
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jj-vcs.github.io/jj/print_page/">
      
      
      
      
      <link rel="icon" href="../images/favicon-96x96.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Print Site - Jujutsu docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    <script>__md_scope=new URL("/jj/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#index" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Jujutsu docs" class="md-header__button md-logo" aria-label="Jujutsu docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jujutsu docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jj-vcs/jj" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jj-vcs/jj
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Jujutsu docs" class="md-nav__button md-logo" aria-label="Jujutsu docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Jujutsu docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jj-vcs/jj" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jj-vcs/jj
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install-and-setup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation and setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial and bird's eye view
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../github.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with GitHub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working on Windows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../FAQ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli-reference.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../testimonials.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testimonials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../community_tools.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Community-built tools
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../working-copy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working copy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bookmarks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bookmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conflicts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conflicts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operation-log.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operation log
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filesets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fileset language
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../revsets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Revset language
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../templates.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templating language
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Comparisons
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Comparisons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git-comparison.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git-command-table.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git command table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git-compatibility.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git compatibility
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sapling-comparison.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sapling comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../related-work.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other related work
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Technical details
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Technical details
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_tenets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core tenets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../technical/architecture.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../technical/concurrency.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concurrency
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../technical/conflicts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conflicts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guidelines and "How to...?"
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code-of-conduct.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code of conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../style_guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Style guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design_docs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design docs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design_doc_blueprint.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design doc blueprint
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../releasing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releasing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../governance/temporary-voting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temporary voting for governance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../governance/GOVERNANCE.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Governance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Design docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Design docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/git-submodules.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git-submodules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/git-submodule-storage.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git-submodule-storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/run.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JJ run
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/sparse-v2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sparse patterns v2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/tracking-branches.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tracking branches
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/copy-tracking.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Copy tracking and tracing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development roadmap
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      1 Home
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2" class="md-nav__link">
    <span class="md-ellipsis">
      2 Getting started
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Getting started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-and-setup" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Installation and setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tutorial" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Tutorial and bird's eye view
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Working with GitHub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Working on Windows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faq" class="md-nav__link">
    <span class="md-ellipsis">
      3 FAQ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli-reference" class="md-nav__link">
    <span class="md-ellipsis">
      4 CLI reference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testimonials" class="md-nav__link">
    <span class="md-ellipsis">
      5 Testimonials
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#community_tools" class="md-nav__link">
    <span class="md-ellipsis">
      6 Community-built tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-7" class="md-nav__link">
    <span class="md-ellipsis">
      7 Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7 Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#working-copy" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 Working copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bookmarks" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 Bookmarks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conflicts" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 Conflicts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operation-log" class="md-nav__link">
    <span class="md-ellipsis">
      7.4 Operation log
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#glossary" class="md-nav__link">
    <span class="md-ellipsis">
      7.5 Glossary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-8" class="md-nav__link">
    <span class="md-ellipsis">
      8 Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8 Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#config" class="md-nav__link">
    <span class="md-ellipsis">
      8.1 Settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filesets" class="md-nav__link">
    <span class="md-ellipsis">
      8.2 Fileset language
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#revsets" class="md-nav__link">
    <span class="md-ellipsis">
      8.3 Revset language
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templates" class="md-nav__link">
    <span class="md-ellipsis">
      8.4 Templating language
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-9" class="md-nav__link">
    <span class="md-ellipsis">
      9 Comparisons
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9 Comparisons">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 Git comparison
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-command-table" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 Git command table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 Git compatibility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sapling-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      9.4 Sapling comparison
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#related-work" class="md-nav__link">
    <span class="md-ellipsis">
      9.5 Other related work
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-10" class="md-nav__link">
    <span class="md-ellipsis">
      10 Technical details
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10 Technical details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core_tenets" class="md-nav__link">
    <span class="md-ellipsis">
      10.1 Core tenets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#technical-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      10.2 Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#technical-concurrency" class="md-nav__link">
    <span class="md-ellipsis">
      10.3 Concurrency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#technical-conflicts" class="md-nav__link">
    <span class="md-ellipsis">
      10.4 Conflicts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-11" class="md-nav__link">
    <span class="md-ellipsis">
      11 Contributing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11 Contributing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    <span class="md-ellipsis">
      11.1 Guidelines and "How to...?"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-of-conduct" class="md-nav__link">
    <span class="md-ellipsis">
      11.2 Code of conduct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#style_guide" class="md-nav__link">
    <span class="md-ellipsis">
      11.3 Style guide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design_docs" class="md-nav__link">
    <span class="md-ellipsis">
      11.4 Design docs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design_doc_blueprint" class="md-nav__link">
    <span class="md-ellipsis">
      11.5 Design doc blueprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#releasing" class="md-nav__link">
    <span class="md-ellipsis">
      11.6 Releasing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#governance-temporary-voting" class="md-nav__link">
    <span class="md-ellipsis">
      11.7 Temporary voting for governance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#governance-governance" class="md-nav__link">
    <span class="md-ellipsis">
      11.8 Governance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-12" class="md-nav__link">
    <span class="md-ellipsis">
      12 Design docs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="12 Design docs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#design-git-submodules" class="md-nav__link">
    <span class="md-ellipsis">
      12.1 git-submodules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design-git-submodule-storage" class="md-nav__link">
    <span class="md-ellipsis">
      12.2 git-submodule-storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design-run" class="md-nav__link">
    <span class="md-ellipsis">
      12.3 JJ run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design-sparse-v2" class="md-nav__link">
    <span class="md-ellipsis">
      12.4 Sparse patterns v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design-tracking-branches" class="md-nav__link">
    <span class="md-ellipsis">
      12.5 Tracking branches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design-copy-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      12.6 Copy tracking and tracing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#roadmap" class="md-nav__link">
    <span class="md-ellipsis">
      13 Development roadmap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index" heading-number="1"><h1 id="index-jujutsua-version-control-system">Jujutsu—a version control system<a class="headerlink" href="#index-jujutsua-version-control-system" title="Permanent link">&para;</a></h1>
<figure>
<img title="jj logo" src="images/jj-logo.svg" width="320" height="320">
</figure>

<h2 id="index-welcome-to-jjs-documentation-website">Welcome to <code>jj</code>'s documentation website!<a class="headerlink" href="#index-welcome-to-jjs-documentation-website" title="Permanent link">&para;</a></h2>
<!-- This only applies to the website, not to the GitHub interface -->
<p>The complete list of the available documentation pages is located in
the sidebar on the left of the page. The sidebar may be hidden; if so,
you can open it either by widening your browser window or by clicking
on the hamburger menu that appears in this situation.</p>
<p>Additional help is available using the <code>jj help</code> command if you have
<code>jj</code> installed.</p>
<p>You may want to jump to:</p>
<ul>
<li>Documentation for the <a href="https://jj-vcs.github.io/jj/latest">latest released version of <code>jj</code></a>.</li>
<li>Documentation for the <a href="https://jj-vcs.github.io/jj/prerelease">unreleased version of <code>jj</code></a>. This version of the docs corresponds to the <code>main</code> branch of the <code>jj</code> repo.</li>
</ul>
<h2 id="index-some-useful-links">Some useful links<a class="headerlink" href="#index-some-useful-links" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/jj-vcs/jj">GitHub repo for <code>jj</code></a></li>
<li>Overview of <code>jj</code> in the repo's <a href="https://github.com/jj-vcs/jj?tab=readme-ov-file#readme">README</a></li>
<li><a href="#install-and-setup">Installation and setup</a></li>
<li><a href="#tutorial">Tutorial and bird's eye view</a></li>
<li><a href="#github">Working with GitHub</a></li>
<li><a href="#roadmap">Development roadmap</a></li>
</ul></section>
                    <section class='print-page md-section' id='section-2' heading-number='2'>
                        <h1>Getting started<a class='headerlink' href='#section-2' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="install-and-setup" heading-number="2.1"><h1 id="install-and-setup-installation-and-setup">Installation and setup<a class="headerlink" href="#install-and-setup-installation-and-setup" title="Permanent link">&para;</a></h1>
<h2 id="install-and-setup-installation">Installation<a class="headerlink" href="#install-and-setup-installation" title="Permanent link">&para;</a></h2>
<h3 id="install-and-setup-download-pre-built-binaries-for-a-release">Download pre-built binaries for a release<a class="headerlink" href="#install-and-setup-download-pre-built-binaries-for-a-release" title="Permanent link">&para;</a></h3>
<p>There are <a href="https://github.com/jj-vcs/jj/releases/latest">pre-built binaries</a> of the last released version of <code>jj</code> for
Windows, Mac, or Linux (the "musl" version should work on all distributions).</p>
<h4 id="install-and-setup-cargo-binstall">Cargo Binstall<a class="headerlink" href="#install-and-setup-cargo-binstall" title="Permanent link">&para;</a></h4>
<p>If you use <a href="https://github.com/cargo-bins/cargo-binstall"><code>cargo-binstall</code></a>, you
can install binaries of the latest <code>jj</code> release from GitHub as follows:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Will put the jj binary for the latest release in ~/.cargo/bin by default</span>
cargo<span class="w"> </span>binstall<span class="w"> </span>--strategies<span class="w"> </span>crate-meta-data<span class="w"> </span>jj-cli
</code></pre></div>
<p>Without the <code>--strategies</code> option, you may get equivalent binaries that should
be compiled from the same source code.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you'd like to install a prerelease version, you'll need to use one of the
options below.</p>
</div>
<h3 id="install-and-setup-linux">Linux<a class="headerlink" href="#install-and-setup-linux" title="Permanent link">&para;</a></h3>
<h4 id="install-and-setup-from-source">From Source<a class="headerlink" href="#install-and-setup-from-source" title="Permanent link">&para;</a></h4>
<p>First make sure that you have a Rust version &gt;= 1.84 and that the
<code>build-essential</code> package is installed by running something like this:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>build-essential
</code></pre></div>
<p>Now run either:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># To install the *prerelease* version from the main branch</span>
cargo<span class="w"> </span>install<span class="w"> </span>--git<span class="w"> </span>https://github.com/jj-vcs/jj.git<span class="w"> </span>--locked<span class="w"> </span>--bin<span class="w"> </span>jj<span class="w"> </span>jj-cli
</code></pre></div>
<p>or:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># To install the latest release</span>
cargo<span class="w"> </span>install<span class="w"> </span>--locked<span class="w"> </span>--bin<span class="w"> </span>jj<span class="w"> </span>jj-cli
</code></pre></div>
<h4 id="install-and-setup-arch-linux">Arch Linux<a class="headerlink" href="#install-and-setup-arch-linux" title="Permanent link">&para;</a></h4>
<p>You can install the <code>jujutsu</code> package from the <a href="https://archlinux.org/packages/extra/x86_64/jujutsu/">official extra repository</a>:</p>
<div class="highlight"><pre><span></span><code>pacman<span class="w"> </span>-S<span class="w"> </span>jujutsu
</code></pre></div>
<p>Or install from the <a href="https://aur.archlinux.org/packages/jujutsu-git">AUR repository</a> with an <a href="https://wiki.archlinux.org/title/AUR_helpers">AUR Helper</a>:</p>
<div class="highlight"><pre><span></span><code>yay<span class="w"> </span>-S<span class="w"> </span>jujutsu-git
</code></pre></div>
<h4 id="install-and-setup-nixos">NixOS<a class="headerlink" href="#install-and-setup-nixos" title="Permanent link">&para;</a></h4>
<p>If you're on NixOS you can install a <strong>released</strong> version of <code>jj</code> using the
<a href="https://search.nixos.org/packages?channel=unstable&amp;show=jujutsu">nixpkgs <code>jujutsu</code> package</a>.</p>
<p>To install a <strong>prerelease</strong> version, you can use the flake for this repository.
For example, if you want to run <code>jj</code> loaded from the flake, use:</p>
<div class="highlight"><pre><span></span><code>nix<span class="w"> </span>run<span class="w"> </span><span class="s1">&#39;github:jj-vcs/jj&#39;</span>
</code></pre></div>
<p>You can also add this flake url to your system input flakes. Or you can
install the flake to your user profile:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Installs the prerelease version from the main branch</span>
nix<span class="w"> </span>profile<span class="w"> </span>install<span class="w"> </span><span class="s1">&#39;github:jj-vcs/jj&#39;</span>
</code></pre></div>
<h4 id="install-and-setup-homebrew">Homebrew<a class="headerlink" href="#install-and-setup-homebrew" title="Permanent link">&para;</a></h4>
<p>If you use Homebrew, you can run:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Installs the latest release</span>
brew<span class="w"> </span>install<span class="w"> </span>jj
</code></pre></div>
<h4 id="install-and-setup-gentoo-linux">Gentoo Linux<a class="headerlink" href="#install-and-setup-gentoo-linux" title="Permanent link">&para;</a></h4>
<p><code>dev-vcs/jj</code> is available in the <a href="https://wiki.gentoo.org/wiki/Project:GURU">GURU</a> repository.
Details on how to enable the GURU repository can be found <a href="https://wiki.gentoo.org/wiki/Project:GURU/Information_for_End_Users">here</a>.</p>
<p>Once you have synced the GURU repository, you can install <code>dev-vcs/jj</code> via Portage:</p>
<div class="highlight"><pre><span></span><code>emerge<span class="w"> </span>-av<span class="w"> </span>dev-vcs/jj
</code></pre></div>
<h4 id="install-and-setup-opensuse-tumbleweed">openSUSE Tumbleweed<a class="headerlink" href="#install-and-setup-opensuse-tumbleweed" title="Permanent link">&para;</a></h4>
<p><code>jujutsu</code> can be installed from the official <a href="http://download.opensuse.org/tumbleweed/repo/oss/">openSUSE-Tumbleweed-Oss</a> repository:</p>
<div class="highlight"><pre><span></span><code>zypper<span class="w"> </span>install<span class="w"> </span>jujutsu
</code></pre></div>
<h3 id="install-and-setup-mac">Mac<a class="headerlink" href="#install-and-setup-mac" title="Permanent link">&para;</a></h3>
<h4 id="install-and-setup-from-source_1">From Source<a class="headerlink" href="#install-and-setup-from-source_1" title="Permanent link">&para;</a></h4>
<p>First make sure that you have a Rust version &gt;= 1.84. You may also need to run:</p>
<div class="highlight"><pre><span></span><code>xcode-select<span class="w"> </span>--install
</code></pre></div>
<p>Now run either:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># To install the *prerelease* version from the main branch</span>
cargo<span class="w"> </span>install<span class="w"> </span>--git<span class="w"> </span>https://github.com/jj-vcs/jj.git<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>--locked<span class="w"> </span>--bin<span class="w"> </span>jj<span class="w"> </span>jj-cli
</code></pre></div>
<p>or:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># To install the latest release</span>
cargo<span class="w"> </span>install<span class="w"> </span>--locked<span class="w"> </span>--bin<span class="w"> </span>jj<span class="w"> </span>jj-cli
</code></pre></div>
<h4 id="install-and-setup-homebrew_1">Homebrew<a class="headerlink" href="#install-and-setup-homebrew_1" title="Permanent link">&para;</a></h4>
<p>If you use Homebrew, you can run:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Installs the latest release</span>
brew<span class="w"> </span>install<span class="w"> </span>jj
</code></pre></div>
<h4 id="install-and-setup-macports">MacPorts<a class="headerlink" href="#install-and-setup-macports" title="Permanent link">&para;</a></h4>
<p>You can also install <code>jj</code> via <a href="https://ports.macports.org/port/jujutsu/">the MacPorts <code>jujutsu</code>
port</a>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Installs the latest release</span>
sudo<span class="w"> </span>port<span class="w"> </span>install<span class="w"> </span>jujutsu
</code></pre></div>
<h3 id="install-and-setup-windows">Windows<a class="headerlink" href="#install-and-setup-windows" title="Permanent link">&para;</a></h3>
<p>First make sure that you have a Rust version &gt;= 1.84. Now run either:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># To install the *prerelease* version from the main branch</span>
cargo<span class="w"> </span>install<span class="w"> </span>--git<span class="w"> </span>https://github.com/jj-vcs/jj.git<span class="w"> </span>--locked<span class="w"> </span>--bin<span class="w"> </span>jj<span class="w"> </span>jj-cli
</code></pre></div>
<p>or:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># To install the latest release</span>
cargo<span class="w"> </span>install<span class="w"> </span>--locked<span class="w"> </span>--bin<span class="w"> </span>jj<span class="w"> </span>jj-cli
</code></pre></div>
<p>via winget:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># To install the latest release via winget</span>
winget<span class="w"> </span>install<span class="w"> </span>jj-vcs.jj
</code></pre></div>
<h2 id="install-and-setup-initial-configuration">Initial configuration<a class="headerlink" href="#install-and-setup-initial-configuration" title="Permanent link">&para;</a></h2>
<p>You may want to configure your name and email so commits are made in your name.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--user<span class="w"> </span>user.name<span class="w"> </span><span class="s2">&quot;Martin von Zweigbergk&quot;</span>
$<span class="w"> </span>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--user<span class="w"> </span>user.email<span class="w"> </span><span class="s2">&quot;martinvonz@google.com&quot;</span>
</code></pre></div>
<h2 id="install-and-setup-command-line-completion">Command-line completion<a class="headerlink" href="#install-and-setup-command-line-completion" title="Permanent link">&para;</a></h2>
<p>To set up command-line completion, source the output of
<code>jj util completion bash/zsh/fish</code>. Exactly how to source it
depends on your shell.</p>
<p>Improved completions are also available. They will complete things like
bookmarks, aliases, revisions, operations and files. They can be context aware,
for example they respect the global flags <code>--repository</code> and <code>--at-operation</code> as
well as some command-specific ones like <code>--revision</code>, <code>--from</code> and <code>--to</code>. You
can activate them with the alternative "dynamic" instructions below. They should
still complete everything the static completions did, so only activate one of
them. Please let us know if you encounter any issues, so we can ensure a smooth
transition once we default to these new completions.</p>
<div class="admonition info">
<p class="admonition-title">Why are the improved completions not the default?</p>
<p>To generate the dynamic completion script, execute <code>jj</code> with <code>$COMPLETE</code> set
to the name of your shell (see examples below). See the upstream clap issue
<a href="https://github.com/clap-rs/clap/issues/3166">#3166</a> for the explanation.</p>
</div>
<h3 id="install-and-setup-bash">Bash<a class="headerlink" href="#install-and-setup-bash" title="Permanent link">&para;</a></h3>
<h4 id="install-and-setup-standard">Standard<a class="headerlink" href="#install-and-setup-standard" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>&lt;<span class="o">(</span>jj<span class="w"> </span>util<span class="w"> </span>completion<span class="w"> </span>bash<span class="o">)</span>
</code></pre></div>
<h4 id="install-and-setup-dynamic">Dynamic<a class="headerlink" href="#install-and-setup-dynamic" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>&lt;<span class="o">(</span><span class="nv">COMPLETE</span><span class="o">=</span>bash<span class="w"> </span>jj<span class="o">)</span>
</code></pre></div>
<h3 id="install-and-setup-zsh">Zsh<a class="headerlink" href="#install-and-setup-zsh" title="Permanent link">&para;</a></h3>
<h4 id="install-and-setup-standard_1">Standard<a class="headerlink" href="#install-and-setup-standard_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>autoload<span class="w"> </span>-U<span class="w"> </span>compinit
compinit
<span class="nb">source</span><span class="w"> </span>&lt;<span class="o">(</span>jj<span class="w"> </span>util<span class="w"> </span>completion<span class="w"> </span>zsh<span class="o">)</span>
</code></pre></div>
<h4 id="install-and-setup-dynamic_1">Dynamic<a class="headerlink" href="#install-and-setup-dynamic_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>&lt;<span class="o">(</span><span class="nv">COMPLETE</span><span class="o">=</span>zsh<span class="w"> </span>jj<span class="o">)</span>
</code></pre></div>
<h3 id="install-and-setup-fish">Fish<a class="headerlink" href="#install-and-setup-fish" title="Permanent link">&para;</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No configuration is required with fish &gt;= 4.1 which loads dynamic completions by default.</p>
</div>
<h4 id="install-and-setup-standard_2">Standard<a class="headerlink" href="#install-and-setup-standard_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>util<span class="w"> </span>completion<span class="w"> </span>fish<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">source</span>
</code></pre></div>
<h4 id="install-and-setup-dynamic_2">Dynamic<a class="headerlink" href="#install-and-setup-dynamic_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nv">COMPLETE</span><span class="o">=</span>fish<span class="w"> </span>jj<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">source</span>
</code></pre></div>
<h3 id="install-and-setup-nushell">Nushell<a class="headerlink" href="#install-and-setup-nushell" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>jj util completion nushell | save completions-jj.nu
use completions-jj.nu *  # Or `source completions-jj.nu`
</code></pre></div>
<p>(dynamic completions not available yet)</p>
<h3 id="install-and-setup-xonsh">Xonsh<a class="headerlink" href="#install-and-setup-xonsh" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>source-bash<span class="w"> </span><span class="k">$(</span>jj<span class="w"> </span>util<span class="w"> </span>completion<span class="k">)</span>
</code></pre></div>
<p>(dynamic completions not available yet)</p>
<h3 id="install-and-setup-powershell">Powershell<a class="headerlink" href="#install-and-setup-powershell" title="Permanent link">&para;</a></h3>
<p>Insert this line in your $PROFILE file:
(usually $HOME\Documents\PowerShell\Microsoft.PowerShell_profile.ps1)</p>
<div class="highlight"><pre><span></span><code>Invoke-Expression<span class="w"> </span><span class="o">(</span><span class="p">&amp;</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="o">(</span>jj<span class="w"> </span>util<span class="w"> </span>completion<span class="w"> </span>power-shell<span class="w"> </span><span class="p">|</span><span class="w"> </span>Out-String<span class="o">)</span><span class="w"> </span><span class="o">})</span>
</code></pre></div>
<p>(dynamic completions not available yet)</p></section><section class="print-page" id="tutorial" heading-number="2.2"><h1 id="tutorial-tutorial">Tutorial<a class="headerlink" href="#tutorial-tutorial" title="Permanent link">&para;</a></h1>
<blockquote>
<p><strong>Hint:</strong> This tutorial has become somewhat out of date. Many people find
the alternative (not quite finished) <a href="https://steveklabnik.github.io/jujutsu-tutorial/">tutorial by Steve
Klabnik</a> helpful.</p>
</blockquote>
<p>This text assumes that the reader is familiar with Git.</p>
<h2 id="tutorial-preparation">Preparation<a class="headerlink" href="#tutorial-preparation" title="Permanent link">&para;</a></h2>
<p>If you haven't already, make sure you
<a href="#install-and-setup">install and configure Jujutsu</a>.</p>
<h2 id="tutorial-cloning-a-git-repository">Cloning a Git repository<a class="headerlink" href="#tutorial-cloning-a-git-repository" title="Permanent link">&para;</a></h2>
<blockquote>
<p><strong>Hint:</strong> Most identifiers used in this tutorial will be different when you
try this at home!</p>
</blockquote>
<p>Let's start by cloning GitHub's Hello-World repo using <code>jj</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Note the &quot;git&quot; before &quot;clone&quot; (there is no support for cloning native jj</span>
<span class="c1"># repos yet)</span>
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/octocat/Hello-World
Fetching<span class="w"> </span>into<span class="w"> </span>new<span class="w"> </span>repo<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;/tmp/tmp.O1DWMiaKd4/Hello-World&quot;</span>
remote:<span class="w"> </span>Enumerating<span class="w"> </span>objects:<span class="w"> </span><span class="m">13</span>,<span class="w"> </span><span class="k">done</span>.
remote:<span class="w"> </span>Total<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="o">(</span>delta<span class="w"> </span><span class="m">0</span><span class="o">)</span>,<span class="w"> </span>reused<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>delta<span class="w"> </span><span class="m">0</span><span class="o">)</span>,<span class="w"> </span>pack-reused<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="o">(</span>from<span class="w"> </span><span class="m">1</span><span class="o">)</span>
bookmark:<span class="w"> </span>master@origin<span class="w">          </span><span class="o">[</span>new<span class="o">]</span><span class="w"> </span>untracked
bookmark:<span class="w"> </span>octocat-patch-1@origin<span class="w"> </span><span class="o">[</span>new<span class="o">]</span><span class="w"> </span>untracked
bookmark:<span class="w"> </span>test@origin<span class="w">            </span><span class="o">[</span>new<span class="o">]</span><span class="w"> </span>untracked
Setting<span class="w"> </span>the<span class="w"> </span>revset<span class="w"> </span><span class="nb">alias</span><span class="w"> </span><span class="sb">`</span>trunk<span class="o">()</span><span class="sb">`</span><span class="w"> </span>to<span class="w"> </span><span class="sb">`</span>master@origin<span class="sb">`</span>
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>kntqzsqt<span class="w"> </span>d7439b06<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>orrkosyo<span class="w"> </span>7fd1a60b<span class="w"> </span>master<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
Added<span class="w"> </span><span class="m">1</span><span class="w"> </span>files,<span class="w"> </span>modified<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>removed<span class="w"> </span><span class="m">0</span><span class="w"> </span>files
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>Hello-World
</code></pre></div>
<p>Running <code>jj st</code> (short for <code>jj status</code>) now yields something like this:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>st
The<span class="w"> </span>working<span class="w"> </span>copy<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>changes.
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>kntqzsqt<span class="w"> </span>d7439b06<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span>:<span class="w"> </span>orrkosyo<span class="w"> </span>7fd1a60b<span class="w"> </span>master<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
</code></pre></div>
<p>Let's look at that output as it introduces new concepts. You can see two
commits: Parent and working copy. Both are identified using two separate
identifiers: the "change ID" and the "commit ID".</p>
<p>The parent commit, for example, has the change ID <code>orrkosyo</code> and the commit ID
<code>7fd1a60b</code>.</p>
<blockquote>
<p><strong>Git users:</strong> The commit ID/hash is what you're used to from Git and should
match what you see when you look at the repository using <code>git log</code> in a Git
checkout of the repository.
The change ID however, is a new concept, unique to Jujutsu.</p>
</blockquote>
<p>We can also see from the output above that our working copy is an actual commit
with a commit ID (<code>d7439b06</code> in the example). When you make a change in the
working copy, the working-copy commit gets automatically amended by the next
<code>jj</code> command.</p>
<blockquote>
<p><strong>Git users:</strong> This is a huge difference from Git where the working copy is a
separate concept and not yet a commit.</p>
</blockquote>
<h2 id="tutorial-changes">Changes<a class="headerlink" href="#tutorial-changes" title="Permanent link">&para;</a></h2>
<p>A change is a commit that can evolve while keeping a stable identifier (similar
to Gerrit's Change-Id). In other words: You can make changes to files in a
change, resulting in a new commit hash, but the change ID will remain the same.</p>
<p>You can see that our clone operation automatically created a new change:</p>
<div class="highlight"><pre><span></span><code>Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>kntqzsqt<span class="w"> </span>d7439b06<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
</code></pre></div>
<p>This new change has the ID <code>kntqzsqt</code> and it is currently empty (contains no
changes compared to the parent) and has no description.</p>
<h2 id="tutorial-creating-our-first-change">Creating our first change<a class="headerlink" href="#tutorial-creating-our-first-change" title="Permanent link">&para;</a></h2>
<p>Let's say we want to edit the <code>README</code> file in the repo to say "Goodbye"
instead of "Hello". Start by describing the change (adding a commit message) so
we don't forget what we're working on:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># This brings up $EDITOR (or `pico` or `Notepad` by default).</span>
<span class="c1"># Enter something like &quot;Say goodbye&quot; in the editor and then save the file and close</span>
<span class="c1"># the editor.</span>
$<span class="w"> </span>jj<span class="w"> </span>describe
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>kntqzsqt<span class="w"> </span>e427edcf<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Say<span class="w"> </span>goodbye
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>orrkosyo<span class="w"> </span>7fd1a60b<span class="w"> </span>master<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
</code></pre></div>
<p>Now make the change in the README:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Adjust as necessary for compatibility with your flavor of `sed`</span>
$<span class="w"> </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/Hello/Goodbye/&#39;</span><span class="w"> </span>README
$<span class="w"> </span>jj<span class="w"> </span>st
Working<span class="w"> </span>copy<span class="w"> </span>changes:
M<span class="w"> </span>README
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>kntqzsqt<span class="w"> </span>5d39e19d<span class="w"> </span>Say<span class="w"> </span>goodbye
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span>:<span class="w"> </span>orrkosyo<span class="w"> </span>7fd1a60b<span class="w"> </span>master<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
</code></pre></div>
<p>Note that you didn't have to tell Jujutsu to add the change like you would with
<code>git add</code>. You actually don't even need to tell it when you add new files or
remove existing files. To untrack a path, add it to your <code>.gitignore</code> and run
<code>jj file untrack &lt;path&gt;</code>.</p>
<p>Also note that the commit hash for our current change (<code>kntqzsqt</code>) changed from
<code>e427edcf</code> to <code>5d39e19d</code>!</p>
<p>To see the diff, run <code>jj diff</code>:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>diff<span class="w"> </span>--git<span class="w">  </span><span class="c1"># Feel free to skip the `--git` flag</span>
diff<span class="w"> </span>--git<span class="w"> </span>a/README<span class="w"> </span>b/README
index<span class="w"> </span>980a0d5f19..1ce3f81130<span class="w"> </span><span class="m">100644</span>
---<span class="w"> </span>a/README
+++<span class="w"> </span>b/README
@@<span class="w"> </span>-1,1<span class="w"> </span>+1,1<span class="w"> </span>@@
-Hello<span class="w"> </span>World!
+Goodbye<span class="w"> </span>World!
</code></pre></div>
<p>Jujutsu's diff format currently defaults to inline coloring of the diff (like
<code>git diff --color-words</code>), so we used <code>--git</code> above to make the diff readable in
this tutorial.</p>
<p>As you may have noticed, the working-copy commit's ID changed both when we
edited the description and when we edited the README. However, the parent commit
stayed the same. Each change to the working-copy commit amends the previous
version. So how do we tell Jujutsu that we are done amending the current change
and want to start working on a new one? That is what <code>jj new</code> is for. That will
create a new commit on top of your current working-copy commit. The new commit
is for the working-copy changes.</p>
<p>So, let's say we're now done with this change, so we create a new change:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>new
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>mpqrykyp<span class="w"> </span>aef4df99<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>kntqzsqt<span class="w"> </span>5d39e19d<span class="w"> </span>Say<span class="w"> </span>goodbye
$<span class="w"> </span>jj<span class="w"> </span>st
The<span class="w"> </span>working<span class="w"> </span>copy<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>changes.
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>mpqrykyp<span class="w"> </span>aef4df99<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span>:<span class="w"> </span>kntqzsqt<span class="w"> </span>5d39e19d<span class="w"> </span>Say<span class="w"> </span>goodbye
</code></pre></div>
<p>If we later realize that we want to make further changes, we can make them in
the working copy and then run <code>jj squash</code>. That command squashes (moves) the
changes from a given commit into its parent commit. Like most commands, it acts
on the working-copy commit by default. When run on the working-copy commit, it
behaves very similar to <code>git commit --amend</code>.</p>
<p>Alternatively, we can use <code>jj edit &lt;commit&gt;</code> to resume editing a commit in the
working copy. Any further changes in the working copy will then amend the
commit. Whether you choose to create a new change and squash, or to edit,
typically depends on how done you are with the change; if the change is almost
done, it makes sense to use <code>jj new</code> so you can easily review your adjustments
with <code>jj diff</code> before running <code>jj squash</code>.</p>
<p>To view how a change has evolved over time, we can use <code>jj evolog</code> to see each
recorded change for the current commit. This records changes to the working
copy, message, squashes, rebases, etc.</p>
<h2 id="tutorial-the-log-command-and-revsets">The log command and "revsets"<a class="headerlink" href="#tutorial-the-log-command-and-revsets" title="Permanent link">&para;</a></h2>
<p>You're probably familiar with <code>git log</code>. Jujutsu has very similar functionality
in its <code>jj log</code> command:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>log
@<span class="w">  </span>mpqrykyp<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:00:22<span class="w"> </span>aef4df99
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
○<span class="w">  </span>kntqzsqt<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">14</span>:56:59<span class="w"> </span>5d39e19d
│<span class="w">  </span>Say<span class="w"> </span>goodbye
◆<span class="w">  </span>orrkosyo<span class="w"> </span>octocat@nowhere.com<span class="w"> </span><span class="m">2012</span>-03-06<span class="w"> </span><span class="m">15</span>:06:50<span class="w"> </span>master<span class="w"> </span>7fd1a60b
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
~
</code></pre></div>
<p>The <code>@</code> indicates the working-copy commit. The first ID on a line
(e.g. "mpqrykyp" above) is the change ID. The second ID is the commit ID. You
can give either ID to commands that take revisions as arguments. We will
generally prefer change IDs because they stay the same when the commit is
rewritten.</p>
<p>By default, <code>jj log</code> lists your local commits, with some remote commits added
for context. The <code>~</code> indicates that the commit has parents that are not included
in the graph. We can use the <code>--revisions</code>/<code>-r</code> flag to select a different set
of revisions to list. The flag accepts a <a href="#revsets">"revset"</a>, which is an
expression in a simple language for specifying revisions. For example, <code>@</code>
refers to the working-copy commit, <code>root()</code> refers to the root commit,
<code>bookmarks()</code> refers to all commits pointed to by bookmarks (similar to Git's
branches). We can combine expressions with <code>|</code> for union, <code>&amp;</code> for intersection
and <code>~</code> for difference. For example:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;@ | root() | bookmarks()&#39;</span>
@<span class="w">  </span>mpqrykyp<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:00:22<span class="w"> </span>aef4df99
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
~<span class="w">  </span><span class="o">(</span>elided<span class="w"> </span>revisions<span class="o">)</span>
◆<span class="w">  </span>orrkosyo<span class="w"> </span>octocat@nowhere.com<span class="w"> </span><span class="m">2012</span>-03-06<span class="w"> </span><span class="m">15</span>:06:50<span class="w"> </span>master<span class="w"> </span>7fd1a60b
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
~<span class="w">  </span><span class="o">(</span>elided<span class="w"> </span>revisions<span class="o">)</span>
◆<span class="w">  </span>zzzzzzzz<span class="w"> </span>root<span class="o">()</span><span class="w"> </span><span class="m">00000000</span>
</code></pre></div>
<p>The <code>00000000</code> commit (change ID <code>zzzzzzzz</code>) is a virtual commit that's called
the "root commit". It's the root commit of every repo. The <code>root()</code>
function in the revset matches it.</p>
<p>There are also operators for getting the parents (<code>foo-</code>), children (<code>foo+</code>),
ancestors (<code>::foo</code>), descendants (<code>foo::</code>), DAG range (<code>foo::bar</code>, like
<code>git log --ancestry-path</code>), range (<code>foo..bar</code>, same as Git's). See
<a href="#revsets">the revset documentation</a> for all revset operators and functions.</p>
<blockquote>
<p><strong>Hint:</strong> If the default <code>jj log</code> omits some commits you expect to see, you
can always run <code>jj log -r ::</code> (or, equivalently, <code>jj log -r 'all()'</code>) to see
all the commits.</p>
</blockquote>
<h2 id="tutorial-conflicts">Conflicts<a class="headerlink" href="#tutorial-conflicts" title="Permanent link">&para;</a></h2>
<p>Now let's see how Jujutsu deals with merge conflicts. We'll start by making some
commits. We use <code>jj new</code> with the <code>--message</code>/<code>-m</code> option to set change
descriptions (commit messages) right away.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Start creating a chain of commits off of the `master` bookmark</span>
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>master<span class="w"> </span>-m<span class="w"> </span>A<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>a<span class="w"> </span>&gt;<span class="w"> </span>file1
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>nuvyytnq<span class="w"> </span>00a2aeed<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>A
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>orrkosyo<span class="w"> </span>7fd1a60b<span class="w"> </span>master<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
Added<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>modified<span class="w"> </span><span class="m">1</span><span class="w"> </span>files,<span class="w"> </span>removed<span class="w"> </span><span class="m">0</span><span class="w"> </span>files
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>-m<span class="w"> </span>B1<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>b1<span class="w"> </span>&gt;<span class="w"> </span>file1
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>ovknlmro<span class="w"> </span>967d9f9f<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>B1
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>nuvyytnq<span class="w"> </span>5dda2f09<span class="w"> </span>A
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>-m<span class="w"> </span>B2<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>b2<span class="w"> </span>&gt;<span class="w"> </span>file1
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>puqltutt<span class="w"> </span>8ebeaffa<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>B2
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>ovknlmro<span class="w"> </span>7d7c6e6b<span class="w"> </span>B1
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>-m<span class="w"> </span>C<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>c<span class="w"> </span>&gt;<span class="w"> </span>file2
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>qzvqqupx<span class="w"> </span>62a3c6d3<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>C
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>puqltutt<span class="w"> </span>daa6ffd5<span class="w"> </span>B2
$<span class="w"> </span>jj<span class="w"> </span>log
@<span class="w">  </span>qzvqqupx<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:41<span class="w"> </span>2370ddf3
│<span class="w">  </span>C
○<span class="w">  </span>puqltutt<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:33<span class="w"> </span>daa6ffd5
│<span class="w">  </span>B2
○<span class="w">  </span>ovknlmro<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:24<span class="w"> </span>7d7c6e6b
│<span class="w">  </span>B1
○<span class="w">  </span>nuvyytnq<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:05<span class="w"> </span>5dda2f09
│<span class="w">  </span>A
│<span class="w"> </span>○<span class="w">  </span>kntqzsqt<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">14</span>:56:59<span class="w"> </span>5d39e19d
├─╯<span class="w">  </span>Say<span class="w"> </span>goodbye
◆<span class="w">  </span>orrkosyo<span class="w"> </span>octocat@nowhere.com<span class="w"> </span><span class="m">2012</span>-03-06<span class="w"> </span><span class="m">15</span>:06:50<span class="w"> </span>master<span class="w"> </span>7fd1a60b
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
~
</code></pre></div>
<p>We now have a few commits, where A, B1, and B2 modify the same file, while C
modifies a different file. Let's now rebase B2 directly onto A. We use the
<code>--source</code>/<code>-s</code> option on the change ID of B2, and <code>--destination</code>/<code>-d</code> option
on A.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>rebase<span class="w"> </span>-s<span class="w"> </span>puqltutt<span class="w"> </span>-d<span class="w"> </span>nuvyytnq<span class="w">  </span><span class="c1"># Replace the IDs by what you have for B2 and A</span>
Rebased<span class="w"> </span><span class="m">2</span><span class="w"> </span>commits<span class="w"> </span>to<span class="w"> </span>destination
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>qzvqqupx<span class="w"> </span>1978b534<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>C
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>puqltutt<span class="w"> </span>f7fb5943<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>B2
Added<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>modified<span class="w"> </span><span class="m">1</span><span class="w"> </span>files,<span class="w"> </span>removed<span class="w"> </span><span class="m">0</span><span class="w"> </span>files
Warning:<span class="w"> </span>There<span class="w"> </span>are<span class="w"> </span>unresolved<span class="w"> </span>conflicts<span class="w"> </span>at<span class="w"> </span>these<span class="w"> </span>paths:
file1<span class="w">    </span><span class="m">2</span>-sided<span class="w"> </span>conflict
New<span class="w"> </span>conflicts<span class="w"> </span>appeared<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>commits:
<span class="w">  </span>qzvqqupx<span class="w"> </span>1978b534<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>C
<span class="w">  </span>puqltutt<span class="w"> </span>f7fb5943<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>B2
Hint:<span class="w"> </span>To<span class="w"> </span>resolve<span class="w"> </span>the<span class="w"> </span>conflicts,<span class="w"> </span>start<span class="w"> </span>by<span class="w"> </span>updating<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>first<span class="w"> </span>one:
<span class="w">  </span>jj<span class="w"> </span>new<span class="w"> </span>puqltutt
Then<span class="w"> </span>use<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>resolve<span class="sb">`</span>,<span class="w"> </span>or<span class="w"> </span>edit<span class="w"> </span>the<span class="w"> </span>conflict<span class="w"> </span>markers<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>directly.
Once<span class="w"> </span>the<span class="w"> </span>conflicts<span class="w"> </span>are<span class="w"> </span>resolved,<span class="w"> </span>you<span class="w"> </span>may<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>inspect<span class="w"> </span>the<span class="w"> </span>result<span class="w"> </span>with<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>diff<span class="sb">`</span>.
Then<span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>squash<span class="sb">`</span><span class="w"> </span>to<span class="w"> </span>move<span class="w"> </span>the<span class="w"> </span>resolution<span class="w"> </span>into<span class="w"> </span>the<span class="w"> </span>conflicted<span class="w"> </span>commit.

$<span class="w"> </span>jj<span class="w"> </span>log
@<span class="w">  </span>qzvqqupx<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:08:33<span class="w"> </span>1978b534<span class="w"> </span>conflict
│<span class="w">  </span>C
×<span class="w">  </span>puqltutt<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:08:33<span class="w"> </span>f7fb5943<span class="w"> </span>conflict
│<span class="w">  </span>B2
│<span class="w"> </span>○<span class="w">  </span>ovknlmro<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:24<span class="w"> </span>7d7c6e6b
├─╯<span class="w">  </span>B1
○<span class="w">  </span>nuvyytnq<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:05<span class="w"> </span>5dda2f09
│<span class="w">  </span>A
│<span class="w"> </span>○<span class="w">  </span>kntqzsqt<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">14</span>:56:59<span class="w"> </span>5d39e19d
├─╯<span class="w">  </span>Say<span class="w"> </span>goodbye
◆<span class="w">  </span>orrkosyo<span class="w"> </span>octocat@nowhere.com<span class="w"> </span><span class="m">2012</span>-03-06<span class="w"> </span><span class="m">15</span>:06:50<span class="w"> </span>master<span class="w"> </span>7fd1a60b
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
~
</code></pre></div>
<p>There are several things worth noting here. First, the <code>jj rebase</code> command said
"Rebased 2 commits". That's because we asked it to rebase commit B2 with the
<code>-s</code> option, which also rebases descendants (commit C in this case). Second,
because B2 modified the same file (and word) as B1, rebasing it resulted in
conflicts, as the output indicates. Third, the conflicts did not prevent the
rebase from completing successfully, nor did it prevent C from getting rebased
on top.</p>
<p>Now let's resolve the conflict in B2. We'll do that by creating a new commit on
top of B2. Once we've resolved the conflict, we'll squash the conflict
resolution into the conflicted B2. That might look like this:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>puqltutt<span class="w">  </span><span class="c1"># Replace the ID by what you have for B2</span>
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>zxoosnnp<span class="w"> </span>c7068d1c<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>puqltutt<span class="w"> </span>f7fb5943<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>B2
Added<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>modified<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>removed<span class="w"> </span><span class="m">1</span><span class="w"> </span>files
Warning:<span class="w"> </span>There<span class="w"> </span>are<span class="w"> </span>unresolved<span class="w"> </span>conflicts<span class="w"> </span>at<span class="w"> </span>these<span class="w"> </span>paths:
file1<span class="w">    </span><span class="m">2</span>-sided<span class="w"> </span>conflict

$<span class="w"> </span>jj<span class="w"> </span>st
The<span class="w"> </span>working<span class="w"> </span>copy<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>changes.
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>zxoosnnp<span class="w"> </span>c7068d1c<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span>:<span class="w"> </span>puqltutt<span class="w"> </span>f7fb5943<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>B2
Warning:<span class="w"> </span>There<span class="w"> </span>are<span class="w"> </span>unresolved<span class="w"> </span>conflicts<span class="w"> </span>at<span class="w"> </span>these<span class="w"> </span>paths:
file1<span class="w">    </span><span class="m">2</span>-sided<span class="w"> </span>conflict
Hint:<span class="w"> </span>To<span class="w"> </span>resolve<span class="w"> </span>the<span class="w"> </span>conflicts,<span class="w"> </span>start<span class="w"> </span>by<span class="w"> </span>updating<span class="w"> </span>to<span class="w"> </span>it:
<span class="w">  </span>jj<span class="w"> </span>new<span class="w"> </span>puqltutt
Then<span class="w"> </span>use<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>resolve<span class="sb">`</span>,<span class="w"> </span>or<span class="w"> </span>edit<span class="w"> </span>the<span class="w"> </span>conflict<span class="w"> </span>markers<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>directly.
Once<span class="w"> </span>the<span class="w"> </span>conflicts<span class="w"> </span>are<span class="w"> </span>resolved,<span class="w"> </span>you<span class="w"> </span>may<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>inspect<span class="w"> </span>the<span class="w"> </span>result<span class="w"> </span>with<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>diff<span class="sb">`</span>.
Then<span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>squash<span class="sb">`</span><span class="w"> </span>to<span class="w"> </span>move<span class="w"> </span>the<span class="w"> </span>resolution<span class="w"> </span>into<span class="w"> </span>the<span class="w"> </span>conflicted<span class="w"> </span>commit.

$<span class="w"> </span>cat<span class="w"> </span>file1
<span class="o">&lt;&lt;&lt;&lt;&lt;&lt;</span>&lt;<span class="w"> </span>Conflict<span class="w"> </span><span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span>
%%%%%%%<span class="w"> </span>Changes<span class="w"> </span>from<span class="w"> </span>base<span class="w"> </span>to<span class="w"> </span>side<span class="w"> </span><span class="c1">#1</span>
-b1
+a
+++++++<span class="w"> </span>Contents<span class="w"> </span>of<span class="w"> </span>side<span class="w"> </span><span class="c1">#2</span>
b2
&gt;&gt;&gt;&gt;&gt;&gt;&gt;<span class="w"> </span>Conflict<span class="w"> </span><span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>ends

$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>resolved<span class="w"> </span>&gt;<span class="w"> </span>file1

$<span class="w"> </span>jj<span class="w"> </span>st
Working<span class="w"> </span>copy<span class="w"> </span>changes:
M<span class="w"> </span>file1
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>zxoosnnp<span class="w"> </span>c2a31a06<span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span>:<span class="w"> </span>puqltutt<span class="w"> </span>f7fb5943<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>B2
Hint:<span class="w"> </span>Conflict<span class="w"> </span><span class="k">in</span><span class="w"> </span>parent<span class="w"> </span>commit<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>resolved<span class="w"> </span><span class="k">in</span><span class="w"> </span>working<span class="w"> </span>copy

$<span class="w"> </span>jj<span class="w"> </span>squash
Rebased<span class="w"> </span><span class="m">1</span><span class="w"> </span>descendant<span class="w"> </span>commits
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>ntxxqymr<span class="w"> </span>e3c279cc<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>puqltutt<span class="w"> </span>2c7a658e<span class="w"> </span>B2
Existing<span class="w"> </span>conflicts<span class="w"> </span>were<span class="w"> </span>resolved<span class="w"> </span>or<span class="w"> </span>abandoned<span class="w"> </span>from<span class="w"> </span><span class="m">2</span><span class="w"> </span>commits.

$<span class="w"> </span>jj<span class="w"> </span>log
@<span class="w">  </span>ntxxqymr<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">19</span>:34:09<span class="w"> </span>e3c279cc
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
│<span class="w"> </span>○<span class="w">  </span>qzvqqupx<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">19</span>:34:09<span class="w"> </span>b9da9d28
├─╯<span class="w">  </span>C
○<span class="w">  </span>puqltutt<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">19</span>:34:09<span class="w"> </span>2c7a658e
│<span class="w">  </span>B2
│<span class="w"> </span>○<span class="w">  </span>ovknlmro<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:24<span class="w"> </span>7d7c6e6b
├─╯<span class="w">  </span>B1
○<span class="w">  </span>nuvyytnq<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:05<span class="w"> </span>5dda2f09
│<span class="w">  </span>A
│<span class="w"> </span>○<span class="w">  </span>kntqzsqt<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">14</span>:56:59<span class="w"> </span>5d39e19d
├─╯<span class="w">  </span>Say<span class="w"> </span>goodbye
◆<span class="w">  </span>orrkosyo<span class="w"> </span>octocat@nowhere.com<span class="w"> </span><span class="m">2012</span>-03-06<span class="w"> </span><span class="m">15</span>:06:50<span class="w"> </span>master<span class="w"> </span>7fd1a60b
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
~
</code></pre></div>
<p>Note that commit C automatically got rebased on top of the resolved B2, and that
C is also resolved (since it modified only a different file).</p>
<p>By the way, if we want to get rid of B1 now, we can run <code>jj abandon
ovknlmro</code>. That will hide the commit from the log output and will rebase any
descendants to its parent.</p>
<h2 id="tutorial-the-operation-log">The operation log<a class="headerlink" href="#tutorial-the-operation-log" title="Permanent link">&para;</a></h2>
<p>Jujutsu keeps a record of all changes you've made to the repo in what's called
the "operation log". Use the <code>jj op</code> (short for <code>jj operation</code>) family of
commands to interact with it. To list the operations, use <code>jj op log</code>:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>op<span class="w"> </span>log
@<span class="w">  </span>d3b77addea49<span class="w"> </span>martinvonz@vonz.svl.corp.google.com<span class="w"> </span><span class="m">3</span><span class="w"> </span>minutes<span class="w"> </span>ago,<span class="w"> </span>lasted<span class="w"> </span><span class="m">3</span><span class="w"> </span>milliseconds
│<span class="w">  </span>squash<span class="w"> </span>commits<span class="w"> </span>into<span class="w"> </span>63874fe6c4fba405ffc38b0dd926f03b715cf7ef
│<span class="w">  </span>args:<span class="w"> </span>jj<span class="w"> </span>squash
○<span class="w">  </span>6fc1873c1180<span class="w"> </span>martinvonz@vonz.svl.corp.google.com<span class="w"> </span><span class="m">3</span><span class="w"> </span>minutes<span class="w"> </span>ago,<span class="w"> </span>lasted<span class="w"> </span><span class="m">1</span><span class="w"> </span>milliseconds
│<span class="w">  </span>snapshot<span class="w"> </span>working<span class="w"> </span>copy
│<span class="w">  </span>args:<span class="w"> </span>jj<span class="w"> </span>st
○<span class="w">  </span>ed91f7bcc1fb<span class="w"> </span>martinvonz@vonz.svl.corp.google.com<span class="w"> </span><span class="m">6</span><span class="w"> </span>minutes<span class="w"> </span>ago,<span class="w"> </span>lasted<span class="w"> </span><span class="m">1</span><span class="w"> </span>milliseconds
│<span class="w">  </span>new<span class="w"> </span>empty<span class="w"> </span>commit
│<span class="w">  </span>args:<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>puqltutt
○<span class="w">  </span>367400773f87<span class="w"> </span>martinvonz@vonz.svl.corp.google.com<span class="w"> </span><span class="m">12</span><span class="w"> </span>minutes<span class="w"> </span>ago,<span class="w"> </span>lasted<span class="w"> </span><span class="m">3</span><span class="w"> </span>milliseconds
│<span class="w">  </span>rebase<span class="w"> </span>commit<span class="w"> </span>daa6ffd5a09a8a7d09a65796194e69b7ed0a566d<span class="w"> </span>and<span class="w"> </span>descendants
│<span class="w">  </span>args:<span class="w"> </span>jj<span class="w"> </span>rebase<span class="w"> </span>--source<span class="w"> </span>puqltutt<span class="w"> </span>--destination<span class="w"> </span>nuvyytnq
<span class="o">[</span>many<span class="w"> </span>more<span class="w"> </span>lines<span class="o">]</span>
</code></pre></div>
<p>The most useful command is <code>jj undo</code> (alias for <code>jj op undo</code>), which will undo
an operation. By default, it will undo the most recent operation. Let's try it:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>undo
Undid<span class="w"> </span>operation:<span class="w"> </span>d3b77addea49<span class="w"> </span><span class="o">(</span><span class="m">2025</span>-05-12<span class="w"> </span><span class="m">00</span>:27:27<span class="o">)</span><span class="w"> </span>squash<span class="w"> </span>commits<span class="w"> </span>into<span class="w"> </span>f7fb5943a6b9460eb106dba2fac5cac1625c6f7a
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>zxoosnnp<span class="w"> </span>63874fe6<span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>puqltutt<span class="w"> </span>f7fb5943<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>B2
New<span class="w"> </span>conflicts<span class="w"> </span>appeared<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>commits:
<span class="w">  </span>qzvqqupx<span class="w"> </span>1978b534<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>C
<span class="w">  </span>puqltutt<span class="w"> </span>f7fb5943<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>B2
Hint:<span class="w"> </span>To<span class="w"> </span>resolve<span class="w"> </span>the<span class="w"> </span>conflicts,<span class="w"> </span>start<span class="w"> </span>by<span class="w"> </span>updating<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>first<span class="w"> </span>one:
<span class="w">  </span>jj<span class="w"> </span>new<span class="w"> </span>nprznkxy
Then<span class="w"> </span>use<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>resolve<span class="sb">`</span>,<span class="w"> </span>or<span class="w"> </span>edit<span class="w"> </span>the<span class="w"> </span>conflict<span class="w"> </span>markers<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>directly.
Once<span class="w"> </span>the<span class="w"> </span>conflicts<span class="w"> </span>are<span class="w"> </span>resolved,<span class="w"> </span>you<span class="w"> </span>may<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>inspect<span class="w"> </span>the<span class="w"> </span>result<span class="w"> </span>with<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>diff<span class="sb">`</span>.
Then<span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>squash<span class="sb">`</span><span class="w"> </span>to<span class="w"> </span>move<span class="w"> </span>the<span class="w"> </span>resolution<span class="w"> </span>into<span class="w"> </span>the<span class="w"> </span>conflicted<span class="w"> </span>commit.

$<span class="w"> </span>jj<span class="w"> </span>log
@<span class="w">  </span>zxoosnnp<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">19</span>:34:09<span class="w"> </span>63874fe6
│<span class="w">  </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
│<span class="w"> </span>×<span class="w">  </span>qzvqqupx<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:08:33<span class="w"> </span>1978b534<span class="w"> </span>conflict
├─╯<span class="w">  </span>C
×<span class="w">  </span>puqltutt<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:08:33<span class="w"> </span>f7fb5943<span class="w"> </span>conflict
│<span class="w">  </span>B2
│<span class="w"> </span>○<span class="w">  </span>ovknlmro<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:24<span class="w"> </span>7d7c6e6b
├─╯<span class="w">  </span>B1
○<span class="w">  </span>nuvyytnq<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">15</span>:07:05<span class="w"> </span>5dda2f09
│<span class="w">  </span>A
│<span class="w"> </span>○<span class="w">  </span>kntqzsqt<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">14</span>:56:59<span class="w"> </span>5d39e19d
├─╯<span class="w">  </span>Say<span class="w"> </span>goodbye
◆<span class="w">  </span>orrkosyo<span class="w"> </span>octocat@nowhere.com<span class="w"> </span><span class="m">2012</span>-03-06<span class="w"> </span><span class="m">15</span>:06:50<span class="w"> </span>master<span class="w"> </span>7fd1a60b
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
~
</code></pre></div>
<p>As you can perhaps see, that undid the <code>jj squash</code> invocation we used for
squashing the conflict resolution into commit B2 earlier. Notice that it also
updated the working copy.</p>
<p>You can also view the repo the way it looked after some earlier operation. For
example, if you want to see <code>jj log</code> output right after the <code>jj rebase</code>
operation, try <code>jj log --at-op=367400773f87</code> but use the hash from your own
<code>jj op log</code>.</p>
<h2 id="tutorial-moving-content-changes-between-commits">Moving content changes between commits<a class="headerlink" href="#tutorial-moving-content-changes-between-commits" title="Permanent link">&para;</a></h2>
<p>You have already seen how <code>jj squash</code> can combine the changes from two commits
into one. There are several other commands for changing the contents of existing
commits.</p>
<p>We'll need some more complex content to test these commands, so let's create a
few more commits:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>master<span class="w"> </span>-m<span class="w"> </span>abc<span class="p">;</span><span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;a\nb\nc\n&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>file
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>ztqrpvnw<span class="w"> </span>f94e49cf<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>abc
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>orrkosyo<span class="w"> </span>7fd1a60b<span class="w"> </span>master<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
Added<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>modified<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>removed<span class="w"> </span><span class="m">1</span><span class="w"> </span>files

$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>-m<span class="w"> </span>ABC<span class="p">;</span><span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;A\nB\nc\n&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>file
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>kwtuwqnm<span class="w"> </span>6f30cd1f<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>ABC
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>ztqrpvnw<span class="w"> </span><span class="m">51002261</span><span class="w"> </span>ab

$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>-m<span class="w"> </span>ABCD<span class="p">;</span><span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;A\nB\nC\nD\n&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>file
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>mrxqplyk<span class="w"> </span>a6749154<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>ABCD
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>kwtuwqnm<span class="w"> </span>30aecc08<span class="w"> </span>ABC

$<span class="w"> </span>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span>master::@
@<span class="w">  </span>mrxqplyk<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">19</span>:38:21<span class="w"> </span>b98c607b
│<span class="w">  </span>ABCD
○<span class="w">  </span>kwtuwqnm<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">19</span>:38:12<span class="w"> </span>30aecc08
│<span class="w">  </span>ABC
○<span class="w">  </span>ztqrpvnw<span class="w"> </span>martinvonz@google.com<span class="w"> </span><span class="m">2023</span>-02-12<span class="w"> </span><span class="m">19</span>:38:03<span class="w"> </span><span class="m">51002261</span>
│<span class="w">  </span>abc
◆<span class="w">  </span>orrkosyo<span class="w"> </span>octocat@nowhere.com<span class="w"> </span><span class="m">2012</span>-03-06<span class="w"> </span><span class="m">15</span>:06:50<span class="w"> </span>master<span class="w"> </span>7fd1a60b
│<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Merge<span class="w"> </span>pull<span class="w"> </span>request<span class="w"> </span><span class="c1">#6 from Spaceghost/patch-1</span>
~
</code></pre></div>
<p>We "forgot" to capitalize "c" in the second commit when we capitalized the other
letters. We then fixed that in the third commit when we also added "D". It would
be cleaner to move the capitalization of "c" into the second commit. We can do
that by running <code>jj squash</code> with the <code>--interactive</code>/<code>-i</code> option on the third
commit. Remember that <code>jj squash</code> moves all the changes from one commit into its
parent. <code>jj squash -i</code> moves only part of the changes into its parent. Now try
that:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>squash<span class="w"> </span>-i
Hint:<span class="w"> </span>Using<span class="w"> </span>default<span class="w"> </span>editor<span class="w"> </span><span class="s1">&#39;:builtin&#39;</span><span class="p">;</span><span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--user<span class="w"> </span>ui.diff-editor<span class="w"> </span>:builtin<span class="sb">`</span><span class="w"> </span>to<span class="w"> </span>disable<span class="w"> </span>this<span class="w"> </span>message.
Rebased<span class="w"> </span><span class="m">1</span><span class="w"> </span>descendant<span class="w"> </span>commits
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>mrxqplyk<span class="w"> </span>52a6c7fd<span class="w"> </span>ABCD
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>kwtuwqnm<span class="w"> </span>643061ac<span class="w"> </span>ABC
</code></pre></div>
<p>That will bring up the built-in diff editor<sup id="fnref:alternative_diff_editors"><a class="footnote-ref" href="#tutorial-fn:alternative_diff_editors">1</a></sup> with a
diff of the changes in the "ABCD" commit. Expand the file by clicking on <code>(+)</code>
or with right arrow, then select the sections/line to include by clicking or
using space. Once complete, press <code>c</code> to confirm changes, or <code>q</code> to exit without
saving. You can also use the mouse to click on the menu items to see more
options (keyboard navigation is currently limited).</p>
<p>If we look at the diff of the second commit, we now see that all three lines got
capitalized:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>diff<span class="w"> </span>-r<span class="w"> </span>@-<span class="w"> </span>--git
diff<span class="w"> </span>--git<span class="w"> </span>a/file<span class="w"> </span>b/file
index<span class="w"> </span>de980441c3..b1e67221af<span class="w"> </span><span class="m">100644</span>
---<span class="w"> </span>a/file
+++<span class="w"> </span>b/file
@@<span class="w"> </span>-1,3<span class="w"> </span>+1,3<span class="w"> </span>@@
-a
-b
-c
+A
+B
+C
</code></pre></div>
<p>The child change ("ABCD" in our case) will have the same content <em>state</em> after
the <code>jj squash</code> command. That means that you can move any changes you want into
the parent change, even if they touch the same word, and it won't cause any
conflicts.</p>
<p>Let's try one final command for changing the contents of an exiting commit. That
command is <code>jj diffedit</code>, which lets you edit the changes in a commit without
checking it out.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>diffedit<span class="w"> </span>-r<span class="w"> </span>@-
Hint:<span class="w"> </span>Using<span class="w"> </span>default<span class="w"> </span>editor<span class="w"> </span><span class="s1">&#39;:builtin&#39;</span><span class="p">;</span><span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--user<span class="w"> </span>ui.diff-editor<span class="w"> </span>:builtin<span class="sb">`</span><span class="w"> </span>to<span class="w"> </span>disable<span class="w"> </span>this<span class="w"> </span>message.
Rebased<span class="w"> </span><span class="m">1</span><span class="w"> </span>descendant<span class="w"> </span>commits
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>mrxqplyk<span class="w"> </span>1c72cd50<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>ABCD
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>kwtuwqnm<span class="w"> </span>70985eaa<span class="w"> </span>ABC
Added<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>modified<span class="w"> </span><span class="m">1</span><span class="w"> </span>files,<span class="w"> </span>removed<span class="w"> </span><span class="m">0</span><span class="w"> </span>files
Warning:<span class="w"> </span>There<span class="w"> </span>are<span class="w"> </span>unresolved<span class="w"> </span>conflicts<span class="w"> </span>at<span class="w"> </span>these<span class="w"> </span>paths:
file<span class="w">    </span><span class="m">2</span>-sided<span class="w"> </span>conflict
New<span class="w"> </span>conflicts<span class="w"> </span>appeared<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>commits:
<span class="w">  </span>mrxqplyk<span class="w"> </span>1c72cd50<span class="w"> </span><span class="o">(</span>conflict<span class="o">)</span><span class="w"> </span>ABCD
Hint:<span class="w"> </span>To<span class="w"> </span>resolve<span class="w"> </span>the<span class="w"> </span>conflicts,<span class="w"> </span>start<span class="w"> </span>by<span class="w"> </span>updating<span class="w"> </span>to<span class="w"> </span>it:
<span class="w">  </span>jj<span class="w"> </span>new<span class="w"> </span>mrxqplyk
Then<span class="w"> </span>use<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>resolve<span class="sb">`</span>,<span class="w"> </span>or<span class="w"> </span>edit<span class="w"> </span>the<span class="w"> </span>conflict<span class="w"> </span>markers<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>directly.
Once<span class="w"> </span>the<span class="w"> </span>conflicts<span class="w"> </span>are<span class="w"> </span>resolved,<span class="w"> </span>you<span class="w"> </span>may<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>inspect<span class="w"> </span>the<span class="w"> </span>result<span class="w"> </span>with<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>diff<span class="sb">`</span>.
Then<span class="w"> </span>run<span class="w"> </span><span class="sb">`</span>jj<span class="w"> </span>squash<span class="sb">`</span><span class="w"> </span>to<span class="w"> </span>move<span class="w"> </span>the<span class="w"> </span>resolution<span class="w"> </span>into<span class="w"> </span>the<span class="w"> </span>conflicted<span class="w"> </span>commit.
</code></pre></div>
<p>In the diff editor, use the arrow keys and spacebar to select all lines but the
last. Press 'c' to save the changes and close it. You can now inspect the
rewritten commit with <code>jj diff -r @-</code> again, and you should see your deletion of
the last line. Unlike <code>jj squash -i</code>, which left the content state of the commit
unchanged, <code>jj diffedit</code> (typically) results in a different state, which means
that descendant commits may have conflicts.</p>
<p>Another command for rewriting contents of existing commits is <code>jj split</code>. Now
that you've seen how <code>jj squash -i</code> and <code>jj diffedit</code> work, you can hopefully
figure out how it works (with the help of the instructions in the diff).</p>
<div class="footnote">
<hr />
<ol>
<li id="tutorial-fn:alternative_diff_editors">
<p>There are many other diff editors you could use.
For example, if you have <a href="https://meldmerge.org">Meld</a> installed and in the
PATH, you can use it via <code>jj squash -i --tool meld</code> or a fancier config with <code>jj
squash -i --tool meld-3</code>. You can configure the default with the
<a href="#config-editing-diffs"><code>ui.diff-editor</code> option</a>; those docs also explain how
to specify a path to an executable if it is not in the PATH.&#160;<a class="footnote-backref" href="#tutorial-fnref:alternative_diff_editors" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="github" heading-number="2.3"><h1 id="github-using-jujutsu-with-github-and-gitlab-projects">Using Jujutsu with GitHub and GitLab Projects<a class="headerlink" href="#github-using-jujutsu-with-github-and-gitlab-projects" title="Permanent link">&para;</a></h1>
<p>This guide assumes a basic understanding of either Git or Mercurial.</p>
<h2 id="github-set-up-an-ssh-key">Set up an SSH key<a class="headerlink" href="#github-set-up-an-ssh-key" title="Permanent link">&para;</a></h2>
<p>As of October 2023 it's recommended to set up an SSH key to work with GitHub
projects. See <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">GitHub's Tutorial</a>. This restriction may be lifted in the
future, see <a href="https://github.com/jj-vcs/jj/issues/469">issue #469</a> for more information and progress on
authenticated HTTP.</p>
<h2 id="github-basic-workflow">Basic workflow<a class="headerlink" href="#github-basic-workflow" title="Permanent link">&para;</a></h2>
<p>The simplest way to start with Jujutsu is to create a stack of commits first.
You will only need to create a bookmark when you need to push the stack to a
remote. There are two primary workflows: using a generated bookmark name or
naming a bookmark.</p>
<h3 id="github-using-a-generated-bookmark-name">Using a generated bookmark name<a class="headerlink" href="#github-using-a-generated-bookmark-name" title="Permanent link">&para;</a></h3>
<p>In this example we're letting Jujutsu auto-create a bookmark.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Start a new commit off of the default bookmark.</span>
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>main
<span class="c1"># Refactor some files, then add a description and start a new commit</span>
$<span class="w"> </span>jj<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;refactor(foo): restructure foo()&#39;</span>
<span class="c1"># Add a feature, then add a description and start a new commit</span>
$<span class="w"> </span>jj<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;feat(bar): add support for bar&#39;</span>
<span class="c1"># Let Jujutsu generate a bookmark name and push that to GitHub. Note that we</span>
<span class="c1"># push the working-copy commit&#39;s *parent* because the working-copy commit</span>
<span class="c1"># itself is empty.</span>
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>-c<span class="w"> </span>@-
</code></pre></div>
<h3 id="github-using-a-named-bookmark">Using a named bookmark<a class="headerlink" href="#github-using-a-named-bookmark" title="Permanent link">&para;</a></h3>
<p>In this example, we create a bookmark named <code>bar</code> and then push it to the remote.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Start a new commit off of the default bookmark.</span>
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>main
<span class="c1"># Refactor some files, then add a description and start a new commit</span>
$<span class="w"> </span>jj<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;refactor(foo): restructure foo()&#39;</span>
<span class="c1"># Add a feature, then add a description and start a new commit</span>
$<span class="w"> </span>jj<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;feat(bar): add support for bar&#39;</span>
<span class="c1"># Create a bookmark so we can push it to GitHub. Note that we created the bookmark</span>
<span class="c1"># on the working-copy commit&#39;s *parent* because the working copy itself is empty.</span>
$<span class="w"> </span>jj<span class="w"> </span>bookmark<span class="w"> </span>create<span class="w"> </span>bar<span class="w"> </span>-r<span class="w"> </span>@-<span class="w"> </span><span class="c1"># `bar` now contains the previous two commits.</span>
<span class="c1"># Push the bookmark to GitHub (pushes only `bar`)</span>
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--allow-new
</code></pre></div>
<p>While it's possible to create a bookmark in advance and commit on top of it in a
Git-like manner, you will then need to move the bookmark manually when you create
a new commits. Unlike Git, Jujutsu will not do it automatically.</p>
<h2 id="github-updating-the-repository">Updating the repository<a class="headerlink" href="#github-updating-the-repository" title="Permanent link">&para;</a></h2>
<p>As of October 2023, Jujutsu has no equivalent to a <code>git pull</code> command (see
<a href="https://github.com/jj-vcs/jj/issues/1039">issue #1039</a>). Until such a command is added, you need to use
<code>jj git fetch</code> followed by a <code>jj rebase -d $main_bookmark</code> to update your
changes.</p>
<h2 id="github-working-in-a-git-co-located-repository">Working in a Git co-located repository<a class="headerlink" href="#github-working-in-a-git-co-located-repository" title="Permanent link">&para;</a></h2>
<p>After doing <code>jj git init --colocate</code>, Git will be in a <a href="https://git-scm.com/docs/git-checkout#_detached_head">detached HEAD
state</a>, which is unusual, as Git mainly works with named branches; jj
does not.</p>
<p>In a co-located repository, every <code>jj</code> command will automatically synchronize
Jujutsu's view of the repo with Git's view. For example, <code>jj commit</code> updates the
HEAD of the Git repository, enabling an incremental migration.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>nvim<span class="w"> </span>docs/tutorial.md
$<span class="w"> </span><span class="c1"># Do some more work.</span>
$<span class="w"> </span>jj<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Update tutorial&quot;</span>
<span class="c1"># Create a bookmark on the working-copy commit&#39;s parent</span>
$<span class="w"> </span>jj<span class="w"> </span>bookmark<span class="w"> </span>create<span class="w"> </span>doc-update<span class="w"> </span>-r<span class="w"> </span>@-
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--allow-new
</code></pre></div>
<h2 id="github-working-in-a-jujutsu-repository">Working in a Jujutsu repository<a class="headerlink" href="#github-working-in-a-jujutsu-repository" title="Permanent link">&para;</a></h2>
<p>In a Jujutsu repository, the workflow is simplified. If there's no need for
explicitly named bookmarks, you can just generate one for a change. As Jujutsu is
able to create a bookmark for a revision.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="c1"># Do your work</span>
$<span class="w"> </span>jj<span class="w"> </span>commit
$<span class="w"> </span><span class="c1"># Push change &quot;mw&quot;, letting Jujutsu automatically create a bookmark called</span>
$<span class="w"> </span><span class="c1"># &quot;push-mwmpwkwknuz&quot;</span>
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--change<span class="w"> </span>mw
</code></pre></div>
<h2 id="github-addressing-review-comments">Addressing review comments<a class="headerlink" href="#github-addressing-review-comments" title="Permanent link">&para;</a></h2>
<p>There are two workflows for addressing review comments, depending on your
project's preference. Many projects prefer that you address comments by adding
commits to your bookmark<sup id="github-fnref:1"><a class="footnote-ref" href="#github-fn:1">1</a></sup>. Some projects (such as Jujutsu and LLVM) instead
prefer that you keep your commits clean by rewriting them and then
force-pushing<sup id="github-fnref:2"><a class="footnote-ref" href="#github-fn:2">2</a></sup>.</p>
<h3 id="github-adding-new-commits">Adding new commits<a class="headerlink" href="#github-adding-new-commits" title="Permanent link">&para;</a></h3>
<p>If your project prefers that you address review comments by adding commits on
top, you can do that by doing something like this:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="c1"># Create a new commit on top of the `your-feature` bookmark from above.</span>
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>your-feature
$<span class="w"> </span><span class="c1"># Address the comments by updating the code. Then review the changes.</span>
$<span class="w"> </span>jj<span class="w"> </span>diff
$<span class="w"> </span><span class="c1"># Give the fix a description and create a new working-copy on top.</span>
$<span class="w"> </span>jj<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;address pr comments&#39;</span>
$<span class="w"> </span><span class="c1"># Update the bookmark to point to the new commit.</span>
$<span class="w"> </span>jj<span class="w"> </span>bookmark<span class="w"> </span>move<span class="w"> </span>your-feature<span class="w"> </span>--to<span class="w"> </span>@-
$<span class="w"> </span><span class="c1"># Push it to your remote</span>
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>push
</code></pre></div>
<p>Notably, the above workflow creates a new commit for you. The same can be
achieved without creating a new commit.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We strongly suggest to <code>jj new</code> after the example below, as all further edits
still get amended to the previous commit.</p>
</div>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="c1"># Create a new commit on top of the `your-feature` bookmark from above.</span>
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>your-feature
$<span class="w"> </span><span class="c1"># Address the comments by updating the code. Then review the changes.</span>
$<span class="w"> </span>jj<span class="w"> </span>diff
$<span class="w"> </span><span class="c1"># Give the fix a description.</span>
$<span class="w"> </span>jj<span class="w"> </span>describe<span class="w"> </span>-m<span class="w"> </span><span class="s1">&#39;address pr comments&#39;</span>
$<span class="w"> </span><span class="c1"># Update the bookmark to point to the current commit.</span>
$<span class="w"> </span>jj<span class="w"> </span>bookmark<span class="w"> </span>move<span class="w"> </span>your-feature<span class="w"> </span>--to<span class="w"> </span>@
$<span class="w"> </span><span class="c1"># Push it to your remote</span>
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>push
</code></pre></div>
<h3 id="github-rewriting-commits">Rewriting commits<a class="headerlink" href="#github-rewriting-commits" title="Permanent link">&para;</a></h3>
<p>If your project prefers that you keep commits clean, you can do that by doing
something like this:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="c1"># Create a new commit on top of the second-to-last commit in `your-feature`,</span>
$<span class="w"> </span><span class="c1"># as reviewers requested a fix there.</span>
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>your-feature-<span class="w"> </span><span class="c1"># NOTE: the trailing hyphen is not a typo!</span>
$<span class="w"> </span><span class="c1"># Address the comments by updating the code. Then review the changes.</span>
$<span class="w"> </span>jj<span class="w"> </span>diff
$<span class="w"> </span><span class="c1"># Squash the changes into the parent commit</span>
$<span class="w"> </span>jj<span class="w"> </span>squash
$<span class="w"> </span><span class="c1"># Push the updated bookmark to the remote. Jujutsu automatically makes it a</span>
$<span class="w"> </span><span class="c1"># force push</span>
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--bookmark<span class="w"> </span>your-feature
</code></pre></div>
<p>The hyphen after <code>your-feature</code> comes from the
<a href="https://github.com/jj-vcs/jj/blob/main/docs/revsets.md">revset</a> syntax.</p>
<h2 id="github-working-with-other-peoples-bookmarks">Working with other people's bookmarks<a class="headerlink" href="#github-working-with-other-peoples-bookmarks" title="Permanent link">&para;</a></h2>
<p>By default, <code>jj git clone</code> imports the default remote bookmark (which is usually
<code>main</code> or <code>master</code>), but <code>jj git fetch</code> doesn't import new remote bookmarks to
local bookmarks. This means that if you want to iterate or test another
contributor's bookmark, you'll need to do <code>jj new &lt;bookmark&gt;@&lt;remote&gt;</code> onto it.</p>
<p>If you want to import all remote bookmarks including inactive ones, set
<code>git.auto-local-bookmark = true</code> in the config file. Then you can specify a
contributor's bookmark as <code>jj new &lt;bookmark&gt;</code> instead of <code>jj new &lt;bookmark&gt;@&lt;remote&gt;</code>.</p>
<p>You can find more information on that setting <a href="#config-automatic-local-bookmark-creation">here</a>.</p>
<h2 id="github-using-github-cli">Using GitHub CLI<a class="headerlink" href="#github-using-github-cli" title="Permanent link">&para;</a></h2>
<p>GitHub CLI will have trouble finding the proper Git repository path in jj repos
that aren't <a href="#git-compatibility-co-located-jujutsugit-repos">co-located</a>
(see <a href="https://github.com/jj-vcs/jj/issues/1008">issue #1008</a>). You can configure the <code>$GIT_DIR</code> environment variable to
point it to the right path:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nv">GIT_DIR</span><span class="o">=</span>.jj/repo/store/git<span class="w"> </span>gh<span class="w"> </span>issue<span class="w"> </span>list
</code></pre></div>
<p>You can make that automatic by installing <a href="https://direnv.net">direnv</a> and
defining hooks in a <code>.envrc</code> file in the repository root to configure <code>$GIT_DIR</code>.
Just add this line into <code>.envrc</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">GIT_DIR</span><span class="o">=</span><span class="nv">$PWD</span>/.jj/repo/store/git
</code></pre></div>
<p>and run <code>direnv allow</code> to approve it for direnv to run. Then GitHub CLI will
work automatically even in repos that aren't co-located so you can execute
commands like <code>gh issue list</code> normally.</p>
<h2 id="github-useful-revsets">Useful Revsets<a class="headerlink" href="#github-useful-revsets" title="Permanent link">&para;</a></h2>
<p>Log all revisions across all local bookmarks that aren't on the main bookmark nor
on any remote:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;bookmarks() &amp; ~(main | remote_bookmarks())&#39;</span>
</code></pre></div>
<p>Log all revisions that you authored, across all bookmarks that aren't on any
remote:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;mine() &amp; bookmarks() &amp; ~remote_bookmarks()&#39;</span>
</code></pre></div>
<p>Log all remote bookmarks that you authored or committed to:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;remote_bookmarks() &amp; (mine() | committer(your@email.com))&#39;</span>
</code></pre></div>
<p>Log all ancestors of the current working copy that aren't on any remote:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;remote_bookmarks()..@&#39;</span>
</code></pre></div>
<h2 id="github-merge-conflicts">Merge conflicts<a class="headerlink" href="#github-merge-conflicts" title="Permanent link">&para;</a></h2>
<p>For a detailed overview, how Jujutsu handles conflicts, revisit
the <a href="#tutorial-conflicts">tutorial</a>.</p>
<h2 id="github-using-several-remotes">Using several remotes<a class="headerlink" href="#github-using-several-remotes" title="Permanent link">&para;</a></h2>
<p>It is common to use several remotes when contributing to a shared repository.
For example, "upstream" can designate the remote where the changes will be
merged through a pull-request while "origin" is your private fork of the
project.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>--remote<span class="w"> </span>upstream<span class="w"> </span>https://github.com/upstream-org/repo
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>repo
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span>git@github.com:your-org/your-repo-fork
</code></pre></div>
<p>This will automatically setup your repository to track the main
bookmark from the upstream repository, typically <code>main@upstream</code>
or <code>master@upstream</code>.</p>
<p>You might want to <code>jj git fetch</code> from "upstream" and to <code>jj git push</code>
to "origin". You can configure the default remotes to fetch from and
push to in your configuration file (for example,
<code>.jj/repo/config.toml</code>):</p>
<div class="highlight"><pre><span></span><code><span class="k">[git]</span>
<span class="n">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;upstream&quot;</span>
<span class="n">push</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;origin&quot;</span>
</code></pre></div>
<p>The default for both <code>git.fetch</code> and <code>git.push</code> is "origin".</p>
<p>If you usually work on a project from several computers, you may
configure <code>jj</code> to fetch from both repositories by default, in order to
keep your own bookmarks synchronized through your <code>origin</code> repository:</p>
<div class="highlight"><pre><span></span><code><span class="k">[git]</span>
<span class="n">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;upstream&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;origin&quot;</span><span class="p">]</span>
<span class="n">push</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;origin&quot;</span>
</code></pre></div>
<div class="footnote">
<hr />
<ol>
<li id="github-fn:1">
<p>This is a GitHub-style review, as GitHub currently only is able to compare
bookmarks.&#160;<a class="footnote-backref" href="#github-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="github-fn:2">
<p>If you're wondering why we prefer clean commits in this project, see
e.g. <a href="https://jg.gg/2018/09/29/stacked-diffs-versus-pull-requests/">this blog post</a>&#160;<a class="footnote-backref" href="#github-fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="windows" heading-number="2.4"><h1 id="windows-working-on-windows">Working on Windows<a class="headerlink" href="#windows-working-on-windows" title="Permanent link">&para;</a></h1>
<p>Jujutsu works the same on all platforms, but there are some caveats that Windows
users should be aware of.</p>
<h2 id="windows-line-endings-are-not-converted">Line endings are not converted<a class="headerlink" href="#windows-line-endings-are-not-converted" title="Permanent link">&para;</a></h2>
<p>Jujutsu does not currently honor <code>.gitattributes</code> and does not have a setting
like Git's <a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration#_core_autocrlf"><code>core.autocrlf</code></a>. This means that line endings will be checked
out exactly as they are committed and committed exactly as authored. This is true on all
platforms, but Windows users are most likely to miss CRLF conversion.</p>
<p>Your Git repository may expect Windows users to have <code>core.autocrlf</code> set to
<code>true</code>, so that files are checked out with line endings converted from LF to CRLF
but committed with line endings converted from CRLF back to LF. Jujutsu doesn't
understand this and preserves CRLF line endings in files when committing.</p>
<p>After creating a colocated repository on Windows, you most likely want to set
<code>core.autocrlf</code> to <code>input</code>, then <code>jj abandon</code> to convert all files on disk to LF
line endings:</p>
<div class="highlight"><pre><span></span><code><span class="n">PS</span><span class="p">&gt;</span> <span class="n">git</span> <span class="n">config</span> <span class="n">core</span><span class="p">.</span><span class="n">autocrlf</span> <span class="n">input</span>

<span class="c"># Abandoning the working copy will cause Jujutsu to overwrite all files with</span>
<span class="c"># CRLF line endings with the line endings they are committed with, probably LF</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="n">jj</span> <span class="n">abandon</span>
</code></pre></div>
<p>This setting ensures Git will check out files with LF line endings without
converting them to CRLF. You'll want to make sure any tooling you use,
especially IDEs, preserve LF line endings.</p>
<h2 id="windows-pagination">Pagination<a class="headerlink" href="#windows-pagination" title="Permanent link">&para;</a></h2>
<p>On Windows, <code>jj</code> will use its integrated pager called <code>streampager</code> by default,
unless the environment variable <code>%PAGER%</code> or the config <code>ui.pager</code> is explicitly
set. See the <a href="#config-pager">pager section of the config docs</a> for more
details.</p>
<p>If the built-in pager doesn't meet your needs and you have Git installed, you
can switch to using Git's pager as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">PS</span><span class="p">&gt;</span> <span class="n">jj</span> <span class="n">config</span> <span class="nb">set </span><span class="p">-</span><span class="n">-user</span> <span class="n">ui</span><span class="p">.</span><span class="n">pager</span> <span class="s1">&#39;[&quot;C:\\Program Files\\Git\\usr\\bin\\less.exe&quot;, &quot;-FRX&quot;]&#39;</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="n">jj</span> <span class="n">config</span> <span class="nb">set </span><span class="p">-</span><span class="n">-user</span> <span class="n">ui</span><span class="p">.</span><span class="n">paginate</span> <span class="n">auto</span>
</code></pre></div>
<h2 id="windows-typing-in-powershell">Typing <code>@</code> in PowerShell<a class="headerlink" href="#windows-typing-in-powershell" title="Permanent link">&para;</a></h2>
<p>PowerShell uses <code>@</code> as part the <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_arrays?view=powershell-7.4#the-array-sub-expression-operator">array sub-expression operator</a>, so it
often needs to be escaped or quoted in commands:</p>
<div class="highlight"><pre><span></span><code><span class="n">PS</span><span class="p">&gt;</span> <span class="n">jj</span> <span class="n">log</span> <span class="n">-r</span> <span class="p">`@</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="n">jj</span> <span class="n">log</span> <span class="n">-r</span> <span class="s1">&#39;@&#39;</span>
</code></pre></div>
<p>One solution is to create a revset alias. For example, to make <code>HEAD</code> an alias
for <code>@</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">PS</span><span class="p">&gt;</span> <span class="n">jj</span> <span class="n">config</span> <span class="nb">set </span><span class="p">-</span><span class="n">-user</span> <span class="n">revset-aliases</span><span class="p">.</span><span class="n">HEAD</span> <span class="s1">&#39;@&#39;</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="n">jj</span> <span class="n">log</span> <span class="n">-r</span> <span class="n">HEAD</span>
</code></pre></div>
<h2 id="windows-wsl-sets-the-execute-bit-on-all-files">WSL sets the execute bit on all files<a class="headerlink" href="#windows-wsl-sets-the-execute-bit-on-all-files" title="Permanent link">&para;</a></h2>
<p>When viewing a Windows drive from WSL (via <em>/mnt/c</em> or a similar path), Windows
exposes all files with the execute bit set. Since Jujutsu automatically records
changes to the working copy, this sets the execute bit on all files committed in
your repository.</p>
<p>If you only need to access the repository in WSL, the best solution is to clone
the repository in the Linux file system (for example, in
<code>~/my-repo</code>).</p>
<p>If you need to use the repository in both WSL and Windows, one solution is to
create a workspace in the Linux file system:</p>
<div class="highlight"><pre><span></span><code><span class="n">PS</span><span class="p">&gt;</span> <span class="n">jj</span> <span class="n">workspace</span> <span class="n">add</span> <span class="p">-</span><span class="n">-name</span> <span class="n">wsl</span> <span class="p">~/</span><span class="n">my-repo</span>
</code></pre></div>
<p>Then only use the <code>~/my-repo</code> workspace from Linux.</p>
<h2 id="windows-symbolic-link-support">Symbolic link support<a class="headerlink" href="#windows-symbolic-link-support" title="Permanent link">&para;</a></h2>
<p><code>jj</code> supports symlinks on Windows only when they are enabled by the operating
system. This requires Windows 10 version 14972 or higher, as well as Developer
Mode. If those conditions are not satisfied, <code>jj</code> will materialize symlinks as
ordinary files.</p>
<p>For colocated repositories, Git support must also be enabled using the
<code>git config</code> option <code>core.symlinks=true</code>.</p></section></section><section class="print-page" id="faq" heading-number="3"><h1 id="faq-frequently-asked-questions">Frequently asked questions<a class="headerlink" href="#faq-frequently-asked-questions" title="Permanent link">&para;</a></h1>
<h3 id="faq-why-does-my-bookmark-not-move-to-the-new-commit-after-jj-newcommit">Why does my bookmark not move to the new commit after <code>jj new/commit</code>?<a class="headerlink" href="#faq-why-does-my-bookmark-not-move-to-the-new-commit-after-jj-newcommit" title="Permanent link">&para;</a></h3>
<p>If you're familiar with Git, you might expect the current bookmark to move forward
when you commit. However, Jujutsu does not have a concept of a "current bookmark".</p>
<p>To move bookmarks, use <code>jj bookmark move</code>.</p>
<h3 id="faq-i-made-a-commit-and-jj-git-push-all-says-nothing-changed-instead-of-pushing-it-what-do-i-do">I made a commit and <code>jj git push --all</code> says "Nothing changed" instead of pushing it. What do I do?<a class="headerlink" href="#faq-i-made-a-commit-and-jj-git-push-all-says-nothing-changed-instead-of-pushing-it-what-do-i-do" title="Permanent link">&para;</a></h3>
<p><code>jj git push --all</code> pushes all <em>bookmarks</em>, not all revisions. You have two
options:</p>
<ul>
<li>Using <code>jj git push --change</code> will automatically create a bookmark and push it.</li>
<li>Using <code>jj bookmark</code> commands to create or move a bookmark to either the commit
  you want to push or a descendant on it. Unlike Git, Jujutsu doesn't do this
  automatically (see previous question).</li>
</ul>
<h3 id="faq-where-is-my-commit-why-is-it-not-visible-in-jj-log">Where is my commit, why is it not visible in <code>jj log</code>?<a class="headerlink" href="#faq-where-is-my-commit-why-is-it-not-visible-in-jj-log" title="Permanent link">&para;</a></h3>
<p>Is your commit visible with <code>jj log -r 'all()'</code>?</p>
<p>If yes, you should be aware that <code>jj log</code> only shows a subset of the commits in
the repo by default. Most commits that exist on a remote are not shown. Local
commits and their immediate parents (for context) are shown. The thinking is
that you are more likely to interact with this set of commits. You can configure
the set of revisions to show by default by overriding <code>revsets.log</code> as described
in <a href="#config">config</a>.</p>
<p>If not, the revision may have been abandoned (e.g. because you
used <code>jj abandon</code>, or because it's an obsolete version that's been rewritten
with <code>jj rebase</code>, <code>jj describe</code>, etc). In that case, <code>jj log -r commit_id</code>
should show the revision as "hidden". <code>jj new commit_id</code> should make the
revision visible again.</p>
<p>See <a href="#revsets">revsets</a> and <a href="#templates">templates</a> for further guidance.</p>
<h3 id="faq-what-are-elided-revisions-in-the-output-of-jj-log-how-can-i-display-them">What are elided revisions in the output of <code>jj log</code>? How can I display them?<a class="headerlink" href="#faq-what-are-elided-revisions-in-the-output-of-jj-log-how-can-i-display-them" title="Permanent link">&para;</a></h3>
<p>"Elided revisions" appears in the log when one revision descends from another,
both are in the revset, but the revisions connecting them are <em>not</em> in the
revset.</p>
<p>For example, suppose you log the revset <code>tyl|mus</code> which contains exactly two
revisions:</p>
<div class="highlight"><pre><span></span><code>$<span class="w">  </span>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;tyl|mus&#39;</span>
○<span class="w">  </span>musnqzvt<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">1</span><span class="w"> </span>minute<span class="w"> </span>ago<span class="w"> </span>9a09f8a5
│<span class="w">  </span>Revision<span class="w"> </span>C
~<span class="w">  </span><span class="o">(</span>elided<span class="w"> </span>revisions<span class="o">)</span>
○<span class="w">  </span>tylynnzk<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">1</span><span class="w"> </span>minute<span class="w"> </span>ago<span class="w"> </span>f26967c8
│<span class="w">  </span>Revision<span class="w"> </span>A
</code></pre></div>
<p>Only the two revisions in the revset are displayed. The text "(elided
revisions)" is shown to indicate that <code>musnqzvt</code> descends from <code>tylynnzk</code>, but
the nodes connecting them are not in the revset.</p>
<p>To view the elided revisions, change the <a href="#revsets">revset expression</a> so it
includes the connecting revisions.  The <code>connected()</code> revset function does
exactly this:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;connected(tyl|mus)&#39;</span>
○<span class="w">  </span>musnqzvt<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">43</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w"> </span>9a09f8a5
│<span class="w">  </span>Revision<span class="w"> </span>C
○<span class="w">  </span>rsvnrznr<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">43</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w"> </span>5b490f30
│<span class="w">  </span>Revision<span class="w"> </span>B
○<span class="w">  </span>tylynnzk<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">43</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w"> </span>f26967c8
│<span class="w">  </span>Revision<span class="w"> </span>A
</code></pre></div>
<h3 id="faq-how-can-i-get-jj-log-to-show-me-what-git-log-would-show-me">How can I get <code>jj log</code> to show me what <code>git log</code> would show me?<a class="headerlink" href="#faq-how-can-i-get-jj-log-to-show-me-what-git-log-would-show-me" title="Permanent link">&para;</a></h3>
<p>Use <code>jj log -r ..</code>. The <code>..</code> <a href="#revsets-operators">operator</a> lists all visible commits in the repo, excluding the root (which is never interesting and is shared by all repos).</p>
<h3 id="faq-can-i-monitor-how-jj-log-evolves">Can I monitor how <code>jj log</code> evolves?<a class="headerlink" href="#faq-can-i-monitor-how-jj-log-evolves" title="Permanent link">&para;</a></h3>
<p>The simplest way to monitor how the history as shown by <code>jj log</code> evolves is by using the <a href="https://man7.org/linux/man-pages/man1/watch.1.html">watch(1)</a> command (or <a href="https://github.com/blacknon/hwatch?tab=readme-ov-file#configuration">hwatch</a> or <a href="https://github.com/sachaos/viddy">viddy</a>).
For example:</p>
<div class="highlight"><pre><span></span><code>watch<span class="w"> </span>--color<span class="w"> </span>jj<span class="w"> </span>--ignore-working-copy<span class="w"> </span>log<span class="w"> </span>--color<span class="o">=</span>always
</code></pre></div>
<p>This will continuously update the (colored) log output in the terminal.
The <code>--ignore-working-copy</code> option avoids conflicts with manual operations during the creation of snapshots.
Martin used watch in a <a href="https://github.com/tmux/tmux/wiki">tmux</a> pane during his presentation <a href="https://www.youtube.com/watch?v=LV0JzI8IcCY">Jujutsu - A Git-compatible VCS</a>.</p>
<p>Alternatively, you can use <a href="https://github.com/tim-janik/jj-fzf">jj-fzf</a>, where the central piece is the <code>jj log</code> view and common operations can be carried out via key bindings while the log view updates.</p>
<p>The wiki lists additional TUIs and GUIs beyond the terminal: <a href="https://github.com/jj-vcs/jj/wiki/GUI-and-TUI">GUI-and-TUI</a></p>
<h3 id="faq-should-i-co-locate-my-repository">Should I co-locate my repository?<a class="headerlink" href="#faq-should-i-co-locate-my-repository" title="Permanent link">&para;</a></h3>
<p>Co-locating a Jujutsu repository allows you to use both Jujutsu and Git in the
same working copy. The benefits of doing so are:</p>
<ul>
<li>
<p>You can use Git commands when you're not sure how to do something with
  Jujutsu, Jujutsu hasn't yet implemented a feature (e.g., bisection), or you
  simply prefer Git in some situations.</p>
</li>
<li>
<p>Tooling that expects a Git repository still works (IDEs, build tooling, etc.)</p>
</li>
</ul>
<p>The <a href="#git-compatibility-co-located-jujutsugit-repos">co-location documentation describes the
drawbacks</a> but the most
important ones are:</p>
<ul>
<li>
<p>Interleaving <code>git</code> and <code>jj</code> commands may create confusing bookmark conflicts
  or divergent changes.</p>
</li>
<li>
<p>If the working copy commit or its parent contain any conflicted files, tools
  expecting a Git repo may interpret the commit contents or its diff in a wrong
  and confusing way. You should avoid doing mutating operations with Git tools
  and ignore the confusing information such tools present for conflicted commits
  (unless you are curious about <a href="#technical-conflicts">the details of how <code>jj</code> stores
  conflicts</a>). See
  <a href="https://github.com/jj-vcs/jj/issues/3979">#3979</a> for plans to improve
  this situation.</p>
</li>
<li>
<p>Jujutsu commands may be a little slower in very large repositories due to
  importing and exporting changes to Git. Most repositories are not noticeably
  affected by this.</p>
</li>
</ul>
<p>If you primarily use Jujutsu to modify the repository, the drawbacks are
unlikely to affect you. Try co-locating while you learn Jujutsu, then switch if
you find a specific reason not to co-locate.</p>
<h3 id="faq-jj-is-said-to-record-the-working-copy-after-jj-log-and-every-other-command-where-can-i-see-these-automatic-saves"><code>jj</code> is said to record the working copy after <code>jj log</code> and every other command. Where can I see these automatic "saves"?<a class="headerlink" href="#faq-jj-is-said-to-record-the-working-copy-after-jj-log-and-every-other-command-where-can-i-see-these-automatic-saves" title="Permanent link">&para;</a></h3>
<p>Indeed, every <code>jj</code> command updates the current "working-copy" revision, marked
with <code>@</code> in <code>jj log</code>. You can notice this by how the <a href="#glossary-commit-id">commit ID</a> of the
working copy revision changes when it's updated. Note that, unless you move to
another revision (with <code>jj new</code> or <code>jj edit</code>, for example), the <a href="#glossary-change-id">change ID</a> will
not change.</p>
<p>If you expected to see a historical view of your working copy changes in the
parent-child relationships between commits you can see in <code>jj log</code>, this is
simply not what they mean. What you can see in <code>jj log</code> is that after the
working copy commit gets amended (after any edit), the commit ID changes.</p>
<p>You can see the actual history of working copy changes using <code>jj evolog</code>. This
will show the history of the commits that were previously the "working-copy
commit", since the last time the change id of the working copy commit changed.
The obsolete changes will be marked as "hidden". They are still accessible with
any <code>jj</code> command (<code>jj diff</code>, for example), but you will need to use the commit
id to refer to hidden commits.</p>
<p>You can also use <code>jj evolog -r</code> on revisions that were previously the
working-copy revisions (or on any other revisions). Use <code>jj evolog -p</code> as an
easy way to see the evolution of the commit's contents.</p>
<h3 id="faq-can-i-prevent-jujutsu-from-recording-my-unfinished-work-im-not-ready-to-commit-it">Can I prevent Jujutsu from recording my unfinished work? I'm not ready to commit it.<a class="headerlink" href="#faq-can-i-prevent-jujutsu-from-recording-my-unfinished-work-im-not-ready-to-commit-it" title="Permanent link">&para;</a></h3>
<p>Jujutsu automatically records new files in the current working-copy commit and
doesn't provide a way to prevent that.</p>
<p>However, you can easily record intermediate drafts of your work. If you think
you might want to go back to the current state of the working-copy commit,
simply use <code>jj new</code>. There's no need for the commit to be "finished" or even
have a description.</p>
<p>Then future edits will go into a new working-copy commit on top of the now
former working-copy commit. Whenever you are happy with another set of edits,
use <code>jj squash</code> to amend the previous commit.</p>
<p>If you have changes you <em>never</em> want to put in a public commit, see: <a href="#faq-how-can-i-keep-my-scratch-files-in-the-repository-without-committing-them">How can I
keep my scratch files in the repository without committing
them?</a></p>
<p>For more options see the next question.</p>
<h3 id="faq-can-i-interactively-create-a-new-commit-from-only-some-of-the-changes-in-the-working-copy-like-git-add-p-git-commit-or-hg-commit-i">Can I interactively create a new commit from only some of the changes in the working copy, like <code>git add -p &amp;&amp; git commit</code> or <code>hg commit -i</code>?<a class="headerlink" href="#faq-can-i-interactively-create-a-new-commit-from-only-some-of-the-changes-in-the-working-copy-like-git-add-p-git-commit-or-hg-commit-i" title="Permanent link">&para;</a></h3>
<p>Since the changes are already in the working-copy commit, the equivalent to
<code>git add -p &amp;&amp; git commit</code>/<code>git commit -p</code>/<code>hg commit -i</code> is to split the
working-copy commit with <code>jj split -i</code> (or the practically identical
<code>jj commit -i</code>).</p>
<p>For the equivalent of <code>git commit --amend -p</code>/<code>hg amend -i</code>, use <code>jj squash -i</code>.</p>
<h3 id="faq-is-there-something-like-git-rebase-interactive-or-hg-histedit">Is there something like <code>git rebase --interactive</code> or <code>hg histedit</code>?<a class="headerlink" href="#faq-is-there-something-like-git-rebase-interactive-or-hg-histedit" title="Permanent link">&para;</a></h3>
<p>It is often sufficient to use some form of <code>jj rebase</code> with <code>-A/-B</code>. For
example, if you have a linear chain of revisions <code>A</code> through <code>C</code> and want to
move <code>C</code> before <code>B</code>, use <code>jj rebase -r C -B B</code>. See <code>jj help rebase</code> for more
examples.</p>
<p>There is a <a href="https://github.com/jj-vcs/jj/issues/1531">tracking issue</a> you can check for updates.</p>
<p>To squash or split commits, use <code>jj squash</code> and <code>jj split</code>.</p>
<h3 id="faq-how-can-i-keep-my-scratch-files-in-the-repository-without-committing-them">How can I keep my scratch files in the repository without committing them?<a class="headerlink" href="#faq-how-can-i-keep-my-scratch-files-in-the-repository-without-committing-them" title="Permanent link">&para;</a></h3>
<p>You can set <code>snapshot.auto-track</code> to only start tracking new files matching the
configured pattern (e.g. <code>"none()"</code>). Changes to already tracked files will
still be snapshotted by every command.</p>
<p>You can keep your notes and other scratch files in the repository, if you add
a wildcard pattern to either the repo's <code>gitignore</code> or your global <code>gitignore</code>.
Something like <code>*.scratch</code> or <code>*.scratchpad</code> should do, after that rename the
files you want to keep around to match the pattern.</p>
<p>If you keep your scratch files in their own directory with no tracked files, you
can create a <code>.gitignore</code> file in that directory containing only <code>*</code>. This will
ignore everything in the directory including the <code>.gitignore</code> file itself.</p>
<p>If <code>$EDITOR</code> integration is important, something like <code>scratchpad.*</code> may be more
helpful, as you can keep the filename extension intact (it
matches <code>scratchpad.md</code>, <code>scratchpad.rs</code> and more). Another option is to add a
directory to the global <code>.gitignore</code> which then stores all your temporary files
and notes. For example, you could add <code>scratch/</code> to <code>~/.git/ignore</code> and then
store arbitrary files in <code>&lt;your-git-repo&gt;/scratch/</code>.</p>
<p>You can find more details on <code>gitignore</code> files <a href="https://git-scm.com/docs/gitignore">here</a>.</p>
<h3 id="faq-how-can-i-avoid-committing-my-local-only-changes-to-tracked-files">How can I avoid committing my local-only changes to tracked files?<a class="headerlink" href="#faq-how-can-i-avoid-committing-my-local-only-changes-to-tracked-files" title="Permanent link">&para;</a></h3>
<p>Suppose your repository tracks a file like <code>secret_config.json</code>, and you make
some changes to that file to work locally. Since Jujutsu automatically commits
the working copy, there's no way to prevent Jujutsu from committing changes to
the file. But, you never want to push those changes to the remote repository.</p>
<p>One solution is to keep these changes in a separate commit branched from the
trunk. To use those changes in your working copy, <em>merge</em> the private commit
into your branch.</p>
<p>Suppose you have a commit "Add new feature":</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>log
@<span class="w">  </span>xxxxxxxx<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">2024</span>-08-21<span class="w"> </span><span class="m">11</span>:13:21<span class="w"> </span>ef612875
│<span class="w">  </span>Add<span class="w"> </span>new<span class="w"> </span>feature
◉<span class="w">  </span>yyyyyyyy<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">2024</span>-08-21<span class="w"> </span><span class="m">11</span>:13:09<span class="w"> </span>main<span class="w"> </span>b624cf12
│<span class="w">  </span>Existing<span class="w"> </span>work
~
</code></pre></div>
<p>First, create a new commit branched from main and add your private changes:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>main<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;private: my credentials&quot;</span>
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>wwwwwwww<span class="w"> </span>861de9eb<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>private:<span class="w"> </span>my<span class="w"> </span>credentials
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>yyyyyyyy<span class="w"> </span>b624cf12<span class="w"> </span>main<span class="w"> </span><span class="p">|</span><span class="w"> </span>Existing<span class="w"> </span>work
Added<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>modified<span class="w"> </span><span class="m">1</span><span class="w"> </span>files,<span class="w"> </span>removed<span class="w"> </span><span class="m">0</span><span class="w"> </span>files

$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{ &quot;password&quot;: &quot;p@ssw0rd1&quot; }&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>secret_config.json
</code></pre></div>
<p>Now create a merge commit with the branch you're working on and the private
commit:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>xxxxxxxx<span class="w"> </span>wwwwwwww
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>vvvvvvvv<span class="w"> </span>ac4d9fbe<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>xxxxxxxx<span class="w"> </span>ef612875<span class="w"> </span>Add<span class="w"> </span>new<span class="w"> </span>feature
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>wwwwwwww<span class="w"> </span>2106921e<span class="w"> </span>private:<span class="w"> </span>my<span class="w"> </span>credentials
Added<span class="w"> </span><span class="m">0</span><span class="w"> </span>files,<span class="w"> </span>modified<span class="w"> </span><span class="m">1</span><span class="w"> </span>files,<span class="w"> </span>removed<span class="w"> </span><span class="m">0</span><span class="w"> </span>files

$<span class="w"> </span>jj<span class="w"> </span>log
@<span class="w">    </span>vvvvvvvv<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">2024</span>-08-22<span class="w"> </span><span class="m">08</span>:57:40<span class="w"> </span>ac4d9fbe
├─╮<span class="w">  </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span><span class="o">(</span>no<span class="w"> </span>description<span class="w"> </span><span class="nb">set</span><span class="o">)</span>
│<span class="w"> </span>◉<span class="w">  </span>wwwwwwww<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">2024</span>-08-22<span class="w"> </span><span class="m">08</span>:57:40<span class="w"> </span>2106921e
│<span class="w"> </span>│<span class="w">  </span>private:<span class="w"> </span>my<span class="w"> </span>credentials
◉<span class="w"> </span>│<span class="w">  </span>xxxxxxxx<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">2024</span>-08-21<span class="w"> </span><span class="m">11</span>:13:21<span class="w"> </span>ef612875
├─╯<span class="w">  </span>Add<span class="w"> </span>new<span class="w"> </span>feature
◉<span class="w">  </span>yyyyyyyy<span class="w"> </span>me@example.com<span class="w"> </span><span class="m">2024</span>-08-21<span class="w"> </span><span class="m">11</span>:13:09<span class="w"> </span>main<span class="w"> </span>b624cf12
│<span class="w">  </span>Existing<span class="w"> </span>work
~
</code></pre></div>
<p>Now you're ready to work:</p>
<ul>
<li>Your work in progress <em>xxxxxxxx</em> is the first parent of the merge commit.</li>
<li>The private commit <em>wwwwwwww</em> is the second parent of the merge commit.</li>
<li>The working copy (<em>vvvvvvvv</em>) contains changes from both.</li>
</ul>
<p>As you work, squash your changes using <code>jj squash --into xxxxxxxx</code>.</p>
<p>If you need a new empty commit on top of <code>xxxxxxxx</code> you can use the
<code>--insert-after</code> and <code>--insert-before</code> options (<code>-A</code> and <code>-B</code> for short):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Insert a new commit after xxxxxxxx</span>
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>--no-edit<span class="w"> </span>-A<span class="w"> </span>xxxxxxxx<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Another feature&quot;</span>
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>uuuuuuuu<span class="w"> </span>1c3cff09<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Another<span class="w"> </span>feature
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>xxxxxxxx<span class="w"> </span>ef612875<span class="w"> </span>Add<span class="w"> </span>new<span class="w"> </span>feature

<span class="c1"># Insert a new commit between yyyyyyyy and vvvvvvvv</span>
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>--no-edit<span class="w"> </span>-A<span class="w"> </span>yyyyyyyy<span class="w"> </span>-B<span class="w"> </span>vvvvvvvv<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Yet another feature&quot;</span>
Working<span class="w"> </span>copy<span class="w">  </span><span class="o">(</span>@<span class="o">)</span><span class="w"> </span>now<span class="w"> </span>at:<span class="w"> </span>tttttttt<span class="w"> </span>938ab831<span class="w"> </span><span class="o">(</span>empty<span class="o">)</span><span class="w"> </span>Yet<span class="w"> </span>another<span class="w"> </span>feature
Parent<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>@-<span class="o">)</span><span class="w">      </span>:<span class="w"> </span>yyyyyyyy<span class="w"> </span>b624cf12<span class="w"> </span>Existing<span class="w"> </span>work
</code></pre></div>
<p>To avoid pushing change <em>wwwwwwww</em> by mistake, use the configuration
<a href="#config-set-of-private-commits">git.private-commits</a>:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--user<span class="w"> </span>git.private-commits<span class="w"> </span><span class="s2">&quot;&#39;&#39;&#39;description(glob:&#39;private:*&#39;)&#39;&#39;&#39;&quot;</span>
</code></pre></div>
<h3 id="faq-i-accidentally-changed-files-in-the-wrong-commit-how-do-i-move-the-recent-changes-into-another-commit">I accidentally changed files in the wrong commit, how do I move the recent changes into another commit?<a class="headerlink" href="#faq-i-accidentally-changed-files-in-the-wrong-commit-how-do-i-move-the-recent-changes-into-another-commit" title="Permanent link">&para;</a></h3>
<p>Let's say we are editing a commit for "featureA", and we forgot to run <code>jj
new</code> or <code>jj commit</code> before doing some work that belongs in a new commit:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>jj<span class="w"> </span>log
<span class="go">@  lnvvtrzo jjfan@example.org 2025-02-28 21:01:10 31a347e0</span>
<span class="go">│  featureA</span>
<span class="go">◆  zzzzzzzz root() 00000000</span>
<span class="gp">$ </span>cat<span class="w"> </span>file<span class="w">  </span><span class="c1"># Oh no, the work on &quot;feature B&quot; should be in a separate commit!</span>
<span class="go">Done with feature A</span>
<span class="go">Working on feature B</span>
</code></pre></div>
<h4 id="faq-step-1-find-the-commit-id-for-the-last-good-version">Step 1: Find the commit id for the "last good version"<a class="headerlink" href="#faq-step-1-find-the-commit-id-for-the-last-good-version" title="Permanent link">&para;</a></h4>
<!-- TODO: Reorganize the two related questions, this one and
  -- the one linked below
  -->
<p>You can find <a href="#faq-jj-is-said-to-record-the-working-copy-after-jj-log-and-every-other-command-where-can-i-see-these-automatic-saves">all the past versions of the working copy revision that <code>jj</code> has
saved</a>
by running <code>jj evolog</code>. The obsolete versions will be marked as "hidden" and
will have the same change id, but will have different commit ids. This
represents different <a href="#glossary-commit">commits</a> that are all parts of the same <a href="#glossary-change">change</a>.</p>
<p>For example, this is what the evolog might look like after you made two edits to
the same change:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span><span class="c1"># Note the word &quot;hidden&quot;, the commit ids on the right,</span>
<span class="gp">$ </span><span class="c1"># and the unchanging change id on the left.</span>
<span class="gp">$ </span>jj<span class="w"> </span>evolog
<span class="go">@  lnvvtrzo jjfan@example.org 2025-02-28 21:01:10 31a347e0</span>
<span class="go">│  featureA</span>
<span class="go">○  lnvvtrzo hidden jjfan@example.org 2025-02-28 21:00:51 b8004ab8</span>
<span class="go">│  featureA</span>
<span class="go">○  lnvvtrzo hidden jjfan@example.org 2025-02-28 20:50:05 e4d831d</span>
<span class="go">   (no description set)</span>
</code></pre></div>
<p>Since commit <code>b800</code> is hidden, it is considered obsolete and <code>jj log</code> (without
arguments) will not show it, nor can it be accessed by its change id. However,
most <code>jj</code> operations work normally on such commits if you refer to them by their
commit id.</p>
<p>To find out which of these versions is the last time before we started working
on feature B (the point where we should have created a new change, but failed
to do so), we can look at the actual changes between the <code>evolog</code> commits by
running <code>jj evolog -p</code>:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span><span class="c1"># When was the last saved point before we started working on feature B?</span>
<span class="gp">$ </span>jj<span class="w"> </span>evolog<span class="w"> </span>-p<span class="w"> </span>--git<span class="w">  </span><span class="c1"># We use `--git` to make diffs clear without colors</span>
<span class="go">@  lnvvtrzo jjfan@example.org 2025-02-28 21:01:10 31a347e0</span>
<span class="go">│  featureA</span>
<span class="go">│  diff --git a/file b/file</span>
<span class="go">│  index 2b455c4207..2a7e05a01a 100644</span>
<span class="go">│  --- a/file</span>
<span class="go">│  +++ b/file</span>
<span class="go">│  @@ -1,1 +1,2 @@</span>
<span class="go">│   Done with feature A</span>
<span class="go">│  +Working on feature B</span>
<span class="go">○  lnvvtrzo hidden jjfan@example.org 2025-02-28 21:00:51 b8004ab8</span>
<span class="go">│  featureA</span>
<span class="go">│  diff --git a/file b/file</span>
<span class="go">│  index cb61245109..2b455c4207</span>
<span class="go">│  --- a/file</span>
<span class="go">│  +++ b/file</span>
<span class="go">│  @@ -1,1 +1,1 @@</span>
<span class="go">│  -Working on feature A</span>
<span class="go">│  +Done with feature A</span>
<span class="go">○  lnvvtrzo hidden jjfan@example.org 2025-02-28 20:50:05 e4d831d</span>
<span class="go">   (no description set)</span>
<span class="go">   diff --git a/file b/file</span>
<span class="go">   index 0000000000..cb61245109</span>
<span class="go">   --- /dev/null</span>
<span class="go">   +++ b/file</span>
<span class="go">   @@ 0,0 +1,1 @@</span>
<span class="go">   +Working on feature A</span>
</code></pre></div>
<p>In this example, the version of the change when we were actually done with
feature A is when we edited the file to say "Done with feature A". This state
was saved in the commit with id <code>b80</code> (the second one in the list). The
following edit (commit <code>31a</code>) belongs in a new change.</p>
<h4 id="faq-step-2-create-a-new-change-for-the-current-state-and-restore-the-existing-change-to-the-older-state">Step 2: Create a new change for the current state and restore the existing change to the older state<a class="headerlink" href="#faq-step-2-create-a-new-change-for-the-current-state-and-restore-the-existing-change-to-the-older-state" title="Permanent link">&para;</a></h4>
<p>The "featureA" change is currently at commit <code>31a</code>:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>jj<span class="w"> </span>log
<span class="go">@  lnvvtrzo jjfan@example.org 2025-02-28 21:01:10 31a347e0</span>
<span class="go">│  featureA</span>
<span class="go">◆  zzzzzzzz root() 00000000</span>
</code></pre></div>
<p>We'd like to create a new "featureB" change with the contents of the current
commit <code>31a</code>, and we'd like the "featureA" change to be reverted to its former
state at commit <code>b80</code> (see step 1 above for how we found that commit id).</p>
<p>First, we create a new empty child commit. Since it is empty, it has the same
contents as <code>31a</code>.</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>jj<span class="w"> </span>new<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;featureB&quot;</span>
<span class="go">Working copy  (@) now at: pvnrkl 47171aa (empty) featureB</span>
<span class="go">Parent commit (@-)      : lnvvtr 31a347e featureA</span>
<span class="gp">$ </span>cat<span class="w"> </span>file
<span class="go">Done with feature A</span>
<span class="go">Working on feature B</span>
</code></pre></div>
<p>Now, we <code>jj restore</code> the change <code>lnvvtr</code> to its state at commit <code>b80</code>. We use
the <code>--restore-descendants</code> flag so that the <em>file contents</em> (AKA snapshot) of
the "featureB" change is preserved.</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span><span class="c1"># We refer to `lnvvtr` as `@-` for brevity</span>
<span class="gp">$ </span>jj<span class="w"> </span>restore<span class="w"> </span>--from<span class="w"> </span>b80<span class="w"> </span>--into<span class="w"> </span>@-<span class="w"> </span>--restore-descendants
<span class="go">Created lnvvtr 599994e featureA</span>
<span class="go">Rebased 1 descendant commits (while preserving their content)</span>
<span class="go">Working copy  (@) now at: pvnrkl 468104c featureB</span>
<span class="go">Parent commit (@-)      : lnvvtr 599994e featureA</span>
</code></pre></div>
<p>Even though <code>@-</code> was modified, <code>--restore-descendants</code> preserved the contents of
the current change:</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>jj<span class="w"> </span>file<span class="w"> </span>show<span class="w"> </span>-r<span class="w"> </span>@<span class="w"> </span>file<span class="w">  </span><span class="c1"># Same as `cat file`</span>
<span class="go">Done with feature A</span>
<span class="go">Working on feature B</span>
<span class="gp">$ </span>jj<span class="w"> </span>file<span class="w"> </span>show<span class="w"> </span>-r<span class="w"> </span>@-<span class="w"> </span>file
<span class="go">Done with feature A</span>
</code></pre></div>
<details class="info">
<summary>More details on what <code>--restore-descendants</code> does</summary>
<p>When we ran the <code>jj restore</code> command, the working copy change <code>@</code> was
at commit <code>471</code> and <code>@</code> was the only child of <code>@-</code>. In this situation,</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>restore<span class="w"> </span>--from<span class="w"> </span>b80<span class="w"> </span>--into<span class="w"> </span>@-<span class="w"> </span>--restore-descendants
</code></pre></div>
<p>is equivalent to</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>restore<span class="w"> </span>--from<span class="w"> </span>b80<span class="w"> </span>--into<span class="w"> </span>@-
jj<span class="w"> </span>restore<span class="w"> </span>--from<span class="w"> </span><span class="m">471</span><span class="w"> </span>--into<span class="w"> </span>@
</code></pre></div>
</details>
<p>Now, we have achieved the exact state we desired:</p>
<div class="highlight"><pre><span></span><code>$ jj log -p --git
@  pvnrklkn jjfan@example.org 2025-02-28 21:39:29 468104c2
│  featureB
│  diff --git a/file b/file
│  index 2b455c4207..2a7e05a01a 100644
│  --- a/file
│  +++ b/file
│  @@ -1,1 +1,2 @@
│   Done with feature A
│  +Working on feature B
○  lnvvtrzo jjfan@example.org 2025-02-28 21:39:29 599994ee
│  featureA
│  diff --git a/file b/file
│  new file mode 100644
│  index 0000000000..2b455c4207
│  --- /dev/null
│  +++ b/file
│  @@ -0,0 +1,1 @@
│  +Done with feature A
◆  zzzzzzzz root() 00000000
$ jj diff --from b80 --to @- # No output means these are identical
$ jj diff --from 31a --to @  # No output means these are identical
</code></pre></div>
<h3 id="faq-how-do-i-resume-working-on-an-existing-change">How do I resume working on an existing change?<a class="headerlink" href="#faq-how-do-i-resume-working-on-an-existing-change" title="Permanent link">&para;</a></h3>
<p>There are two ways to resume working on an earlier change: <code>jj new</code> then <code>jj squash</code>,
and <code>jj edit</code>. The first is generally recommended, but <code>jj edit</code> can be useful. When
you use <code>jj edit</code>, the revision is directly amended with your new changes, making it
difficult to tell what exactly you change. You should avoid using <code>jj edit</code> when the
revision has a conflict, as you may accidentally break the plain-text annotations on
your state without realising.</p>
<p>To start, use <code>jj new &lt;rev&gt;</code> to create a change based on that earlier revision. Make
your edits, then use <code>jj squash</code> to update the earlier revision with those edits.
For when you would use git stashing, use <code>jj edit &lt;rev&gt;</code> for expected behaviour.
Other workflows may prefer <code>jj edit</code> as well.</p>
<h3 id="faq-why-are-most-merge-commits-marked-as-empty">Why are most merge commits marked as "(empty)"?<a class="headerlink" href="#faq-why-are-most-merge-commits-marked-as-empty" title="Permanent link">&para;</a></h3>
<p>Jujutsu, like Git, is a snapshot-based VCS. That means that each commit
logically records the state of all current files in the repo. The changes in a
commit are not recorded but are instead calculated when needed by comparing the
commit's state to the parent commit's state. Jujutsu defines the changes in a
commit to be relative to the auto-merged parents (if there's only one parent,
then that merge is trivial - it's the parent commit's state). As a result, a
merge commit that was a clean merge (no conflict resolution, no additional
changes) is considered empty. Conversely, if the merge commit contains conflict
resolutions or additional changes, then it will be considered non-empty.</p>
<p>This definition of the changes in a commit is used throughout Jujutsu. It's
used by <code>jj diff -r</code> and <code>jj log -p</code> to show the changes in a commit. It's used
by <code>jj rebase</code> to rebase the changes in a commit. It's used in <code>jj log</code> to
indicate which commits are empty. It's used in the <code>files()</code> revset function
(and by <code>jj log &lt;path&gt;</code>) to find commits that modify a certain path. And so on.</p>
<h3 id="faq-how-do-i-deal-with-divergent-changes-after-the-change-id">How do I deal with divergent changes ('??' after the <a href="#glossary-change-id">change ID</a>)?<a class="headerlink" href="#faq-how-do-i-deal-with-divergent-changes-after-the-change-id" title="Permanent link">&para;</a></h3>
<p>A <a href="#glossary-divergent-change">divergent change</a> represents a change that has two
or more visible commits associated with it. To refer to such commits, you must
use their <a href="#glossary-commit-id">commit ID</a>. Most commonly, the way to resolve
this is to abandon the unneeded commits (using <code>jj abandon &lt;commit ID&gt;</code>). If you
would like to keep both commits with this change ID, you can <code>jj duplicate</code> one
of them before abandoning it.</p>
<h3 id="faq-how-do-i-deal-with-conflicted-bookmarks-after-bookmark-name">How do I deal with conflicted bookmarks ('??' after bookmark name)?<a class="headerlink" href="#faq-how-do-i-deal-with-conflicted-bookmarks-after-bookmark-name" title="Permanent link">&para;</a></h3>
<p>A <a href="#bookmarks-conflicts">conflicted bookmark</a> is a bookmark that refers to multiple
different commits because jj couldn't fully resolve its desired position.
Resolving conflicted bookmarks is usually done by setting the bookmark to the
correct commit using <code>jj bookmark move &lt;name&gt; --to &lt;commit ID&gt;</code>.</p>
<p>Usually, the different commits associated with the conflicted bookmark should all
appear in the log, but if they don't you can use <code>jj bookmark list</code>to show all the
commits associated with it.</p>
<h3 id="faq-how-do-i-integrate-jujutsu-with-gerrit">How do I integrate Jujutsu with Gerrit?<a class="headerlink" href="#faq-how-do-i-integrate-jujutsu-with-gerrit" title="Permanent link">&para;</a></h3>
<p>Add this to your configuration to automatically add Change-Id trailers to commit messages:
<div class="highlight"><pre><span></span><code><span class="k">[templates]</span>
<span class="n">commit_trailers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">if(</span>
<span class="s1">  !trailers.contains_key(&quot;Change-Id&quot;),</span>
<span class="s1">  format_gerrit_change_id_trailer(self)</span>
<span class="s1">)</span>
<span class="s1">&#39;&#39;&#39;</span>
</code></pre></div>
Note: If you don't check for the presence of the "Change-Id" trailer, you might
occasionally get duplicate trailers.
This happens when Jujutsu's change-id isn't in sync with the "Change-Id" trailer.
Eg. after <code>jj split</code>, the "Change-Id" trailer generated for the new change would
be different from the original one, it wouldn't be deduplicated.</p>
<p>You'll have to manually invoke <code>git push</code> of <code>HEAD</code> on the underlying git repository
into the remote Gerrit bookmark <code>refs/for/$BRANCH</code>, where <code>$BRANCH</code> is the base
bookmark you want your changes to go to (e.g., <code>git push origin
HEAD:refs/for/main</code>). Using a <a href="#glossary-co-located-repos">co-located</a> repo
will make the underlying git repo directly accessible from the working
directory.</p>
<p>We hope to integrate with Gerrit natively in the future.</p>
<h3 id="faq-i-want-to-write-a-tool-which-integrates-with-jujutsu-should-i-use-the-library-or-parse-the-cli">I want to write a tool which integrates with Jujutsu. Should I use the library or parse the CLI?<a class="headerlink" href="#faq-i-want-to-write-a-tool-which-integrates-with-jujutsu-should-i-use-the-library-or-parse-the-cli" title="Permanent link">&para;</a></h3>
<p>There are some trade-offs and there is no definitive answer yet.</p>
<ul>
<li>Using <code>jj-lib</code> avoids parsing command output and makes error handling easier.</li>
<li><code>jj-lib</code> is not a stable API, so you may have to make changes to your tool
when the API changes.</li>
<li>The CLI is not stable either, so you may need to make your tool detect the
different versions and call the right command.</li>
<li>Using the CLI means that your tool will work with custom-built <code>jj</code> binaries,
like the one at Google (if you're using the library, you will not be able to
detect custom backends and more).</li>
</ul></section><section class="print-page" id="cli-reference" heading-number="4"><!-- The contents of the CLI reference is auto-generated by a Rust test.
 --- If `cargo insta` is installed, you can regenerate the CLI reference with:
 ---      cargo insta test --accept --workspace -- test_generate
 -->

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This CLI reference is experimental. It is automatically generated, but
does not match the <code>jj help</code> output exactly.</p>
<p>Run <code>jj help &lt;COMMAND&gt;</code> for more authoritative documentation.</p>
<p>If you see a significant difference, feel free to file a bug, or a PR to note the difference here.</p>
</div>
<!-- BEGIN INCLUDE ../cli/tests/cli-reference@.md.snap '&lt;!-- BEGIN MARKDOWN--&gt;' '' -->

<h1 id="cli-reference-command-line-help-for-jj">Command-Line Help for <code>jj</code><a class="headerlink" href="#cli-reference-command-line-help-for-jj" title="Permanent link">&para;</a></h1>
<p>This document contains the help content for the <code>jj</code> command-line program.</p>
<p><strong>Command Overview:</strong></p>
<ul>
<li><a href="#cli-reference-jj"><code>jj</code>↴</a></li>
<li><a href="#cli-reference-jj-abandon"><code>jj abandon</code>↴</a></li>
<li><a href="#cli-reference-jj-absorb"><code>jj absorb</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark"><code>jj bookmark</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark-create"><code>jj bookmark create</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark-delete"><code>jj bookmark delete</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark-forget"><code>jj bookmark forget</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark-list"><code>jj bookmark list</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark-move"><code>jj bookmark move</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark-rename"><code>jj bookmark rename</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark-set"><code>jj bookmark set</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark-track"><code>jj bookmark track</code>↴</a></li>
<li><a href="#cli-reference-jj-bookmark-untrack"><code>jj bookmark untrack</code>↴</a></li>
<li><a href="#cli-reference-jj-commit"><code>jj commit</code>↴</a></li>
<li><a href="#cli-reference-jj-config"><code>jj config</code>↴</a></li>
<li><a href="#cli-reference-jj-config-edit"><code>jj config edit</code>↴</a></li>
<li><a href="#cli-reference-jj-config-get"><code>jj config get</code>↴</a></li>
<li><a href="#cli-reference-jj-config-list"><code>jj config list</code>↴</a></li>
<li><a href="#cli-reference-jj-config-path"><code>jj config path</code>↴</a></li>
<li><a href="#cli-reference-jj-config-set"><code>jj config set</code>↴</a></li>
<li><a href="#cli-reference-jj-config-unset"><code>jj config unset</code>↴</a></li>
<li><a href="#cli-reference-jj-describe"><code>jj describe</code>↴</a></li>
<li><a href="#cli-reference-jj-diff"><code>jj diff</code>↴</a></li>
<li><a href="#cli-reference-jj-diffedit"><code>jj diffedit</code>↴</a></li>
<li><a href="#cli-reference-jj-duplicate"><code>jj duplicate</code>↴</a></li>
<li><a href="#cli-reference-jj-edit"><code>jj edit</code>↴</a></li>
<li><a href="#cli-reference-jj-evolog"><code>jj evolog</code>↴</a></li>
<li><a href="#cli-reference-jj-file"><code>jj file</code>↴</a></li>
<li><a href="#cli-reference-jj-file-annotate"><code>jj file annotate</code>↴</a></li>
<li><a href="#cli-reference-jj-file-chmod"><code>jj file chmod</code>↴</a></li>
<li><a href="#cli-reference-jj-file-list"><code>jj file list</code>↴</a></li>
<li><a href="#cli-reference-jj-file-show"><code>jj file show</code>↴</a></li>
<li><a href="#cli-reference-jj-file-track"><code>jj file track</code>↴</a></li>
<li><a href="#cli-reference-jj-file-untrack"><code>jj file untrack</code>↴</a></li>
<li><a href="#cli-reference-jj-fix"><code>jj fix</code>↴</a></li>
<li><a href="#cli-reference-jj-git"><code>jj git</code>↴</a></li>
<li><a href="#cli-reference-jj-git-clone"><code>jj git clone</code>↴</a></li>
<li><a href="#cli-reference-jj-git-export"><code>jj git export</code>↴</a></li>
<li><a href="#cli-reference-jj-git-fetch"><code>jj git fetch</code>↴</a></li>
<li><a href="#cli-reference-jj-git-import"><code>jj git import</code>↴</a></li>
<li><a href="#cli-reference-jj-git-init"><code>jj git init</code>↴</a></li>
<li><a href="#cli-reference-jj-git-push"><code>jj git push</code>↴</a></li>
<li><a href="#cli-reference-jj-git-remote"><code>jj git remote</code>↴</a></li>
<li><a href="#cli-reference-jj-git-remote-add"><code>jj git remote add</code>↴</a></li>
<li><a href="#cli-reference-jj-git-remote-list"><code>jj git remote list</code>↴</a></li>
<li><a href="#cli-reference-jj-git-remote-remove"><code>jj git remote remove</code>↴</a></li>
<li><a href="#cli-reference-jj-git-remote-rename"><code>jj git remote rename</code>↴</a></li>
<li><a href="#cli-reference-jj-git-remote-set-url"><code>jj git remote set-url</code>↴</a></li>
<li><a href="#cli-reference-jj-git-root"><code>jj git root</code>↴</a></li>
<li><a href="#cli-reference-jj-help"><code>jj help</code>↴</a></li>
<li><a href="#cli-reference-jj-interdiff"><code>jj interdiff</code>↴</a></li>
<li><a href="#cli-reference-jj-log"><code>jj log</code>↴</a></li>
<li><a href="#cli-reference-jj-new"><code>jj new</code>↴</a></li>
<li><a href="#cli-reference-jj-next"><code>jj next</code>↴</a></li>
<li><a href="#cli-reference-jj-operation"><code>jj operation</code>↴</a></li>
<li><a href="#cli-reference-jj-operation-abandon"><code>jj operation abandon</code>↴</a></li>
<li><a href="#cli-reference-jj-operation-diff"><code>jj operation diff</code>↴</a></li>
<li><a href="#cli-reference-jj-operation-log"><code>jj operation log</code>↴</a></li>
<li><a href="#cli-reference-jj-operation-restore"><code>jj operation restore</code>↴</a></li>
<li><a href="#cli-reference-jj-operation-show"><code>jj operation show</code>↴</a></li>
<li><a href="#cli-reference-jj-operation-undo"><code>jj operation undo</code>↴</a></li>
<li><a href="#cli-reference-jj-parallelize"><code>jj parallelize</code>↴</a></li>
<li><a href="#cli-reference-jj-prev"><code>jj prev</code>↴</a></li>
<li><a href="#cli-reference-jj-rebase"><code>jj rebase</code>↴</a></li>
<li><a href="#cli-reference-jj-resolve"><code>jj resolve</code>↴</a></li>
<li><a href="#cli-reference-jj-restore"><code>jj restore</code>↴</a></li>
<li><a href="#cli-reference-jj-revert"><code>jj revert</code>↴</a></li>
<li><a href="#cli-reference-jj-root"><code>jj root</code>↴</a></li>
<li><a href="#cli-reference-jj-show"><code>jj show</code>↴</a></li>
<li><a href="#cli-reference-jj-sign"><code>jj sign</code>↴</a></li>
<li><a href="#cli-reference-jj-simplify-parents"><code>jj simplify-parents</code>↴</a></li>
<li><a href="#cli-reference-jj-sparse"><code>jj sparse</code>↴</a></li>
<li><a href="#cli-reference-jj-sparse-edit"><code>jj sparse edit</code>↴</a></li>
<li><a href="#cli-reference-jj-sparse-list"><code>jj sparse list</code>↴</a></li>
<li><a href="#cli-reference-jj-sparse-reset"><code>jj sparse reset</code>↴</a></li>
<li><a href="#cli-reference-jj-sparse-set"><code>jj sparse set</code>↴</a></li>
<li><a href="#cli-reference-jj-split"><code>jj split</code>↴</a></li>
<li><a href="#cli-reference-jj-squash"><code>jj squash</code>↴</a></li>
<li><a href="#cli-reference-jj-status"><code>jj status</code>↴</a></li>
<li><a href="#cli-reference-jj-tag"><code>jj tag</code>↴</a></li>
<li><a href="#cli-reference-jj-tag-list"><code>jj tag list</code>↴</a></li>
<li><a href="#cli-reference-jj-undo"><code>jj undo</code>↴</a></li>
<li><a href="#cli-reference-jj-unsign"><code>jj unsign</code>↴</a></li>
<li><a href="#cli-reference-jj-util"><code>jj util</code>↴</a></li>
<li><a href="#cli-reference-jj-util-completion"><code>jj util completion</code>↴</a></li>
<li><a href="#cli-reference-jj-util-config-schema"><code>jj util config-schema</code>↴</a></li>
<li><a href="#cli-reference-jj-util-exec"><code>jj util exec</code>↴</a></li>
<li><a href="#cli-reference-jj-util-gc"><code>jj util gc</code>↴</a></li>
<li><a href="#cli-reference-jj-util-install-man-pages"><code>jj util install-man-pages</code>↴</a></li>
<li><a href="#cli-reference-jj-util-markdown-help"><code>jj util markdown-help</code>↴</a></li>
<li><a href="#cli-reference-jj-version"><code>jj version</code>↴</a></li>
<li><a href="#cli-reference-jj-workspace"><code>jj workspace</code>↴</a></li>
<li><a href="#cli-reference-jj-workspace-add"><code>jj workspace add</code>↴</a></li>
<li><a href="#cli-reference-jj-workspace-forget"><code>jj workspace forget</code>↴</a></li>
<li><a href="#cli-reference-jj-workspace-list"><code>jj workspace list</code>↴</a></li>
<li><a href="#cli-reference-jj-workspace-rename"><code>jj workspace rename</code>↴</a></li>
<li><a href="#cli-reference-jj-workspace-root"><code>jj workspace root</code>↴</a></li>
<li><a href="#cli-reference-jj-workspace-update-stale"><code>jj workspace update-stale</code>↴</a></li>
</ul>
<h2 id="cli-reference-jj"><code>jj</code><a class="headerlink" href="#cli-reference-jj" title="Permanent link">&para;</a></h2>
<p>Jujutsu (An experimental VCS)</p>
<p>To get started, see the tutorial [<code>jj help -k tutorial</code>].</p>
<p><strong>Usage:</strong> <code>jj [OPTIONS] [COMMAND]</code></p>
<p>'jj help --help' lists available keywords. Use 'jj help -k' to show help for one of these keywords.</p>
<h6 id="cli-reference-subcommands"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands" title="Permanent link">&para;</a></h6>
<ul>
<li><code>abandon</code> — Abandon a revision</li>
<li><code>absorb</code> — Move changes from a revision into the stack of mutable revisions</li>
<li><code>bookmark</code> — Manage bookmarks [default alias: b]</li>
<li><code>commit</code> — Update the description and create a new change on top</li>
<li><code>config</code> — Manage config options</li>
<li><code>describe</code> — Update the change description or other metadata</li>
<li><code>diff</code> — Compare file contents between two revisions</li>
<li><code>diffedit</code> — Touch up the content changes in a revision with a diff editor</li>
<li><code>duplicate</code> — Create new changes with the same content as existing ones</li>
<li><code>edit</code> — Sets the specified revision as the working-copy revision</li>
<li><code>evolog</code> — Show how a change has evolved over time</li>
<li><code>file</code> — File operations</li>
<li><code>fix</code> — Update files with formatting fixes or other changes</li>
<li><code>git</code> — Commands for working with Git remotes and the underlying Git repo</li>
<li><code>help</code> — Print this message or the help of the given subcommand(s)</li>
<li><code>interdiff</code> — Compare the changes of two commits</li>
<li><code>log</code> — Show revision history</li>
<li><code>new</code> — Create a new, empty change and (by default) edit it in the working copy</li>
<li><code>next</code> — Move the working-copy commit to the child revision</li>
<li><code>operation</code> — Commands for working with the operation log</li>
<li><code>parallelize</code> — Parallelize revisions by making them siblings</li>
<li><code>prev</code> — Change the working copy revision relative to the parent revision</li>
<li><code>rebase</code> — Move revisions to different parent(s)</li>
<li><code>resolve</code> — Resolve conflicted files with an external merge tool</li>
<li><code>restore</code> — Restore paths from another revision</li>
<li><code>revert</code> — Apply the reverse of the given revision(s)</li>
<li><code>root</code> — Show the current workspace root directory (shortcut for <code>jj workspace root</code>)</li>
<li><code>show</code> — Show commit description and changes in a revision</li>
<li><code>sign</code> — Cryptographically sign a revision</li>
<li><code>simplify-parents</code> — Simplify parent edges for the specified revision(s)</li>
<li><code>sparse</code> — Manage which paths from the working-copy commit are present in the working copy</li>
<li><code>split</code> — Split a revision in two</li>
<li><code>squash</code> — Move changes from a revision into another revision</li>
<li><code>status</code> — Show high-level repo status</li>
<li><code>tag</code> — Manage tags</li>
<li><code>undo</code> — Undo an operation (shortcut for <code>jj op undo</code>)</li>
<li><code>unsign</code> — Drop a cryptographic signature</li>
<li><code>util</code> — Infrequently used commands such as for generating shell completions</li>
<li><code>version</code> — Display version information</li>
<li><code>workspace</code> — Commands for working with workspaces</li>
</ul>
<h6 id="cli-reference-options"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-R</code>, <code>--repository &lt;REPOSITORY&gt;</code> — Path to repository to operate on</p>
<p>By default, Jujutsu searches for the closest .jj/ directory in an ancestor of the current working directory.</p>
</li>
<li>
<p><code>--ignore-working-copy</code> — Don't snapshot the working copy, and don't update it</p>
<p>By default, Jujutsu snapshots the working copy at the beginning of every command. The working copy is also updated at the end of the command, if the command modified the working-copy commit (<code>@</code>). If you want to avoid snapshotting the working copy and instead see a possibly stale working-copy commit, you can use <code>--ignore-working-copy</code>. This may be useful e.g. in a command prompt, especially if you have another process that commits the working copy.</p>
<p>Loading the repository at a specific operation with <code>--at-operation</code> implies <code>--ignore-working-copy</code>.</p>
</li>
<li>
<p><code>--ignore-immutable</code> — Allow rewriting immutable commits</p>
<p>By default, Jujutsu prevents rewriting commits in the configured set of immutable commits. This option disables that check and lets you rewrite any commit but the root commit.</p>
<p>This option only affects the check. It does not affect the <code>immutable_heads()</code> revset or the <code>immutable</code> template keyword.</p>
</li>
<li>
<p><code>--at-operation &lt;AT_OPERATION&gt;</code> [alias: <code>at-op</code>] — Operation to load the repo at</p>
<p>Operation to load the repo at. By default, Jujutsu loads the repo at the most recent operation, or at the merge of the divergent operations if any.</p>
<p>You can use <code>--at-op=&lt;operation ID&gt;</code> to see what the repo looked like at an earlier operation. For example <code>jj --at-op=&lt;operation ID&gt; st</code> will show you what <code>jj st</code> would have shown you when the given operation had just finished. <code>--at-op=@</code> is pretty much the same as the default except that divergent operations will never be merged.</p>
<p>Use <code>jj op log</code> to find the operation ID you want. Any unambiguous prefix of the operation ID is enough.</p>
<p>When loading the repo at an earlier operation, the working copy will be ignored, as if <code>--ignore-working-copy</code> had been specified.</p>
<p>It is possible to run mutating commands when loading the repo at an earlier operation. Doing that is equivalent to having run concurrent commands starting at the earlier operation. There's rarely a reason to do that, but it is possible.</p>
</li>
<li>
<p><code>--debug</code> — Enable debug logging</p>
</li>
<li>
<p><code>--color &lt;WHEN&gt;</code> — When to colorize output</p>
<p>Possible values: <code>always</code>, <code>never</code>, <code>debug</code>, <code>auto</code></p>
</li>
<li>
<p><code>--quiet</code> — Silence non-primary command output</p>
<p>For example, <code>jj file list</code> will still list files, but it won't tell you if the working copy was snapshotted or if descendants were rebased.</p>
<p>Warnings and errors will still be printed.</p>
</li>
<li>
<p><code>--no-pager</code> — Disable the pager</p>
</li>
<li>
<p><code>--config &lt;NAME=VALUE&gt;</code> — Additional configuration options (can be repeated)</p>
<p>The name should be specified as TOML dotted keys. The value should be specified as a TOML expression. If string value isn't enclosed by any TOML constructs (such as array notation), quotes can be omitted.</p>
</li>
<li>
<p><code>--config-file &lt;PATH&gt;</code> — Additional configuration files (can be repeated)</p>
</li>
</ul>
<h2 id="cli-reference-jj-abandon"><code>jj abandon</code><a class="headerlink" href="#cli-reference-jj-abandon" title="Permanent link">&para;</a></h2>
<p>Abandon a revision</p>
<p>Abandon a revision, rebasing descendants onto its parent(s). The behavior is similar to <code>jj restore --changes-in</code>; the difference is that <code>jj abandon</code> gives you a new change, while <code>jj restore</code> updates the existing change.</p>
<p>If a working-copy commit gets abandoned, it will be given a new, empty commit. This is true in general; it is not specific to this command.</p>
<p><strong>Usage:</strong> <code>jj abandon [OPTIONS] [REVSETS]...</code></p>
<h6 id="cli-reference-arguments"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;REVSETS&gt;</code> — The revision(s) to abandon (default: @)</li>
</ul>
<h6 id="cli-reference-options_1"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_1" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--retain-bookmarks</code> — Do not delete bookmarks pointing to the revisions to abandon</p>
<p>Bookmarks will be moved to the parent revisions instead.</p>
</li>
<li>
<p><code>--restore-descendants</code> — Do not modify the content of the children of the abandoned commits</p>
</li>
</ul>
<h2 id="cli-reference-jj-absorb"><code>jj absorb</code><a class="headerlink" href="#cli-reference-jj-absorb" title="Permanent link">&para;</a></h2>
<p>Move changes from a revision into the stack of mutable revisions</p>
<p>This command splits changes in the source revision and moves each change to the closest mutable ancestor where the corresponding lines were modified last. If the destination revision cannot be determined unambiguously, the change will be left in the source revision.</p>
<p>The source revision will be abandoned if all changes are absorbed into the destination revisions, and if the source revision has no description.</p>
<p>The modification made by <code>jj absorb</code> can be reviewed by <code>jj op show -p</code>.</p>
<p><strong>Usage:</strong> <code>jj absorb [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_1"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_1" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Move only changes to these paths (instead of all paths)</li>
</ul>
<h6 id="cli-reference-options_2"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_2" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-f</code>, <code>--from &lt;REVSET&gt;</code> — Source revision to absorb from</p>
<p>Default value: <code>@</code></p>
</li>
<li>
<p><code>-t</code>, <code>--into &lt;REVSETS&gt;</code> [alias: <code>to</code>] — Destination revisions to absorb into</p>
<p>Only ancestors of the source revision will be considered.</p>
<p>Default value: <code>mutable()</code></p>
</li>
</ul>
<h2 id="cli-reference-jj-bookmark"><code>jj bookmark</code><a class="headerlink" href="#cli-reference-jj-bookmark" title="Permanent link">&para;</a></h2>
<p>Manage bookmarks [default alias: b]</p>
<p>See [<code>jj help -k bookmarks</code>] for more information.</p>
<p><strong>Usage:</strong> <code>jj bookmark &lt;COMMAND&gt;</code></p>
<h6 id="cli-reference-subcommands_1"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_1" title="Permanent link">&para;</a></h6>
<ul>
<li><code>create</code> — Create a new bookmark</li>
<li><code>delete</code> — Delete an existing bookmark and propagate the deletion to remotes on the next push</li>
<li><code>forget</code> — Forget a bookmark without marking it as a deletion to be pushed</li>
<li><code>list</code> — List bookmarks and their targets</li>
<li><code>move</code> — Move existing bookmarks to target revision</li>
<li><code>rename</code> — Rename <code>old</code> bookmark name to <code>new</code> bookmark name</li>
<li><code>set</code> — Create or update a bookmark to point to a certain commit</li>
<li><code>track</code> — Start tracking given remote bookmarks</li>
<li><code>untrack</code> — Stop tracking given remote bookmarks</li>
</ul>
<h2 id="cli-reference-jj-bookmark-create"><code>jj bookmark create</code><a class="headerlink" href="#cli-reference-jj-bookmark-create" title="Permanent link">&para;</a></h2>
<p>Create a new bookmark</p>
<p><strong>Usage:</strong> <code>jj bookmark create [OPTIONS] &lt;NAMES&gt;...</code></p>
<p><strong>Command Alias:</strong> <code>c</code></p>
<h6 id="cli-reference-arguments_2"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_2" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;NAMES&gt;</code> — The bookmarks to create</li>
</ul>
<h6 id="cli-reference-options_3"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_3" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-r</code>, <code>--revision &lt;REVSET&gt;</code> [alias: <code>to</code>] — The bookmark's target revision</li>
</ul>
<h2 id="cli-reference-jj-bookmark-delete"><code>jj bookmark delete</code><a class="headerlink" href="#cli-reference-jj-bookmark-delete" title="Permanent link">&para;</a></h2>
<p>Delete an existing bookmark and propagate the deletion to remotes on the next push</p>
<p>Revisions referred to by the deleted bookmarks are not abandoned. To delete revisions as well as bookmarks, use <code>jj abandon</code>. For example, <code>jj abandon main..&lt;bookmark&gt;</code> will abandon revisions belonging to the <code>&lt;bookmark&gt;</code> branch (relative to the <code>main</code> branch.)</p>
<p>If you don't want the deletion of the local bookmark to propagate to any tracked remote bookmarks, use <code>jj bookmark forget</code> instead.</p>
<p><strong>Usage:</strong> <code>jj bookmark delete &lt;NAMES&gt;...</code></p>
<p><strong>Command Alias:</strong> <code>d</code></p>
<h6 id="cli-reference-arguments_3"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_3" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;NAMES&gt;</code> — The bookmarks to delete</p>
<p>By default, the specified name matches exactly. Use <code>glob:</code> prefix to select bookmarks by <a href="https://jj-vcs.github.io/jj/latest/revsets/#string-patterns">wildcard pattern</a>.</p>
</li>
</ul>
<h2 id="cli-reference-jj-bookmark-forget"><code>jj bookmark forget</code><a class="headerlink" href="#cli-reference-jj-bookmark-forget" title="Permanent link">&para;</a></h2>
<p>Forget a bookmark without marking it as a deletion to be pushed</p>
<p>If a local bookmark is forgotten, any corresponding remote bookmarks will become untracked to ensure that the forgotten bookmark will not impact remotes on future pushes.</p>
<p><strong>Usage:</strong> <code>jj bookmark forget [OPTIONS] &lt;NAMES&gt;...</code></p>
<p><strong>Command Alias:</strong> <code>f</code></p>
<h6 id="cli-reference-arguments_4"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_4" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;NAMES&gt;</code> — The bookmarks to forget</p>
<p>By default, the specified name matches exactly. Use <code>glob:</code> prefix to select bookmarks by <a href="https://jj-vcs.github.io/jj/latest/revsets/#string-patterns">wildcard pattern</a>.</p>
</li>
</ul>
<h6 id="cli-reference-options_4"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_4" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--include-remotes</code> — When forgetting a local bookmark, also forget any corresponding remote bookmarks</p>
<p>A forgotten remote bookmark will not impact remotes on future pushes. It will be recreated on future fetches if it still exists on the remote. If there is a corresponding Git-tracking remote bookmark, it will also be forgotten.</p>
</li>
</ul>
<h2 id="cli-reference-jj-bookmark-list"><code>jj bookmark list</code><a class="headerlink" href="#cli-reference-jj-bookmark-list" title="Permanent link">&para;</a></h2>
<p>List bookmarks and their targets</p>
<p>By default, a tracking remote bookmark will be included only if its target is different from the local target. A non-tracking remote bookmark won't be listed. For a conflicted bookmark (both local and remote), old target revisions are preceded by a "-" and new target revisions are preceded by a "+".</p>
<p>See [<code>jj help -k bookmarks</code>] for more information.</p>
<p><strong>Usage:</strong> <code>jj bookmark list [OPTIONS] [NAMES]...</code></p>
<p><strong>Command Alias:</strong> <code>l</code></p>
<h6 id="cli-reference-arguments_5"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_5" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;NAMES&gt;</code> — Show bookmarks whose local name matches</p>
<p>By default, the specified name matches exactly. Use <code>glob:</code> prefix to select bookmarks by <a href="https://jj-vcs.github.io/jj/latest/revsets/#string-patterns">wildcard pattern</a>.</p>
</li>
</ul>
<h6 id="cli-reference-options_5"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_5" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-a</code>, <code>--all-remotes</code> — Show all tracking and non-tracking remote bookmarks including the ones whose targets are synchronized with the local bookmarks</li>
<li>
<p><code>--remote &lt;REMOTE&gt;</code> — Show all tracking and non-tracking remote bookmarks belonging to this remote</p>
<p>Can be combined with <code>--tracked</code> or <code>--conflicted</code> to filter the bookmarks shown (can be repeated.)</p>
<p>By default, the specified remote name matches exactly. Use <code>glob:</code> prefix to select remotes by <a href="https://jj-vcs.github.io/jj/latest/revsets/#string-patterns">wildcard pattern</a>.</p>
</li>
<li>
<p><code>-t</code>, <code>--tracked</code> — Show remote tracked bookmarks only. Omits local Git-tracking bookmarks by default</p>
</li>
<li><code>-c</code>, <code>--conflicted</code> — Show conflicted bookmarks only</li>
<li>
<p><code>-r</code>, <code>--revisions &lt;REVSETS&gt;</code> — Show bookmarks whose local targets are in the given revisions</p>
<p>Note that <code>-r deleted_bookmark</code> will not work since <code>deleted_bookmark</code> wouldn't have a local target.</p>
</li>
<li>
<p><code>-T</code>, <code>--template &lt;TEMPLATE&gt;</code> — Render each bookmark using the given template</p>
<p>All 0-argument methods of the [<code>CommitRef</code> type] are available as keywords in the template expression. See [<code>jj help -k templates</code>] for more information.</p>
</li>
<li>
<p><code>--sort &lt;SORT_KEY&gt;</code> — Sort bookmarks based on the given key (or multiple keys)</p>
<p>Suffix the key with <code>-</code> to sort in descending order of the value (e.g. <code>--sort name-</code>). Note that when using multiple keys, the first key is the most significant.</p>
<p>This defaults to the <code>ui.bookmark-list-sort-keys</code> setting.</p>
<p>Possible values: <code>name</code>, <code>name-</code>, <code>author-name</code>, <code>author-name-</code>, <code>author-email</code>, <code>author-email-</code>, <code>author-date</code>, <code>author-date-</code>, <code>committer-name</code>, <code>committer-name-</code>, <code>committer-email</code>, <code>committer-email-</code>, <code>committer-date</code>, <code>committer-date-</code></p>
</li>
</ul>
<h2 id="cli-reference-jj-bookmark-move"><code>jj bookmark move</code><a class="headerlink" href="#cli-reference-jj-bookmark-move" title="Permanent link">&para;</a></h2>
<p>Move existing bookmarks to target revision</p>
<p>If bookmark names are given, the specified bookmarks will be updated to point to the target revision.</p>
<p>If <code>--from</code> options are given, bookmarks currently pointing to the specified revisions will be updated. The bookmarks can also be filtered by names.</p>
<p>Example: pull up the nearest bookmarks to the working-copy parent</p>
<p>$ jj bookmark move --from 'heads(::@- &amp; bookmarks())' --to @-</p>
<p><strong>Usage:</strong> <code>jj bookmark move [OPTIONS] &lt;NAMES|--from &lt;REVSETS&gt;&gt;</code></p>
<p><strong>Command Alias:</strong> <code>m</code></p>
<h6 id="cli-reference-arguments_6"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_6" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;NAMES&gt;</code> — Move bookmarks matching the given name patterns</p>
<p>By default, the specified name matches exactly. Use <code>glob:</code> prefix to select bookmarks by <a href="https://jj-vcs.github.io/jj/latest/revsets/#string-patterns">wildcard pattern</a>.</p>
</li>
</ul>
<h6 id="cli-reference-options_6"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_6" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-f</code>, <code>--from &lt;REVSETS&gt;</code> — Move bookmarks from the given revisions</li>
<li><code>-t</code>, <code>--to &lt;REVSET&gt;</code> — Move bookmarks to this revision</li>
<li><code>-B</code>, <code>--allow-backwards</code> — Allow moving bookmarks backwards or sideways</li>
</ul>
<h2 id="cli-reference-jj-bookmark-rename"><code>jj bookmark rename</code><a class="headerlink" href="#cli-reference-jj-bookmark-rename" title="Permanent link">&para;</a></h2>
<p>Rename <code>old</code> bookmark name to <code>new</code> bookmark name</p>
<p>The new bookmark name points at the same commit as the old bookmark name.</p>
<p><strong>Usage:</strong> <code>jj bookmark rename &lt;OLD&gt; &lt;NEW&gt;</code></p>
<p><strong>Command Alias:</strong> <code>r</code></p>
<h6 id="cli-reference-arguments_7"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_7" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;OLD&gt;</code> — The old name of the bookmark</li>
<li><code>&lt;NEW&gt;</code> — The new name of the bookmark</li>
</ul>
<h2 id="cli-reference-jj-bookmark-set"><code>jj bookmark set</code><a class="headerlink" href="#cli-reference-jj-bookmark-set" title="Permanent link">&para;</a></h2>
<p>Create or update a bookmark to point to a certain commit</p>
<p><strong>Usage:</strong> <code>jj bookmark set [OPTIONS] &lt;NAMES&gt;...</code></p>
<p><strong>Command Alias:</strong> <code>s</code></p>
<h6 id="cli-reference-arguments_8"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_8" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;NAMES&gt;</code> — The bookmarks to update</li>
</ul>
<h6 id="cli-reference-options_7"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_7" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-r</code>, <code>--revision &lt;REVSET&gt;</code> [alias: <code>to</code>] — The bookmark's target revision</li>
<li><code>-B</code>, <code>--allow-backwards</code> — Allow moving the bookmark backwards or sideways</li>
</ul>
<h2 id="cli-reference-jj-bookmark-track"><code>jj bookmark track</code><a class="headerlink" href="#cli-reference-jj-bookmark-track" title="Permanent link">&para;</a></h2>
<p>Start tracking given remote bookmarks</p>
<p>A tracking remote bookmark will be imported as a local bookmark of the same name. Changes to it will propagate to the existing local bookmark on future pulls.</p>
<p><strong>Usage:</strong> <code>jj bookmark track &lt;BOOKMARK@REMOTE&gt;...</code></p>
<p><strong>Command Alias:</strong> <code>t</code></p>
<h6 id="cli-reference-arguments_9"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_9" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;BOOKMARK@REMOTE&gt;</code> — Remote bookmarks to track</p>
<p>By default, the specified name matches exactly. Use <code>glob:</code> prefix to select bookmarks by <a href="https://jj-vcs.github.io/jj/latest/revsets/#string-patterns">wildcard pattern</a>.</p>
<p>Examples: bookmark@remote, glob:main@<em>, glob:jjfan-</em>@upstream</p>
</li>
</ul>
<h2 id="cli-reference-jj-bookmark-untrack"><code>jj bookmark untrack</code><a class="headerlink" href="#cli-reference-jj-bookmark-untrack" title="Permanent link">&para;</a></h2>
<p>Stop tracking given remote bookmarks</p>
<p>A non-tracking remote bookmark is just a pointer to the last-fetched remote bookmark. It won't be imported as a local bookmark on future pulls.</p>
<p>If you want to forget a local bookmark while also untracking the corresponding remote bookmarks, use <code>jj bookmark forget</code> instead.</p>
<p><strong>Usage:</strong> <code>jj bookmark untrack &lt;BOOKMARK@REMOTE&gt;...</code></p>
<h6 id="cli-reference-arguments_10"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_10" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;BOOKMARK@REMOTE&gt;</code> — Remote bookmarks to untrack</p>
<p>By default, the specified name matches exactly. Use <code>glob:</code> prefix to select bookmarks by <a href="https://jj-vcs.github.io/jj/latest/revsets/#string-patterns">wildcard pattern</a>.</p>
<p>Examples: bookmark@remote, glob:main@<em>, glob:jjfan-</em>@upstream</p>
</li>
</ul>
<h2 id="cli-reference-jj-commit"><code>jj commit</code><a class="headerlink" href="#cli-reference-jj-commit" title="Permanent link">&para;</a></h2>
<p>Update the description and create a new change on top</p>
<p><strong>Usage:</strong> <code>jj commit [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_11"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_11" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Put these paths in the first commit</li>
</ul>
<h6 id="cli-reference-options_8"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_8" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-i</code>, <code>--interactive</code> — Interactively choose which changes to include in the first commit</li>
<li><code>--tool &lt;NAME&gt;</code> — Specify diff editor to be used (implies --interactive)</li>
<li><code>-m</code>, <code>--message &lt;MESSAGE&gt;</code> — The change description to use (don't open editor)</li>
<li>
<p><code>--reset-author</code> — Reset the author to the configured user</p>
<p>This resets the author name, email, and timestamp.</p>
<p>You can use it in combination with the JJ_USER and JJ_EMAIL environment variables to set a different author:</p>
<p>$ JJ_USER='Foo Bar' JJ_EMAIL=foo@bar.com jj commit --reset-author</p>
</li>
<li>
<p><code>--author &lt;AUTHOR&gt;</code> — Set author to the provided string</p>
<p>This changes author name and email while retaining author timestamp for non-discardable commits.</p>
</li>
</ul>
<h2 id="cli-reference-jj-config"><code>jj config</code><a class="headerlink" href="#cli-reference-jj-config" title="Permanent link">&para;</a></h2>
<p>Manage config options</p>
<p>Operates on jj configuration, which comes from the config file and environment variables.</p>
<p>See [<code>jj help -k config</code>] to know more about file locations, supported config options, and other details about <code>jj config</code>.</p>
<p><strong>Usage:</strong> <code>jj config &lt;COMMAND&gt;</code></p>
<h6 id="cli-reference-subcommands_2"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_2" title="Permanent link">&para;</a></h6>
<ul>
<li><code>edit</code> — Start an editor on a jj config file</li>
<li><code>get</code> — Get the value of a given config option.</li>
<li><code>list</code> — List variables set in config files, along with their values</li>
<li><code>path</code> — Print the paths to the config files</li>
<li><code>set</code> — Update a config file to set the given option to a given value</li>
<li><code>unset</code> — Update a config file to unset the given option</li>
</ul>
<h2 id="cli-reference-jj-config-edit"><code>jj config edit</code><a class="headerlink" href="#cli-reference-jj-config-edit" title="Permanent link">&para;</a></h2>
<p>Start an editor on a jj config file.</p>
<p>Creates the file if it doesn't already exist regardless of what the editor does.</p>
<p><strong>Usage:</strong> <code>jj config edit &lt;--user|--repo&gt;</code></p>
<p><strong>Command Alias:</strong> <code>e</code></p>
<h6 id="cli-reference-options_9"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_9" title="Permanent link">&para;</a></h6>
<ul>
<li><code>--user</code> — Target the user-level config</li>
<li><code>--repo</code> — Target the repo-level config</li>
</ul>
<h2 id="cli-reference-jj-config-get"><code>jj config get</code><a class="headerlink" href="#cli-reference-jj-config-get" title="Permanent link">&para;</a></h2>
<p>Get the value of a given config option.</p>
<p>Unlike <code>jj config list</code>, the result of <code>jj config get</code> is printed without
extra formatting and therefore is usable in scripting. For example:</p>
<p>$ jj config list user.name
user.name="Martin von Zweigbergk"
$ jj config get user.name
Martin von Zweigbergk</p>
<p><strong>Usage:</strong> <code>jj config get &lt;NAME&gt;</code></p>
<p><strong>Command Alias:</strong> <code>g</code></p>
<h6 id="cli-reference-arguments_12"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_12" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;NAME&gt;</code></li>
</ul>
<h2 id="cli-reference-jj-config-list"><code>jj config list</code><a class="headerlink" href="#cli-reference-jj-config-list" title="Permanent link">&para;</a></h2>
<p>List variables set in config files, along with their values</p>
<p><strong>Usage:</strong> <code>jj config list [OPTIONS] [NAME]</code></p>
<p><strong>Command Alias:</strong> <code>l</code></p>
<h6 id="cli-reference-arguments_13"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_13" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;NAME&gt;</code> — An optional name of a specific config option to look up</li>
</ul>
<h6 id="cli-reference-options_10"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_10" title="Permanent link">&para;</a></h6>
<ul>
<li><code>--include-defaults</code> — Whether to explicitly include built-in default values in the list</li>
<li><code>--include-overridden</code> — Allow printing overridden values</li>
<li><code>--user</code> — Target the user-level config</li>
<li><code>--repo</code> — Target the repo-level config</li>
<li>
<p><code>-T</code>, <code>--template &lt;TEMPLATE&gt;</code> — Render each variable using the given template</p>
<p>The following keywords are available in the template expression:</p>
<ul>
<li><code>name: String</code>: Config name.</li>
<li><code>value: ConfigValue</code>: Value to be formatted in TOML syntax.</li>
<li><code>overridden: Boolean</code>: True if the value is shadowed by other.</li>
<li><code>source: String</code>: Source of the value.</li>
<li><code>path: String</code>: Path to the config file.</li>
</ul>
<p>Can be overridden by the <code>templates.config_list</code> setting. To
 see a detailed config list, use the <code>builtin_config_list_detailed</code>
 template.</p>
<p>See [<code>jj help -k templates</code>] for more information.</p>
</li>
</ul>
<h2 id="cli-reference-jj-config-path"><code>jj config path</code><a class="headerlink" href="#cli-reference-jj-config-path" title="Permanent link">&para;</a></h2>
<p>Print the paths to the config files</p>
<p>A config file at that path may or may not exist.</p>
<p>See <code>jj config edit</code> if you'd like to immediately edit a file.</p>
<p><strong>Usage:</strong> <code>jj config path &lt;--user|--repo&gt;</code></p>
<p><strong>Command Alias:</strong> <code>p</code></p>
<h6 id="cli-reference-options_11"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_11" title="Permanent link">&para;</a></h6>
<ul>
<li><code>--user</code> — Target the user-level config</li>
<li><code>--repo</code> — Target the repo-level config</li>
</ul>
<h2 id="cli-reference-jj-config-set"><code>jj config set</code><a class="headerlink" href="#cli-reference-jj-config-set" title="Permanent link">&para;</a></h2>
<p>Update a config file to set the given option to a given value</p>
<p><strong>Usage:</strong> <code>jj config set &lt;--user|--repo&gt; &lt;NAME&gt; &lt;VALUE&gt;</code></p>
<p><strong>Command Alias:</strong> <code>s</code></p>
<h6 id="cli-reference-arguments_14"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_14" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;NAME&gt;</code></li>
<li>
<p><code>&lt;VALUE&gt;</code> — New value to set</p>
<p>The value should be specified as a TOML expression. If string value isn't enclosed by any TOML constructs (such as apostrophes or array notation), quotes can be omitted. Note that the value may also need shell quoting. TOML multi-line strings can be useful if the value contains apostrophes. For example, to set <code>foo.bar</code> to the string "{don't}" use <code>jj config set --user foo.bar "'''{don't}'''"</code>. This is valid in both Bash and Fish.</p>
<p>Alternative, e.g. to avoid dealing with shell quoting, use <code>jj config edit</code> to edit the TOML file directly.</p>
</li>
</ul>
<h6 id="cli-reference-options_12"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_12" title="Permanent link">&para;</a></h6>
<ul>
<li><code>--user</code> — Target the user-level config</li>
<li><code>--repo</code> — Target the repo-level config</li>
</ul>
<h2 id="cli-reference-jj-config-unset"><code>jj config unset</code><a class="headerlink" href="#cli-reference-jj-config-unset" title="Permanent link">&para;</a></h2>
<p>Update a config file to unset the given option</p>
<p><strong>Usage:</strong> <code>jj config unset &lt;--user|--repo&gt; &lt;NAME&gt;</code></p>
<p><strong>Command Alias:</strong> <code>u</code></p>
<h6 id="cli-reference-arguments_15"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_15" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;NAME&gt;</code></li>
</ul>
<h6 id="cli-reference-options_13"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_13" title="Permanent link">&para;</a></h6>
<ul>
<li><code>--user</code> — Target the user-level config</li>
<li><code>--repo</code> — Target the repo-level config</li>
</ul>
<h2 id="cli-reference-jj-describe"><code>jj describe</code><a class="headerlink" href="#cli-reference-jj-describe" title="Permanent link">&para;</a></h2>
<p>Update the change description or other metadata</p>
<p>Starts an editor to let you edit the description of changes. The editor will be $EDITOR, or <code>pico</code> if that's not defined (<code>Notepad</code> on Windows).</p>
<p><strong>Usage:</strong> <code>jj describe [OPTIONS] [REVSETS]...</code></p>
<p><strong>Command Alias:</strong> <code>desc</code></p>
<h6 id="cli-reference-arguments_16"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_16" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;REVSETS&gt;</code> — The revision(s) whose description to edit (default: @)</li>
</ul>
<h6 id="cli-reference-options_14"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_14" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-m</code>, <code>--message &lt;MESSAGE&gt;</code> — The change description to use (don't open editor)</p>
<p>If multiple revisions are specified, the same description will be used for all of them.</p>
</li>
<li>
<p><code>--stdin</code> — Read the change description from stdin</p>
<p>If multiple revisions are specified, the same description will be used for all of them.</p>
</li>
<li>
<p><code>--no-edit</code> — Don't open an editor</p>
<p>This is mainly useful in combination with e.g. <code>--reset-author</code>.</p>
</li>
<li>
<p><code>--edit</code> — Open an editor</p>
<p>Forces an editor to open when using <code>--stdin</code> or <code>--message</code> to allow the message to be edited afterwards.</p>
</li>
<li>
<p><code>--reset-author</code> — Reset the author to the configured user</p>
<p>This resets the author name, email, and timestamp.</p>
<p>You can use it in combination with the JJ_USER and JJ_EMAIL environment variables to set a different author:</p>
<p>$ JJ_USER='Foo Bar' JJ_EMAIL=foo@bar.com jj describe --reset-author</p>
</li>
<li>
<p><code>--author &lt;AUTHOR&gt;</code> — Set author to the provided string</p>
<p>This changes author name and email while retaining author timestamp for non-discardable commits.</p>
</li>
</ul>
<h2 id="cli-reference-jj-diff"><code>jj diff</code><a class="headerlink" href="#cli-reference-jj-diff" title="Permanent link">&para;</a></h2>
<p>Compare file contents between two revisions</p>
<p>With the <code>-r</code> option, shows the changes compared to the parent revision. If there are several parent revisions (i.e., the given revision is a merge), then they will be merged and the changes from the result to the given revision will be shown.</p>
<p>With the <code>--from</code> and/or <code>--to</code> options, shows the difference from/to the given revisions. If either is left out, it defaults to the working-copy commit. For example, <code>jj diff --from main</code> shows the changes from "main" (perhaps a bookmark name) to the working-copy commit.</p>
<p>If no option is specified, it defaults to <code>-r @</code>.</p>
<p><strong>Usage:</strong> <code>jj diff [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_17"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_17" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Restrict the diff to these paths</li>
</ul>
<h6 id="cli-reference-options_15"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_15" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-r</code>, <code>--revisions &lt;REVSETS&gt;</code> — Show changes in these revisions</p>
<p>If there are multiple revisions, then then total diff for all of them will be shown. For example, if you have a linear chain of revisions A..D, then <code>jj diff -r B::D</code> equals <code>jj diff --from A --to D</code>. Multiple heads and/or roots are supported, but gaps in the revset are not supported (e.g. <code>jj diff -r 'A|C'</code> in a linear chain A..C).</p>
<p>If a revision is a merge commit, this shows changes <em>from</em> the automatic merge of the contents of all of its parents <em>to</em> the contents of the revision itself.</p>
<p>If none of <code>-r</code>, <code>-f</code>, or <code>-t</code> is provided, then the default is <code>-r @</code>.</p>
</li>
<li>
<p><code>-f</code>, <code>--from &lt;REVSET&gt;</code> — Show changes from this revision</p>
<p>If none of <code>-r</code>, <code>-f</code>, or <code>-t</code> is provided, then the default is <code>-r @</code>.</p>
</li>
<li>
<p><code>-t</code>, <code>--to &lt;REVSET&gt;</code> — Show changes to this revision</p>
<p>If none of <code>-r</code>, <code>-f</code>, or <code>-t</code> is provided, then the default is <code>-r @</code>.</p>
</li>
<li>
<p><code>-s</code>, <code>--summary</code> — For each path, show only whether it was modified, added, or deleted</p>
</li>
<li><code>--stat</code> — Show a histogram of the changes</li>
<li>
<p><code>--types</code> — For each path, show only its type before and after</p>
<p>The diff is shown as two letters. The first letter indicates the type before and the second letter indicates the type after. '-' indicates that the path was not present, 'F' represents a regular file, `L' represents a symlink, 'C' represents a conflict, and 'G' represents a Git submodule.</p>
</li>
<li>
<p><code>--name-only</code> — For each path, show only its path</p>
<p>Typically useful for shell commands like: <code>jj diff -r @- --name-only | xargs perl -pi -e's/OLD/NEW/g</code></p>
</li>
<li>
<p><code>--git</code> — Show a Git-format diff</p>
</li>
<li><code>--color-words</code> — Show a word-level diff with changes indicated only by color</li>
<li>
<p><code>--tool &lt;TOOL&gt;</code> — Generate diff by external command</p>
<p>A builtin format can also be specified as <code>:&lt;name&gt;</code>. For example, <code>--tool=:git</code> is equivalent to <code>--git</code>.</p>
</li>
<li>
<p><code>--context &lt;CONTEXT&gt;</code> — Number of lines of context to show</p>
</li>
<li><code>-w</code>, <code>--ignore-all-space</code> — Ignore whitespace when comparing lines</li>
<li><code>-b</code>, <code>--ignore-space-change</code> — Ignore changes in amount of whitespace when comparing lines</li>
</ul>
<h2 id="cli-reference-jj-diffedit"><code>jj diffedit</code><a class="headerlink" href="#cli-reference-jj-diffedit" title="Permanent link">&para;</a></h2>
<p>Touch up the content changes in a revision with a diff editor</p>
<p>With the <code>-r</code> option, starts a <a href="https://jj-vcs.github.io/jj/latest/config/#editing-diffs">diff editor</a> on the changes in the revision.</p>
<p>With the <code>--from</code> and/or <code>--to</code> options, starts a <a href="https://jj-vcs.github.io/jj/latest/config/#editing-diffs">diff editor</a> comparing the "from" revision to the "to" revision.</p>
<p>Edit the right side of the diff until it looks the way you want. Once you close the editor, the revision specified with <code>-r</code> or <code>--to</code> will be updated. Unless <code>--restore-descendants</code> is used, descendants will be rebased on top as usual, which may result in conflicts.</p>
<p>See <code>jj restore</code> if you want to move entire files from one revision to another. For moving changes between revisions, see <code>jj squash -i</code>.</p>
<p><strong>Usage:</strong> <code>jj diffedit [OPTIONS]</code></p>
<h6 id="cli-reference-options_16"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_16" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-r</code>, <code>--revision &lt;REVSET&gt;</code> — The revision to touch up</p>
<p>Defaults to @ if neither --to nor --from are specified.</p>
</li>
<li>
<p><code>-f</code>, <code>--from &lt;REVSET&gt;</code> — Show changes from this revision</p>
<p>Defaults to @ if --to is specified.</p>
</li>
<li>
<p><code>-t</code>, <code>--to &lt;REVSET&gt;</code> — Edit changes in this revision</p>
<p>Defaults to @ if --from is specified.</p>
</li>
<li>
<p><code>--tool &lt;NAME&gt;</code> — Specify diff editor to be used</p>
</li>
<li>
<p><code>--restore-descendants</code> — Preserve the content (not the diff) when rebasing descendants</p>
<p>When rebasing a descendant on top of the rewritten revision, its diff compared to its parent(s) is normally preserved, i.e. the same way that descendants are always rebased. This flag makes it so the content/state is preserved instead of preserving the diff.</p>
</li>
</ul>
<h2 id="cli-reference-jj-duplicate"><code>jj duplicate</code><a class="headerlink" href="#cli-reference-jj-duplicate" title="Permanent link">&para;</a></h2>
<p>Create new changes with the same content as existing ones</p>
<p>When none of the <code>--destination</code>, <code>--insert-after</code>, or <code>--insert-before</code> arguments are provided, commits will be duplicated onto their existing parents or onto other newly duplicated commits.</p>
<p>When any of the <code>--destination</code>, <code>--insert-after</code>, or <code>--insert-before</code> arguments are provided, the roots of the specified commits will be duplicated onto the destination indicated by the arguments. Other specified commits will be duplicated onto these newly duplicated commits. If the <code>--insert-after</code> or <code>--insert-before</code> arguments are provided, the new children indicated by the arguments will be rebased onto the heads of the specified commits.</p>
<p>By default, the duplicated commits retain the descriptions of the originals. This can be customized with the <code>templates.duplicate_description</code> setting.</p>
<p><strong>Usage:</strong> <code>jj duplicate [OPTIONS] [REVSETS]...</code></p>
<h6 id="cli-reference-arguments_18"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_18" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;REVSETS&gt;</code> — The revision(s) to duplicate (default: @)</li>
</ul>
<h6 id="cli-reference-options_17"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_17" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-d</code>, <code>--destination &lt;REVSETS&gt;</code> — The revision(s) to duplicate onto (can be repeated to create a merge commit)</li>
<li><code>-A</code>, <code>--insert-after &lt;REVSETS&gt;</code> [alias: <code>after</code>] — The revision(s) to insert after (can be repeated to create a merge commit)</li>
<li><code>-B</code>, <code>--insert-before &lt;REVSETS&gt;</code> [alias: <code>before</code>] — The revision(s) to insert before (can be repeated to create a merge commit)</li>
</ul>
<h2 id="cli-reference-jj-edit"><code>jj edit</code><a class="headerlink" href="#cli-reference-jj-edit" title="Permanent link">&para;</a></h2>
<p>Sets the specified revision as the working-copy revision</p>
<p>Note: it is <a href="https://jj-vcs.github.io/jj/latest/FAQ#how-do-i-resume-working-on-an-existing-change">generally recommended</a> to instead use <code>jj new</code> and <code>jj squash</code>.</p>
<p><strong>Usage:</strong> <code>jj edit &lt;REVSET&gt;</code></p>
<h6 id="cli-reference-arguments_19"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_19" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;REVSET&gt;</code> — The commit to edit</li>
</ul>
<h2 id="cli-reference-jj-evolog"><code>jj evolog</code><a class="headerlink" href="#cli-reference-jj-evolog" title="Permanent link">&para;</a></h2>
<p>Show how a change has evolved over time</p>
<p>Lists the previous commits which a change has pointed to. The current commit of a change evolves when the change is updated, rebased, etc.</p>
<p><strong>Usage:</strong> <code>jj evolog [OPTIONS]</code></p>
<p><strong>Command Alias:</strong> <code>evolution-log</code></p>
<h6 id="cli-reference-options_18"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_18" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-r</code>, <code>--revision &lt;REVSET&gt;</code></p>
<p>Default value: <code>@</code></p>
</li>
<li>
<p><code>-n</code>, <code>--limit &lt;LIMIT&gt;</code> — Limit number of revisions to show</p>
<p>Applied after revisions are reordered topologically, but before being reversed.</p>
</li>
<li>
<p><code>--reversed</code> — Show revisions in the opposite order (older revisions first)</p>
</li>
<li><code>--no-graph</code> — Don't show the graph, show a flat list of revisions</li>
<li>
<p><code>-T</code>, <code>--template &lt;TEMPLATE&gt;</code> — Render each revision using the given template</p>
<p>Run <code>jj log -T</code> to list the built-in templates.</p>
<p>You can also specify arbitrary template expressions using the <a href="https://jj-vcs.github.io/jj/latest/templates/#commit-keywords">built-in keywords</a>. See [<code>jj help -k templates</code>] for more information.</p>
</li>
<li>
<p><code>-p</code>, <code>--patch</code> — Show patch compared to the previous version of this change</p>
<p>If the previous version has different parents, it will be temporarily rebased to the parents of the new version, so the diff is not contaminated by unrelated changes.</p>
</li>
<li>
<p><code>-s</code>, <code>--summary</code> — For each path, show only whether it was modified, added, or deleted</p>
</li>
<li><code>--stat</code> — Show a histogram of the changes</li>
<li>
<p><code>--types</code> — For each path, show only its type before and after</p>
<p>The diff is shown as two letters. The first letter indicates the type before and the second letter indicates the type after. '-' indicates that the path was not present, 'F' represents a regular file, `L' represents a symlink, 'C' represents a conflict, and 'G' represents a Git submodule.</p>
</li>
<li>
<p><code>--name-only</code> — For each path, show only its path</p>
<p>Typically useful for shell commands like: <code>jj diff -r @- --name-only | xargs perl -pi -e's/OLD/NEW/g</code></p>
</li>
<li>
<p><code>--git</code> — Show a Git-format diff</p>
</li>
<li><code>--color-words</code> — Show a word-level diff with changes indicated only by color</li>
<li>
<p><code>--tool &lt;TOOL&gt;</code> — Generate diff by external command</p>
<p>A builtin format can also be specified as <code>:&lt;name&gt;</code>. For example, <code>--tool=:git</code> is equivalent to <code>--git</code>.</p>
</li>
<li>
<p><code>--context &lt;CONTEXT&gt;</code> — Number of lines of context to show</p>
</li>
<li><code>--ignore-all-space</code> — Ignore whitespace when comparing lines</li>
<li><code>--ignore-space-change</code> — Ignore changes in amount of whitespace when comparing lines</li>
</ul>
<h2 id="cli-reference-jj-file"><code>jj file</code><a class="headerlink" href="#cli-reference-jj-file" title="Permanent link">&para;</a></h2>
<p>File operations</p>
<p><strong>Usage:</strong> <code>jj file &lt;COMMAND&gt;</code></p>
<h6 id="cli-reference-subcommands_3"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_3" title="Permanent link">&para;</a></h6>
<ul>
<li><code>annotate</code> — Show the source change for each line of the target file</li>
<li><code>chmod</code> — Sets or removes the executable bit for paths in the repo</li>
<li><code>list</code> — List files in a revision</li>
<li><code>show</code> — Print contents of files in a revision</li>
<li><code>track</code> — Start tracking specified paths in the working copy</li>
<li><code>untrack</code> — Stop tracking specified paths in the working copy</li>
</ul>
<h2 id="cli-reference-jj-file-annotate"><code>jj file annotate</code><a class="headerlink" href="#cli-reference-jj-file-annotate" title="Permanent link">&para;</a></h2>
<p>Show the source change for each line of the target file.</p>
<p>Annotates a revision line by line. Each line includes the source change that introduced the associated line. A path to the desired file must be provided.</p>
<p><strong>Usage:</strong> <code>jj file annotate [OPTIONS] &lt;PATH&gt;</code></p>
<h6 id="cli-reference-arguments_20"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_20" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;PATH&gt;</code> — the file to annotate</li>
</ul>
<h6 id="cli-reference-options_19"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_19" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-r</code>, <code>--revision &lt;REVSET&gt;</code> — an optional revision to start at</li>
<li>
<p><code>-T</code>, <code>--template &lt;TEMPLATE&gt;</code> — Render each line using the given template</p>
<p>All 0-argument methods of the [<code>AnnotationLine</code> type] are available as keywords in the template expression. See [<code>jj help -k templates</code>] for more information.</p>
<p>If not specified, this defaults to the <code>templates.file_annotate</code> setting.</p>
</li>
</ul>
<h2 id="cli-reference-jj-file-chmod"><code>jj file chmod</code><a class="headerlink" href="#cli-reference-jj-file-chmod" title="Permanent link">&para;</a></h2>
<p>Sets or removes the executable bit for paths in the repo</p>
<p>Unlike the POSIX <code>chmod</code>, <code>jj file chmod</code> also works on Windows, on conflicted files, and on arbitrary revisions.</p>
<p><strong>Usage:</strong> <code>jj file chmod [OPTIONS] &lt;MODE&gt; &lt;FILESETS&gt;...</code></p>
<h6 id="cli-reference-arguments_21"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_21" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;MODE&gt;</code></p>
<p>Possible values:</p>
<ul>
<li><code>n</code>:
  Make a path non-executable (alias: normal)</li>
<li><code>x</code>:
  Make a path executable (alias: executable)</li>
</ul>
</li>
<li>
<p><code>&lt;FILESETS&gt;</code> — Paths to change the executable bit for</p>
</li>
</ul>
<h6 id="cli-reference-options_20"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_20" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-r</code>, <code>--revision &lt;REVSET&gt;</code> — The revision to update</p>
<p>Default value: <code>@</code></p>
</li>
</ul>
<h2 id="cli-reference-jj-file-list"><code>jj file list</code><a class="headerlink" href="#cli-reference-jj-file-list" title="Permanent link">&para;</a></h2>
<p>List files in a revision</p>
<p><strong>Usage:</strong> <code>jj file list [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_22"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_22" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Only list files matching these prefixes (instead of all files)</li>
</ul>
<h6 id="cli-reference-options_21"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_21" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-r</code>, <code>--revision &lt;REVSET&gt;</code> — The revision to list files in</p>
<p>Default value: <code>@</code></p>
</li>
<li>
<p><code>-T</code>, <code>--template &lt;TEMPLATE&gt;</code> — Render each file entry using the given template</p>
<p>All 0-argument methods of the [<code>TreeEntry</code> type] are available as keywords in the template expression. See [<code>jj help -k templates</code>] for more information.</p>
</li>
</ul>
<h2 id="cli-reference-jj-file-show"><code>jj file show</code><a class="headerlink" href="#cli-reference-jj-file-show" title="Permanent link">&para;</a></h2>
<p>Print contents of files in a revision</p>
<p>If the given path is a directory, files in the directory will be visited recursively.</p>
<p><strong>Usage:</strong> <code>jj file show [OPTIONS] &lt;FILESETS&gt;...</code></p>
<h6 id="cli-reference-arguments_23"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_23" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Paths to print</li>
</ul>
<h6 id="cli-reference-options_22"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_22" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-r</code>, <code>--revision &lt;REVSET&gt;</code> — The revision to get the file contents from</p>
<p>Default value: <code>@</code></p>
</li>
</ul>
<h2 id="cli-reference-jj-file-track"><code>jj file track</code><a class="headerlink" href="#cli-reference-jj-file-track" title="Permanent link">&para;</a></h2>
<p>Start tracking specified paths in the working copy</p>
<p>Without arguments, all paths that are not ignored will be tracked.</p>
<p>New files in the working copy can be automatically tracked. You can configure which paths to automatically track by setting <code>snapshot.auto-track</code> (e.g. to <code>"none()"</code> or <code>"glob:**/*.rs"</code>). Files that don't match the pattern can be manually tracked using this command. The default pattern is <code>all()</code> and this command has no effect.</p>
<p><strong>Usage:</strong> <code>jj file track &lt;FILESETS&gt;...</code></p>
<h6 id="cli-reference-arguments_24"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_24" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Paths to track</li>
</ul>
<h2 id="cli-reference-jj-file-untrack"><code>jj file untrack</code><a class="headerlink" href="#cli-reference-jj-file-untrack" title="Permanent link">&para;</a></h2>
<p>Stop tracking specified paths in the working copy</p>
<p><strong>Usage:</strong> <code>jj file untrack &lt;FILESETS&gt;...</code></p>
<h6 id="cli-reference-arguments_25"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_25" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;FILESETS&gt;</code> — Paths to untrack. They must already be ignored.</p>
<p>The paths could be ignored via a .gitignore or .git/info/exclude (in colocated repos).</p>
</li>
</ul>
<h2 id="cli-reference-jj-fix"><code>jj fix</code><a class="headerlink" href="#cli-reference-jj-fix" title="Permanent link">&para;</a></h2>
<p>Update files with formatting fixes or other changes</p>
<p>The primary use case for this command is to apply the results of automatic
code formatting tools to revisions that may not be properly formatted yet.
It can also be used to modify files with other tools like <code>sed</code> or <code>sort</code>.</p>
<p>The changed files in the given revisions will be updated with any fixes
determined by passing their file content through any external tools the user
has configured for those files. Descendants will also be updated by passing
their versions of the same files through the same tools, which will ensure
that the fixes are not lost. This will never result in new conflicts. Files
with existing conflicts will be updated on all sides of the conflict, which
can potentially increase or decrease the number of conflict markers.</p>
<p>The external tools must accept the current file content on standard input,
and return the updated file content on standard output. A tool's output will
not be used unless it exits with a successful exit code. Output on standard
error will be passed through to the terminal.</p>
<p>Tools are defined in a table where the keys are arbitrary identifiers and
the values have the following properties:</p>
<ul>
<li><code>command</code>: The arguments used to run the tool. The first argument is the
   path to an executable file. Arguments can contain the substring <code>$path</code>,
   which will be replaced with the repo-relative path of the file being
   fixed. It is useful to provide the path to tools that include the path in
   error messages, or behave differently based on the directory or file
   name.</li>
<li><code>patterns</code>: Determines which files the tool will affect. If this list is
   empty, no files will be affected by the tool. If there are multiple
   patterns, the tool is applied only once to each file in the union of the
   patterns.</li>
<li><code>enabled</code>: Enables or disables the tool. If omitted, the tool is enabled.
   This is useful for defining disabled tools in user configuration that can
   be enabled in individual repositories with one config setting.</li>
</ul>
<p>For example, the following configuration defines how two code formatters
(<code>clang-format</code> and <code>black</code>) will apply to three different file extensions
(<code>.cc</code>, <code>.h</code>, and <code>.py</code>):</p>
<div class="highlight"><pre><span></span><code><span class="k">[fix.tools.clang-format]</span>
<span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/usr/bin/clang-format&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--assume-filename=$path&quot;</span><span class="p">]</span>
<span class="n">patterns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;glob:&#39;**/*.cc&#39;&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;glob:&#39;**/*.h&#39;&quot;</span><span class="p">]</span>

<span class="k">[fix.tools.black]</span>
<span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/usr/bin/black&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--stdin-filename=$path&quot;</span><span class="p">]</span>
<span class="n">patterns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;glob:&#39;**/*.py&#39;&quot;</span><span class="p">]</span>
</code></pre></div>
<p>Execution order of tools that affect the same file is deterministic, but
currently unspecified, and may change between releases. If two tools affect
the same file, the second tool to run will receive its input from the
output of the first tool.</p>
<p><strong>Usage:</strong> <code>jj fix [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_26"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_26" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Fix only these paths</li>
</ul>
<h6 id="cli-reference-options_23"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_23" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-s</code>, <code>--source &lt;REVSETS&gt;</code> — Fix files in the specified revision(s) and their descendants. If no revisions are specified, this defaults to the <code>revsets.fix</code> setting, or <code>reachable(@, mutable())</code> if it is not set</li>
<li><code>--include-unchanged-files</code> — Fix unchanged files in addition to changed ones. If no paths are specified, all files in the repo will be fixed</li>
</ul>
<h2 id="cli-reference-jj-git"><code>jj git</code><a class="headerlink" href="#cli-reference-jj-git" title="Permanent link">&para;</a></h2>
<p>Commands for working with Git remotes and the underlying Git repo</p>
<p>See this <a href="https://jj-vcs.github.io/jj/latest/git-comparison/.">comparison</a>, including a <a href="https://jj-vcs.github.io/jj/latest/git-command-table">table of commands</a>.</p>
<p><strong>Usage:</strong> <code>jj git &lt;COMMAND&gt;</code></p>
<h6 id="cli-reference-subcommands_4"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_4" title="Permanent link">&para;</a></h6>
<ul>
<li><code>clone</code> — Create a new repo backed by a clone of a Git repo</li>
<li><code>export</code> — Update the underlying Git repo with changes made in the repo</li>
<li><code>fetch</code> — Fetch from a Git remote</li>
<li><code>import</code> — Update repo with changes made in the underlying Git repo</li>
<li><code>init</code> — Create a new Git backed repo</li>
<li><code>push</code> — Push to a Git remote</li>
<li><code>remote</code> — Manage Git remotes</li>
<li><code>root</code> — Show the underlying Git directory of a repository using the Git backend</li>
</ul>
<h2 id="cli-reference-jj-git-clone"><code>jj git clone</code><a class="headerlink" href="#cli-reference-jj-git-clone" title="Permanent link">&para;</a></h2>
<p>Create a new repo backed by a clone of a Git repo</p>
<p>The Git repo will be a bare git repo stored inside the <code>.jj/</code> directory.</p>
<p><strong>Usage:</strong> <code>jj git clone [OPTIONS] &lt;SOURCE&gt; [DESTINATION]</code></p>
<h6 id="cli-reference-arguments_27"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_27" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;SOURCE&gt;</code> — URL or path of the Git repo to clone</p>
<p>Local path will be resolved to absolute form.</p>
</li>
<li>
<p><code>&lt;DESTINATION&gt;</code> — Specifies the target directory for the Jujutsu repository clone. If not provided, defaults to a directory named after the last component of the source URL. The full directory path will be created if it doesn't exist</p>
</li>
</ul>
<h6 id="cli-reference-options_24"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_24" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--remote &lt;REMOTE_NAME&gt;</code> — Name of the newly created remote</p>
<p>Default value: <code>origin</code></p>
</li>
<li>
<p><code>--colocate</code> — Whether or not to colocate the Jujutsu repo with the git repo</p>
</li>
<li><code>--depth &lt;DEPTH&gt;</code> — Create a shallow clone of the given depth</li>
</ul>
<h2 id="cli-reference-jj-git-export"><code>jj git export</code><a class="headerlink" href="#cli-reference-jj-git-export" title="Permanent link">&para;</a></h2>
<p>Update the underlying Git repo with changes made in the repo</p>
<p><strong>Usage:</strong> <code>jj git export</code></p>
<h2 id="cli-reference-jj-git-fetch"><code>jj git fetch</code><a class="headerlink" href="#cli-reference-jj-git-fetch" title="Permanent link">&para;</a></h2>
<p>Fetch from a Git remote</p>
<p>If a working-copy commit gets abandoned, it will be given a new, empty commit. This is true in general; it is not specific to this command.</p>
<p><strong>Usage:</strong> <code>jj git fetch [OPTIONS]</code></p>
<h6 id="cli-reference-options_25"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_25" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-b</code>, <code>--branch &lt;BRANCH&gt;</code> — Fetch only some of the branches</p>
<p>By default, the specified name matches exactly. Use <code>glob:</code> prefix to expand <code>*</code> as a glob, e.g. <code>--branch 'glob:push-*'</code>. Other wildcard characters such as <code>?</code> are <em>not</em> supported.</p>
<p>Default value: <code>glob:*</code></p>
</li>
<li>
<p><code>--remote &lt;REMOTE&gt;</code> — The remote to fetch from (only named remotes are supported, can be repeated)</p>
<p>This defaults to the <code>git.fetch</code> setting. If that is not configured, and if there are multiple remotes, the remote named "origin" will be used.</p>
<p>By default, the specified remote names matches exactly. Use a <a href="https://jj-vcs.github.io/jj/latest/revsets#string-patterns">string pattern</a>, e.g. <code>--remote 'glob:*'</code>, to select remotes using patterns.</p>
</li>
<li>
<p><code>--all-remotes</code> — Fetch from all remotes</p>
</li>
</ul>
<h2 id="cli-reference-jj-git-import"><code>jj git import</code><a class="headerlink" href="#cli-reference-jj-git-import" title="Permanent link">&para;</a></h2>
<p>Update repo with changes made in the underlying Git repo</p>
<p>If a working-copy commit gets abandoned, it will be given a new, empty commit. This is true in general; it is not specific to this command.</p>
<p><strong>Usage:</strong> <code>jj git import</code></p>
<h2 id="cli-reference-jj-git-init"><code>jj git init</code><a class="headerlink" href="#cli-reference-jj-git-init" title="Permanent link">&para;</a></h2>
<p>Create a new Git backed repo</p>
<p><strong>Usage:</strong> <code>jj git init [OPTIONS] [DESTINATION]</code></p>
<h6 id="cli-reference-arguments_28"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_28" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;DESTINATION&gt;</code> — The destination directory where the <code>jj</code> repo will be created. If the directory does not exist, it will be created. If no directory is given, the current directory is used.</p>
<p>By default the <code>git</code> repo is under <code>$destination/.jj</code></p>
<p>Default value: <code>.</code></p>
</li>
</ul>
<h6 id="cli-reference-options_26"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_26" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--colocate</code> — Specifies that the <code>jj</code> repo should also be a valid <code>git</code> repo, allowing the use of both <code>jj</code> and <code>git</code> commands in the same directory.</p>
<p>This is done by placing the backing git repo into a <code>.git</code> directory in the root of the <code>jj</code> repo along with the <code>.jj</code> directory. If the <code>.git</code> directory already exists, all the existing commits will be imported.</p>
<p>This option is mutually exclusive with <code>--git-repo</code>.</p>
</li>
<li>
<p><code>--git-repo &lt;GIT_REPO&gt;</code> — Specifies a path to an <strong>existing</strong> git repository to be used as the backing git repo for the newly created <code>jj</code> repo.</p>
<p>If the specified <code>--git-repo</code> path happens to be the same as the <code>jj</code> repo path (both .jj and .git directories are in the same working directory), then both <code>jj</code> and <code>git</code> commands will work on the same repo. This is called a co-located repo.</p>
<p>This option is mutually exclusive with <code>--colocate</code>.</p>
</li>
</ul>
<h2 id="cli-reference-jj-git-push"><code>jj git push</code><a class="headerlink" href="#cli-reference-jj-git-push" title="Permanent link">&para;</a></h2>
<p>Push to a Git remote</p>
<p>By default, pushes tracking bookmarks pointing to <code>remote_bookmarks(remote=&lt;remote&gt;)..@</code>. Use <code>--bookmark</code> to push specific bookmarks. Use <code>--all</code> to push all bookmarks. Use <code>--change</code> to generate bookmark names based on the change IDs of specific commits.</p>
<p>Unlike in Git, the remote to push to is not derived from the tracked remote bookmarks. Use <code>--remote</code> to select the remote Git repository by name. There is no option to push to multiple remotes.</p>
<p>Before the command actually moves, creates, or deletes a remote bookmark, it makes several <a href="https://jj-vcs.github.io/jj/latest/bookmarks/#pushing-bookmarks-safety-checks">safety checks</a>. If there is a problem, you may need to run <code>jj git fetch --remote &lt;remote name&gt;</code> and/or resolve some <a href="https://jj-vcs.github.io/jj/latest/bookmarks/#conflicts">bookmark conflicts</a>.</p>
<p><strong>Usage:</strong> <code>jj git push [OPTIONS]</code></p>
<h6 id="cli-reference-options_27"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_27" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--remote &lt;REMOTE&gt;</code> — The remote to push to (only named remotes are supported)</p>
<p>This defaults to the <code>git.push</code> setting. If that is not configured, and if there are multiple remotes, the remote named "origin" will be used.</p>
</li>
<li>
<p><code>-b</code>, <code>--bookmark &lt;BOOKMARK&gt;</code> — Push only this bookmark, or bookmarks matching a pattern (can be repeated)</p>
<p>By default, the specified name matches exactly. Use <code>glob:</code> prefix to select bookmarks by <a href="https://jj-vcs.github.io/jj/latest/revsets/#string-patterns">wildcard pattern</a>.</p>
</li>
<li>
<p><code>--all</code> — Push all bookmarks (including new bookmarks)</p>
</li>
<li>
<p><code>--tracked</code> — Push all tracked bookmarks</p>
<p>This usually means that the bookmark was already pushed to or fetched from the <a href="https://jj-vcs.github.io/jj/latest/bookmarks#remotes-and-tracked-bookmarks">relevant remote</a>.</p>
</li>
<li>
<p><code>--deleted</code> — Push all deleted bookmarks</p>
<p>Only tracked bookmarks can be successfully deleted on the remote. A warning will be printed if any untracked bookmarks on the remote correspond to missing local bookmarks.</p>
</li>
<li>
<p><code>-N</code>, <code>--allow-new</code> — Allow pushing new bookmarks</p>
<p>Newly-created remote bookmarks will be tracked automatically.</p>
<p>This can also be turned on by the <code>git.push-new-bookmarks</code> setting. If it's set to <code>true</code>, <code>--allow-new</code> is no-op.</p>
</li>
<li>
<p><code>--allow-empty-description</code> — Allow pushing commits with empty descriptions</p>
</li>
<li>
<p><code>--allow-private</code> — Allow pushing commits that are private</p>
<p>The set of private commits can be configured by the <code>git.private-commits</code> setting. The default is <code>none()</code>, meaning all commits are eligible to be pushed.</p>
</li>
<li>
<p><code>-r</code>, <code>--revisions &lt;REVSETS&gt;</code> — Push bookmarks pointing to these commits (can be repeated)</p>
</li>
<li>
<p><code>-c</code>, <code>--change &lt;REVSETS&gt;</code> — Push this commit by creating a bookmark based on its change ID (can be repeated)</p>
<p>The created bookmark will be tracked automatically. Use the <code>git.push-bookmark-prefix</code> setting to change the prefix for generated names.</p>
</li>
<li>
<p><code>--named &lt;NAME=REVISION&gt;</code> — Specify a new bookmark name and a revision to push under that name, e.g. '--named myfeature=@'</p>
<p>Does not require --allow-new.</p>
</li>
<li>
<p><code>--dry-run</code> — Only display what will change on the remote</p>
</li>
</ul>
<h2 id="cli-reference-jj-git-remote"><code>jj git remote</code><a class="headerlink" href="#cli-reference-jj-git-remote" title="Permanent link">&para;</a></h2>
<p>Manage Git remotes</p>
<p>The Git repo will be a bare git repo stored inside the <code>.jj/</code> directory.</p>
<p><strong>Usage:</strong> <code>jj git remote &lt;COMMAND&gt;</code></p>
<h6 id="cli-reference-subcommands_5"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_5" title="Permanent link">&para;</a></h6>
<ul>
<li><code>add</code> — Add a Git remote</li>
<li><code>list</code> — List Git remotes</li>
<li><code>remove</code> — Remove a Git remote and forget its bookmarks</li>
<li><code>rename</code> — Rename a Git remote</li>
<li><code>set-url</code> — Set the URL of a Git remote</li>
</ul>
<h2 id="cli-reference-jj-git-remote-add"><code>jj git remote add</code><a class="headerlink" href="#cli-reference-jj-git-remote-add" title="Permanent link">&para;</a></h2>
<p>Add a Git remote</p>
<p><strong>Usage:</strong> <code>jj git remote add &lt;REMOTE&gt; &lt;URL&gt;</code></p>
<h6 id="cli-reference-arguments_29"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_29" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;REMOTE&gt;</code> — The remote's name</li>
<li>
<p><code>&lt;URL&gt;</code> — The remote's URL or path</p>
<p>Local path will be resolved to absolute form.</p>
</li>
</ul>
<h2 id="cli-reference-jj-git-remote-list"><code>jj git remote list</code><a class="headerlink" href="#cli-reference-jj-git-remote-list" title="Permanent link">&para;</a></h2>
<p>List Git remotes</p>
<p><strong>Usage:</strong> <code>jj git remote list</code></p>
<h2 id="cli-reference-jj-git-remote-remove"><code>jj git remote remove</code><a class="headerlink" href="#cli-reference-jj-git-remote-remove" title="Permanent link">&para;</a></h2>
<p>Remove a Git remote and forget its bookmarks</p>
<p><strong>Usage:</strong> <code>jj git remote remove &lt;REMOTE&gt;</code></p>
<h6 id="cli-reference-arguments_30"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_30" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;REMOTE&gt;</code> — The remote's name</li>
</ul>
<h2 id="cli-reference-jj-git-remote-rename"><code>jj git remote rename</code><a class="headerlink" href="#cli-reference-jj-git-remote-rename" title="Permanent link">&para;</a></h2>
<p>Rename a Git remote</p>
<p><strong>Usage:</strong> <code>jj git remote rename &lt;OLD&gt; &lt;NEW&gt;</code></p>
<h6 id="cli-reference-arguments_31"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_31" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;OLD&gt;</code> — The name of an existing remote</li>
<li><code>&lt;NEW&gt;</code> — The desired name for <code>old</code></li>
</ul>
<h2 id="cli-reference-jj-git-remote-set-url"><code>jj git remote set-url</code><a class="headerlink" href="#cli-reference-jj-git-remote-set-url" title="Permanent link">&para;</a></h2>
<p>Set the URL of a Git remote</p>
<p><strong>Usage:</strong> <code>jj git remote set-url &lt;REMOTE&gt; &lt;URL&gt;</code></p>
<h6 id="cli-reference-arguments_32"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_32" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;REMOTE&gt;</code> — The remote's name</li>
<li>
<p><code>&lt;URL&gt;</code> — The desired URL or path for <code>remote</code></p>
<p>Local path will be resolved to absolute form.</p>
</li>
</ul>
<h2 id="cli-reference-jj-git-root"><code>jj git root</code><a class="headerlink" href="#cli-reference-jj-git-root" title="Permanent link">&para;</a></h2>
<p>Show the underlying Git directory of a repository using the Git backend</p>
<p><strong>Usage:</strong> <code>jj git root</code></p>
<h2 id="cli-reference-jj-help"><code>jj help</code><a class="headerlink" href="#cli-reference-jj-help" title="Permanent link">&para;</a></h2>
<p>Print this message or the help of the given subcommand(s)</p>
<p><strong>Usage:</strong> <code>jj help [OPTIONS] [COMMAND]...</code></p>
<h6 id="cli-reference-arguments_33"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_33" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;COMMAND&gt;</code> — Print help for the subcommand(s)</li>
</ul>
<h6 id="cli-reference-options_28"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_28" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-k</code>, <code>--keyword &lt;KEYWORD&gt;</code> — Show help for keywords instead of commands</p>
<p>Possible values:</p>
<ul>
<li><code>bookmarks</code>:
  Named pointers to revisions (similar to Git's branches)</li>
<li><code>config</code>:
  How and where to set configuration options</li>
<li><code>filesets</code>:
  A functional language for selecting a set of files</li>
<li><code>glossary</code>:
  Definitions of various terms</li>
<li><code>revsets</code>:
  A functional language for selecting a set of revision</li>
<li><code>templates</code>:
  A functional language to customize command output</li>
<li><code>tutorial</code>:
  Show a tutorial to get started with jj</li>
</ul>
</li>
</ul>
<h2 id="cli-reference-jj-interdiff"><code>jj interdiff</code><a class="headerlink" href="#cli-reference-jj-interdiff" title="Permanent link">&para;</a></h2>
<p>Compare the changes of two commits</p>
<p>This excludes changes from other commits by temporarily rebasing <code>--from</code> onto <code>--to</code>'s parents. If you wish to compare the same change across versions, consider <code>jj evolog -p</code> instead.</p>
<p><strong>Usage:</strong> <code>jj interdiff [OPTIONS] &lt;--from &lt;REVSET&gt;|--to &lt;REVSET&gt;&gt; [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_34"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_34" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Restrict the diff to these paths</li>
</ul>
<h6 id="cli-reference-options_29"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_29" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-f</code>, <code>--from &lt;REVSET&gt;</code> — Show changes from this revision</li>
<li><code>-t</code>, <code>--to &lt;REVSET&gt;</code> — Show changes to this revision</li>
<li><code>-s</code>, <code>--summary</code> — For each path, show only whether it was modified, added, or deleted</li>
<li><code>--stat</code> — Show a histogram of the changes</li>
<li>
<p><code>--types</code> — For each path, show only its type before and after</p>
<p>The diff is shown as two letters. The first letter indicates the type before and the second letter indicates the type after. '-' indicates that the path was not present, 'F' represents a regular file, `L' represents a symlink, 'C' represents a conflict, and 'G' represents a Git submodule.</p>
</li>
<li>
<p><code>--name-only</code> — For each path, show only its path</p>
<p>Typically useful for shell commands like: <code>jj diff -r @- --name-only | xargs perl -pi -e's/OLD/NEW/g</code></p>
</li>
<li>
<p><code>--git</code> — Show a Git-format diff</p>
</li>
<li><code>--color-words</code> — Show a word-level diff with changes indicated only by color</li>
<li>
<p><code>--tool &lt;TOOL&gt;</code> — Generate diff by external command</p>
<p>A builtin format can also be specified as <code>:&lt;name&gt;</code>. For example, <code>--tool=:git</code> is equivalent to <code>--git</code>.</p>
</li>
<li>
<p><code>--context &lt;CONTEXT&gt;</code> — Number of lines of context to show</p>
</li>
<li><code>-w</code>, <code>--ignore-all-space</code> — Ignore whitespace when comparing lines</li>
<li><code>-b</code>, <code>--ignore-space-change</code> — Ignore changes in amount of whitespace when comparing lines</li>
</ul>
<h2 id="cli-reference-jj-log"><code>jj log</code><a class="headerlink" href="#cli-reference-jj-log" title="Permanent link">&para;</a></h2>
<p>Show revision history</p>
<p>Renders a graphical view of the project's history, ordered with children before parents. By default, the output only includes mutable revisions, along with some additional revisions for context. Use <code>jj log -r ::</code> to see all revisions. See [<code>jj help -k revsets</code>] for information about the syntax.</p>
<p>Spans of revisions that are not included in the graph per <code>--revisions</code> are rendered as a synthetic node labeled "(elided revisions)".</p>
<p>The working-copy commit is indicated by a <code>@</code> symbol in the graph. <a href="https://jj-vcs.github.io/jj/latest/config/#set-of-immutable-commits">Immutable revisions</a> have a <code>◆</code> symbol. Other commits have a <code>○</code> symbol. All of these symbols can be <a href="https://jj-vcs.github.io/jj/latest/config/#node-style">customized</a>.</p>
<p><strong>Usage:</strong> <code>jj log [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_35"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_35" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Show revisions modifying the given paths</li>
</ul>
<h6 id="cli-reference-options_30"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_30" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-r</code>, <code>--revisions &lt;REVSETS&gt;</code> — Which revisions to show</p>
<p>If no paths nor revisions are specified, this defaults to the <code>revsets.log</code> setting.</p>
</li>
<li>
<p><code>-n</code>, <code>--limit &lt;LIMIT&gt;</code> — Limit number of revisions to show</p>
<p>Applied after revisions are filtered and reordered topologically, but before being reversed.</p>
</li>
<li>
<p><code>--reversed</code> — Show revisions in the opposite order (older revisions first)</p>
</li>
<li><code>--no-graph</code> — Don't show the graph, show a flat list of revisions</li>
<li>
<p><code>-T</code>, <code>--template &lt;TEMPLATE&gt;</code> — Render each revision using the given template</p>
<p>Run <code>jj log -T</code> to list the built-in templates.</p>
<p>You can also specify arbitrary template expressions using the <a href="https://jj-vcs.github.io/jj/latest/templates/#commit-keywords">built-in keywords</a>. See [<code>jj help -k templates</code>] for more information.</p>
<p>If not specified, this defaults to the <code>templates.log</code> setting.</p>
</li>
<li>
<p><code>-p</code>, <code>--patch</code> — Show patch</p>
</li>
<li><code>-s</code>, <code>--summary</code> — For each path, show only whether it was modified, added, or deleted</li>
<li><code>--stat</code> — Show a histogram of the changes</li>
<li>
<p><code>--types</code> — For each path, show only its type before and after</p>
<p>The diff is shown as two letters. The first letter indicates the type before and the second letter indicates the type after. '-' indicates that the path was not present, 'F' represents a regular file, `L' represents a symlink, 'C' represents a conflict, and 'G' represents a Git submodule.</p>
</li>
<li>
<p><code>--name-only</code> — For each path, show only its path</p>
<p>Typically useful for shell commands like: <code>jj diff -r @- --name-only | xargs perl -pi -e's/OLD/NEW/g</code></p>
</li>
<li>
<p><code>--git</code> — Show a Git-format diff</p>
</li>
<li><code>--color-words</code> — Show a word-level diff with changes indicated only by color</li>
<li>
<p><code>--tool &lt;TOOL&gt;</code> — Generate diff by external command</p>
<p>A builtin format can also be specified as <code>:&lt;name&gt;</code>. For example, <code>--tool=:git</code> is equivalent to <code>--git</code>.</p>
</li>
<li>
<p><code>--context &lt;CONTEXT&gt;</code> — Number of lines of context to show</p>
</li>
<li><code>--ignore-all-space</code> — Ignore whitespace when comparing lines</li>
<li><code>--ignore-space-change</code> — Ignore changes in amount of whitespace when comparing lines</li>
</ul>
<h2 id="cli-reference-jj-new"><code>jj new</code><a class="headerlink" href="#cli-reference-jj-new" title="Permanent link">&para;</a></h2>
<p>Create a new, empty change and (by default) edit it in the working copy</p>
<p>By default, <code>jj</code> will edit the new change, making the <a href="https://jj-vcs.github.io/jj/latest/working-copy/">working copy</a> represent the new commit. This can be avoided with <code>--no-edit</code>.</p>
<p>Note that you can create a merge commit by specifying multiple revisions as argument. For example, <code>jj new @ main</code> will create a new commit with the working copy and the <code>main</code> bookmark as parents.</p>
<p><strong>Usage:</strong> <code>jj new [OPTIONS] [REVSETS]...</code></p>
<h6 id="cli-reference-arguments_36"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_36" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;REVSETS&gt;</code> — Parent(s) of the new change</p>
<p>Default value: <code>@</code></p>
</li>
</ul>
<h6 id="cli-reference-options_31"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_31" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-m</code>, <code>--message &lt;MESSAGE&gt;</code> — The change description to use</li>
<li><code>--no-edit</code> — Do not edit the newly created change</li>
<li>
<p><code>-A</code>, <code>--insert-after &lt;REVSETS&gt;</code> [alias: <code>after</code>] — Insert the new change after the given commit(s)</p>
<p>Example: <code>jj new --after A</code> creates a new change between <code>A</code> and its
 children:</p>
<div class="highlight"><pre><span></span><code>                B   C
                 \ /
    B   C   =&gt;    @
     \ /          |
      A           A
</code></pre></div>
<p>Specifying <code>--after</code> multiple times will relocate all children of the
 given commits.</p>
<p>Example: <code>jj new --after A --after X</code> creates a change with <code>A</code> and <code>X</code>
 as parents, and rebases all children on top of the new change:</p>
<div class="highlight"><pre><span></span><code>                B   Y
                 \ /
    B  Y    =&gt;    @
    |  |         / \
    A  X        A   X
</code></pre></div>
</li>
<li>
<p><code>-B</code>, <code>--insert-before &lt;REVSETS&gt;</code> [alias: <code>before</code>] — Insert the new change before the given commit(s)</p>
<p>Example: <code>jj new --before C</code> creates a new change between <code>C</code> and its
 parents:</p>
<div class="highlight"><pre><span></span><code>                   C
                   |
      C     =&gt;     @
     / \          / \
    A   B        A   B
</code></pre></div>
<p><code>--after</code> and <code>--before</code> can be combined.</p>
<p>Example: <code>jj new --after A --before D</code>:</p>
<div class="highlight"><pre><span></span><code>    D            D
    |           / \
    C          |   C
    |    =&gt;    @   |
    B          |   B
    |           \ /
    A            A
</code></pre></div>
<p>Similar to <code>--after</code>, you can specify <code>--before</code> multiple times.</p>
</li>
</ul>
<h2 id="cli-reference-jj-next"><code>jj next</code><a class="headerlink" href="#cli-reference-jj-next" title="Permanent link">&para;</a></h2>
<p>Move the working-copy commit to the child revision</p>
<p>The command creates a new empty working copy revision that is the child of a
descendant <code>offset</code> revisions ahead of the parent of the current working
copy.</p>
<p>For example, when the offset is 1:</p>
<div class="highlight"><pre><span></span><code>D        D @
|        |/
C @  =&gt;  C
|/       |
B        B
</code></pre></div>
<p>If <code>--edit</code> is passed, the working copy revision is changed to the child of
the current working copy revision.</p>
<div class="highlight"><pre><span></span><code>D        D
|        |
C        C
|        |
B   =&gt;   @
|        |
@        A
</code></pre></div>
<p><strong>Usage:</strong> <code>jj next [OPTIONS] [OFFSET]</code></p>
<h6 id="cli-reference-arguments_37"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_37" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;OFFSET&gt;</code> — How many revisions to move forward. Advances to the next child by default</p>
<p>Default value: <code>1</code></p>
</li>
</ul>
<h6 id="cli-reference-options_32"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_32" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-e</code>, <code>--edit</code> — Instead of creating a new working-copy commit on top of the target commit (like <code>jj new</code>), edit the target commit directly (like <code>jj edit</code>)</p>
<p>Takes precedence over config in <code>ui.movement.edit</code>; i.e. will negate <code>ui.movement.edit = false</code></p>
</li>
<li>
<p><code>-n</code>, <code>--no-edit</code> — The inverse of <code>--edit</code></p>
<p>Takes precedence over config in <code>ui.movement.edit</code>; i.e. will negate <code>ui.movement.edit = true</code></p>
</li>
<li>
<p><code>--conflict</code> — Jump to the next conflicted descendant</p>
</li>
</ul>
<h2 id="cli-reference-jj-operation"><code>jj operation</code><a class="headerlink" href="#cli-reference-jj-operation" title="Permanent link">&para;</a></h2>
<p>Commands for working with the operation log</p>
<p>See the <a href="https://jj-vcs.github.io/jj/latest/operation-log/">operation log documentation</a> for more information.</p>
<p><strong>Usage:</strong> <code>jj operation &lt;COMMAND&gt;</code></p>
<p><strong>Command Alias:</strong> <code>op</code></p>
<h6 id="cli-reference-subcommands_6"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_6" title="Permanent link">&para;</a></h6>
<ul>
<li><code>abandon</code> — Abandon operation history</li>
<li><code>diff</code> — Compare changes to the repository between two operations</li>
<li><code>log</code> — Show the operation log</li>
<li><code>restore</code> — Create a new operation that restores the repo to an earlier state</li>
<li><code>show</code> — Show changes to the repository in an operation</li>
<li><code>undo</code> — Create a new operation that undoes an earlier operation</li>
</ul>
<h2 id="cli-reference-jj-operation-abandon"><code>jj operation abandon</code><a class="headerlink" href="#cli-reference-jj-operation-abandon" title="Permanent link">&para;</a></h2>
<p>Abandon operation history</p>
<p>To discard old operation history, use <code>jj op abandon ..&lt;operation ID&gt;</code>. It will abandon the specified operation and all its ancestors. The descendants will be reparented onto the root operation.</p>
<p>To discard recent operations, use <code>jj op restore &lt;operation ID&gt;</code> followed by <code>jj op abandon &lt;operation ID&gt;..@-</code>.</p>
<p>The abandoned operations, commits, and other unreachable objects can later be garbage collected by using <code>jj util gc</code> command.</p>
<p><strong>Usage:</strong> <code>jj operation abandon &lt;OPERATION&gt;</code></p>
<h6 id="cli-reference-arguments_38"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_38" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;OPERATION&gt;</code> — The operation or operation range to abandon</li>
</ul>
<h2 id="cli-reference-jj-operation-diff"><code>jj operation diff</code><a class="headerlink" href="#cli-reference-jj-operation-diff" title="Permanent link">&para;</a></h2>
<p>Compare changes to the repository between two operations</p>
<p><strong>Usage:</strong> <code>jj operation diff [OPTIONS]</code></p>
<h6 id="cli-reference-options_33"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_33" title="Permanent link">&para;</a></h6>
<ul>
<li><code>--operation &lt;OPERATION&gt;</code> [alias: <code>op</code>] — Show repository changes in this operation, compared to its parent</li>
<li><code>-f</code>, <code>--from &lt;FROM&gt;</code> — Show repository changes from this operation</li>
<li><code>-t</code>, <code>--to &lt;TO&gt;</code> — Show repository changes to this operation</li>
<li><code>--no-graph</code> — Don't show the graph, show a flat list of modified changes</li>
<li>
<p><code>-p</code>, <code>--patch</code> — Show patch of modifications to changes</p>
<p>If the previous version has different parents, it will be temporarily rebased to the parents of the new version, so the diff is not contaminated by unrelated changes.</p>
</li>
<li>
<p><code>-s</code>, <code>--summary</code> — For each path, show only whether it was modified, added, or deleted</p>
</li>
<li><code>--stat</code> — Show a histogram of the changes</li>
<li>
<p><code>--types</code> — For each path, show only its type before and after</p>
<p>The diff is shown as two letters. The first letter indicates the type before and the second letter indicates the type after. '-' indicates that the path was not present, 'F' represents a regular file, `L' represents a symlink, 'C' represents a conflict, and 'G' represents a Git submodule.</p>
</li>
<li>
<p><code>--name-only</code> — For each path, show only its path</p>
<p>Typically useful for shell commands like: <code>jj diff -r @- --name-only | xargs perl -pi -e's/OLD/NEW/g</code></p>
</li>
<li>
<p><code>--git</code> — Show a Git-format diff</p>
</li>
<li><code>--color-words</code> — Show a word-level diff with changes indicated only by color</li>
<li>
<p><code>--tool &lt;TOOL&gt;</code> — Generate diff by external command</p>
<p>A builtin format can also be specified as <code>:&lt;name&gt;</code>. For example, <code>--tool=:git</code> is equivalent to <code>--git</code>.</p>
</li>
<li>
<p><code>--context &lt;CONTEXT&gt;</code> — Number of lines of context to show</p>
</li>
<li><code>--ignore-all-space</code> — Ignore whitespace when comparing lines</li>
<li><code>--ignore-space-change</code> — Ignore changes in amount of whitespace when comparing lines</li>
</ul>
<h2 id="cli-reference-jj-operation-log"><code>jj operation log</code><a class="headerlink" href="#cli-reference-jj-operation-log" title="Permanent link">&para;</a></h2>
<p>Show the operation log</p>
<p>Like other commands, <code>jj op log</code> snapshots the current working-copy changes and reconciles divergent operations. Use <code>--at-op=@ --ignore-working-copy</code> to inspect the current state without mutation.</p>
<p><strong>Usage:</strong> <code>jj operation log [OPTIONS]</code></p>
<h6 id="cli-reference-options_34"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_34" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-n</code>, <code>--limit &lt;LIMIT&gt;</code> — Limit number of operations to show</p>
<p>Applied after operations are reordered topologically, but before being reversed.</p>
</li>
<li>
<p><code>--reversed</code> — Show operations in the opposite order (older operations first)</p>
</li>
<li><code>--no-graph</code> — Don't show the graph, show a flat list of operations</li>
<li>
<p><code>-T</code>, <code>--template &lt;TEMPLATE&gt;</code> — Render each operation using the given template</p>
<p>You can specify arbitrary template expressions using the <a href="https://jj-vcs.github.io/jj/latest/templates/#commit-keywords">built-in keywords</a>. See [<code>jj help -k templates</code>] for more information.</p>
</li>
<li>
<p><code>-d</code>, <code>--op-diff</code> — Show changes to the repository at each operation</p>
</li>
<li>
<p><code>-p</code>, <code>--patch</code> — Show patch of modifications to changes (implies --op-diff)</p>
<p>If the previous version has different parents, it will be temporarily rebased to the parents of the new version, so the diff is not contaminated by unrelated changes.</p>
</li>
<li>
<p><code>-s</code>, <code>--summary</code> — For each path, show only whether it was modified, added, or deleted</p>
</li>
<li><code>--stat</code> — Show a histogram of the changes</li>
<li>
<p><code>--types</code> — For each path, show only its type before and after</p>
<p>The diff is shown as two letters. The first letter indicates the type before and the second letter indicates the type after. '-' indicates that the path was not present, 'F' represents a regular file, `L' represents a symlink, 'C' represents a conflict, and 'G' represents a Git submodule.</p>
</li>
<li>
<p><code>--name-only</code> — For each path, show only its path</p>
<p>Typically useful for shell commands like: <code>jj diff -r @- --name-only | xargs perl -pi -e's/OLD/NEW/g</code></p>
</li>
<li>
<p><code>--git</code> — Show a Git-format diff</p>
</li>
<li><code>--color-words</code> — Show a word-level diff with changes indicated only by color</li>
<li>
<p><code>--tool &lt;TOOL&gt;</code> — Generate diff by external command</p>
<p>A builtin format can also be specified as <code>:&lt;name&gt;</code>. For example, <code>--tool=:git</code> is equivalent to <code>--git</code>.</p>
</li>
<li>
<p><code>--context &lt;CONTEXT&gt;</code> — Number of lines of context to show</p>
</li>
<li><code>--ignore-all-space</code> — Ignore whitespace when comparing lines</li>
<li><code>--ignore-space-change</code> — Ignore changes in amount of whitespace when comparing lines</li>
</ul>
<h2 id="cli-reference-jj-operation-restore"><code>jj operation restore</code><a class="headerlink" href="#cli-reference-jj-operation-restore" title="Permanent link">&para;</a></h2>
<p>Create a new operation that restores the repo to an earlier state</p>
<p>This restores the repo to the state at the specified operation, effectively undoing all later operations. It does so by creating a new operation.</p>
<p><strong>Usage:</strong> <code>jj operation restore [OPTIONS] &lt;OPERATION&gt;</code></p>
<h6 id="cli-reference-arguments_39"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_39" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;OPERATION&gt;</code> — The operation to restore to</p>
<p>Use <code>jj op log</code> to find an operation to restore to. Use e.g. <code>jj --at-op=&lt;operation ID&gt; log</code> before restoring to an operation to see the state of the repo at that operation.</p>
</li>
</ul>
<h6 id="cli-reference-options_35"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_35" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--what &lt;WHAT&gt;</code> — What portions of the local state to restore (can be repeated)</p>
<p>This option is EXPERIMENTAL.</p>
<p>Default values: <code>repo</code>, <code>remote-tracking</code></p>
<p>Possible values:</p>
<ul>
<li><code>repo</code>:
  The jj repo state and local bookmarks</li>
<li><code>remote-tracking</code>:
  The remote-tracking bookmarks. Do not restore these if you'd like to push after the undo</li>
</ul>
</li>
</ul>
<h2 id="cli-reference-jj-operation-show"><code>jj operation show</code><a class="headerlink" href="#cli-reference-jj-operation-show" title="Permanent link">&para;</a></h2>
<p>Show changes to the repository in an operation</p>
<p><strong>Usage:</strong> <code>jj operation show [OPTIONS] [OPERATION]</code></p>
<h6 id="cli-reference-arguments_40"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_40" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;OPERATION&gt;</code> — Show repository changes in this operation, compared to its parent(s)</p>
<p>Default value: <code>@</code></p>
</li>
</ul>
<h6 id="cli-reference-options_36"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_36" title="Permanent link">&para;</a></h6>
<ul>
<li><code>--no-graph</code> — Don't show the graph, show a flat list of modified changes</li>
<li>
<p><code>-p</code>, <code>--patch</code> — Show patch of modifications to changes</p>
<p>If the previous version has different parents, it will be temporarily rebased to the parents of the new version, so the diff is not contaminated by unrelated changes.</p>
</li>
<li>
<p><code>-s</code>, <code>--summary</code> — For each path, show only whether it was modified, added, or deleted</p>
</li>
<li><code>--stat</code> — Show a histogram of the changes</li>
<li>
<p><code>--types</code> — For each path, show only its type before and after</p>
<p>The diff is shown as two letters. The first letter indicates the type before and the second letter indicates the type after. '-' indicates that the path was not present, 'F' represents a regular file, `L' represents a symlink, 'C' represents a conflict, and 'G' represents a Git submodule.</p>
</li>
<li>
<p><code>--name-only</code> — For each path, show only its path</p>
<p>Typically useful for shell commands like: <code>jj diff -r @- --name-only | xargs perl -pi -e's/OLD/NEW/g</code></p>
</li>
<li>
<p><code>--git</code> — Show a Git-format diff</p>
</li>
<li><code>--color-words</code> — Show a word-level diff with changes indicated only by color</li>
<li>
<p><code>--tool &lt;TOOL&gt;</code> — Generate diff by external command</p>
<p>A builtin format can also be specified as <code>:&lt;name&gt;</code>. For example, <code>--tool=:git</code> is equivalent to <code>--git</code>.</p>
</li>
<li>
<p><code>--context &lt;CONTEXT&gt;</code> — Number of lines of context to show</p>
</li>
<li><code>--ignore-all-space</code> — Ignore whitespace when comparing lines</li>
<li><code>--ignore-space-change</code> — Ignore changes in amount of whitespace when comparing lines</li>
</ul>
<h2 id="cli-reference-jj-operation-undo"><code>jj operation undo</code><a class="headerlink" href="#cli-reference-jj-operation-undo" title="Permanent link">&para;</a></h2>
<p>Create a new operation that undoes an earlier operation</p>
<p>This undoes an individual operation by applying the inverse of the operation.</p>
<p><strong>Usage:</strong> <code>jj operation undo [OPTIONS] [OPERATION]</code></p>
<h6 id="cli-reference-arguments_41"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_41" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;OPERATION&gt;</code> — The operation to undo</p>
<p>Use <code>jj op log</code> to find an operation to undo.</p>
<p>Default value: <code>@</code></p>
</li>
</ul>
<h6 id="cli-reference-options_37"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_37" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--what &lt;WHAT&gt;</code> — What portions of the local state to restore (can be repeated)</p>
<p>This option is EXPERIMENTAL.</p>
<p>Default values: <code>repo</code>, <code>remote-tracking</code></p>
<p>Possible values:</p>
<ul>
<li><code>repo</code>:
  The jj repo state and local bookmarks</li>
<li><code>remote-tracking</code>:
  The remote-tracking bookmarks. Do not restore these if you'd like to push after the undo</li>
</ul>
</li>
</ul>
<h2 id="cli-reference-jj-parallelize"><code>jj parallelize</code><a class="headerlink" href="#cli-reference-jj-parallelize" title="Permanent link">&para;</a></h2>
<p>Parallelize revisions by making them siblings</p>
<p>Running <code>jj parallelize 1::2</code> will transform the history like this:
<div class="highlight"><pre><span></span><code>3
|             3
2            / \
|    -&gt;     1   2
1            \ /
|             0
0
</code></pre></div></p>
<p>The command effectively says "these revisions are actually independent",
meaning that they should no longer be ancestors/descendants of each other.
However, revisions outside the set that were previously ancestors of a
revision in the set will remain ancestors of it. For example, revision 0
above remains an ancestor of both 1 and 2. Similarly,
revisions outside the set that were previously descendants of a revision
in the set will remain descendants of it. For example, revision 3 above
remains a descendant of both 1 and 2.</p>
<p>Therefore, <code>jj parallelize '1 | 3'</code> is a no-op. That's because 2, which is
not in the target set, was a descendant of 1 before, so it remains a
descendant, and it was an ancestor of 3 before, so it remains an ancestor.</p>
<p><strong>Usage:</strong> <code>jj parallelize [REVSETS]...</code></p>
<h6 id="cli-reference-arguments_42"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_42" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;REVSETS&gt;</code> — Revisions to parallelize</li>
</ul>
<h2 id="cli-reference-jj-prev"><code>jj prev</code><a class="headerlink" href="#cli-reference-jj-prev" title="Permanent link">&para;</a></h2>
<p>Change the working copy revision relative to the parent revision</p>
<p>The command creates a new empty working copy revision that is the child of
an ancestor <code>offset</code> revisions behind the parent of the current working
copy.</p>
<p>For example, when the offset is 1:</p>
<div class="highlight"><pre><span></span><code>D @      D
|/       |
A   =&gt;   A @
|        |/
B        B
</code></pre></div>
<p>If <code>--edit</code> is passed, the working copy revision is changed to the parent of
the current working copy revision.</p>
<div class="highlight"><pre><span></span><code>D @      D
|/       |
C   =&gt;   @
|        |
B        B
|        |
A        A
</code></pre></div>
<p><strong>Usage:</strong> <code>jj prev [OPTIONS] [OFFSET]</code></p>
<h6 id="cli-reference-arguments_43"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_43" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;OFFSET&gt;</code> — How many revisions to move backward. Moves to the parent by default</p>
<p>Default value: <code>1</code></p>
</li>
</ul>
<h6 id="cli-reference-options_38"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_38" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-e</code>, <code>--edit</code> — Edit the parent directly, instead of moving the working-copy commit</p>
<p>Takes precedence over config in <code>ui.movement.edit</code>; i.e. will negate <code>ui.movement.edit = false</code></p>
</li>
<li>
<p><code>-n</code>, <code>--no-edit</code> — The inverse of <code>--edit</code></p>
<p>Takes precedence over config in <code>ui.movement.edit</code>; i.e. will negate <code>ui.movement.edit = true</code></p>
</li>
<li>
<p><code>--conflict</code> — Jump to the previous conflicted ancestor</p>
</li>
</ul>
<h2 id="cli-reference-jj-rebase"><code>jj rebase</code><a class="headerlink" href="#cli-reference-jj-rebase" title="Permanent link">&para;</a></h2>
<p>Move revisions to different parent(s)</p>
<p>This command moves revisions to different parent(s) while preserving the
changes (diff) in the revisions.</p>
<p>There are three different ways of specifying which revisions to rebase:</p>
<ul>
<li><code>--source/-s</code> to rebase a revision and its descendants</li>
<li><code>--branch/-b</code> to rebase a whole branch, relative to the destination</li>
<li><code>--revisions/-r</code> to rebase the specified revisions without their
  descendants</li>
</ul>
<p>If no option is specified, it defaults to <code>-b @</code>.</p>
<p>There are three different ways of specifying where the revisions should be
rebased to:</p>
<ul>
<li><code>--destination/-d</code> to rebase the revisions onto the specified targets</li>
<li><code>--insert-after/-A</code> to rebase the revisions onto the specified targets and
  to rebase the targets' descendants onto the rebased revisions</li>
<li><code>--insert-before/-B</code> to rebase the revisions onto the specified targets'
  parents and to rebase the targets and their descendants onto the rebased
  revisions</li>
</ul>
<p>See the sections below for details about the different ways of specifying
which revisions to rebase where.</p>
<p>If a working-copy revision gets abandoned, it will be given a new, empty
revision. This is true in general; it is not specific to this command.</p>
<h3 id="cli-reference-specifying-which-revisions-to-rebase">Specifying which revisions to rebase<a class="headerlink" href="#cli-reference-specifying-which-revisions-to-rebase" title="Permanent link">&para;</a></h3>
<p>With <code>--source/-s</code>, the command rebases the specified revision and its
descendants to the destination. For example, <code>jj rebase -s M -d O</code> would
transform your history like this (letters followed by an apostrophe are
post-rebase versions):</p>
<div class="highlight"><pre><span></span><code>O           N&#39;
|           |
| N         M&#39;
| |         |
| M         O
| |    =&gt;   |
| | L       | L
| |/        | |
| K         | K
|/          |/
J           J
</code></pre></div>
<p>Each revision passed to <code>-s</code> will become a direct child of the destination,
so if you instead run <code>jj rebase -s M -s N -d O</code> (or
<code>jj rebase -s 'all:M|N' -d O</code>) in the example above, then N' would instead
be a direct child of O.</p>
<p>With <code>--branch/-b</code>, the command rebases the whole "branch" containing the
specified revision. A "branch" is the set of revisions that includes:</p>
<ul>
<li>the specified revision and ancestors that are not also ancestors of the
  destination</li>
<li>all descendants of those revisions</li>
</ul>
<p>In other words, <code>jj rebase -b X -d Y</code> rebases revisions in the revset
<code>(Y..X)::</code> (which is equivalent to <code>jj rebase -s 'roots(Y..X)' -d Y</code> for a
single root). For example, either <code>jj rebase -b L -d O</code> or <code>jj rebase -b M
-d O</code> would transform your history like this (because <code>L</code> and <code>M</code> are on the
same "branch", relative to the destination):</p>
<div class="highlight"><pre><span></span><code>O           N&#39;
|           |
| N         M&#39;
| |         |
| M         | L&#39;
| |    =&gt;   |/
| | L       K&#39;
| |/        |
| K         O
|/          |
J           J
</code></pre></div>
<p>With <code>--revisions/-r</code>, the command rebases only the specified revisions to
the destination. Any "hole" left behind will be filled by rebasing
descendants onto the specified revisions' parent(s). For example,
<code>jj rebase -r K -d M</code> would transform your history like this:</p>
<div class="highlight"><pre><span></span><code>M          K&#39;
|          |
| L        M
| |   =&gt;   |
| K        | L&#39;
|/         |/
J          J
</code></pre></div>
<p>Multiple revisions can be specified, and any dependencies (graph edges)
within the set will be preserved. For example, <code>jj rebase -r 'K|N' -d O</code>
would transform your history like this:</p>
<div class="highlight"><pre><span></span><code>O           N&#39;
|           |
| N         K&#39;
| |         |
| M         O
| |    =&gt;   |
| | L       | M&#39;
| |/        |/
| K         | L&#39;
|/          |/
J           J
</code></pre></div>
<p><code>jj rebase -s X</code> is similar to <code>jj rebase -r X::</code> and will behave the same
if X is a single revision. However, if X is a set of multiple revisions,
or if you passed multiple <code>-s</code> arguments, then <code>jj rebase -s</code> will make each
of the specified revisions an immediate child of the destination, while
<code>jj rebase -r</code> will preserve dependencies within the set.</p>
<p>Note that you can create a merge revision by repeating the <code>-d</code> argument.
For example, if you realize that revision L actually depends on revision M
in order to work (in addition to its current parent K), you can run <code>jj
rebase -s L -d K -d M</code>:</p>
<div class="highlight"><pre><span></span><code>M          L&#39;
|          |\
| L        M |
| |   =&gt;   | |
| K        | K
|/         |/
J          J
</code></pre></div>
<h3 id="cli-reference-specifying-where-to-rebase-the-revisions">Specifying where to rebase the revisions<a class="headerlink" href="#cli-reference-specifying-where-to-rebase-the-revisions" title="Permanent link">&para;</a></h3>
<p>With <code>--destination/-d</code>, the command rebases the selected revisions onto
the targets. Existing descendants of the targets will not be affected. See
the section above for examples.</p>
<p>With <code>--insert-after/-A</code>, the selected revisions will be inserted after the
targets. This is similar to <code>-d</code>, but if the targets have any existing
descendants, then those will be rebased onto the rebased selected revisions.</p>
<p>For example, <code>jj rebase -r K -A L</code> will rewrite history like this:
<div class="highlight"><pre><span></span><code>N           N&#39;
|           |
| M         | M&#39;
|/          |/
L      =&gt;   K&#39;
|           |
| K         L
|/          |
J           J
</code></pre></div></p>
<p>The <code>-A</code> (and <code>-B</code>) argument can also be used for reordering revisions. For
example, <code>jj rebase -r M -A J</code> will rewrite history like this:
<div class="highlight"><pre><span></span><code>M          L&#39;
|          |
L          K&#39;
|     =&gt;   |
K          M&#39;
|          |
J          J
</code></pre></div></p>
<p>With <code>--insert-before/-B</code>, the selected revisions will be inserted before
the targets. This is achieved by rebasing the selected revisions onto the
target revisions' parents, and then rebasing the target revisions and their
descendants onto the rebased revisions.</p>
<p>For example, <code>jj rebase -r K -B L</code> will rewrite history like this:
<div class="highlight"><pre><span></span><code>N           N&#39;
|           |
| M         | M&#39;
|/          |/
L     =&gt;    L&#39;
|           |
| K         K&#39;
|/          |
J           J
</code></pre></div></p>
<p>The <code>-A</code> and <code>-B</code> arguments can also be combined, which can be useful around
merges. For example, you can use <code>jj rebase -r K -A J -B M</code> to create a new
merge (but <code>jj rebase -r M -d L -d K</code> might be simpler in this particular
case):
<div class="highlight"><pre><span></span><code>M           M&#39;
|           |\
L           L |
|     =&gt;    | |
| K         | K&#39;
|/          |/
J           J
</code></pre></div></p>
<p>To insert a commit inside an existing merge with <code>jj rebase -r O -A K -B M</code>:
<div class="highlight"><pre><span></span><code>O           N&#39;
|           |\
N           | M&#39;
|\          | |\
| M         | O&#39;|
| |    =&gt;   |/ /
| L         | L
| |         | |
K |         K |
|/          |/
J           J
</code></pre></div></p>
<p><strong>Usage:</strong> <code>jj rebase [OPTIONS] &lt;--destination &lt;REVSETS&gt;|--insert-after &lt;REVSETS&gt;|--insert-before &lt;REVSETS&gt;&gt;</code></p>
<h6 id="cli-reference-options_39"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_39" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-b</code>, <code>--branch &lt;REVSETS&gt;</code> — Rebase the whole branch relative to destination's ancestors (can be repeated)</p>
<p><code>jj rebase -b=br -d=dst</code> is equivalent to <code>jj rebase '-s=roots(dst..br)' -d=dst</code>.</p>
<p>If none of <code>-b</code>, <code>-s</code>, or <code>-r</code> is provided, then the default is <code>-b @</code>.</p>
</li>
<li>
<p><code>-s</code>, <code>--source &lt;REVSETS&gt;</code> — Rebase specified revision(s) together with their trees of descendants (can be repeated)</p>
<p>Each specified revision will become a direct child of the destination revision(s), even if some of the source revisions are descendants of others.</p>
<p>If none of <code>-b</code>, <code>-s</code>, or <code>-r</code> is provided, then the default is <code>-b @</code>.</p>
</li>
<li>
<p><code>-r</code>, <code>--revisions &lt;REVSETS&gt;</code> — Rebase the given revisions, rebasing descendants onto this revision's parent(s)</p>
<p>Unlike <code>-s</code> or <code>-b</code>, you may <code>jj rebase -r</code> a revision <code>A</code> onto a descendant of <code>A</code>.</p>
<p>If none of <code>-b</code>, <code>-s</code>, or <code>-r</code> is provided, then the default is <code>-b @</code>.</p>
</li>
<li>
<p><code>-d</code>, <code>--destination &lt;REVSETS&gt;</code> — The revision(s) to rebase onto (can be repeated to create a merge commit)</p>
</li>
<li><code>-A</code>, <code>--insert-after &lt;REVSETS&gt;</code> [alias: <code>after</code>] — The revision(s) to insert after (can be repeated to create a merge commit)</li>
<li><code>-B</code>, <code>--insert-before &lt;REVSETS&gt;</code> [alias: <code>before</code>] — The revision(s) to insert before (can be repeated to create a merge commit)</li>
<li><code>--skip-emptied</code> — If true, when rebasing would produce an empty commit, the commit is abandoned. It will not be abandoned if it was already empty before the rebase. Will never skip merge commits with multiple non-empty parents</li>
<li>
<p><code>--keep-divergent</code> — Keep divergent commits while rebasing</p>
<p>Without this flag, divergent commits are abandoned while rebasing if another commit with the same change ID is already present in the destination with identical changes.</p>
</li>
</ul>
<h2 id="cli-reference-jj-resolve"><code>jj resolve</code><a class="headerlink" href="#cli-reference-jj-resolve" title="Permanent link">&para;</a></h2>
<p>Resolve conflicted files with an external merge tool</p>
<p>Only conflicts that can be resolved with a 3-way merge are supported. See docs for merge tool configuration instructions. External merge tools will be invoked for each conflicted file one-by-one until all conflicts are resolved. To stop resolving conflicts, exit the merge tool without making any changes.</p>
<p>Note that conflicts can also be resolved without using this command. You may edit the conflict markers in the conflicted file directly with a text editor.</p>
<p><strong>Usage:</strong> <code>jj resolve [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_44"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_44" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Only resolve conflicts in these paths. You can use the <code>--list</code> argument to find paths to use here</li>
</ul>
<h6 id="cli-reference-options_40"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_40" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-r</code>, <code>--revision &lt;REVSET&gt;</code></p>
<p>Default value: <code>@</code></p>
</li>
<li>
<p><code>-l</code>, <code>--list</code> — Instead of resolving conflicts, list all the conflicts</p>
</li>
<li>
<p><code>--tool &lt;NAME&gt;</code> — Specify 3-way merge tool to be used</p>
<p>The built-in merge tools <code>:ours</code> and <code>:theirs</code> can be used to choose side #1 and side #2 of the conflict respectively.</p>
</li>
</ul>
<h2 id="cli-reference-jj-restore"><code>jj restore</code><a class="headerlink" href="#cli-reference-jj-restore" title="Permanent link">&para;</a></h2>
<p>Restore paths from another revision</p>
<p>That means that the paths get the same content in the destination (<code>--to</code>) as they had in the source (<code>--from</code>). This is typically used for undoing changes to some paths in the working copy (<code>jj restore &lt;paths&gt;</code>).</p>
<p>If only one of <code>--from</code> or <code>--to</code> is specified, the other one defaults to the working copy.</p>
<p>When neither <code>--from</code> nor <code>--to</code> is specified, the command restores into the working copy from its parent(s). <code>jj restore</code> without arguments is similar to <code>jj abandon</code>, except that it leaves an empty revision with its description and other metadata preserved.</p>
<p>See <code>jj diffedit</code> if you'd like to restore portions of files rather than entire files.</p>
<p><strong>Usage:</strong> <code>jj restore [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_45"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_45" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Restore only these paths (instead of all paths)</li>
</ul>
<h6 id="cli-reference-options_41"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_41" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-f</code>, <code>--from &lt;REVSET&gt;</code> — Revision to restore from (source)</li>
<li><code>-t</code>, <code>--into &lt;REVSET&gt;</code> [alias: <code>to</code>] — Revision to restore into (destination)</li>
<li>
<p><code>-c</code>, <code>--changes-in &lt;REVSET&gt;</code> — Undo the changes in a revision as compared to the merge of its parents.</p>
<p>This undoes the changes that can be seen with <code>jj diff -r REVSET</code>. If <code>REVSET</code> only has a single parent, this option is equivalent to <code>jj restore --into REVSET --from REVSET-</code>.</p>
<p>The default behavior of <code>jj restore</code> is equivalent to <code>jj restore --changes-in @</code>.</p>
</li>
<li>
<p><code>-i</code>, <code>--interactive</code> — Interactively choose which parts to restore</p>
</li>
<li><code>--tool &lt;NAME&gt;</code> — Specify diff editor to be used (implies --interactive)</li>
<li><code>--restore-descendants</code> — Preserve the content (not the diff) when rebasing descendants</li>
</ul>
<h2 id="cli-reference-jj-revert"><code>jj revert</code><a class="headerlink" href="#cli-reference-jj-revert" title="Permanent link">&para;</a></h2>
<p>Apply the reverse of the given revision(s)</p>
<p>The reverse of each of the given revisions is applied sequentially in reverse topological order at the given location.</p>
<p>The description of the new revisions can be customized with the <code>templates.revert_description</code> config variable.</p>
<p><strong>Usage:</strong> <code>jj revert [OPTIONS] &lt;--destination &lt;REVSETS&gt;|--insert-after &lt;REVSETS&gt;|--insert-before &lt;REVSETS&gt;&gt;</code></p>
<h6 id="cli-reference-options_42"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_42" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-r</code>, <code>--revisions &lt;REVSETS&gt;</code> — The revision(s) to apply the reverse of</li>
<li><code>-d</code>, <code>--destination &lt;REVSETS&gt;</code> — The revision(s) to apply the reverse changes on top of</li>
<li><code>-A</code>, <code>--insert-after &lt;REVSETS&gt;</code> [alias: <code>after</code>] — The revision(s) to insert the reverse changes after (can be repeated to create a merge commit)</li>
<li><code>-B</code>, <code>--insert-before &lt;REVSETS&gt;</code> [alias: <code>before</code>] — The revision(s) to insert the reverse changes before (can be repeated to create a merge commit)</li>
</ul>
<h2 id="cli-reference-jj-root"><code>jj root</code><a class="headerlink" href="#cli-reference-jj-root" title="Permanent link">&para;</a></h2>
<p>Show the current workspace root directory (shortcut for <code>jj workspace root</code>)</p>
<p><strong>Usage:</strong> <code>jj root</code></p>
<h2 id="cli-reference-jj-show"><code>jj show</code><a class="headerlink" href="#cli-reference-jj-show" title="Permanent link">&para;</a></h2>
<p>Show commit description and changes in a revision</p>
<p><strong>Usage:</strong> <code>jj show [OPTIONS] [REVSET]</code></p>
<h6 id="cli-reference-arguments_46"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_46" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;REVSET&gt;</code> — Show changes in this revision, compared to its parent(s)</p>
<p>Default value: <code>@</code></p>
</li>
</ul>
<h6 id="cli-reference-options_43"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_43" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-T</code>, <code>--template &lt;TEMPLATE&gt;</code> — Render a revision using the given template</p>
<p>You can specify arbitrary template expressions using the <a href="https://jj-vcs.github.io/jj/latest/templates/#commit-keywords">built-in keywords</a>. See [<code>jj help -k templates</code>] for more information.</p>
</li>
<li>
<p><code>-s</code>, <code>--summary</code> — For each path, show only whether it was modified, added, or deleted</p>
</li>
<li><code>--stat</code> — Show a histogram of the changes</li>
<li>
<p><code>--types</code> — For each path, show only its type before and after</p>
<p>The diff is shown as two letters. The first letter indicates the type before and the second letter indicates the type after. '-' indicates that the path was not present, 'F' represents a regular file, `L' represents a symlink, 'C' represents a conflict, and 'G' represents a Git submodule.</p>
</li>
<li>
<p><code>--name-only</code> — For each path, show only its path</p>
<p>Typically useful for shell commands like: <code>jj diff -r @- --name-only | xargs perl -pi -e's/OLD/NEW/g</code></p>
</li>
<li>
<p><code>--git</code> — Show a Git-format diff</p>
</li>
<li><code>--color-words</code> — Show a word-level diff with changes indicated only by color</li>
<li>
<p><code>--tool &lt;TOOL&gt;</code> — Generate diff by external command</p>
<p>A builtin format can also be specified as <code>:&lt;name&gt;</code>. For example, <code>--tool=:git</code> is equivalent to <code>--git</code>.</p>
</li>
<li>
<p><code>--context &lt;CONTEXT&gt;</code> — Number of lines of context to show</p>
</li>
<li><code>--ignore-all-space</code> — Ignore whitespace when comparing lines</li>
<li><code>--ignore-space-change</code> — Ignore changes in amount of whitespace when comparing lines</li>
<li><code>--no-patch</code> — Do not show the patch</li>
</ul>
<h2 id="cli-reference-jj-sign"><code>jj sign</code><a class="headerlink" href="#cli-reference-jj-sign" title="Permanent link">&para;</a></h2>
<p>Cryptographically sign a revision</p>
<p>This command requires configuring a <a href="https://jj-vcs.github.io/jj/latest/config/#commit-signing">commit signing</a> backend.</p>
<p><strong>Usage:</strong> <code>jj sign [OPTIONS]</code></p>
<h6 id="cli-reference-options_44"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_44" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-r</code>, <code>--revisions &lt;REVSETS&gt;</code> — What revision(s) to sign</p>
<p>If no revisions are specified, this defaults to the <code>revsets.sign</code> setting.</p>
<p>Note that revisions are always re-signed.</p>
<p>While that leads to discomfort for users, which sign with hardware devices, as of now we cannot reliably check if a commit is already signed by the user without creating a signature (see <a href="https://github.com/jj-vcs/jj/issues/5786">#5786</a>).</p>
</li>
<li>
<p><code>--key &lt;KEY&gt;</code> — The key used for signing</p>
</li>
</ul>
<h2 id="cli-reference-jj-simplify-parents"><code>jj simplify-parents</code><a class="headerlink" href="#cli-reference-jj-simplify-parents" title="Permanent link">&para;</a></h2>
<p>Simplify parent edges for the specified revision(s).</p>
<p>Removes all parents of each of the specified revisions that are also indirect ancestors of the same revisions through other parents. This has no effect on any revision's contents, including the working copy.</p>
<p>In other words, for all (A, B, C) where A has (B, C) as parents and C is an ancestor of B, A will be rewritten to have only B as a parent instead of B+C.</p>
<p><strong>Usage:</strong> <code>jj simplify-parents [OPTIONS]</code></p>
<h6 id="cli-reference-options_45"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_45" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-s</code>, <code>--source &lt;REVSETS&gt;</code> — Simplify specified revision(s) together with their trees of descendants (can be repeated)</li>
<li>
<p><code>-r</code>, <code>--revisions &lt;REVSETS&gt;</code> — Simplify specified revision(s) (can be repeated)</p>
<p>If both <code>--source</code> and <code>--revisions</code> are not provided, this defaults to the <code>revsets.simplify-parents</code> setting, or <code>reachable(@, mutable())</code> if it is not set.</p>
</li>
</ul>
<h2 id="cli-reference-jj-sparse"><code>jj sparse</code><a class="headerlink" href="#cli-reference-jj-sparse" title="Permanent link">&para;</a></h2>
<p>Manage which paths from the working-copy commit are present in the working copy</p>
<p><strong>Usage:</strong> <code>jj sparse &lt;COMMAND&gt;</code></p>
<h6 id="cli-reference-subcommands_7"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_7" title="Permanent link">&para;</a></h6>
<ul>
<li><code>edit</code> — Start an editor to update the patterns that are present in the working copy</li>
<li><code>list</code> — List the patterns that are currently present in the working copy</li>
<li><code>reset</code> — Reset the patterns to include all files in the working copy</li>
<li><code>set</code> — Update the patterns that are present in the working copy</li>
</ul>
<h2 id="cli-reference-jj-sparse-edit"><code>jj sparse edit</code><a class="headerlink" href="#cli-reference-jj-sparse-edit" title="Permanent link">&para;</a></h2>
<p>Start an editor to update the patterns that are present in the working copy</p>
<p><strong>Usage:</strong> <code>jj sparse edit</code></p>
<h2 id="cli-reference-jj-sparse-list"><code>jj sparse list</code><a class="headerlink" href="#cli-reference-jj-sparse-list" title="Permanent link">&para;</a></h2>
<p>List the patterns that are currently present in the working copy</p>
<p>By default, a newly cloned or initialized repo will have have a pattern matching all files from the repo root. That pattern is rendered as <code>.</code> (a single period).</p>
<p><strong>Usage:</strong> <code>jj sparse list</code></p>
<h2 id="cli-reference-jj-sparse-reset"><code>jj sparse reset</code><a class="headerlink" href="#cli-reference-jj-sparse-reset" title="Permanent link">&para;</a></h2>
<p>Reset the patterns to include all files in the working copy</p>
<p><strong>Usage:</strong> <code>jj sparse reset</code></p>
<h2 id="cli-reference-jj-sparse-set"><code>jj sparse set</code><a class="headerlink" href="#cli-reference-jj-sparse-set" title="Permanent link">&para;</a></h2>
<p>Update the patterns that are present in the working copy</p>
<p>For example, if all you need is the <code>README.md</code> and the <code>lib/</code> directory, use <code>jj sparse set --clear --add README.md --add lib</code>. If you no longer need the <code>lib</code> directory, use <code>jj sparse set --remove lib</code>.</p>
<p><strong>Usage:</strong> <code>jj sparse set [OPTIONS]</code></p>
<h6 id="cli-reference-options_46"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_46" title="Permanent link">&para;</a></h6>
<ul>
<li><code>--add &lt;ADD&gt;</code> — Patterns to add to the working copy</li>
<li><code>--remove &lt;REMOVE&gt;</code> — Patterns to remove from the working copy</li>
<li><code>--clear</code> — Include no files in the working copy (combine with --add)</li>
</ul>
<h2 id="cli-reference-jj-split"><code>jj split</code><a class="headerlink" href="#cli-reference-jj-split" title="Permanent link">&para;</a></h2>
<p>Split a revision in two</p>
<p>Starts a <a href="https://jj-vcs.github.io/jj/latest/config/#editing-diffs">diff editor</a> on the changes in the revision. Edit the right side of the diff until it has the content you want in the new revision. Once you close the editor, your edited content will replace the previous revision. The remaining changes will be put in a new revision on top.</p>
<p>If the change you split had a description, you will be asked to enter a change description for each commit. If the change did not have a description, the remaining changes will not get a description, and you will be asked for a description only for the selected changes.</p>
<p>Splitting an empty commit is not supported because the same effect can be achieved with <code>jj new</code>.</p>
<p><strong>Usage:</strong> <code>jj split [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_47"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_47" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Files matching any of these filesets are put in the selected changes</li>
</ul>
<h6 id="cli-reference-options_47"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_47" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-i</code>, <code>--interactive</code> — Interactively choose which parts to split</p>
<p>This is the default if no filesets are provided.</p>
</li>
<li>
<p><code>--tool &lt;NAME&gt;</code> — Specify diff editor to be used (implies --interactive)</p>
</li>
<li>
<p><code>-r</code>, <code>--revision &lt;REVSET&gt;</code> — The revision to split</p>
<p>Default value: <code>@</code></p>
</li>
<li>
<p><code>-d</code>, <code>--destination &lt;REVSETS&gt;</code> — The revision(s) to rebase onto (can be repeated to create a merge commit)</p>
</li>
<li><code>-A</code>, <code>--insert-after &lt;REVSETS&gt;</code> [alias: <code>after</code>] — The revision(s) to insert after (can be repeated to create a merge commit)</li>
<li><code>-B</code>, <code>--insert-before &lt;REVSETS&gt;</code> [alias: <code>before</code>] — The revision(s) to insert before (can be repeated to create a merge commit)</li>
<li>
<p><code>-m</code>, <code>--message &lt;MESSAGE&gt;</code> — The change description to use (don't open editor)</p>
<p>The description is used for the commit with the selected changes. The source commit description is kept unchanged.</p>
</li>
<li>
<p><code>-p</code>, <code>--parallel</code> — Split the revision into two parallel revisions instead of a parent and child</p>
</li>
</ul>
<h2 id="cli-reference-jj-squash"><code>jj squash</code><a class="headerlink" href="#cli-reference-jj-squash" title="Permanent link">&para;</a></h2>
<p>Move changes from a revision into another revision</p>
<p>With the <code>-r</code> option, moves the changes from the specified revision to the parent revision. Fails if there are several parent revisions (i.e., the given revision is a merge).</p>
<p>With the <code>--from</code> and/or <code>--into</code> options, moves changes from/to the given revisions. If either is left out, it defaults to the working-copy commit. For example, <code>jj squash --into @--</code> moves changes from the working-copy commit to the grandparent.</p>
<p>If, after moving changes out, the source revision is empty compared to its parent(s), and <code>--keep-emptied</code> is not set, it will be abandoned. Without <code>--interactive</code> or paths, the source revision will always be empty.</p>
<p>If the source was abandoned and both the source and destination had a non-empty description, you will be asked for the combined description. If either was empty, then the other one will be used.</p>
<p>If a working-copy commit gets abandoned, it will be given a new, empty commit. This is true in general; it is not specific to this command.</p>
<p><strong>Usage:</strong> <code>jj squash [OPTIONS] [FILESETS]...</code></p>
<h6 id="cli-reference-arguments_48"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_48" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Move only changes to these paths (instead of all paths)</li>
</ul>
<h6 id="cli-reference-options_48"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_48" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-r</code>, <code>--revision &lt;REVSET&gt;</code> — Revision to squash into its parent (default: @)</li>
<li><code>-f</code>, <code>--from &lt;REVSETS&gt;</code> — Revision(s) to squash from (default: @)</li>
<li><code>-t</code>, <code>--into &lt;REVSET&gt;</code> [alias: <code>to</code>] — Revision to squash into (default: @)</li>
<li><code>-m</code>, <code>--message &lt;MESSAGE&gt;</code> — The description to use for squashed revision (don't open editor)</li>
<li><code>-u</code>, <code>--use-destination-message</code> — Use the description of the destination revision and discard the description(s) of the source revision(s)</li>
<li><code>-i</code>, <code>--interactive</code> — Interactively choose which parts to squash</li>
<li><code>--tool &lt;NAME&gt;</code> — Specify diff editor to be used (implies --interactive)</li>
<li><code>-k</code>, <code>--keep-emptied</code> — The source revision will not be abandoned</li>
</ul>
<h2 id="cli-reference-jj-status"><code>jj status</code><a class="headerlink" href="#cli-reference-jj-status" title="Permanent link">&para;</a></h2>
<p>Show high-level repo status</p>
<p>This includes:</p>
<ul>
<li>The working copy commit and its parents, and a summary of the changes in the working copy (compared to the merged parents) * Conflicts in the working copy * <a href="https://jj-vcs.github.io/jj/latest/bookmarks/#conflicts">Conflicted bookmarks</a></li>
</ul>
<p><strong>Usage:</strong> <code>jj status [FILESETS]...</code></p>
<p><strong>Command Alias:</strong> <code>st</code></p>
<h6 id="cli-reference-arguments_49"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_49" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;FILESETS&gt;</code> — Restrict the status display to these paths</li>
</ul>
<h2 id="cli-reference-jj-tag"><code>jj tag</code><a class="headerlink" href="#cli-reference-jj-tag" title="Permanent link">&para;</a></h2>
<p>Manage tags</p>
<p><strong>Usage:</strong> <code>jj tag &lt;COMMAND&gt;</code></p>
<h6 id="cli-reference-subcommands_8"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_8" title="Permanent link">&para;</a></h6>
<ul>
<li><code>list</code> — List tags</li>
</ul>
<h2 id="cli-reference-jj-tag-list"><code>jj tag list</code><a class="headerlink" href="#cli-reference-jj-tag-list" title="Permanent link">&para;</a></h2>
<p>List tags</p>
<p><strong>Usage:</strong> <code>jj tag list [OPTIONS] [NAMES]...</code></p>
<p><strong>Command Alias:</strong> <code>l</code></p>
<h6 id="cli-reference-arguments_50"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_50" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;NAMES&gt;</code> — Show tags whose local name matches</p>
<p>By default, the specified name matches exactly. Use <code>glob:</code> prefix to select tags by <a href="https://jj-vcs.github.io/jj/latest/revsets/#string-patterns">wildcard pattern</a>.</p>
</li>
</ul>
<h6 id="cli-reference-options_49"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_49" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>-T</code>, <code>--template &lt;TEMPLATE&gt;</code> — Render each tag using the given template</p>
<p>All 0-argument methods of the [<code>CommitRef</code> type] are available as keywords in the template expression. See [<code>jj help -k templates</code>] for more information.</p>
</li>
</ul>
<h2 id="cli-reference-jj-undo"><code>jj undo</code><a class="headerlink" href="#cli-reference-jj-undo" title="Permanent link">&para;</a></h2>
<p>Undo an operation (shortcut for <code>jj op undo</code>)</p>
<p><strong>Usage:</strong> <code>jj undo [OPTIONS] [OPERATION]</code></p>
<h6 id="cli-reference-arguments_51"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_51" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;OPERATION&gt;</code> — The operation to undo</p>
<p>Use <code>jj op log</code> to find an operation to undo.</p>
<p>Default value: <code>@</code></p>
</li>
</ul>
<h6 id="cli-reference-options_50"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_50" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--what &lt;WHAT&gt;</code> — What portions of the local state to restore (can be repeated)</p>
<p>This option is EXPERIMENTAL.</p>
<p>Default values: <code>repo</code>, <code>remote-tracking</code></p>
<p>Possible values:</p>
<ul>
<li><code>repo</code>:
  The jj repo state and local bookmarks</li>
<li><code>remote-tracking</code>:
  The remote-tracking bookmarks. Do not restore these if you'd like to push after the undo</li>
</ul>
</li>
</ul>
<h2 id="cli-reference-jj-unsign"><code>jj unsign</code><a class="headerlink" href="#cli-reference-jj-unsign" title="Permanent link">&para;</a></h2>
<p>Drop a cryptographic signature</p>
<p>See also <a href="https://jj-vcs.github.io/jj/latest/config/#commit-signing">commit signing</a> docs.</p>
<p><strong>Usage:</strong> <code>jj unsign [OPTIONS]</code></p>
<h6 id="cli-reference-options_51"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_51" title="Permanent link">&para;</a></h6>
<ul>
<li><code>-r</code>, <code>--revisions &lt;REVSETS&gt;</code> — What revision(s) to unsign</li>
</ul>
<h2 id="cli-reference-jj-util"><code>jj util</code><a class="headerlink" href="#cli-reference-jj-util" title="Permanent link">&para;</a></h2>
<p>Infrequently used commands such as for generating shell completions</p>
<p><strong>Usage:</strong> <code>jj util &lt;COMMAND&gt;</code></p>
<h6 id="cli-reference-subcommands_9"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_9" title="Permanent link">&para;</a></h6>
<ul>
<li><code>completion</code> — Print a command-line-completion script</li>
<li><code>config-schema</code> — Print the JSON schema for the jj TOML config format</li>
<li><code>exec</code> — Execute an external command via jj</li>
<li><code>gc</code> — Run backend-dependent garbage collection</li>
<li><code>install-man-pages</code> — Install Jujutsu's manpages to the provided path</li>
<li><code>markdown-help</code> — Print the CLI help for all subcommands in Markdown</li>
</ul>
<h2 id="cli-reference-jj-util-completion"><code>jj util completion</code><a class="headerlink" href="#cli-reference-jj-util-completion" title="Permanent link">&para;</a></h2>
<p>Print a command-line-completion script</p>
<p>Apply it by running one of these:</p>
<ul>
<li>Bash: <code>source &lt;(jj util completion bash)</code></li>
<li>Fish: <code>jj util completion fish | source</code></li>
<li>Nushell:
    <div class="highlight"><pre><span></span><code>jj util completion nushell | save &quot;completions-jj.nu&quot;
use &quot;completions-jj.nu&quot; *  # Or `source &quot;completions-jj.nu&quot;`
</code></pre></div></li>
<li>Zsh:
    <div class="highlight"><pre><span></span><code>autoload<span class="w"> </span>-U<span class="w"> </span>compinit
compinit
<span class="nb">source</span><span class="w"> </span>&lt;<span class="o">(</span>jj<span class="w"> </span>util<span class="w"> </span>completion<span class="w"> </span>zsh<span class="o">)</span>
</code></pre></div></li>
</ul>
<p><strong>Usage:</strong> <code>jj util completion [SHELL]</code></p>
<h6 id="cli-reference-arguments_52"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_52" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>&lt;SHELL&gt;</code></p>
<p>Possible values: <code>bash</code>, <code>elvish</code>, <code>fish</code>, <code>nushell</code>, <code>power-shell</code>, <code>zsh</code></p>
</li>
</ul>
<h2 id="cli-reference-jj-util-config-schema"><code>jj util config-schema</code><a class="headerlink" href="#cli-reference-jj-util-config-schema" title="Permanent link">&para;</a></h2>
<p>Print the JSON schema for the jj TOML config format</p>
<p><strong>Usage:</strong> <code>jj util config-schema</code></p>
<h2 id="cli-reference-jj-util-exec"><code>jj util exec</code><a class="headerlink" href="#cli-reference-jj-util-exec" title="Permanent link">&para;</a></h2>
<p>Execute an external command via jj</p>
<p>This is useful for arbitrary aliases.</p>
<p>!! WARNING !!</p>
<p>The following technique just provides a convenient syntax for running
arbitrary code on your system. Using it irresponsibly may cause damage
ranging from breaking the behavior of <code>jj undo</code> to wiping your file system.
Exercise the same amount of caution while writing these aliases as you would
when typing commands into the terminal!</p>
<p>This feature may be removed or replaced by an embedded scripting language in
the future.</p>
<p>Let's assume you have a script called "my-jj-script" in you $PATH and you
would like to execute it as "jj my-script". You would add the following line
to your configuration file to achieve that:</p>
<div class="highlight"><pre><span></span><code><span class="k">[aliases]</span>
<span class="n">my-script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;util&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;exec&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;my-jj-script&quot;</span><span class="p">]</span>
<span class="c1">#                            ^^^^</span>
<span class="c1"># This makes sure that flags are passed to your script instead of parsed by jj.</span>
</code></pre></div>
<p>If you don't want to manage your script as a separate file, you can even
inline it into your config file:</p>
<div class="highlight"><pre><span></span><code><span class="k">[aliases]</span>
<span class="n">my-inline-script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;util&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;exec&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bash&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">set -euo pipefail</span>
<span class="s2">echo &quot;Look Ma, everything in one file!&quot;</span>
<span class="s2">echo &quot;args: $@&quot;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="c1">#    ^^</span>
<span class="c1"># This last empty string will become &quot;$0&quot; in bash, so your actual arguments</span>
<span class="c1"># are all included in &quot;$@&quot; and start at &quot;$1&quot; as expected.</span>
</code></pre></div>
<blockquote>
<p>Note: Shebangs (e.g. <code>#!/usr/bin/env</code>) aren't necessary since you're
already explicitly passing your script into the right shell.</p>
</blockquote>
<p><strong>Usage:</strong> <code>jj util exec &lt;COMMAND&gt; [ARGS]...</code></p>
<h6 id="cli-reference-arguments_53"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_53" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;COMMAND&gt;</code> — External command to execute</li>
<li><code>&lt;ARGS&gt;</code> — Arguments to pass to the external command</li>
</ul>
<h2 id="cli-reference-jj-util-gc"><code>jj util gc</code><a class="headerlink" href="#cli-reference-jj-util-gc" title="Permanent link">&para;</a></h2>
<p>Run backend-dependent garbage collection.</p>
<p>To garbage-collect old operations and the commits/objects referenced by them, run <code>jj op abandon ..&lt;some old operation&gt;</code> before <code>jj util gc</code>.</p>
<p>Previous versions of a change that are reachable via the evolution log are not garbage-collected.</p>
<p><strong>Usage:</strong> <code>jj util gc [OPTIONS]</code></p>
<h6 id="cli-reference-options_52"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_52" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--expire &lt;EXPIRE&gt;</code> — Time threshold</p>
<p>By default, only obsolete objects and operations older than 2 weeks are pruned.</p>
<p>Only the string "now" can be passed to this parameter. Support for arbitrary absolute and relative timestamps will come in a subsequent release.</p>
</li>
</ul>
<h2 id="cli-reference-jj-util-install-man-pages"><code>jj util install-man-pages</code><a class="headerlink" href="#cli-reference-jj-util-install-man-pages" title="Permanent link">&para;</a></h2>
<p>Install Jujutsu's manpages to the provided path</p>
<p><strong>Usage:</strong> <code>jj util install-man-pages &lt;PATH&gt;</code></p>
<h6 id="cli-reference-arguments_54"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_54" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;PATH&gt;</code> — The path where manpages will installed. An example path might be <code>/usr/share/man</code>. The provided path will be appended with <code>man1</code>, etc., as appropriate</li>
</ul>
<h2 id="cli-reference-jj-util-markdown-help"><code>jj util markdown-help</code><a class="headerlink" href="#cli-reference-jj-util-markdown-help" title="Permanent link">&para;</a></h2>
<p>Print the CLI help for all subcommands in Markdown</p>
<p><strong>Usage:</strong> <code>jj util markdown-help</code></p>
<h2 id="cli-reference-jj-version"><code>jj version</code><a class="headerlink" href="#cli-reference-jj-version" title="Permanent link">&para;</a></h2>
<p>Display version information</p>
<p><strong>Usage:</strong> <code>jj version</code></p>
<h2 id="cli-reference-jj-workspace"><code>jj workspace</code><a class="headerlink" href="#cli-reference-jj-workspace" title="Permanent link">&para;</a></h2>
<p>Commands for working with workspaces</p>
<p>Workspaces let you add additional working copies attached to the same repo. A common use case is so you can run a slow build or test in one workspace while you're continuing to write code in another workspace.</p>
<p>Each workspace has its own working-copy commit. When you have more than one workspace attached to a repo, they are indicated by <code>&lt;workspace name&gt;@</code> in <code>jj log</code>.</p>
<p>Each workspace also has own sparse patterns.</p>
<p><strong>Usage:</strong> <code>jj workspace &lt;COMMAND&gt;</code></p>
<h6 id="cli-reference-subcommands_10"><strong>Subcommands:</strong><a class="headerlink" href="#cli-reference-subcommands_10" title="Permanent link">&para;</a></h6>
<ul>
<li><code>add</code> — Add a workspace</li>
<li><code>forget</code> — Stop tracking a workspace's working-copy commit in the repo</li>
<li><code>list</code> — List workspaces</li>
<li><code>rename</code> — Renames the current workspace</li>
<li><code>root</code> — Show the current workspace root directory</li>
<li><code>update-stale</code> — Update a workspace that has become stale</li>
</ul>
<h2 id="cli-reference-jj-workspace-add"><code>jj workspace add</code><a class="headerlink" href="#cli-reference-jj-workspace-add" title="Permanent link">&para;</a></h2>
<p>Add a workspace</p>
<p>By default, the new workspace inherits the sparse patterns of the current workspace. You can override this with the <code>--sparse-patterns</code> option.</p>
<p><strong>Usage:</strong> <code>jj workspace add [OPTIONS] &lt;DESTINATION&gt;</code></p>
<h6 id="cli-reference-arguments_55"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_55" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;DESTINATION&gt;</code> — Where to create the new workspace</li>
</ul>
<h6 id="cli-reference-options_53"><strong>Options:</strong><a class="headerlink" href="#cli-reference-options_53" title="Permanent link">&para;</a></h6>
<ul>
<li>
<p><code>--name &lt;NAME&gt;</code> — A name for the workspace</p>
<p>To override the default, which is the basename of the destination directory.</p>
</li>
<li>
<p><code>-r</code>, <code>--revision &lt;REVSETS&gt;</code> — A list of parent revisions for the working-copy commit of the newly created workspace. You may specify nothing, or any number of parents.</p>
<p>If no revisions are specified, the new workspace will be created, and its working-copy commit will exist on top of the parent(s) of the working-copy commit in the current workspace, i.e. they will share the same parent(s).</p>
<p>If any revisions are specified, the new workspace will be created, and the new working-copy commit will be created with all these revisions as parents, i.e. the working-copy commit will exist as if you had run <code>jj new r1 r2 r3 ...</code>.</p>
</li>
<li>
<p><code>--sparse-patterns &lt;SPARSE_PATTERNS&gt;</code> — How to handle sparse patterns when creating a new workspace</p>
<p>Default value: <code>copy</code></p>
<p>Possible values:</p>
<ul>
<li><code>copy</code>:
  Copy all sparse patterns from the current workspace</li>
<li><code>full</code>:
  Include all files in the new workspace</li>
<li><code>empty</code>:
  Clear all files from the workspace (it will be empty)</li>
</ul>
</li>
</ul>
<h2 id="cli-reference-jj-workspace-forget"><code>jj workspace forget</code><a class="headerlink" href="#cli-reference-jj-workspace-forget" title="Permanent link">&para;</a></h2>
<p>Stop tracking a workspace's working-copy commit in the repo</p>
<p>The workspace will not be touched on disk. It can be deleted from disk before or after running this command.</p>
<p><strong>Usage:</strong> <code>jj workspace forget [WORKSPACES]...</code></p>
<h6 id="cli-reference-arguments_56"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_56" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;WORKSPACES&gt;</code> — Names of the workspaces to forget. By default, forgets only the current workspace</li>
</ul>
<h2 id="cli-reference-jj-workspace-list"><code>jj workspace list</code><a class="headerlink" href="#cli-reference-jj-workspace-list" title="Permanent link">&para;</a></h2>
<p>List workspaces</p>
<p><strong>Usage:</strong> <code>jj workspace list</code></p>
<h2 id="cli-reference-jj-workspace-rename"><code>jj workspace rename</code><a class="headerlink" href="#cli-reference-jj-workspace-rename" title="Permanent link">&para;</a></h2>
<p>Renames the current workspace</p>
<p><strong>Usage:</strong> <code>jj workspace rename &lt;NEW_WORKSPACE_NAME&gt;</code></p>
<h6 id="cli-reference-arguments_57"><strong>Arguments:</strong><a class="headerlink" href="#cli-reference-arguments_57" title="Permanent link">&para;</a></h6>
<ul>
<li><code>&lt;NEW_WORKSPACE_NAME&gt;</code> — The name of the workspace to update to</li>
</ul>
<h2 id="cli-reference-jj-workspace-root"><code>jj workspace root</code><a class="headerlink" href="#cli-reference-jj-workspace-root" title="Permanent link">&para;</a></h2>
<p>Show the current workspace root directory</p>
<p><strong>Usage:</strong> <code>jj workspace root</code></p>
<h2 id="cli-reference-jj-workspace-update-stale"><code>jj workspace update-stale</code><a class="headerlink" href="#cli-reference-jj-workspace-update-stale" title="Permanent link">&para;</a></h2>
<p>Update a workspace that has become stale</p>
<p>See the <a href="https://jj-vcs.github.io/jj/latest/working-copy/#stale-working-copy">stale working copy documentation</a> for more information.</p>
<p><strong>Usage:</strong> <code>jj workspace update-stale</code></p>
<hr/>

<p><small><i>
    This document was generated automatically by
    <a href="https://crates.io/crates/clap-markdown"><code>clap-markdown</code></a>.
</i></small></p>
<!-- END INCLUDE --></section><section class="print-page" id="testimonials" heading-number="5"><h1 id="testimonials-testimonials">Testimonials<a class="headerlink" href="#testimonials-testimonials" title="Permanent link">&para;</a></h1>
<p>You might not be ready to make the jump to Jujutsu yet. It's understandable; new
tools come with new lessons, failures, and ideas to absorb. They require
practice. In order to provide some motivation, we've collected a number of real,
100% authentic testimonials &mdash; from our loving users, our silly developers
&mdash; all to tip the scales and get you on our side!</p>
<h2 id="testimonials-what-the-users-have-to-say">What the users have to say<a class="headerlink" href="#testimonials-what-the-users-have-to-say" title="Permanent link">&para;</a></h2>
<blockquote>
<p>I've spent many years of my career working on version control. What I like
most about Jujutsu is how it has non-obvious solutions to UX problems that
we've run into in the past. What most people may not realize is that there are
many novel features which all interlock to make it easy to use.</p>
<p>For example, consider Jujutsu's support for automatically rebasing descendants
of amended revisions. When we implemented that in Mercurial, we ran into an
issue: what if there's a merge conflict? Our solution was to warn users and
just not perform the auto-rebase. Now, suddenly, users have to understand that
there can be old versions of the same revision visible in their log, and learn
how to fix this state.</p>
<p>In contrast, Jujutsu's solution is to simply make merge conflicts first-class.
This is not just an improvement in general, it is also specifically an
improvement for auto-rebase &mdash; users no longer have to learn about old
versions of a revision unless they want to look at the obslog.</p>
<p>Over and over, I'm struck by how well Jujutsu demonstrates this kind of
evolved thinking, which as an experienced version control developer I deeply
appreciate.</p>
</blockquote>
<p>&mdash; Rain, engineer at Oxide Computer Company, former VCS developer</p>
<blockquote>
<p>Jujutsu is amazing... I couldn't have come up with anything remotely as
elegant.</p>
<p>It's so rare that a solution attacks the innermost core of a problem so
thoroughly, I genuinely feel blessed to be in its presence. And also a bit
vindicated in not even trying to learn to use any of the tools that felt like
more crutches stacked upon a sand castle</p>
</blockquote>
<p>&mdash; Anonymous user, speaking from the shadows</p>
<blockquote>
<p>It's the easiest time I've ever had learning a tool this deeply this quickly,
because of the ability to experiment and undo, instead of triple-checking
before trying a new scary command.</p>
</blockquote>
<p>&mdash; Scott Olson, advanced Git user and now a Jujutsu user</p>
<blockquote>
<p>I initially started to use Jujutsu for personal repos, and it has quickly
gone from "neat, let's try this more" to "very neat, added to my permanent
config and automatically installed for new machines".</p>
</blockquote>
<p>&mdash; Poliorcetics, on GitHub</p>
<blockquote>
<p>when i worked on the rust compiler, my job was to chain together a bunch of
strange and cursed tools that broke often. jujutsu breaks about half as
much, so that's pretty good i guess</p>
</blockquote>
<p>&mdash; jyn514, Rust contributor</p>
<blockquote>
<p>Jujutsu is pretty cool, you can even keep most of your existing workflows</p>
</blockquote>
<p>&mdash; Ben, who doesn't want you keeping your existing workflow</p>
<blockquote>
<p>Wait, it's not called Jujitsu?</p>
</blockquote>
<p>&mdash; Phil, Mercurial contributor (who doesn't have to learn Git, now that
Jujutsu exists)</p>
<blockquote>
<p>When I heard about Jujutsu I decided to try it out before forming an opinion.
Technically it never formed, because I haven't considered going back.</p>
</blockquote>
<p>&mdash; gul banana, computer programmer</p>
<blockquote>
<p>muwhahaha, I have corrupted my cofounder and now 100% of brontosource dev is on JJ.</p>
</blockquote>
<p>&mdash; Matt Kulunkundis, cofounder BrontoSource</p>
<blockquote>
<p>jj is genuinely the first tool since Rust that has me excited.</p>
</blockquote>
<p>&mdash; David Barsky, rust-analyzer and <code>tokio-rs/tracing</code> developer</p>
<blockquote>
<p>Today I did some complex surgery on a legacy repo that has been committed to
for years by a number of individuals with varying hygienic habits. [..]</p>
<p>Now, this still took me about two hours using jj. But at no point did I
seriously consider physical violence to humans or inanimate objects.
Everything progressed calmly and methodically. I was able to introspect
changes before I made them, and when I did screw up… <code>jj undo</code> to the
rescue.</p>
</blockquote>
<p>&mdash; An unknown scientist, who couldn't have done it with Git.</p>
<blockquote>
<p>jj was my first exposure to revsets and at first I was
"why would I ever need that", but now after exercising that math part of my
brain that's been stale since high school, they're indispensable</p>
</blockquote>
<p>&mdash; Marijan Smetko, who previously only knew Git.</p>
<blockquote>
<p>I think my favorite thing about jj is it makes the way I abused Git via
lazygit the standard way of doing things</p>
</blockquote>
<p>&mdash; Isaac Corbrey, reformed Git user</p>
<h2 id="testimonials-what-the-developers-have-to-say">What the developers have to say<a class="headerlink" href="#testimonials-what-the-developers-have-to-say" title="Permanent link">&para;</a></h2>
<blockquote>
<p>I've been a FOSS contributor using Git for over 16 years, and Jujutsu
continues to amaze me every day. It has that sweet simplicity I was fond of in
Darcs, but it boils down all my most core and fundamental workflows &mdash;
developed over years of experience &mdash; into a simple set of primitives.
The internal design is simple and beautiful; it looks like a database, making
the implementation elegant, safe, and extensible. All this, using the same Git
repositories my coworkers use.</p>
<p>It's like if you found out one day that you built your entire home on a vein
of rich gold. Every day I seem to find new and beautiful emergent behaviors,
all adding up to a tool that is greater than the sum of its parts.</p>
</blockquote>
<p>&mdash; Austin Seipp, "No 1. Jujutsu Fan"</p>
<blockquote>
<p>Honestly, I implemented signing support mostly for that sweet dopamine hit
that you get from the green checkmark on GitHub. Yeah.</p>
</blockquote>
<p>&mdash; Anton Bulakh, contributor and dopamine enthusiast</p>
<blockquote>
<p>I'm sometimes still surprised that navigating with <code>jj next</code> and <code>jj prev</code>
works.</p>
</blockquote>
<p>&mdash; Philip Metzger, author of <code>jj next</code> and <code>jj prev</code></p>
<blockquote>
<p>I'm surprised when it works.</p>
</blockquote>
<p>&mdash; Martin von Zweigbergk, project creator and leader</p>
<h2 id="testimonials-spread-the-word-yourself">Spread the word yourself<a class="headerlink" href="#testimonials-spread-the-word-yourself" title="Permanent link">&para;</a></h2>
<p>Are you satisfied with Jujutsu? Ready to recommend it to a Jujillion of your
friends and coworkers? Great! The easiest way to help the project grow is word
of mouth. So make sure to talk to them about it and show off your hip new tool.
Maybe post a link to it on your other favorite tool that you love using, Slack?</p>
<p>If you're not sure what to say, we hired the cheapest marketing team we could
find to design a list of Pre-Approved Endorsements in their laboratory. Just
copy and paste these right into a text box! Shilling for an open source project
has never been easier than this.</p>
<blockquote>
<p>Jujutsu is an alright tool. I guess.</p>
<p>Jujutsu is my favorite software tool of all time. I am saying this for no
particular reason, definitely not because I was paid to.</p>
<p>I love Jujutsu. I love Jujutsu. I love Jujutsu. I love Jujutsu. I love
Jujutsu. I love Jujutsu. I love Jujutsu. I love Jujutsu.</p>
</blockquote></section><section class="print-page" id="community_tools" heading-number="6"><h1 id="community_tools-community-built-tools-around-jujutsu">Community-built tools around Jujutsu<a class="headerlink" href="#community_tools-community-built-tools-around-jujutsu" title="Permanent link">&para;</a></h1>
<p><strong>Important:</strong> Many of these are not complete yet, just like Jujutsu itself.
But they already simplify many workflows and can improve your experience.</p>
<h2 id="community_tools-diffedit3">Diffedit3<a class="headerlink" href="#community_tools-diffedit3" title="Permanent link">&para;</a></h2>
<p>Diffedit3 is a web-based alternate to Meld, as it no longer is packaged and
available for all Distros. Its creator is also a frequent contributor.</p>
<p>Find it <a href="https://github.com/ilyagr/diffedit3">here</a></p>
<h2 id="community_tools-gg-gui-for-jj">GG - GUI for JJ<a class="headerlink" href="#community_tools-gg-gui-for-jj" title="Permanent link">&para;</a></h2>
<p>GG is a cross platform GUI for Jujutsu which makes all graph manipulating
workflows quite easy. Take a look at its README.md as it quite descriptive.</p>
<p>Find it <a href="https://github.com/gulbanana/gg">here</a>.</p>
<h2 id="community_tools-hunknvim">Hunk.nvim<a class="headerlink" href="#community_tools-hunknvim" title="Permanent link">&para;</a></h2>
<p>Hunk.nvim is a Neovim based diff-editor for Jujutsu which can be used as an
alternative to the default <code>:builtin</code> diff-editor.</p>
<p>Find it <a href="https://github.com/julienvincent/hunk.nvim">here</a>.</p>
<h2 id="community_tools-jj-fzf">JJ-FZF<a class="headerlink" href="#community_tools-jj-fzf" title="Permanent link">&para;</a></h2>
<p>Centered around the <code>jj log</code> graph view, jj-fzf provides previews of diffs, the
evolution-log, browses the op log and offers a large number of key bindings for
commonly used <code>jj</code> operations from rebase to undo, and helps with divergent commits.</p>
<p>Find it <a href="https://github.com/tim-janik/jj-fzf">here</a>.</p>
<h2 id="community_tools-jj-tui">JJ TUI<a class="headerlink" href="#community_tools-jj-tui" title="Permanent link">&para;</a></h2>
<p>This is TUI for Jujutsu built in Ocaml, it is unopiniated and its creator is
open to feedback.</p>
<p>Find it <a href="https://github.com/faldor20/jj_tui">here</a>.</p>
<h2 id="community_tools-jujutsu-kaizen">Jujutsu Kaizen<a class="headerlink" href="#community_tools-jujutsu-kaizen" title="Permanent link">&para;</a></h2>
<p>Jujutsu Kaizen is a plugin for Visual Studio Code. The goal of this extension is to bring the great UX of Jujutsu into the VS Code UI.
Its developers are currently focused on achieving parity for commonly used features of VS Code's built-in Git extension, such as the various operations possible via the Source Control view.</p>
<p>Find it <a href="https://github.com/keanemind/jjk">here</a>.</p>
<h2 id="community_tools-lazyjj">LazyJJ<a class="headerlink" href="#community_tools-lazyjj" title="Permanent link">&para;</a></h2>
<p>lazyjj is a lazygit inspired TUI for Jujutsu.</p>
<p>Find it <a href="https://github.com/Cretezy/lazyjj">here</a>.</p>
<h2 id="community_tools-visual-jujutsu">Visual Jujutsu<a class="headerlink" href="#community_tools-visual-jujutsu" title="Permanent link">&para;</a></h2>
<p>VJJ is a fzf (fuzzy finder) wrapper for Jujutsu, which is meant to be used
interactively in the terminal.</p>
<p>Find it <a href="https://github.com/noahmayr/vjj">here</a>.</p>
<h2 id="community_tools-visualjj">VisualJJ<a class="headerlink" href="#community_tools-visualjj" title="Permanent link">&para;</a></h2>
<p>VisualJJ is a plugin for Visual Studio Code which provides native integration
for Jujutsu, not relying on Git colocation. Unlike other tools on this page,
VisualJJ is not open-source.</p>
<p>Find it <a href="https://www.visualjj.com">here</a>.</p>
<h2 id="community_tools-jujutsu-ui">Jujutsu UI<a class="headerlink" href="#community_tools-jujutsu-ui" title="Permanent link">&para;</a></h2>
<p>jjui is a terminal user interface for working with Jujutsu version control system.</p>
<p>Find it <a href="https://github.com/idursun/jjui">here</a>.</p>
<!-- TODO: Add benbrittains/cultivate when its ready -->
<h2 id="community_tools-finding-other-integrations">Finding other integrations<a class="headerlink" href="#community_tools-finding-other-integrations" title="Permanent link">&para;</a></h2>
<p>You can find other community contributed tools and integrations in our
<a href="https://github.com/jj-vcs/jj/wiki">Wiki</a>.</p></section>
                    <section class='print-page md-section' id='section-7' heading-number='7'>
                        <h1>Concepts<a class='headerlink' href='#section-7' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="working-copy" heading-number="7.1"><h1 id="working-copy-working-copy">Working copy<a class="headerlink" href="#working-copy-working-copy" title="Permanent link">&para;</a></h1>
<h2 id="working-copy-introduction">Introduction<a class="headerlink" href="#working-copy-introduction" title="Permanent link">&para;</a></h2>
<p>The working copy is where the current working-copy commit's files are written so
you can interact with them. It is also where files are read from in order to
create new commits (though there are many other ways of creating new commits).</p>
<p>Unlike most other VCSs, Jujutsu will automatically create commits from the
working-copy contents when they have changed. Most <code>jj</code> commands you run will
commit the working-copy changes if they have changed. The resulting revision
will replace the previous working-copy revision.</p>
<p>Also unlike most other VCSs, added files are implicitly tracked by default. That
means that if you add a new file to the working copy, it will be automatically
committed once you run e.g. <code>jj st</code>. Similarly, if you remove a file from the
working copy, it will implicitly be untracked.</p>
<p>The <code>snapshot.auto-track</code> config option controls which paths get automatically
tracked when they're added to the working copy. See the
<a href="#filesets">fileset documentation</a> for the syntax. Files with paths matching
<a href="#working-copy-ignored-files">ignore files</a> are never tracked automatically.</p>
<p>You can use <code>jj file untrack</code> to untrack a file while keeping it in the working
copy. However, first <a href="#working-copy-ignored-files">ignore</a> them or remove them from the
<code>snapshot.auto-track</code> patterns; otherwise they will be immediately tracked again.</p>
<h2 id="working-copy-conflicts">Conflicts<a class="headerlink" href="#working-copy-conflicts" title="Permanent link">&para;</a></h2>
<p>When you check out a commit with conflicts, those conflicts need to be
represented in the working copy somehow. However, the file system doesn't
understand conflicts. Jujutsu's solution is to add conflict markers to
conflicted files when it writes them to the working copy. It also keeps track of
the (typically 3) different parts involved in the conflict. Whenever it scans
the working copy thereafter, it parses the conflict markers and recreates the
conflict state from them. You can resolve conflicts by replacing the conflict
markers by the resolved text. You don't need to resolve all conflicts at once.
You can even resolve part of a conflict by updating the different parts of the
conflict marker.</p>
<p>To resolve conflicts in a commit, use <code>jj new &lt;commit&gt;</code> to create a working-copy
commit on top. You would then have the same conflicts in the working-copy
commit. Once you have resolved the conflicts, you can inspect the conflict
resolutions with <code>jj diff</code>. Then run <code>jj squash</code> to move the conflict
resolutions into the conflicted commit. Alternatively, you can edit the commit
with conflicts directly in the working copy by using <code>jj edit &lt;commit&gt;</code>. The
main disadvantage of that is that it's harder to inspect the conflict
resolutions.</p>
<p>With the <code>jj resolve</code> command, you can use an external merge tool to resolve
conflicts that have 2 sides and a base.  There is not yet a good way of
resolving conflicts between directories, files, and symlinks
(https://github.com/jj-vcs/jj/issues/19). You can use <code>jj restore</code> to choose
one side of the conflict, but there's no way to even see where the involved
parts came from.</p>
<h2 id="working-copy-ignored-files">Ignored files<a class="headerlink" href="#working-copy-ignored-files" title="Permanent link">&para;</a></h2>
<p>You probably don't want build outputs and temporary files to be under version
control. You can tell Jujutsu to not automatically track certain files by using
<code>.gitignore</code> files (there's no such thing as <code>.jjignore</code> yet).
See https://git-scm.com/docs/gitignore for details about the format.
<code>.gitignore</code> files are supported in any directory in the working copy, as well
as in <code>$XDG_CONFIG_HOME/git/ignore</code> and <code>$GIT_DIR/info/exclude</code>.</p>
<p>Ignored files are never tracked automatically (regardless of the value of
<code>snapshot.auto-track</code>), but files that were already tracked will remain tracked
even if they match ignore patterns. You can untrack such files with the
<code>jj file untrack</code> command.</p>
<h2 id="working-copy-workspaces">Workspaces<a class="headerlink" href="#working-copy-workspaces" title="Permanent link">&para;</a></h2>
<p>You can have multiple working copies backed by a single repo. Use
<code>jj workspace add</code> to create a new working copy. The working copy will have a
<code>.jj/</code> directory linked to the main repo. The working copy and the <code>.jj/</code>
directory together is called a "workspace". Each workspace can have a different
commit checked out.</p>
<p>Having multiple workspaces can be useful for running long-running tests in a one
while you continue developing in another, for example. If needed,
<code>jj workspace root</code> prints the root path of the current workspace.</p>
<p>When you're done using a workspace, use <code>jj workspace forget</code> to make the repo
forget about it. The files can be deleted from disk separately (either before or
after).</p>
<h2 id="working-copy-stale-working-copy">Stale working copy<a class="headerlink" href="#working-copy-stale-working-copy" title="Permanent link">&para;</a></h2>
<p>Almost all commands go through three main steps:</p>
<ol>
<li>Snapshot the working copy (which gets recorded as an operation)</li>
<li>Create new commits etc. "in memory" and record that as a new operation</li>
<li>Update the working copy to match the new operation, i.e. to the commit that
   the operation says that <code>@</code> should point to</li>
</ol>
<p>If step 3 doesn't happen for some reason, the working copy is considered
"stale". We can detect that because the working copy (<code>.jj/working_copy/</code>)
keeps track of which operation it was last updated to. When the working copy is
stale, use <code>jj workspace update-stale</code> to update the files in the working copy.</p>
<p>A common reason that step 3 doesn't happen for a working copy is that you
rewrote the commit from another workspace. When you modify workspace A's
working-copy commit from workspace B, workspace A's working copy will become
stale.</p>
<p>A working copy can also become stale because some error, such as <code>^C</code> prevented
step 3 from completing. It's also possible that it was successfully updated in
step 3 but the operation has then been lost (e.g. by <code>jj op abandon</code> or
"spontaneously" by certain storage backends). If the operation has been lost,
then <code>jj workspace update-stale</code> will create a recovery commit with the
contents of the working copy but parented to the current operation's
working-copy commit.</p></section><section class="print-page" id="bookmarks" heading-number="7.2"><h1 id="bookmarks-bookmarks">Bookmarks<a class="headerlink" href="#bookmarks-bookmarks" title="Permanent link">&para;</a></h1>
<h2 id="bookmarks-introduction">Introduction<a class="headerlink" href="#bookmarks-introduction" title="Permanent link">&para;</a></h2>
<p>Bookmarks are named pointers to revisions (just like branches are in Git). You
can move them without affecting the target revision's identity. Bookmarks
automatically move when revisions are rewritten (e.g. by <code>jj rebase</code>). You can
pass a bookmark's name to commands that want a revision as argument. For example,
<code>jj new main</code> will create a new revision on top of the <code>main</code> bookmark. Use
<code>jj bookmark list</code> to list bookmarks and <code>jj bookmark &lt;subcommand&gt;</code> to create,
move, or delete bookmarks. There is currently no concept of an
active/current/checked-out bookmark.</p>
<h2 id="bookmarks-mapping-to-git-branches">Mapping to Git branches<a class="headerlink" href="#bookmarks-mapping-to-git-branches" title="Permanent link">&para;</a></h2>
<p>Jujutsu maps its bookmarks to Git branches when interacting with Git repos. For
example, <code>jj git push --bookmark foo</code> will push the state of the <code>foo</code> bookmark
to the <code>foo</code> branch on the Git remote. Similarly, if you create a <code>bar</code> branch
in the backing Git repo, then a subsequent <code>jj git import</code> will create a <code>bar</code>
bookmark (reminder: that import happens automatically in
<a href="#git-compatibility-co-located-jujutsugit-repos">colocated repos</a>).</p>
<h2 id="bookmarks-remotes-and-tracked-bookmarks">Remotes and tracked bookmarks<a class="headerlink" href="#bookmarks-remotes-and-tracked-bookmarks" title="Permanent link">&para;</a></h2>
<p>Jujutsu records the last seen position of a bookmark on each remote (just like
Git's remote-tracking branches). This record is updated on every <code>jj git fetch</code>
and <code>jj git push</code> of the bookmark. You can refer to the remembered remote bookmark
positions with <code>&lt;bookmark name&gt;@&lt;remote name&gt;</code>, such as <code>jj new main@origin</code>. <code>jj</code>
does not provide a way to manually edit these recorded positions.</p>
<p>A remote bookmark can be associated with a local bookmark of the same name. This
is called a <strong>tracked remote bookmark</strong> (which maps to a Git remote branch when
using the Git backend). When you pull a tracked bookmark from a remote, any
changes compared to the current record of the remote's state will be propagated
to the corresponding local bookmark, which will be created if it doesn't exist
already.</p>
<div class="admonition note">
<p class="admonition-title">Details: how <code>fetch</code> pulls bookmarks</p>
<p>Let's say you run <code>jj git fetch --remote origin</code> and, during the fetch, <code>jj</code>
determines that the remote's <code>main</code> bookmark has been moved so that its target is
now ahead of the local record in <code>main@origin</code>.</p>
<p><code>jj</code> will then update <code>main@origin</code> to the new target. If <code>main@origin</code> is
<strong>tracked</strong>, <code>jj</code> will also apply the change to the local bookmark <code>main</code>. If the
local target has also been moved compared to <code>main@origin</code> (probably because you
ran <code>jj bookmark set main</code>), then the two updates will be merged. If one is ahead
of the other, then that target will become the new target. Otherwise, the local
bookmark will become conflicted (see the <a href="#bookmarks-conflicts">"Conflicts" section</a> below
for details).</p>
</div>
<p>Most commands don't show the tracked remote bookmark if it has the same target as
the local bookmark. The local bookmark (without <code>@&lt;remote name&gt;</code>) is considered the
bookmark's desired target. Consequently, if you want to update a bookmark on a
remote, you first update the bookmark locally and then push the update to the
remote. If a local bookmark also exists on some remote but points to a different
target there, <code>jj log</code> will show the bookmark name with an asterisk suffix (e.g.
<code>main*</code>). That is meant to remind you that you may want to push the bookmark to
some remote.</p>
<p>If you want to know the internals of bookmark tracking, consult the
<a href="#design-tracking-branches">Design Doc</a>.</p>
<h3 id="bookmarks-terminology-summary">Terminology summary<a class="headerlink" href="#bookmarks-terminology-summary" title="Permanent link">&para;</a></h3>
<ul>
<li>A <strong>remote bookmark</strong> is a bookmark ref on the remote. <code>jj</code> can find out its
  actual state only when it's actively communicating with the remote. However,
  <code>jj</code> does store the last-seen position of the remote bookmark; this is the
  commit <code>jj show &lt;bookmark name&gt;@&lt;remote name&gt;</code> would show. This notion is
  completely analogous to Git's "remote-tracking branches".</li>
<li>A <strong>tracked (remote) bookmark</strong> is defined above. You can make a remote bookmark
  tracked with the <a href="#bookmarks-manually-tracking-a-bookmark"><code>jj bookmark track</code> command</a>, for
  example.</li>
<li>A <strong>tracking (local) bookmark</strong> is the local bookmark that <code>jj</code> tries to keep in
  sync with the tracked remote bookmark. For example, after <code>jj bookmark track
  mybookmark@origin</code>, there will be a local bookmark <code>mybookmark</code> that's tracking the
  remote <code>mybookmark@origin</code> bookmark. A local bookmark can track a bookmark of the same
  name on 0 or more remotes.</li>
</ul>
<p>The notion of tracked bookmarks serves a similar function to the Git notion of an
"upstream branch". Unlike Git, a single local bookmark can be tracking remote
bookmarks on multiple remotes, and the names of the local and remote bookmarks
must match.</p>
<h3 id="bookmarks-manually-tracking-a-bookmark">Manually tracking a bookmark<a class="headerlink" href="#bookmarks-manually-tracking-a-bookmark" title="Permanent link">&para;</a></h3>
<p>To track a bookmark permanently use <code>jj bookmark track &lt;bookmark name&gt;@&lt;remote name&gt;</code>.
It will now be imported as a local bookmark until you untrack it or it is deleted
on the remote.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="c1"># List all available bookmarks, as we want our colleague&#39;s bookmark.</span>
$<span class="w"> </span>jj<span class="w"> </span>bookmark<span class="w"> </span>list<span class="w"> </span>--all
$<span class="w"> </span><span class="c1"># Find the bookmark.</span>
$<span class="w"> </span><span class="c1"># [...]</span>
$<span class="w"> </span><span class="c1"># Actually track the bookmark.</span>
$<span class="w"> </span>jj<span class="w"> </span>bookmark<span class="w"> </span>track<span class="w"> </span>&lt;bookmark<span class="w"> </span>name&gt;@&lt;remote<span class="w"> </span>name&gt;<span class="w"> </span><span class="c1"># Example: jj bookmark track my-feature@origin</span>
$<span class="w"> </span><span class="c1"># From this point on, &lt;bookmark name&gt; will be imported when fetching from &lt;remote name&gt;.</span>
$<span class="w"> </span>jj<span class="w"> </span>git<span class="w"> </span>fetch<span class="w"> </span>--remote<span class="w"> </span>&lt;remote<span class="w"> </span>name&gt;
$<span class="w"> </span><span class="c1"># A local bookmark &lt;bookmark name&gt; should have been created or updated while fetching.</span>
$<span class="w"> </span>jj<span class="w"> </span>new<span class="w"> </span>&lt;bookmark<span class="w"> </span>name&gt;<span class="w"> </span><span class="c1"># Do some local testing, etc.</span>
</code></pre></div>
<h3 id="bookmarks-untracking-a-bookmark">Untracking a bookmark<a class="headerlink" href="#bookmarks-untracking-a-bookmark" title="Permanent link">&para;</a></h3>
<p>To stop following a remote bookmark, you can <code>jj bookmark untrack</code> it. After that,
subsequent fetches of that remote will no longer move the local bookmark to match
the position of the remote bookmark.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="c1"># List all local and remote bookmarks.</span>
$<span class="w"> </span>jj<span class="w"> </span>bookmark<span class="w"> </span>list<span class="w"> </span>--all
$<span class="w"> </span><span class="c1"># Find the bookmark we no longer want to track.</span>
$<span class="w"> </span><span class="c1"># [...]</span>
<span class="c1"># # Actually untrack it.</span>
$<span class="w"> </span>jj<span class="w"> </span>bookmark<span class="w"> </span>untrack<span class="w"> </span>&lt;bookmark<span class="w"> </span>name&gt;@&lt;remote<span class="w"> </span>name&gt;<span class="w"> </span><span class="c1"># Example: jj bookmark untrack stuff@origin</span>
$<span class="w"> </span><span class="c1"># From this point on, this remote bookmark won&#39;t be imported anymore.</span>
$<span class="w"> </span><span class="c1"># The local bookmark (e.g. stuff) is unaffected. It may or may not still</span>
$<span class="w"> </span><span class="c1"># be tracking bookmarks on other remotes (e.g. stuff@upstream).</span>
</code></pre></div>
<h3 id="bookmarks-listing-tracked-bookmarks">Listing tracked bookmarks<a class="headerlink" href="#bookmarks-listing-tracked-bookmarks" title="Permanent link">&para;</a></h3>
<p>To list tracked bookmarks, you can <code>jj bookmark list --tracked</code> or <code>jj bookmark list -t</code>.
This command omits local Git-tracking bookmarks by default.</p>
<p>You can see if a specific bookmark is tracked with <code>jj bookmark list --tracked &lt;bookmark name&gt;</code>.</p>
<h3 id="bookmarks-automatic-tracking-of-bookmarks-gitauto-local-bookmark-option">Automatic tracking of bookmarks &amp; <code>git.auto-local-bookmark</code> option<a class="headerlink" href="#bookmarks-automatic-tracking-of-bookmarks-gitauto-local-bookmark-option" title="Permanent link">&para;</a></h3>
<p>There are two situations where <code>jj</code> tracks bookmarks automatically. <code>jj git
clone</code> automatically sets up the default remote bookmark (e.g. <code>main@origin</code>) as
tracked. When you push a local bookmark, the newly created bookmark on the remote is
marked as tracked.</p>
<p>By default, every other remote bookmark is marked as "not tracked" when it's
fetched. If desired, you need to manually <code>jj bookmark track</code> them. This works
well for repositories where multiple people work on a large number of bookmarks.</p>
<p>The default can be changed by setting the config <code>git.auto-local-bookmark = true</code>.
Then, <code>jj git fetch</code> tracks every <em>newly fetched</em> bookmark with a local bookmark.
Branches that already existed before the <code>jj git fetch</code> are not affected. This
is similar to Mercurial, which fetches all its bookmarks (equivalent to Git's
branches) by default.</p>
<h2 id="bookmarks-bookmark-movement">Bookmark movement<a class="headerlink" href="#bookmarks-bookmark-movement" title="Permanent link">&para;</a></h2>
<p>Currently Jujutsu automatically moves local bookmarks when these conditions are
met:</p>
<ul>
<li>When a commit has been rewritten (e.g, when you rebase) bookmarks and the
   working-copy will move along with it.</li>
<li>When a commit has been abandoned, all associated bookmarks will be moved
   to its parent(s). If a working copy was pointing to the abandoned commit,
   then a new working-copy commit will be created on top of the parent(s).</li>
</ul>
<p>You could describe the movement as following along the change-id of the
current bookmark commit, even if it isn't entirely accurate.</p>
<h2 id="bookmarks-pushing-bookmarks-safety-checks">Pushing bookmarks: Safety checks<a class="headerlink" href="#bookmarks-pushing-bookmarks-safety-checks" title="Permanent link">&para;</a></h2>
<p>Before <code>jj git push</code> actually moves, creates, or deletes a remote bookmark, it
makes several safety checks.</p>
<ol>
<li>
<p><code>jj</code> will contact the remote and check that the actual state of the remote
   bookmark matches <code>jj</code>'s record of its last known position. If there is a
   conflict, <code>jj</code> will refuse to push the bookmark. In this case, you need to run
   <code>jj git fetch --remote &lt;remote name&gt;</code> and resolve the resulting bookmark
   conflict. Then, you can try <code>jj git push</code> again.</p>
<p>If you are familiar with Git, this makes <code>jj git push</code> similar to <code>git
 push --force-with-lease</code>.</p>
<p>There are a few cases where <code>jj git push</code> will succeed even though the remote
 bookmark is in an unexpected location. These are the cases where <code>jj git fetch</code>
 would not create a bookmark conflict and would not move the local bookmark, e.g.
 if the unexpected location is identical to the local position of the bookmark.</p>
</li>
<li>
<p>The local bookmark must not be <a href="#bookmarks-conflicts">conflicted</a>. If it is, you would
   need to use <code>jj bookmark move</code>, for example, to resolve the conflict.</p>
<p>This makes <code>jj git push</code> safe even if <code>jj git fetch</code> is performed on a timer
 in the background (this situation is a known issue<sup id="bookmarks-fnref:known-issue"><a class="footnote-ref" href="#bookmarks-fn:known-issue">1</a></sup> with some
 forms of <code>git push --force-with-lease</code>). If the bookmark moves on a remote in a
 problematic way, <code>jj git fetch</code> will create a conflict. This should ensure
 that the user becomes aware of the conflict before they can <code>jj git push</code> and
 override the bookmark on the remote.</p>
</li>
<li>
<p>If the remote bookmark already exists on the remote, it must be
   <a href="#bookmarks-remotes-and-tracked-bookmarks">tracked</a>. If the bookmark does not already
   exist on the remote, there is no problem; <code>jj git push --allow-new</code> will
   create the remote bookmark and mark it as tracked.</p>
</li>
</ol>
<h2 id="bookmarks-conflicts">Conflicts<a class="headerlink" href="#bookmarks-conflicts" title="Permanent link">&para;</a></h2>
<p>Bookmarks can end up in a conflicted state. When that happens, <code>jj status</code> will
include information about the conflicted bookmarks (and instructions for how to
mitigate it). <code>jj bookmark list</code> will have details. <code>jj log</code> will show the bookmark
name with a double question mark suffix (e.g. <code>main??</code>) on each of the
conflicted bookmark's potential target revisions. Using the bookmark name to look up
a revision will resolve to all potential targets. That means that <code>jj new main</code>
will error out, complaining that the revset resolved to multiple revisions.</p>
<p>Both local bookmarks (e.g. <code>main</code>) and the remote bookmark (e.g. <code>main@origin</code>) can
have conflicts. Both can end up in that state if concurrent operations were run
in the repo. The local bookmark more typically becomes conflicted because it was
updated both locally and on a remote.</p>
<p>To resolve a conflicted state in a local bookmark (e.g. <code>main</code>), you can move the
bookmark to the desired target with <code>jj bookmark move</code>. You may want to first either
merge the conflicted targets with <code>jj new</code> (e.g. <code>jj new 'all:main'</code>), or you may
want to rebase one side on top of the other with <code>jj rebase</code>.</p>
<p>To resolve a conflicted state in a remote bookmark (e.g. <code>main@origin</code>), simply
pull from the remote (e.g. <code>jj git fetch</code>). The conflict resolution will also
propagate to the local bookmark (which was presumably also conflicted).</p>
<h2 id="bookmarks-ease-of-use">Ease of use<a class="headerlink" href="#bookmarks-ease-of-use" title="Permanent link">&para;</a></h2>
<p>The use of bookmarks is frequent in some workflows, for example, when
interacting with Git repositories containing branches. To this end,
one-letter shortcuts have been implemented, both for the <code>jj bookmark</code>
command itself through an alias (as <code>jj b</code>), and for its subcommands.
For example, <code>jj bookmark create BOOKMARK-NAME -r@</code> can be abbreviated as
<code>jj b c BOOKMARK-NAME -r@</code>.</p>
<div class="footnote">
<hr />
<ol>
<li id="bookmarks-fn:known-issue">
<p>See "A general note on safety" in
<a href="https://git-scm.com/docs/git-push#Documentation/git-push.txt---no-force-with-lease">https://git-scm.com/docs/git-push#Documentation/git-push.txt---no-force-with-lease</a>&#160;<a class="footnote-backref" href="#bookmarks-fnref:known-issue" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="conflicts" heading-number="7.3"><h1 id="conflicts-first-class-conflicts">First-class conflicts<a class="headerlink" href="#conflicts-first-class-conflicts" title="Permanent link">&para;</a></h1>
<h2 id="conflicts-introduction">Introduction<a class="headerlink" href="#conflicts-introduction" title="Permanent link">&para;</a></h2>
<p>Conflicts happen when Jujutsu can't figure out how to merge different changes
made to the same file. For instance, this can happen if two people are working
on the same file and make different changes to the same part of the file, and
then their commits are merged together with <code>jj new</code> (or one is rebased onto the
other with <code>jj rebase</code>).</p>
<p>Unlike most other VCSs, Jujutsu can record conflicted states in commits. For
example, if you rebase a commit and it results in a conflict, the conflict will
be recorded in the rebased commit and the rebase operation will succeed. You can
then resolve the conflict whenever you want. Conflicted states can be further
rebased, merged, or backed out. Note that what's stored in the commit is a
logical representation of the conflict, not conflict <em>markers</em>; rebasing a
conflict doesn't result in a nested conflict markers (see
<a href="#technical-conflicts">technical doc</a> for how this works).</p>
<h2 id="conflicts-advantages">Advantages<a class="headerlink" href="#conflicts-advantages" title="Permanent link">&para;</a></h2>
<p>The deeper understanding of conflicts has many advantages:</p>
<ul>
<li>Removes the need for things like
  <code>git rebase/merge/cherry-pick/etc --continue</code>. Instead, you get a single
  workflow for resolving conflicts: check out the conflicted commit, resolve
  conflicts, and amend.</li>
<li>Enables the "auto-rebase" feature, where descendants of rewritten commits
  automatically get rewritten. This feature mostly replaces Mercurial's
  <a href="https://www.mercurial-scm.org/wiki/ChangesetEvolution">Changeset Evolution</a>.</li>
<li>Lets us define the change in a merge commit as being compared to the merged
  parents. That way, we can rebase merge commits correctly (unlike both Git and
  Mercurial). That includes conflict resolutions done in the merge commit,
  addressing a common use case for
  <a href="https://git-scm.com/docs/git-rerere">git rerere</a>.
  Since the changes in a merge commit are displayed and rebased as expected,
  <a href="https://git-scm.com/docs/gitglossary/2.22.0#Documentation/gitglossary.txt-aiddefevilmergeaevilmerge">evil merges</a>
  are arguably not as evil anymore.</li>
<li>Allows you to postpone conflict resolution until you're ready for it. You
  can easily keep all your work-in-progress commits rebased onto upstream's head
  if you like.</li>
<li><a href="https://stackoverflow.com/questions/26370185/how-do-criss-cross-merges-arise-in-git">Criss-cross merges</a>
  and <a href="https://git-scm.com/docs/git-merge#Documentation/git-merge.txt-octopus">octopus merges</a>
  become trivial (implementation-wise); some cases that Git can't currently
  handle, or that would result in nested conflict markers, can be automatically
  resolved.</li>
<li>Enables collaborative conflict resolution. (This assumes that you can share
  the conflicts with others, which you probably shouldn't do if some people
  interact with your project using Git.)</li>
</ul>
<p>For information about how conflicts are handled in the working copy, see
<a href="#working-copy-conflicts">here</a>.</p>
<h2 id="conflicts-conflict-markers">Conflict markers<a class="headerlink" href="#conflicts-conflict-markers" title="Permanent link">&para;</a></h2>
<p>Conflicts are "materialized" using <em>conflict markers</em> in various contexts. For
example, when you run <code>jj new</code> or <code>jj edit</code> on a commit with a conflict, it will
be materialized in the working copy. Conflicts are also materialized when they
are part of diff output (e.g. <code>jj show</code> on a commit that introduces or resolves
a conflict).</p>
<p>As an example, imagine that you have a file which contains the following text,
all in lowercase:</p>
<div class="highlight"><pre><span></span><code>apple
grape
orange
</code></pre></div>
<p>One person replaces the word "grape" with "grapefruit" in commit A, while
another person changes every line to uppercase in commit B. If you merge the
changes together with <code>jj new A B</code>, the resulting commit will have a conflict
since Jujutsu can't figure out how to combine these changes. Therefore, Jujutsu
will materialize the conflict in the working copy using conflict markers, which
would look like this:</p>
<div class="highlight"><pre><span></span><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; Conflict 1 of 1
%%%%%%% Changes from base to side #1
 apple
-grape
+grapefruit
 orange
+++++++ Contents of side #2
APPLE
GRAPE
ORANGE
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Conflict 1 of 1 ends
</code></pre></div>
<p>The markers <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> and <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code> indicate the start and end of a conflict
respectively. The marker <code>+++++++</code> indicates the start of a snapshot, while the
marker <code>%%%%%%%</code> indicates the start of a diff to apply to the snapshot.
Therefore, to resolve this conflict, you would apply the diff (changing "grape"
to "grapefruit") to the snapshot (the side with every line in uppercase),
editing the file to look like this:</p>
<div class="highlight"><pre><span></span><code>APPLE
GRAPEFRUIT
ORANGE
</code></pre></div>
<p>In practice, conflicts are usually 2-sided, meaning that there's only 2
conflicting changes being merged together at a time, but Jujutsu supports
conflicts with arbitrarily many sides, which can happen when merging 3 or more
commits at once. In that case, you would see a single snapshot section and
multiple diff sections.</p>
<p>Compared to just showing the content of each side of the conflict, the main
benefit of Jujutsu's style of conflict markers is that you don't need to spend
time manually comparing the sides to spot the differences between them. This is
especially beneficial for many-sided conflicts, since resolving them just
requires applying each diff to the snapshot one-by-one.</p>
<h2 id="conflicts-alternative-conflict-marker-styles">Alternative conflict marker styles<a class="headerlink" href="#conflicts-alternative-conflict-marker-styles" title="Permanent link">&para;</a></h2>
<p>If you prefer to just see the contents of each side of the conflict without the
diff, Jujutsu also supports a "snapshot" style, which can be enabled by setting
the <code>ui.conflict-marker-style</code> config option to "snapshot":</p>
<div class="highlight"><pre><span></span><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; Conflict 1 of 1
+++++++ Contents of side #1
apple
grapefruit
orange
------- Contents of base
apple
grape
orange
+++++++ Contents of side #2
APPLE
GRAPE
ORANGE
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Conflict 1 of 1 ends
</code></pre></div>
<p>Some tools expect Git-style conflict markers, so Jujutsu also supports <a href="https://git-scm.com/docs/git-merge#_how_conflicts_are_presented">Git's
"diff3" style</a>
conflict markers by setting the <code>ui.conflict-marker-style</code> config option to
"git":</p>
<div class="highlight"><pre><span></span><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; Side #1 (Conflict 1 of 1)
apple
grapefruit
orange
||||||| Base
apple
grape
orange
=======
APPLE
GRAPE
ORANGE
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Side #2 (Conflict 1 of 1 ends)
</code></pre></div>
<p>This conflict marker style only supports 2-sided conflicts though, so it falls
back to the similar "snapshot" conflict markers if there are more than 2 sides
to the conflict.</p>
<h2 id="conflicts-long-conflict-markers">Long conflict markers<a class="headerlink" href="#conflicts-long-conflict-markers" title="Permanent link">&para;</a></h2>
<p>Some files may contain lines which could be confused for conflict markers. For
instance, a line could start with <code>=======</code>, which looks like a Git-style
conflict marker. To ensure that it's always unambiguous which lines are conflict
markers and which are just part of the file contents, <code>jj</code> sometimes uses
conflict markers which are longer than normal:</p>
<div class="highlight"><pre><span></span><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; Conflict 1 of 1
%%%%%%%%%%%%%%% Changes from base to side #1
-Heading
+HEADING
 =======
+++++++++++++++ Contents of side #2
New Heading
===========
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; Conflict 1 of 1 ends
</code></pre></div>
<h2 id="conflicts-conflicts-with-missing-terminating-newline">Conflicts with missing terminating newline<a class="headerlink" href="#conflicts-conflicts-with-missing-terminating-newline" title="Permanent link">&para;</a></h2>
<p>When materializing conflicts, <code>jj</code> outputs them in a line-based format. This
format is easiest to interpret for text files that consist of a series of lines,
with each line terminated by a newline character (<code>\n</code>). This means that a text
file should either be empty, or it should end with a newline character.</p>
<p>While most text files follow this convention, some do not. When <code>jj</code> encounters
a missing terminating newline character in a conflict, it will add a comment to
the conflict markers to make the conflict easier to interpret. If you don't care
about whether your file ends with a terminating newline character, you can
generally ignore this comment and resolve the conflict normally.</p>
<p>For instance, if a file originally contained <code>grape</code> with no terminating newline
character, and one person changed <code>grape</code> to <code>grapefruit</code>, while another person
added the missing newline character to make <code>grape\n</code>, the resulting conflict
would look like this:</p>
<div class="highlight"><pre><span></span><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; Conflict 1 of 1
+++++++ Contents of side #1 (no terminating newline)
grapefruit
%%%%%%% Changes from base to side #2 (adds terminating newline)
-grape
+grape
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Conflict 1 of 1 ends
</code></pre></div>
<p>Therefore, a resolution of this conflict could be <code>grapefruit\n</code>, with the
terminating newline character added.</p></section><section class="print-page" id="operation-log" heading-number="7.4"><h1 id="operation-log-operation-log">Operation log<a class="headerlink" href="#operation-log-operation-log" title="Permanent link">&para;</a></h1>
<h2 id="operation-log-introduction">Introduction<a class="headerlink" href="#operation-log-introduction" title="Permanent link">&para;</a></h2>
<p>Jujutsu records each operation that modifies the repo in the "operation log".
You can see the log with <code>jj op log</code>. Each operation object contains a snapshot
of how the repo looked at the end of the operation. We call this snapshot a
"view" object. The view contains information about where each bookmark, tag, and
Git ref (in Git-backed repos) pointed, as well as the set of heads in the repo,
and the current working-copy commit in each workspace. The operation object also
(in addition to the view) contains pointers to the operation(s) immediately
before it, as well as metadata about the operation, such as timestamps,
username, hostname, description.</p>
<p>The operation log allows you to undo an operation (<code>jj [op] undo</code>), which doesn't
need to be the most recent one. It also lets you restore the entire repo to the
way it looked at an earlier point (<code>jj op restore</code>).</p>
<p>When referring to operations, you can use <code>@</code> to represent the current
operation.</p>
<p>The following operators are supported:</p>
<ul>
<li><code>x-</code>: Parents of <code>x</code> (e.g. <code>@-</code>)</li>
<li><code>x+</code>: Children of <code>x</code></li>
</ul>
<h2 id="operation-log-divergent-operations">Divergent operations<a class="headerlink" href="#operation-log-divergent-operations" title="Permanent link">&para;</a></h2>
<p>One benefit of the operation log (and the reason for its creation) is that it
allows lock-free concurrency -- you can run concurrent <code>jj</code> commands without
corrupting the repo, even if you run the commands on different machines that
access the repo via a distributed file system (as long as the file system
guarantees that a write is only visible once previous writes are visible). When
you run a <code>jj</code> command, it will start by loading the repo at the latest
operation. It will not see any changes written by concurrent commands. If there
are conflicts, you will be informed of them by subsequent <code>jj st</code> and/or
<code>jj log</code> commands.</p>
<p>As an example, let's say you had started editing the description of a change and
then also update the contents of the change (maybe because you had forgotten the
editor). When you eventually close your editor, the command will succeed and
e.g. <code>jj log</code> will indicate that the change has diverged.</p>
<h2 id="operation-log-loading-an-old-version-of-the-repo">Loading an old version of the repo<a class="headerlink" href="#operation-log-loading-an-old-version-of-the-repo" title="Permanent link">&para;</a></h2>
<p>The top-level <code>--at-operation/--at-op</code> option allows you to load the repo at a
specific operation. This can be useful for understanding how your repo got into
the current state. It can be even more useful for understanding why someone
else's repo got into its current state.</p>
<p>When you use <code>--at-op</code>, the automatic snapshotting of the working copy will not
take place. When referring to a revision with the <code>@</code> symbol (as many commands
do by default), that will resolve to the working-copy commit recorded in the
operation's view (which is actually how it always works -- it's just the
snapshotting that's skipped with <code>--at-op</code>).</p>
<p>As a top-level option, <code>--at-op</code> can be passed to any command. However, you
will typically only want to run read-only commands. For example, <code>jj log</code>,
<code>jj st</code>, and <code>jj diff</code> all make sense. It's still possible to run e.g.
<code>jj --at-op=&lt;some operation ID&gt; describe</code>. That's equivalent to having started
<code>jj describe</code> back when the specified operation was the most recent operation
and then let it run until now (which can be done for that particular command by
not closing the editor). There's practically no good reason to do that other
than to simulate concurrent commands.</p></section><section class="print-page" id="glossary" heading-number="7.5"><h1 id="glossary-glossary">Glossary<a class="headerlink" href="#glossary-glossary" title="Permanent link">&para;</a></h1>
<h2 id="glossary-anonymous-branch">Anonymous branch<a class="headerlink" href="#glossary-anonymous-branch" title="Permanent link">&para;</a></h2>
<p>An anonymous branch is a chain of commits that doesn't necessarily have any
<a href="#glossary-bookmark">bookmarks</a> pointing to it or to any of its descendants. Unlike Git,
Jujutsu keeps commits on anonymous branches around until they are explicitly
abandoned. Visible anonymous branches are tracked by the <a href="#glossary-view">view</a>, which
stores a list of <a href="#glossary-head">heads</a> of such branches.</p>
<h2 id="glossary-backend">Backend<a class="headerlink" href="#glossary-backend" title="Permanent link">&para;</a></h2>
<p>A backend is an implementation of the storage layer. There is currently only one
production-ready builtin commit backend: the Git backend. The Git backend stores
commits in a Git repository. There are several backends used for testing. Google
also has its own cloud-based backend.</p>
<p>There are also pluggable backends for storing other information than commits,
such as the "operation store backend" for storing
<a href="#glossary-operation-log">the operation log</a>.</p>
<h2 id="glossary-bookmark">Bookmark<a class="headerlink" href="#glossary-bookmark" title="Permanent link">&para;</a></h2>
<p>A bookmark is a named pointer to a <a href="#glossary-commit">commit</a>. They are similar to Git's
<a href="#glossary-branch">branches</a> and even more similar to <a href="https://wiki.mercurial-scm.org/Bookmarks">Mercurial's
bookmarks</a>. See <a href="#bookmarks">here</a>
for details.</p>
<p>Unlike in Git, there is no concept of a "current bookmark"; bookmarks <em>do not</em>
move when you create a new commit. Bookmarks <em>do</em> automatically follow the
commit if it gets <a href="#glossary-rewrite">rewritten</a>.</p>
<h2 id="glossary-branch">Branch<a class="headerlink" href="#glossary-branch" title="Permanent link">&para;</a></h2>
<p>In the context of <code>jj</code>, the work "branch" usually refers to an <a href="#glossary-anonymous-branch">anonymous
branch</a> or, less formally, a branch of the commit "tree"
(which is itself an informal way to refer to the commit graph, parts of which
might resemble a tree even when it's not mathematically a tree).</p>
<p>We also sometimes discuss Git's branches and branches on Git remotes. Locally,
these correspond to <a href="#glossary-bookmark">bookmarks</a>. In a co-located repository, each
local Git branch corresponds to a <code>jj</code> bookmark.</p>
<h2 id="glossary-change">Change<a class="headerlink" href="#glossary-change" title="Permanent link">&para;</a></h2>
<p>A change is a commit as it <a href="#glossary-rewrite">evolves over time</a>. Changes themselves
don't exist as an object in the data model; only the change ID does. The change
ID is a property of a commit.</p>
<h2 id="glossary-change-id">Change ID<a class="headerlink" href="#glossary-change-id" title="Permanent link">&para;</a></h2>
<p>A change ID is a unique identifier for a <a href="#glossary-change">change</a>. They are typically
16 bytes long and are often randomly generated. By default, <code>jj log</code> presents
them as a sequence of 12 letters in the k-z range, at the beginning of a line.
These are actually hexadecimal numbers that use "digits" z-k instead of 0-9a-f.</p>
<h2 id="glossary-commit">Commit<a class="headerlink" href="#glossary-commit" title="Permanent link">&para;</a></h2>
<p>A snapshot of the files in the repository at a given point in time (technically
a <a href="#glossary-tree">tree object</a>), together with some metadata. The metadata includes the
author, the date, and pointers to the commit's parents. Through the pointers to
the parents, the commits form a
<a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">Directed Acyclic Graph (DAG)</a>
.</p>
<p>Note that even though commits are stored as snapshots, they are often treated
as differences between snapshots, namely compared to their parent's snapshot. If
they have more than one parent, then the difference is computed against the
result of merging the parents. For example, <code>jj diff</code> will show the differences
introduced by a commit compared to its parent(s), and <code>jj rebase</code> will apply
those changes onto another base commit.</p>
<p>The word "revision" is used as a synonym for "commit".</p>
<h2 id="glossary-commit-id">Commit ID<a class="headerlink" href="#glossary-commit-id" title="Permanent link">&para;</a></h2>
<p>A commit ID is a unique identifier for a <a href="#glossary-commit">commit</a>. They are 20 bytes
long when using the Git backend. They are presented in regular hexadecimal
format at the end of the line in <code>jj log</code>, using 12 hexadecimal digits by
default. When using the Git backend, the commit ID is the Git commit ID.</p>
<h2 id="glossary-co-located-repos">Co-located repos<a class="headerlink" href="#glossary-co-located-repos" title="Permanent link">&para;</a></h2>
<p>When using the Git <a href="#glossary-backend">backend</a> and the backing Git repository's <code>.git/</code>
directory is a sibling of <code>.jj/</code>, we call the repository "co-located". Most
tools designed for Git can be easily used on such repositories. <code>jj</code> and <code>git</code>
commands can be used interchangeably.</p>
<p>See <a href="#git-compatibility-co-located-jujutsugit-repos">here</a> for details.</p>
<h2 id="glossary-conflict">Conflict<a class="headerlink" href="#glossary-conflict" title="Permanent link">&para;</a></h2>
<p>Conflicts can occur in many places. The most common type is conflicts in files.
Those are the conflicts that users coming from other VCSs are usually familiar
with. You can see them in <code>jj status</code> and in <code>jj log</code> (the red "conflict"
label at the end of the line). See <a href="#conflicts">here</a> for details.</p>
<p>Conflicts can also occur in <a href="#glossary-bookmark">bookmarks</a>. For example, if you moved a
bookmark locally, and it was also moved on the remote, then the bookmark will be
in a conflicted state after you pull from the remote.
See <a href="#bookmarks-conflicts">here</a> for details.</p>
<p>Similar to a bookmark conflict, when a <a href="#glossary-change">change</a> is rewritten locally
and remotely, for example, then the change will be in a conflicted state. We
call that a <a href="#glossary-divergent-change">divergent change</a>.</p>
<h2 id="glossary-divergent-change">Divergent change<a class="headerlink" href="#glossary-divergent-change" title="Permanent link">&para;</a></h2>
<p>A divergent change is a <a href="#glossary-change">change</a> that has more than one
<a href="#glossary-visible-commits">visible commit</a>.</p>
<h2 id="glossary-head">Head<a class="headerlink" href="#glossary-head" title="Permanent link">&para;</a></h2>
<p>A head is a commit with no descendants. The context in which it has no
descendants varies. For example, the <code>heads(X)</code>
<a href="#revsets-functions">revset function</a> returns commits that have no descendants
within the set <code>X</code> itself. The <a href="#glossary-view">view</a> records which
anonymous heads (heads without a bookmark pointing to them) are visible at a
given <a href="#glossary-operation">operation</a>. Note that this is quite different from Git's
<a href="https://git-scm.com/book/en/v2/Git-Internals-Git-References#ref_the_ref">HEAD</a>.</p>
<h2 id="glossary-hidden-commits-abandoned-commits">Hidden commits, abandoned commits<a class="headerlink" href="#glossary-hidden-commits-abandoned-commits" title="Permanent link">&para;</a></h2>
<p>See <a href="#glossary-visible-commits">visible commits</a>.</p>
<h2 id="glossary-operation">Operation<a class="headerlink" href="#glossary-operation" title="Permanent link">&para;</a></h2>
<p>A snapshot of the <a href="#glossary-visible-commits">visible commits</a> and <a href="#glossary-bookmark">bookmarks</a>
at a given point in time (technically a <a href="#glossary-view">view object</a>), together with
some metadata. The metadata includes the username, hostname, timestamps, and
pointers to the operation's parents.</p>
<h2 id="glossary-operation-log">Operation log<a class="headerlink" href="#glossary-operation-log" title="Permanent link">&para;</a></h2>
<p>The operation log is the
<a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">DAG</a> formed by
<a href="#glossary-operation">operation</a> objects, much in the same way that commits form a DAG,
which is sometimes called the "commit history". When operations happen in
sequence, they form a single line in the graph. Operations that happen
concurrently from jj's perspective result in forks and merges in the DAG.</p>
<h2 id="glossary-repository">Repository<a class="headerlink" href="#glossary-repository" title="Permanent link">&para;</a></h2>
<p>Basically everything under <code>.jj/</code>, i.e. the full set of <a href="#glossary-operation">operations</a>
and <a href="#glossary-commit">commits</a>.</p>
<h2 id="glossary-remote">Remote<a class="headerlink" href="#glossary-remote" title="Permanent link">&para;</a></h2>
<p>TODO</p>
<h2 id="glossary-revision">Revision<a class="headerlink" href="#glossary-revision" title="Permanent link">&para;</a></h2>
<p>A synonym for <a href="#glossary-commit">Commit</a>.</p>
<h2 id="glossary-revset">Revset<a class="headerlink" href="#glossary-revset" title="Permanent link">&para;</a></h2>
<p>Jujutsu supports a functional language for selecting a set of revisions.
Expressions in this language are called "revsets". See <a href="#revsets">here</a> for
details. We also often use the term "revset" for the set of revisions selected
by a revset.</p>
<h2 id="glossary-rewrite">Rewrite<a class="headerlink" href="#glossary-rewrite" title="Permanent link">&para;</a></h2>
<p>To "rewrite" a commit means to create a new version of that commit with
different contents, metadata (including parent pointers), or both. Rewriting a
commit results in a new commit, and thus a new <a href="#glossary-commit-id">commit ID</a>, but the
<a href="#glossary-change-id">change ID</a> generally remains the same. Some examples of rewriting a
commit would be changing its description or rebasing it. Modifying the working
copy rewrites the working copy commit.</p>
<h2 id="glossary-root-commit">Root commit<a class="headerlink" href="#glossary-root-commit" title="Permanent link">&para;</a></h2>
<p>The root commit is a virtual commit at the root of every repository. It has a
commit ID consisting of all '0's (<code>00000000...</code>) and a change ID consisting of
all 'z's (<code>zzzzzzzz...</code>). It can be referred to in <a href="#glossary-revset">revsets</a> by the
function <code>root()</code>. Note that our definition of "root commit" is different from
Git's; Git's "root commits" are the first commit(s) in the repository, i.e. the
commits <code>jj log -r 'root()+'</code> will show.</p>
<h2 id="glossary-tree">Tree<a class="headerlink" href="#glossary-tree" title="Permanent link">&para;</a></h2>
<p>A tree object represents a snapshot of a directory in the repository. Tree
objects are defined recursively; each tree object only has the files and
directories contained directly in the directory it represents.</p>
<h2 id="glossary-tracked-bookmarks-and-tracking-bookmarks">Tracked bookmarks and tracking bookmarks<a class="headerlink" href="#glossary-tracked-bookmarks-and-tracking-bookmarks" title="Permanent link">&para;</a></h2>
<p>A remote bookmark can be made "tracked" with the <code>jj bookmark track</code> command. This
results in a "tracking" local bookmark that tracks the remote bookmark.</p>
<p>See <a href="#bookmarks-terminology-summary">the bookmarks documentation</a> for a more
detailed definition of these terms.</p>
<h2 id="glossary-visible-commits">Visible commits<a class="headerlink" href="#glossary-visible-commits" title="Permanent link">&para;</a></h2>
<p>Visible commits are the commits you see in <code>jj log -r 'all()'</code>. They are the
commits that are reachable from an anonymous head in the <a href="#glossary-view">view</a>.
Ancestors of a visible commit are implicitly visible.</p>
<p>Intuitively, visible commits are the "latest versions" of a revision with a
given <a href="#glossary-change-id">change id</a>. A commit that's abandoned or
<a href="#glossary-rewrite">rewritten</a> stops being visible and is labeled as "hidden". Such
commits are no longer accessible using a change id, but they are still
accessible by their <a href="#glossary-commit-id">commit id</a>.</p>
<h2 id="glossary-view">View<a class="headerlink" href="#glossary-view" title="Permanent link">&para;</a></h2>
<p>A view is a snapshot of bookmarks and their targets, anonymous heads,
and working-copy commits. The anonymous heads define which commits
are <a href="#glossary-visible-commits">visible</a>.</p>
<p>A view object is similar to a <a href="#glossary-tree">tree</a> object in that it represents a
snapshot without history, and an <a href="#glossary-operation">operation</a> object is similar to a
<a href="#glossary-commit">commit</a> object in that it adds metadata and history.</p>
<h2 id="glossary-workspace">Workspace<a class="headerlink" href="#glossary-workspace" title="Permanent link">&para;</a></h2>
<p>A workspace is a <a href="#glossary-working-copy">working copy</a> and an
associated <a href="#glossary-repository">repository</a>. There can be multiple workspaces for a
single repository. Each workspace has a <code>.jj/</code> directory, but the
<a href="#glossary-commit">commits</a> and <a href="#glossary-operation">operations</a> will be stored in the initial
workspace; the other workspaces will have pointers to the initial workspace. See
<a href="#working-copy-workspaces">here</a> for details.</p>
<p>This is what Git calls a "worktree".</p>
<h2 id="glossary-working-copy">Working copy<a class="headerlink" href="#glossary-working-copy" title="Permanent link">&para;</a></h2>
<p>The working copy contains the files you're currently working on. It is
automatically snapshot at the beginning of almost every <code>jj</code> command, thus
creating a new <a href="#glossary-working-copy-commit">working-copy commit</a> if any changes had
been made in the working copy. Conversely, the working copy is automatically
updated to the state of the working-copy commit at the end of almost every <code>jj</code>
command. See <a href="#working-copy">here</a> for details.</p>
<p>This is what Git calls a "working tree".</p>
<h2 id="glossary-working-copy-commit">Working-copy commit<a class="headerlink" href="#glossary-working-copy-commit" title="Permanent link">&para;</a></h2>
<p>A commit that corresponds to the current state of the working copy. There is
one working-copy commit per <a href="#glossary-workspace">workspace</a>. The current working-copy
commits are tracked in the <a href="#glossary-operation-log">operation log</a>.</p></section></section>
                    <section class='print-page md-section' id='section-8' heading-number='8'>
                        <h1>Configuration<a class='headerlink' href='#section-8' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="config" heading-number="8.1"><h1 id="config-configuration">Configuration<a class="headerlink" href="#config-configuration" title="Permanent link">&para;</a></h1>
<p>These are the config settings available to jj/Jujutsu.</p>
<h2 id="config-config-files-and-toml">Config files and TOML<a class="headerlink" href="#config-config-files-and-toml" title="Permanent link">&para;</a></h2>
<p><code>jj</code> loads several types of config settings:</p>
<ul>
<li>
<p>The built-in settings. These cannot be edited. They can be viewed in the
  <code>cli/src/config/</code> directory in <code>jj</code>'s source repo.</p>
</li>
<li>
<p>The user settings. These can be edited with <code>jj config edit --user</code>. User
settings are located in <a href="#config-user-config-files">the user config files</a>, which can be found with <code>jj
config path --user</code>.</p>
</li>
<li>
<p>The repo settings. These can be edited with <code>jj config edit --repo</code> and are
located in <code>.jj/repo/config.toml</code>.</p>
</li>
<li>
<p>Settings <a href="#config-specifying-config-on-the-command-line">specified in the command-line</a>.</p>
</li>
</ul>
<p>These are listed in the order they are loaded; the settings from earlier items
in the list are overridden by the settings from later items if they disagree.
Every type of config except for the built-in settings is optional.</p>
<p>You can enable JSON Schema validation in your editor by adding a <code>$schema</code>
reference at the top of your TOML config files. See <a href="#config-json-schema-support">JSON Schema
Support</a> for details.</p>
<p>See the <a href="https://toml.io/en/">TOML site</a> and the <a href="https://toml.io/en/v1.0.0">syntax guide</a> for a detailed description of the
syntax. We cover some of the basics below.</p>
<p>The first thing to remember is that the value of a setting (the part to the
right of the <code>=</code> sign) should be surrounded in quotes if it's a string.</p>
<h3 id="config-dotted-style-and-headings">Dotted style and headings<a class="headerlink" href="#config-dotted-style-and-headings" title="Permanent link">&para;</a></h3>
<p>In TOML, anything under a heading can be dotted instead. For example,
<code>user.name = "YOUR NAME"</code> is equivalent to:</p>
<div class="highlight"><pre><span></span><code><span class="k">[user]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR NAME&quot;</span>
</code></pre></div>
<p>For future reference, here are a couple of more complicated examples,</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Dotted style</span>
<span class="n">template-aliases</span><span class="p">.</span><span class="s2">&quot;format_short_id(id)&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;id.shortest(12)&quot;</span>
<span class="n">colors</span><span class="p">.</span><span class="s2">&quot;commit_id prefix&quot;</span><span class="p">.</span><span class="n">bold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>

<span class="c1"># is equivalent to:</span>
<span class="k">[template-aliases]</span>
<span class="s2">&quot;format_short_id(id)&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;id.shortest(12)&quot;</span>

<span class="k">[colors]</span>
<span class="s2">&quot;commit_id prefix&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">bold</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>The docs below refer to keys in text using dotted notation, but example
blocks will use heading notation to be unambiguous. If you are confident with TOML
then use whichever suits you in your config. If you mix dotted keys and headings,
<strong>you must put the dotted keys before the first heading</strong>.</p>
<p>That's probably enough TOML to keep you out of trouble but the <a href="https://toml.io/en/v1.0.0">syntax guide</a> is
very short if you ever need to check.</p>
<h2 id="config-user-settings">User settings<a class="headerlink" href="#config-user-settings" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="k">[user]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR NAME&quot;</span>
<span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR_EMAIL@example.com&quot;</span>
</code></pre></div>
<p>Don't forget to change these to your own details!</p>
<h2 id="config-ui-settings">UI settings<a class="headerlink" href="#config-ui-settings" title="Permanent link">&para;</a></h2>
<h3 id="config-colorizing-output">Colorizing output<a class="headerlink" href="#config-colorizing-output" title="Permanent link">&para;</a></h3>
<p>Possible values are <code>always</code>, <code>never</code>, <code>debug</code> and <code>auto</code> (default: <code>auto</code>).
<code>auto</code> will use color only when writing to a terminal. <code>debug</code> will print the
active labels alongside the regular colorized output.</p>
<p>This setting overrides the <code>NO_COLOR</code> environment variable (if set).</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;never&quot;</span><span class="w"> </span><span class="c1"># Turn off color</span>
</code></pre></div>
<h3 id="config-custom-colors-and-styles">Custom colors and styles<a class="headerlink" href="#config-custom-colors-and-styles" title="Permanent link">&para;</a></h3>
<p>You can customize the colors used for various elements of the UI. For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[colors]</span>
<span class="n">commit_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;green&quot;</span>
</code></pre></div>
<p>The following colors are available:</p>
<ul>
<li>black</li>
<li>red</li>
<li>green</li>
<li>yellow</li>
<li>blue</li>
<li>magenta</li>
<li>cyan</li>
<li>white</li>
<li>default</li>
</ul>
<p>All of them but "default" come in a bright version too, e.g. "bright red". The
"default" color can be used to override a color defined by a parent style
(explained below).</p>
<p>You can also use a 6-digit hex code for more control over the exact color used:</p>
<div class="highlight"><pre><span></span><code><span class="k">[colors]</span>
<span class="n">change_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;#ff1525&quot;</span>
</code></pre></div>
<p>If you use a string value for a color, as in the examples above, it will be used
for the foreground color. You can also set the background color, reverse colors
(swap foreground and background), or make the text bold, italic, or underlined.
For that, you need to use a table:</p>
<div class="highlight"><pre><span></span><code><span class="k">[colors]</span>
<span class="n">commit_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">fg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;#ff1525&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bold</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">underline</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<span class="n">change_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">italic</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>The key names are called "labels". The above used <code>commit_id</code> as label. You can
also create rules combining multiple labels. The rules work a bit like CSS
selectors. For example, if you want to color commit IDs green in general but
make the commit ID of the working-copy commit also be underlined, you can do
this:</p>
<div class="highlight"><pre><span></span><code><span class="k">[colors]</span>
<span class="n">commit_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;green&quot;</span>
<span class="s2">&quot;working_copy commit_id&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">underline</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>Parts of the style that are not overridden - such as the foreground color in the
example above - are inherited from the style of the parent label.</p>
<p>Which elements can be colored is not yet documented, but see
the <a href="https://github.com/jj-vcs/jj/blob/main/cli/src/config/colors.toml">default color configuration</a>
for some examples of what's possible.</p>
<h3 id="config-default-command">Default command<a class="headerlink" href="#config-default-command" title="Permanent link">&para;</a></h3>
<p>When <code>jj</code> is run with no explicit subcommand, the value of the
<code>ui.default-command</code> setting will be used instead. Possible values are any valid
subcommand name, subcommand alias, or user-defined alias (defaults to <code>"log"</code>).</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">default-command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--reversed&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="config-default-description">Default description<a class="headerlink" href="#config-default-description" title="Permanent link">&para;</a></h3>
<p>The editor content of a commit description can be populated by the
<code>draft_commit_description</code> template.</p>
<div class="highlight"><pre><span></span><code><span class="k">[templates]</span>
<span class="n">draft_commit_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">concat(</span>
<span class="s1">  coalesce(description, default_commit_description, &quot;\n&quot;),</span>
<span class="s1">  surround(</span>
<span class="s1">    &quot;\nJJ: This commit contains the following changes:\n&quot;, &quot;&quot;,</span>
<span class="s1">    indent(&quot;JJ:     &quot;, diff.stat(72)),</span>
<span class="s1">  ),</span>
<span class="s1">  &quot;\nJJ: ignore-rest\n&quot;,</span>
<span class="s1">  diff.git(),</span>
<span class="s1">)</span>
<span class="s1">&#39;&#39;&#39;</span>
</code></pre></div>
<p>You can override only the <code>default_commit_description</code> value if you like, e.g.:
<div class="highlight"><pre><span></span><code><span class="k">[template-aliases]</span>
<span class="n">default_commit_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&quot;</span>

<span class="s1">Closes #NNNN</span>
<span class="s1">&quot;</span>
<span class="s1">&#39;&#39;&#39;</span>
</code></pre></div></p>
<h3 id="config-duplicate-commit-description">Duplicate commit description<a class="headerlink" href="#config-duplicate-commit-description" title="Permanent link">&para;</a></h3>
<p>By default, <code>jj duplicate</code> copies the descriptions from the original commits.
You can customize this behavior by specifying the <code>duplicate_description</code>
template, which is given a <code>Commit</code> type of the original commit.</p>
<div class="highlight"><pre><span></span><code><span class="k">[templates]</span>
<span class="n">duplicate_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">concat(</span>
<span class="s1">  description,</span>
<span class="s1">  &quot;\n(cherry picked from commit &quot;,</span>
<span class="s1">  commit_id,</span>
<span class="s1">  &quot;)&quot;</span>
<span class="s1">)</span>
<span class="s1">&#39;&#39;&#39;</span>
</code></pre></div>
<h3 id="config-bookmark-listing-order">Bookmark listing order<a class="headerlink" href="#config-bookmark-listing-order" title="Permanent link">&para;</a></h3>
<p>By default, <code>jj bookmark list</code> displays bookmarks sorted alphabetically by name.
You can customize this sorting behavior by specifying sort keys in your config
file:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">bookmark-list-sort-keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</code></pre></div>
<p>The configuration works identically to using the <code>--sort</code> option for
<code>jj bookmark list</code>. The following sort keys are supported: <code>name</code>, <code>author-name</code>,
<code>author-email</code>, <code>author-date</code>, <code>committer-name</code>, <code>committer-email</code>,
<code>committer-date</code>. Suffix the key with <code>-</code> to sort in descending order. Multiple
keys can be supplied here, the first key is the most significant.</p>
<p>When the <code>--sort</code> option is used with <code>jj bookmark list</code>, the configuration
is ignored.</p>
<h3 id="config-commit-trailers">Commit trailers<a class="headerlink" href="#config-commit-trailers" title="Permanent link">&para;</a></h3>
<p>You can configure automatic addition of one or more trailers to commit
descriptions using the <code>commit_trailers</code> template.</p>
<p>Each line of the template is an individual trailer, usually in <code>Key: Value</code>
format.</p>
<p>Trailers defined in this template are deduplicated with the existing
description: if the entire line of a trailer is already present, it will not be
added again. To deduplicate based only on the trailer key, use the
<code>trailers.contains_key(key)</code> method within the template.</p>
<div class="highlight"><pre><span></span><code><span class="k">[templates]</span>
<span class="n">commit_trailers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">format_signed_off_by_trailer(self)</span>
<span class="s1">++ if(!trailers.contains_key(&quot;Change-Id&quot;), format_gerrit_change_id_trailer(self))&#39;&#39;&#39;</span>
</code></pre></div>
<p>Some ready-to-use trailer templates are available for frequently used trailers:</p>
<ul>
<li><code>format_signed_off_by_trailer(commit)</code> creates a "Signed-off-by" trailer
  using the committer info.</li>
<li><code>format_gerrit_change_id_trailer(commit)</code> creates a "Change-Id" trailer
  suitable to be used with Gerrit. It is based Jujutsu's change id.</li>
</ul>
<p>Existing trailers are also accessible via <code>commit.trailers()</code>.</p>
<h3 id="config-diff-colors-and-styles">Diff colors and styles<a class="headerlink" href="#config-diff-colors-and-styles" title="Permanent link">&para;</a></h3>
<p>In color-words and git diffs, word-level hunks are rendered with underline. You
can override the default style with the following keys:</p>
<div class="highlight"><pre><span></span><code><span class="k">[colors]</span>
<span class="c1"># Highlight hunks with background</span>
<span class="s2">&quot;diff removed token&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">bg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;#221111&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">underline</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span>
<span class="s2">&quot;diff added token&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">bg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;#002200&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">underline</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span>
<span class="c1"># Alternatively, swap colors</span>
<span class="s2">&quot;diff token&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">underline</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<h3 id="config-diff-format">Diff format<a class="headerlink" href="#config-diff-format" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="c1"># Builtin formats: &quot;:color-words&quot; (default), &quot;:git&quot;,</span>
<span class="c1">#                  &quot;:summary&quot;, &quot;:stat&quot;, &quot;:types&quot;, &quot;:name-only&quot;</span>
<span class="c1"># or external command name and arguments (see below)</span>
<span class="n">diff-formatter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;:git&quot;</span>
</code></pre></div>
<h4 id="config-color-words-diff-options">Color-words diff options<a class="headerlink" href="#config-color-words-diff-options" title="Permanent link">&para;</a></h4>
<p>In color-words diffs, changed words are displayed inline by default. Because
it's difficult to read a diff line with many removed/added words, there's a
threshold to switch to traditional separate-line format. You can also change
the default number of lines of context shown.</p>
<ul>
<li>
<p><code>max-inline-alternation</code>: Maximum number of removed/added word alternation to
  inline. For example, <code>&lt;added&gt; ... &lt;added&gt;</code> sequence has 1 alternation, so the
  line will be inline if <code>max-inline-alternation &gt;= 1</code>. <code>&lt;added&gt; ... &lt;removed&gt;
  ... &lt;added&gt;</code> sequence has 3 alternation.</p>
<ul>
<li><code>0</code>: disable inlining, making <code>--color-words</code> more similar to <code>--git</code></li>
<li><code>1</code>: inline removes-only or adds-only lines</li>
<li><code>2</code>, <code>3</code>, ..: inline up to <code>2</code>, <code>3</code>, .. alternation</li>
<li><code>-1</code>: inline all lines</li>
</ul>
<p>The default is <code>3</code>.</p>
<p><strong>This parameter is experimental.</strong> The definition is subject to change.</p>
</li>
<li>
<p><code>conflict</code>: How conflicts are processed and displayed.</p>
<ul>
<li><code>"materialize"</code>: compare materialized contents (default)</li>
<li><code>"pair"</code>: compare individual pairs</li>
</ul>
<p><strong>This parameter is experimental.</strong></p>
</li>
<li>
<p><code>context</code>: Number of lines of context to show in the diff. The default is <code>3</code>.</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">[diff.color-words]</span>
<span class="n">max-inline-alternation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
</code></pre></div>
<h4 id="config-git-diff-options">Git diff options<a class="headerlink" href="#config-git-diff-options" title="Permanent link">&para;</a></h4>
<p>In git diffs you can change the default number of lines of context shown.</p>
<ul>
<li><code>context</code>: Number of lines of context to show in the diff. The default is <code>3</code>.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">[diff.git]</span>
<span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
</code></pre></div>
<h3 id="config-generating-diffs-by-external-command">Generating diffs by external command<a class="headerlink" href="#config-generating-diffs-by-external-command" title="Permanent link">&para;</a></h3>
<p>If <code>ui.diff-formatter</code> is not a builtin format, the specified diff command will
be called.</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="c1"># Use Difftastic by default</span>
<span class="n">diff-formatter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;difft&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--color=always&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$left&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$right&quot;</span><span class="p">]</span>
<span class="c1"># Use tool named &quot;&lt;name&gt;&quot; (see below)</span>
<span class="n">diff-formatter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;name&gt;&quot;</span>
</code></pre></div>
<p>The external diff tool can also be enabled by <code>diff --tool &lt;name&gt;</code> argument.
For the tool named <code>&lt;name&gt;</code>, command arguments can be configured as follows.</p>
<div class="highlight"><pre><span></span><code><span class="k">[merge-tools.</span><span class="err">&lt;</span><span class="k">name</span><span class="err">&gt;</span><span class="k">]</span>
<span class="c1"># program = &quot;&lt;name&gt;&quot;  # Defaults to the name of the tool if not specified</span>
<span class="n">diff-args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;--color=always&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$left&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$right&quot;</span><span class="p">]</span>
</code></pre></div>
<ul>
<li><code>$left</code> and <code>$right</code> are replaced with the paths to the left and right
  directories to diff respectively.</li>
</ul>
<p>By default <code>jj</code> will invoke external tools with a directory containing the left
and right sides.  The <code>diff-invocation-mode</code> config can change this to file by file
invocations as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">diff-formatter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;vimdiff&quot;</span>

<span class="k">[merge-tools.vimdiff]</span>
<span class="n">diff-invocation-mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;file-by-file&quot;</span>
</code></pre></div>
<p>By default <code>jj</code> will display a warning when the command exits with a non-success
error code. The <code>diff-expected-exit-codes</code> config can suppress this warning
message for specific exit codes:</p>
<div class="highlight"><pre><span></span><code><span class="k">[merge-tools.delta]</span>
<span class="n">diff-expected-exit-codes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
<h3 id="config-conflict-marker-style">Conflict marker style<a class="headerlink" href="#config-conflict-marker-style" title="Permanent link">&para;</a></h3>
<p>You can configure which style of conflict markers to use when materializing
conflicts:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="c1"># Shows a single snapshot and one or more diffs to apply to it</span>
<span class="n">conflict-marker-style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;diff&quot;</span>
<span class="c1"># Shows a snapshot for each side and base of the conflict</span>
<span class="n">conflict-marker-style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;snapshot&quot;</span>
<span class="c1"># Uses Git&#39;s &quot;diff3&quot; conflict markers to support tools that depend on it</span>
<span class="n">conflict-marker-style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;git&quot;</span>
</code></pre></div>
<p>For more details about these conflict marker styles, see the <a href="#conflicts-conflict-markers">conflicts
page</a>.</p>
<h3 id="config-set-of-immutable-commits">Set of immutable commits<a class="headerlink" href="#config-set-of-immutable-commits" title="Permanent link">&para;</a></h3>
<p>You can configure the set of immutable commits via
<code>revset-aliases."immutable_heads()"</code>. The default set of immutable heads is
<code>builtin_immutable_heads()</code>, which in turn is defined as
<code>present(trunk()) | tags() | untracked_remote_bookmarks()</code>. For example, to
also consider the <code>release@origin</code> bookmark immutable:</p>
<div class="highlight"><pre><span></span><code><span class="k">[revset-aliases]</span>
<span class="s2">&quot;immutable_heads()&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;builtin_immutable_heads() | release@origin&quot;</span>
</code></pre></div>
<p>To prevent rewriting commits authored by other users:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># The `trunk().. &amp;` bit is an optimization to scan for non-`mine()` commits</span>
<span class="c1"># only among commits that are not in `trunk()`.</span>
<span class="k">[revset-aliases]</span>
<span class="s2">&quot;immutable_heads()&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;builtin_immutable_heads() | (trunk().. &amp; ~mine())&quot;</span>
</code></pre></div>
<p>Ancestors of the configured set are also immutable. The root commit is always
immutable even if the set is empty.</p>
<p>Immutable commits (other than the root commit) can be rewritten using the
<code>--ignore-immutable</code> CLI flag.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using <code>--ignore-immutable</code> will allow you to rewrite any commit in the
history, and all descendants, without warning. Use this power wisely, and
remember <code>jj undo</code>.</p>
</div>
<h3 id="config-behavior-of-prev-and-next-commands">Behavior of prev and next commands<a class="headerlink" href="#config-behavior-of-prev-and-next-commands" title="Permanent link">&para;</a></h3>
<p>If you prefer using an "edit-based" workflow, rather than squashing
modifications into parent changes, you may find yourself using the <code>prev</code> and
<code>next</code> commands with their <code>--edit</code> flag often to move between your changes. You
can avoid having to type the <code>--edit</code> flag every time you need it by actually
making it the default:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui.movement]</span>
<span class="n">edit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</code></pre></div>
<p>You can pass the <code>--no-edit</code> flag to <code>prev</code> and <code>next</code> if you find yourself
needing the original behavior.</p>
<h2 id="config-list">List<a class="headerlink" href="#config-list" title="Permanent link">&para;</a></h2>
<h3 id="config-default-template">Default Template<a class="headerlink" href="#config-default-template" title="Permanent link">&para;</a></h3>
<p>You can configure the template used when no <code>-T</code> is specified.</p>
<ul>
<li><code>templates.config_list</code> for <code>jj config list</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">[templates]</span>
<span class="c1"># Use builtin config list template</span>
<span class="n">config_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;builtin_config_list&quot;</span>
</code></pre></div>
<p>If you want to see the config variable origin (type and path) when you do <code>jj config list</code>
you can add this to your config:</p>
<div class="highlight"><pre><span></span><code><span class="k">[templates]</span>
<span class="n">config_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;builtin_config_list_detailed&quot;</span>
</code></pre></div>
<h2 id="config-log">Log<a class="headerlink" href="#config-log" title="Permanent link">&para;</a></h2>
<h3 id="config-default-revisions">Default revisions<a class="headerlink" href="#config-default-revisions" title="Permanent link">&para;</a></h3>
<p>You can configure the revisions <code>jj log</code> would show when neither <code>-r</code> nor any paths are specified.</p>
<div class="highlight"><pre><span></span><code><span class="k">[revsets]</span>
<span class="c1"># Show commits that are not in `main@origin`</span>
<span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;main@origin..&quot;</span>
</code></pre></div>
<p>The default value for <code>revsets.log</code> is
<code>'present(@) | ancestors(immutable_heads().., 2) | present(trunk())'</code>.</p>
<h3 id="config-default-template_1">Default Template<a class="headerlink" href="#config-default-template_1" title="Permanent link">&para;</a></h3>
<p>You can configure the template used when no <code>-T</code> is specified.</p>
<ul>
<li><code>templates.log</code> for <code>jj log</code></li>
<li><code>templates.op_log</code> for <code>jj op log</code></li>
<li><code>templates.show</code> for <code>jj show</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">[templates]</span>
<span class="c1"># Use builtin log template</span>
<span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;builtin_log_compact&quot;</span>
<span class="c1"># Use builtin op log template</span>
<span class="n">op_log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;builtin_op_log_compact&quot;</span>
<span class="c1"># Use builtin show template</span>
<span class="n">show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;builtin_log_detailed&quot;</span>
</code></pre></div>
<p>If you want to see the full description when you do <code>jj log</code> you can add this to
your config:</p>
<div class="highlight"><pre><span></span><code><span class="k">[templates]</span>
<span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;builtin_log_compact_full_description&quot;</span>
</code></pre></div>
<h3 id="config-graph-style">Graph style<a class="headerlink" href="#config-graph-style" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="c1"># Possible values: &quot;curved&quot; (default), &quot;square&quot;, &quot;ascii&quot;, &quot;ascii-large&quot;</span>
<span class="n">graph</span><span class="p">.</span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;square&quot;</span>
</code></pre></div>
<h4 id="config-node-style">Node style<a class="headerlink" href="#config-node-style" title="Permanent link">&para;</a></h4>
<p>The symbols used to represent commits or operations can be customized via
templates.</p>
<ul>
<li><code>templates.log_node</code> for commits (with <code>Option&lt;Commit&gt;</code> keywords)</li>
<li><code>templates.op_log_node</code> for operations (with <code>Operation</code> keywords)</li>
</ul>
<p>For example:
<div class="highlight"><pre><span></span><code><span class="k">[templates]</span>
<span class="n">log_node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">coalesce(</span>
<span class="s1">  if(!self, &quot;🮀&quot;),</span>
<span class="s1">  if(current_working_copy, &quot;@&quot;),</span>
<span class="s1">  if(root, &quot;┴&quot;),</span>
<span class="s1">  if(immutable, &quot;●&quot;, &quot;○&quot;),</span>
<span class="s1">)</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">op_log_node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;if(current_operation, &quot;@&quot;, &quot;○&quot;)&#39;</span>
</code></pre></div></p>
<h3 id="config-wrap-log-content">Wrap log content<a class="headerlink" href="#config-wrap-log-content" title="Permanent link">&para;</a></h3>
<p>If enabled, <code>log</code>/<code>evolog</code>/<code>op log</code> content will be wrapped based on
the terminal width.</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">log-word-wrap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</code></pre></div>
<h3 id="config-display-of-commit-and-change-ids">Display of commit and change ids<a class="headerlink" href="#config-display-of-commit-and-change-ids" title="Permanent link">&para;</a></h3>
<p>Can be customized by the <code>format_short_id()</code> template alias.</p>
<div class="highlight"><pre><span></span><code><span class="k">[template-aliases]</span>
<span class="c1"># Highlight unique prefix and show at least 12 characters (default)</span>
<span class="s1">&#39;format_short_id(id)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;id.shortest(12)&#39;</span>
<span class="c1"># Just the shortest possible unique prefix</span>
<span class="s1">&#39;format_short_id(id)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;id.shortest()&#39;</span>
<span class="c1"># Show unique prefix and the rest surrounded by brackets</span>
<span class="s1">&#39;format_short_id(id)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;id.shortest(12).prefix() ++ &quot;[&quot; ++ id.shortest(12).rest() ++ &quot;]&quot;&#39;</span>
<span class="c1"># Always show 12 characters</span>
<span class="s1">&#39;format_short_id(id)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;id.short(12)&#39;</span>
</code></pre></div>
<p>To customize these separately, use the <code>format_short_commit_id()</code> and
<code>format_short_change_id()</code> aliases:</p>
<div class="highlight"><pre><span></span><code><span class="k">[template-aliases]</span>
<span class="c1"># Uppercase change ids. `jj` treats change and commit ids as case-insensitive.</span>
<span class="s1">&#39;format_short_change_id(id)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;format_short_id(id).upper()&#39;</span>
</code></pre></div>
<p>Operation ids can be customized by the <code>format_short_operation_id()</code> alias:</p>
<div class="highlight"><pre><span></span><code><span class="k">[template-aliases]</span>
<span class="c1"># Always show 12 characters</span>
<span class="s1">&#39;format_short_operation_id(id)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;id.short(12)&#39;</span>
</code></pre></div>
<p>To get shorter prefixes for certain revisions, set <code>revsets.short-prefixes</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">[revsets]</span>
<span class="c1"># Prioritize the current bookmark</span>
<span class="n">short-prefixes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;(main..@)::&quot;</span>
</code></pre></div>
<h3 id="config-relative-timestamps">Relative timestamps<a class="headerlink" href="#config-relative-timestamps" title="Permanent link">&para;</a></h3>
<p>Can be customized by the <code>format_timestamp()</code> template alias.</p>
<div class="highlight"><pre><span></span><code><span class="k">[template-aliases]</span>
<span class="c1"># Full timestamp in ISO 8601 format</span>
<span class="s1">&#39;format_timestamp(timestamp)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;timestamp&#39;</span>
<span class="c1"># Relative timestamp rendered as &quot;x days/hours/seconds ago&quot;</span>
<span class="s1">&#39;format_timestamp(timestamp)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;timestamp.ago()&#39;</span>
</code></pre></div>
<p><code>jj op log</code> defaults to relative timestamps. To use absolute timestamps, you
will need to modify the <code>format_time_range()</code> template alias.</p>
<div class="highlight"><pre><span></span><code><span class="k">[template-aliases]</span>
<span class="s1">&#39;format_time_range(time_range)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;time_range.start() ++ &quot; - &quot; ++ time_range.end()&#39;</span>
</code></pre></div>
<h3 id="config-author-format">Author format<a class="headerlink" href="#config-author-format" title="Permanent link">&para;</a></h3>
<p>Can be customized by the <code>format_short_signature()</code> template alias.</p>
<div class="highlight"><pre><span></span><code><span class="k">[template-aliases]</span>
<span class="c1"># Full email address (default)</span>
<span class="s1">&#39;format_short_signature(signature)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;signature.email()&#39;</span>
<span class="c1"># Both name and email address</span>
<span class="s1">&#39;format_short_signature(signature)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;signature&#39;</span>
<span class="c1"># Username part of the email address</span>
<span class="s1">&#39;format_short_signature(signature)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;signature.email().local()&#39;</span>
</code></pre></div>
<h3 id="config-commit-timestamp">Commit timestamp<a class="headerlink" href="#config-commit-timestamp" title="Permanent link">&para;</a></h3>
<p>Commits have both an "author timestamp" and "committer timestamp". By default,
jj displays the committer timestamp, but can be changed to show the author
timestamp instead.</p>
<p>The function must return a timestamp because the return value will likely be
formatted with <code>format_timestamp()</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">[template-aliases]</span>
<span class="s1">&#39;commit_timestamp(commit)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;commit.author().timestamp()&#39;</span>
</code></pre></div>
<h3 id="config-signature-format">Signature format<a class="headerlink" href="#config-signature-format" title="Permanent link">&para;</a></h3>
<p>Can be enabled with <code>ui.show-cryptographic-signatures</code>, and
customized with <code>format_short_cryptographic_signature(sig)</code> and
<code>format_detailed_cryptographic_signature(sig)</code>.</p>
<p>Note that the formatting functions take an <code>Option&lt;CryptographicSignature&gt;</code>.
This allows you to emit a custom message if a signature is not present, but
will raise an error if you try to access methods on a signature that is not
available.</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="c1"># default is false</span>
<span class="n">show-cryptographic-signatures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>

<span class="k">[template-aliases]</span>
<span class="s1">&#39;format_short_cryptographic_signature(sig)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">  if(sig,</span>
<span class="s1">    sig.status(),</span>
<span class="s1">    &quot;(no sig)&quot;,</span>
<span class="s1">  )</span>
<span class="s1">&#39;&#39;&#39;</span>
</code></pre></div>
<h2 id="config-allow-large-revsets-by-default">Allow "large" revsets by default<a class="headerlink" href="#config-allow-large-revsets-by-default" title="Permanent link">&para;</a></h2>
<p>Certain commands (such as <code>jj rebase</code>) can take multiple revset arguments, but
default to requiring each of those revsets to expand to a <em>single</em> revision.
This restriction can be overridden by prefixing a revset that the user wants to
be able to expand to more than one revision with the <a href="#revsets-the-all-modifier"><code>all:</code>
modifier</a>.</p>
<p>Another way you can override this check is by setting
<code>ui.always-allow-large-revsets</code> to <code>true</code>. Then, <code>jj</code> will allow every one of
the revset arguments of such commands to expand to any number of revisions.</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="c1"># Assume `all:` prefix before revsets whenever it would make a difference</span>
<span class="n">always-allow-large-revsets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</code></pre></div>
<h2 id="config-pager">Pager<a class="headerlink" href="#config-pager" title="Permanent link">&para;</a></h2>
<p>The default pager is can be set via <code>ui.pager</code> or the <code>PAGER</code> environment
variable. The priority is as follows (environment variables are marked with
a <code>$</code>):</p>
<p><code>ui.pager</code> &gt; <code>$PAGER</code></p>
<p><code>less -FRX</code> is the default pager in the absence of any other setting, except
on Windows where it is <code>:builtin</code>.</p>
<p>The special value <code>:builtin</code> enables usage of the <a href="#config-builtin-pager">integrated
pager</a>.</p>
<p>If you are using a standard Linux distro, your system likely already has
<code>$PAGER</code> set and that will be preferred over the built-in. To use the built-in:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--user<span class="w"> </span>ui.pager<span class="w"> </span>:builtin
</code></pre></div>
<p>It is possible the default will change to <code>:builtin</code> for all platforms in the
future.</p>
<p>Additionally, paging behavior can be toggled via <code>ui.paginate</code> like so:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="c1"># Enable pagination for commands that support it (default)</span>
<span class="n">paginate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;auto&quot;</span>
<span class="c1"># Disable all pagination, equivalent to using --no-pager</span>
<span class="n">paginate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;never&quot;</span>
</code></pre></div>
<h3 id="config-builtin-pager">Builtin pager<a class="headerlink" href="#config-builtin-pager" title="Permanent link">&para;</a></h3>
<p>Our builtin pager is based on
<a href="https://github.com/markbt/streampager/"><code>streampager</code></a> but is configured within
<code>jj</code>'s config. It is configured via the <code>ui.streampager</code> table.</p>
<h4 id="config-key-bindings">Key bindings<a class="headerlink" href="#config-key-bindings" title="Permanent link">&para;</a></h4>
<p>The built-in pager supports both navigation via arrows and Vim-style navigation.
Beyond that, here are some useful keybindings for the pager:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Key</th>
<th style="text-align: left;">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>Ctrl-c</code> or <code>q</code></td>
<td style="text-align: left;">Quit</td>
</tr>
<tr>
<td style="text-align: left;"><code>h</code> or <code>F1</code></td>
<td style="text-align: left;">Show all key bindings</td>
</tr>
<tr>
<td style="text-align: left;"><code>Esc</code></td>
<td style="text-align: left;">Close help or prompt</td>
</tr>
<tr>
<td style="text-align: left;"><code>\</code></td>
<td style="text-align: left;">Toggle line wrapping</td>
</tr>
<tr>
<td style="text-align: left;"><code>#</code></td>
<td style="text-align: left;">Toggle line numbers</td>
</tr>
<tr>
<td style="text-align: left;"><code>Ctrl-r</code></td>
<td style="text-align: left;">Toggle the ruler</td>
</tr>
</tbody>
</table>
<p>The built-in pager does not support mouse input.</p>
<h4 id="config-wrapping-config">Wrapping config<a class="headerlink" href="#config-wrapping-config" title="Permanent link">&para;</a></h4>
<p>Wrapping performed by the pager happens <em>in addition to</em> any
wrapping that <code>jj</code> itself does.</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui.streampager]</span>
<span class="n">wrapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;anywhere&quot;</span><span class="w">  </span><span class="c1"># wrap at screen edge (default)</span>
<span class="n">wrapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;word&quot;</span><span class="w">      </span><span class="c1"># wrap on word boundaries</span>
<span class="n">wrapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="w">      </span><span class="c1"># strip long lines, allow scrolling</span>
<span class="w">                       </span><span class="c1"># left and right like `less -S`</span>
</code></pre></div>
<h4 id="config-auto-exit-clearing-the-screen-on-startup-or-exit">Auto-exit, clearing the screen on startup or exit<a class="headerlink" href="#config-auto-exit-clearing-the-screen-on-startup-or-exit" title="Permanent link">&para;</a></h4>
<p>You can configure whether the pager clears the screen on startup or exit, and
whether it quits automatically on short inputs. When the pager auto-quits,
features like word-wrapping are disabled.</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui.streampager]</span>
<span class="c1"># Do not clear screen on exit. Use a full-screen interface for long</span>
<span class="c1"># output only. Like `less -FX`.</span>
<span class="n">interface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;quit-if-one-page&quot;</span><span class="w">  </span><span class="c1"># (default).</span>
<span class="c1"># Always use a full-screen interface, ask the terminal to clear the</span>
<span class="c1"># screen on exit. Like `less -+FX`.</span>
<span class="n">interface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;full-screen-clear-output&quot;</span>
<span class="c1"># Use the alternate screen if the input is either long or takes more</span>
<span class="c1"># than 2 seconds to finish. Similar but not identical to `less -F -+X`.</span>
<span class="n">interface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;quit-quickly-or-clear-output&quot;</span>
</code></pre></div>
<h4 id="config-showing-the-ruler-on-startup">Showing the ruler on startup<a class="headerlink" href="#config-showing-the-ruler-on-startup" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">[ui.streampager]</span>
<span class="c1"># Start with the ruler showing</span>
<span class="n">show-ruler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="c1"># (default)</span>
<span class="c1"># Start with the ruler hidden</span>
<span class="n">show-ruler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</code></pre></div>
<h3 id="config-processing-contents-to-be-paged">Processing contents to be paged<a class="headerlink" href="#config-processing-contents-to-be-paged" title="Permanent link">&para;</a></h3>
<p>If you'd like to pass the output through a formatter e.g.
<a href="https://github.com/so-fancy/diff-so-fancy"><code>diff-so-fancy</code></a> before piping it
through a pager you must do it using a subshell as, unlike <code>git</code> or <code>hg</code>, the
command will be executed directly. For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">pager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;diff-so-fancy | less -RFX&quot;</span><span class="p">]</span>
</code></pre></div>
<p>Some formatters (like <a href="https://github.com/dandavison/delta"><code>delta</code></a>) require
git style diffs for formatting. You can configure this style of
diff as the default with the <code>ui.diff</code> setting. For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">pager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span>

<span class="k">[ui.diff]</span>
<span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;git&quot;</span>
</code></pre></div>
<h2 id="config-aliases">Aliases<a class="headerlink" href="#config-aliases" title="Permanent link">&para;</a></h2>
<p>You can define aliases for commands, including their arguments. For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[aliases]</span>
<span class="c1"># `jj l` shows commits on the working-copy commit&#39;s (anonymous) bookmark</span>
<span class="c1"># compared to the `main` bookmark</span>
<span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-r&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;(main..@):: | (main..@)-&quot;</span><span class="p">]</span>
</code></pre></div>
<p>This alias syntax can only run a single jj command. However, you may want to
execute multiple jj commands with a single alias, or run arbitrary scripts that
complement your version control workflow. This can be done, but be aware of the
danger:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The following technique just provides a convenient syntax for running
arbitrary code on your system. Using it irresponsibly may cause damage
ranging from breaking the behavior of <code>jj undo</code> to wiping your file system.
Exercise the same amount of caution while writing these aliases as you would
when typing commands into the terminal!</p>
<p>This feature may be removed or replaced by an embedded scripting language in
the future.</p>
</div>
<p>The command <code>jj util exec</code> will simply run any command you pass to it as an
argument. Additional arguments are passed through. Here are some examples:</p>
<div class="highlight"><pre><span></span><code><span class="k">[aliases]</span>
<span class="n">my-script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;util&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;exec&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;my-jj-script&quot;</span><span class="p">]</span>
<span class="c1">#                            ^^^^</span>
<span class="c1"># This makes sure that flags are passed to your script instead of parsed by jj.</span>
<span class="n">my-inline-script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;util&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;exec&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;bash&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">set -euo pipefail</span>
<span class="s2">echo &quot;Look Ma, everything in one file!&quot;</span>
<span class="s2">echo &quot;args: $@&quot;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="c1">#    ^^</span>
<span class="c1"># This last empty string will become &quot;$0&quot; in bash, so your actual arguments</span>
<span class="c1"># are all included in &quot;$@&quot; and start at &quot;$1&quot; as expected.</span>
</code></pre></div>
<blockquote>
<p>Note: Shebangs (e.g. <code>#!/usr/bin/env</code>) aren't necessary since you're already
explicitly passing your script into the right shell.</p>
</blockquote>
<h2 id="config-editor">Editor<a class="headerlink" href="#config-editor" title="Permanent link">&para;</a></h2>
<p>The default editor is set via <code>ui.editor</code>, though there are several places to
set it. The priority is as follows (environment variables are marked with
a <code>$</code>):</p>
<p><code>$JJ_EDITOR</code> &gt; <code>ui.editor</code> &gt; <code>$VISUAL</code> &gt; <code>$EDITOR</code></p>
<p>Pico is the default editor (Notepad on Windows) in the absence of any other
setting, but you could set it explicitly too.</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;pico&quot;</span>
</code></pre></div>
<p>To use NeoVim instead:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;nvim&quot;</span>
</code></pre></div>
<p>For GUI editors you possibly need to use a <code>-w</code> or <code>--wait</code>. Some examples:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="n">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;code -w&quot;</span><span class="w">       </span><span class="c1"># VS Code</span>
<span class="n">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;code.cmd -w&quot;</span><span class="w">   </span><span class="c1"># VS Code on Windows</span>
<span class="n">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bbedit -w&quot;</span><span class="w">     </span><span class="c1"># BBEdit</span>
<span class="n">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;subl -n -w&quot;</span><span class="w">    </span><span class="c1"># Sublime Text</span>
<span class="n">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;mate -w&quot;</span><span class="w">       </span><span class="c1"># TextMate</span>
<span class="n">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;C:/Program Files/Notepad++/notepad++.exe&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;-multiInst&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-notabbar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-nosession&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-noPlugin&quot;</span><span class="p">]</span><span class="w"> </span><span class="c1"># Notepad++</span>
<span class="n">editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;idea --temp-project --wait&quot;</span><span class="w">   </span><span class="c1">#IntelliJ</span>
</code></pre></div>
<p>Obviously, you would only set one line, don't copy them all in!</p>
<h2 id="config-editing-diffs">Editing diffs<a class="headerlink" href="#config-editing-diffs" title="Permanent link">&para;</a></h2>
<p>The <code>ui.diff-editor</code> setting affects the default tool used for editing diffs
(e.g.  <code>jj split</code>, <code>jj squash -i</code>). If it is not set, the special value
<code>:builtin</code> is used. It launches a built-in TUI tool (known as <a href="https://github.com/arxanas/scm-record?tab=readme-ov-file#scm-diff-editor">scm-diff-editor</a>)
to edit the diff in your terminal.</p>
<p>You can try a different tool temporarily by doing e.g. <code>jj split --tool meld</code> or
you can set the option to change the default. This requires that you have an
appropriate tool installed, see for example <a href="#config-using-meld-as-a-diff-editor">the instructions for using
Meld</a>.</p>
<p><strong>Suggestion:</strong> If possible, it is recommended to try an external diff tool like
<a href="#config-using-meld-as-a-diff-editor">Meld</a> (see below for some other possibilities)
for splitting commits and other diff editing, in addition to the built-in diff
editor. It is good to know the capabilities of both. The built-in diff editor
does not require external tools to be available, is faster for tasks like
picking hunks, and does not require leaving the terminal. External tools give
you the flexibility of picking out portions of lines from the diff or even
arbitrarily editing the text of the files.</p>
<p>If <code>ui.diff-editor</code> is a string, e.g. <code>"meld"</code>, the arguments will be read from
the following config keys.</p>
<div class="highlight"><pre><span></span><code><span class="k">[merge-tools.meld]</span>
<span class="c1"># program = &quot;meld&quot;      # Defaults to the name of the tool if not specified</span>
<span class="n">program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/path/to/meld&quot;</span><span class="w"> </span><span class="c1"># May be necessary if `meld` is not in the PATH</span>
<span class="n">edit-args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;--newtab&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$left&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$right&quot;</span><span class="p">]</span>
</code></pre></div>
<p><code>jj</code> makes the following substitutions:</p>
<ul>
<li>
<p><code>$left</code> and <code>$right</code> are replaced with the paths to the left and right
  directories to diff respectively.</p>
</li>
<li>
<p>If no <code>edit-args</code> are specified, <code>["$left", "$right"]</code> are set by default.</p>
</li>
</ul>
<p>Finally, <code>ui.diff-editor</code> can be a list that specifies a command and its arguments.</p>
<p>Some examples:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="c1"># Use merge-tools.meld.edit-args</span>
<span class="n">diff-editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;meld&quot;</span><span class="w">  </span><span class="c1"># Or `kdiff3`, or `diffedit3`, ...</span>
<span class="c1"># Specify edit-args inline</span>
<span class="n">diff-editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/path/to/binary&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--be-helpful&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$left&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$right&quot;</span><span class="p">]</span>
<span class="c1"># Equivalent to [&quot;binary&quot;, &quot;$left&quot;, &quot;$right&quot;] arguments by default</span>
<span class="n">diff-editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;binary&quot;</span>
</code></pre></div>
<h3 id="config-experimental-3-pane-diff-editing">Experimental 3-pane diff editing<a class="headerlink" href="#config-experimental-3-pane-diff-editing" title="Permanent link">&para;</a></h3>
<p>We offer two special "3-pane" diff editor configs:</p>
<ul>
<li><code>meld-3</code>, which requires installing <a href="https://meldmerge.org/">Meld</a>, and</li>
<li><code>diffedit3</code>, which requires installing <a href="https://github.com/ilyagr/diffedit3/releases"><code>diffedit3</code></a>.</li>
</ul>
<p><code>Meld</code> is a graphical application that is recommended, but can be difficult to
install in some situations. <code>diffedit3</code> is designed to be easy to install and to
be usable in environments where Meld is difficult to use (e.g. over SSH via port
forwarding). <code>diffedit3</code> starts a local server that can be accessed via a web
browser, similarly to <a href="https://jupyter.org/">Jupyter</a>.</p>
<p>There is also the <code>diffedit3-ssh</code> which is similar to <code>diffedit3</code> but does not
try to open the web browser pointing to the local server (the URL
printed to the terminal) automatically. <code>diffedit3-ssh</code> also always uses ports in between
17376-17380 and fails if they are all busy. This can be useful when working
over SSH. Open the fold below for more details of how to set that up.</p>
<details>
<summary> Tips for using `diffedit3-ssh` over SSH </summary>

To use `diffedit3` over SSH, you need to set up port forwarding. One way to do
this is to start SSH as follows (copy-paste the relevant lines):

<div class="highlight"><pre><span></span><code>ssh<span class="w"> </span>-L<span class="w"> </span><span class="m">17376</span>:localhost:17376<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-L<span class="w"> </span><span class="m">17377</span>:localhost:17377<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-L<span class="w"> </span><span class="m">17378</span>:localhost:17378<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-L<span class="w"> </span><span class="m">17379</span>:localhost:17379<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-L<span class="w"> </span><span class="m">17380</span>:localhost:17380<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>myhost.example.com
</code></pre></div>

`diffedit3-ssh` is set up to use these 5 ports by default. Usually, only the
first of them will be used. The rest are used if another program happens to use
one of them, or if you run multiple instances of `diffedit3` at the same time.

Another way is to add a snippet to `~/.ssh/config`:

<div class="highlight"><pre><span></span><code>Host myhost
    User     myself
    Hostname myhost.example.com
    LocalForward 17376 localhost:17376
    LocalForward 17377 localhost:17377
    LocalForward 17378 localhost:17378
    LocalForward 17379 localhost:17379
    LocalForward 17380 localhost:17380
</code></pre></div>

With that configuration, you should be able to simply `ssh myhost`.

</details>

<p>Setting either <code>ui.diff-editor = "meld-3"</code> or <code>ui.diff-editor = "diffedit3"</code>
will result in the diff editor showing 3 panes: the diff on the left and right,
and an editing pane in the middle. This allow you to see both sides of the
original diff while editing.</p>
<p>If you use <code>ui.diff-editor = "meld-3"</code>, note that you can still get the 2-pane
Meld view using <code>jj diff --tool meld</code>. <code>diffedit3</code> has a button you can use to
switch to a 2-pane view.</p>
<p>To configure other diff editors in this way, you can include <code>$output</code> together
with <code>$left</code> and <code>$right</code> in <code>merge-tools.TOOL.edit-args</code>. <code>jj</code> will replace
<code>$output</code> with the directory where the diff editor will be expected to put the
result of the user's edits. Initially, the contents of <code>$output</code> will be the
same as the contents of <code>$right</code>.</p>
<h3 id="config-jj-instructions"><code>JJ-INSTRUCTIONS</code><a class="headerlink" href="#config-jj-instructions" title="Permanent link">&para;</a></h3>
<p>When editing a diff, jj will include a synthetic file called <code>JJ-INSTRUCTIONS</code>
in the diff with instructions on how to edit the diff. Any changes you make to
this file will be ignored. To suppress the creation of this file, set
<code>ui.diff-instructions = false</code>.</p>
<h3 id="config-using-meld-as-a-diff-editor">Using Meld as a diff editor<a class="headerlink" href="#config-using-meld-as-a-diff-editor" title="Permanent link">&para;</a></h3>
<p><a href="https://meldmerge.org">Meld</a> is a nice and polished free diff editor. It can be
obtained as follows:</p>
<ul>
<li>
<p><strong>Linux:</strong> use your favorite package manager, e.g. <code>sudo apt install meld</code>.</p>
</li>
<li>
<p><strong>Windows:</strong> Meld can be downloaded from <a href="https://meldmerge.org/">https://meldmerge.org/</a>.</p>
</li>
<li>
<p><strong>Mac OS:</strong> Install Homebrew and run <code>brew install --cask meld</code>.
  This will install both an app in <code>/Applications/Meld.app</code> and the command-line
  <code>meld</code> command that <code>jj</code> uses. You can read about <a href="https://gist.github.com/ilyagr/1b40f6061d8ad320cee4c12843df1a23">more details and other
  options</a> but,
  as of this writing, this is by far the easiest.</p>
</li>
</ul>
<p><code>jj</code> has two diff editing configurations that use Meld: <code>meld</code> for a 2-pane view
and <code>meld-3</code> for a <a href="#config-experimental-3-pane-diff-editing">three-pane view</a>.</p>
<p>There is also a <code>meld</code> <a href="#config-3-way-merge-tools-for-conflict-resolution">merge tool</a>
that can be useful, but does not support displaying the merge base while
merging.</p>
<h3 id="config-using-vim-as-a-diff-editor">Using Vim as a diff editor<a class="headerlink" href="#config-using-vim-as-a-diff-editor" title="Permanent link">&para;</a></h3>
<p>Using <code>ui.diff-editor = "vimdiff"</code> is possible but not recommended. For a better
experience, you can follow <a href="https://github.com/jj-vcs/jj/wiki/Vim#using-vim-as-a-diff-tool">instructions from the Wiki</a> to configure the
<a href="https://github.com/will133/vim-dirdiff">DirDiff Vim plugin</a> and/or the <a href="https://github.com/balki/vimtabdiff">vimtabdiff Python script</a>.</p>
<h2 id="config-3-way-merge-tools-for-conflict-resolution">3-way merge tools for conflict resolution<a class="headerlink" href="#config-3-way-merge-tools-for-conflict-resolution" title="Permanent link">&para;</a></h2>
<p>The <code>ui.merge-editor</code> key specifies the tool used for three-way merge tools
by <code>jj resolve</code>. For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[ui]</span>
<span class="c1"># Use merge-tools.meld.merge-args</span>
<span class="n">merge-editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;meld&quot;</span><span class="w">  </span><span class="c1"># Or &quot;vscode&quot; or &quot;vscodium&quot; or &quot;kdiff3&quot; or &quot;vimdiff&quot;</span>
<span class="c1"># Specify merge-args inline</span>
<span class="n">merge-editor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;meld&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$left&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$base&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$right&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-o&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$output&quot;</span><span class="p">]</span>
</code></pre></div>
<p>The following tools can be used out of the box, as long as they are installed:</p>
<ul>
<li>"kdiff3"</li>
<li>"meld"</li>
<li>"mergiraf"</li>
<li>"smerge"</li>
<li>"vimdiff"</li>
<li>"vscode"</li>
<li>"vscodium"</li>
</ul>
<p>Using VS Code as a merge tool works well with VS Code's <a href="https://code.visualstudio.com/docs/remote/remote-overview">Remote
Development</a>
functionality, as long as <code>jj</code> is called from VS Code's terminal.</p>
<h3 id="config-setting-up-a-custom-merge-tool">Setting up a custom merge tool<a class="headerlink" href="#config-setting-up-a-custom-merge-tool" title="Permanent link">&para;</a></h3>
<p>To use a different tool named <code>TOOL</code>, the arguments to pass to the tool MUST be
specified either inline or in the <code>merge-tools.TOOL.merge-args</code> key. As an
example of how to set this key and other tool configuration options, here is
the out-of-the-box configuration of the three default tools. (There is no need
to copy it to your config file verbatim, but you are welcome to customize it.)</p>
<div class="highlight"><pre><span></span><code><span class="k">[merge-tools.kdiff3]</span>
<span class="c1"># program  = &quot;kdiff3&quot;     # Defaults to the name of the tool if not specified</span>
<span class="n">merge-args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;$base&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$left&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$right&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-o&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$output&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--auto&quot;</span><span class="p">]</span>
<span class="k">[merge-tools.meld]</span>
<span class="n">merge-args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;$left&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$base&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$right&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-o&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$output&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--auto-merge&quot;</span><span class="p">]</span>

<span class="k">[merge-tools.vimdiff]</span>
<span class="n">merge-args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-d&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$output&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-M&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;$left&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$base&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;$right&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;wincmd J&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;set modifiable&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;set write&quot;</span><span class="p">]</span>
<span class="n">program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;vim&quot;</span>
<span class="n">merge-tool-edits-conflict-markers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w">    </span><span class="c1"># See below for an explanation</span>
</code></pre></div>
<p><code>jj</code> makes the following substitutions:</p>
<ul>
<li>
<p><code>$output</code> (REQUIRED) is replaced with the name of the file that the merge tool
  should output. <code>jj</code> will read this file after the merge tool exits.</p>
</li>
<li>
<p><code>$left</code> and <code>$right</code> are replaced with the paths to two files containing the
  content of each side of the conflict.</p>
</li>
<li>
<p><code>$base</code> is replaced with the path to a file containing the contents of the
  conflicted file in the last common ancestor of the two sides of the conflict.</p>
</li>
<li>
<p><code>$marker_length</code> is replaced with the length of the conflict markers which
  should be used for the file. This can be useful if the merge tool parses
  and/or generates conflict markers. Usually, <code>jj</code> uses conflict markers of
  length 7, but they can be longer if necessary to make parsing unambiguous.</p>
</li>
</ul>
<h3 id="config-editing-conflict-markers-with-a-tool-or-a-text-editor">Editing conflict markers with a tool or a text editor<a class="headerlink" href="#config-editing-conflict-markers-with-a-tool-or-a-text-editor" title="Permanent link">&para;</a></h3>
<p>By default, the merge tool starts with an empty output file. If the tool puts
anything into the output file and exits with the 0 exit code,
<code>jj</code> assumes that the conflict is fully resolved, while if the tool exits with
a non-zero exit code, <code>jj</code> assumes that the merge should be cancelled.
This is appropriate for most graphical merge tools.</p>
<p>For merge tools which try to automatically resolve conflicts without user input,
this behavior may not be desired. For instance, some automatic merge tools use
an exit code of 1 to indicate that some conflicts were unable to be resolved and
that the output file should contain conflict markers. In that case, you could
set the config option <code>merge-tools.TOOL.merge-conflict-exit-codes = [1]</code> to tell
<code>jj</code> to expect conflict markers in the output file if the exit code is 1. If a
merge tool produces output using Git's "diff3" conflict style, <code>jj</code> should be
able to parse it correctly, so many Git merge drivers should be usable with <code>jj</code>
as well.</p>
<p>Some tools (e.g. <code>vimdiff</code>) can present a multi-way diff but don't resolve
conflict themselves. When using such tools, <code>jj</code>
can help you by populating the output file with conflict markers before starting
the merge tool (instead of leaving the output file empty and letting the merge
tool fill it in). To do that, set the
<code>merge-tools.vimdiff.merge-tool-edits-conflict-markers = true</code> option.</p>
<p>With this option set, if the output file still contains conflict markers after
the conflict is done, <code>jj</code> assumes that the conflict was only partially resolved
and parses the conflict markers to get the new state of the conflict. The
conflict is considered fully resolved when there are no conflict markers left.
The conflict marker style can also be customized per tool using the
<code>merge-tools.TOOL.conflict-marker-style</code> option, which takes the same values as
<a href="#config-conflict-marker-style"><code>ui.conflict-marker-style</code></a>.</p>
<h2 id="config-code-formatting-and-other-file-content-transformations">Code formatting and other file content transformations<a class="headerlink" href="#config-code-formatting-and-other-file-content-transformations" title="Permanent link">&para;</a></h2>
<p>The <code>jj fix</code> command allows you to efficiently rewrite files in complex commit
graphs with no risk of introducing conflicts, using tools like <code>clang-format</code> or
<code>prettier</code>. The tools run as subprocesses that take file content on standard
input and repeat it, with any desired changes, on standard output. The file is
only rewritten if the subprocess produces a successful exit code.</p>
<h3 id="config-enforce-coding-style-rules">Enforce coding style rules<a class="headerlink" href="#config-enforce-coding-style-rules" title="Permanent link">&para;</a></h3>
<p>Suppose you want to use <code>clang-format</code> to format your <code>*.c</code> and <code>*.h</code> files,
as well as sorting their <code>#include</code> directives.</p>
<p><code>jj fix</code> provides the file content anonymously on standard input, but the name
of the file being formatted may be important for include sorting or other output
like error messages. To address this, you can use the <code>$path</code> substitution to
provide the name of the file in a command argument.</p>
<div class="highlight"><pre><span></span><code><span class="k">[fix.tools.clang-format]</span>
<span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/usr/bin/clang-format&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--sort-includes&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--assume-filename=$path&quot;</span><span class="p">]</span>
<span class="n">patterns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;glob:&#39;**/*.c&#39;&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;glob:&#39;**/*.h&#39;&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="config-sort-and-remove-duplicate-lines-from-a-file">Sort and remove duplicate lines from a file<a class="headerlink" href="#config-sort-and-remove-duplicate-lines-from-a-file" title="Permanent link">&para;</a></h3>
<p><code>jj fix</code> can also be used with tools that are not considered code formatters.</p>
<p>Suppose you have a list of words in a text file in your repository, and you want
to keep the file sorted alphabetically and remove any duplicate words.</p>
<div class="highlight"><pre><span></span><code><span class="k">[fix.tools.sort-word-list]</span>
<span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-u&quot;</span><span class="p">]</span>
<span class="n">patterns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;word_list.txt&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="config-execution-order-of-tools">Execution order of tools<a class="headerlink" href="#config-execution-order-of-tools" title="Permanent link">&para;</a></h3>
<p>If two or more tools affect the same file, they are executed in the ascending
lexicographical order of their configured names. This will remain as a tie
breaker if other ordering mechanisms are introduced in the future. If you use
numbers in tool names to control execution order, remember to include enough
leading zeros so that, for example, <code>09</code> sorts before <code>10</code>.</p>
<p>Suppose you want to keep only the 10 smallest numbers in a text file that
contains one number on each line. This can be accomplished with <code>sort</code> and
<code>head</code>, but execution order is important.</p>
<div class="highlight"><pre><span></span><code><span class="k">[fix.tools.1-sort-numbers-file]</span>
<span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-n&quot;</span><span class="p">]</span>
<span class="n">patterns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;numbers.txt&quot;</span><span class="p">]</span>

<span class="k">[fix.tools.2-truncate-numbers-file]</span>
<span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;head&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-n&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;10&quot;</span><span class="p">]</span>
<span class="n">patterns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;numbers.txt&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="config-disabling-and-enabling-tools">Disabling and enabling tools<a class="headerlink" href="#config-disabling-and-enabling-tools" title="Permanent link">&para;</a></h3>
<p>Tools can be disabled and enabled with the optional <code>enabled</code> config. This
allows you to define tools globally but enable them only for specific
repositories.</p>
<p>In the user configuration, define a disabled tool for running rustfmt:</p>
<div class="highlight"><pre><span></span><code><span class="k">[fix.tools.rustfmt]</span>
<span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;rustfmt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--emit&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;stdout&quot;</span><span class="p">]</span>
<span class="n">patterns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;glob:&#39;**/*.rs&#39;&quot;</span><span class="p">]</span>
</code></pre></div>
<p>Then to use the tool in a specific repository, set the <code>enabled</code> config:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--repo<span class="w"> </span>fix.tools.rustfmt.enabled<span class="w"> </span><span class="nb">true</span>
</code></pre></div>
<h2 id="config-commit-signing">Commit Signing<a class="headerlink" href="#config-commit-signing" title="Permanent link">&para;</a></h2>
<p><code>jj</code> can be configured to sign and verify the commits it creates using either
GnuPG or SSH signing keys.</p>
<p>To do this you need to configure a signing backend.</p>
<p>Setting the backend to <code>"none"</code> disables signing.</p>
<h3 id="config-gnupg-signing">GnuPG Signing<a class="headerlink" href="#config-gnupg-signing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">[signing]</span>
<span class="n">behavior</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;own&quot;</span>
<span class="n">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;gpg&quot;</span>
<span class="c1">## You can set `key` to anything accepted by `gpg -u`</span>
<span class="c1">## If not set then defaults to the key associated with `user.email`</span>
<span class="c1"># key = &quot;4ED556E9729E000F&quot;</span>
<span class="c1"># key = &quot;signing@example.com&quot;</span>
</code></pre></div>
<p>By default the gpg backend will look for a <code>gpg</code> binary on your path. If you want
to change the program used or specify a path to <code>gpg</code> explicitly you can set:</p>
<div class="highlight"><pre><span></span><code><span class="k">[signing]</span>
<span class="n">backends</span><span class="p">.</span><span class="n">gpg</span><span class="p">.</span><span class="n">program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;gpg2&quot;</span>
</code></pre></div>
<p>Also by default the gpg backend will consider key expiry when verifying commit signatures.
To consider expired keys as valid you can set:</p>
<div class="highlight"><pre><span></span><code><span class="k">[signing]</span>
<span class="n">backends</span><span class="p">.</span><span class="n">gpg</span><span class="p">.</span><span class="n">allow-expired-keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</code></pre></div>
<h4 id="config-pkcs12-certificates">PKCS#12 Certificates<a class="headerlink" href="#config-pkcs12-certificates" title="Permanent link">&para;</a></h4>
<p>PKCS#12 certificates can be used to sign commits using the <code>gpgsm</code> backend.</p>
<div class="highlight"><pre><span></span><code><span class="k">[signing]</span>
<span class="n">behavior</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;own&quot;</span>
<span class="n">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;gpgsm&quot;</span>
<span class="c1">## You can set `key` to anything accepted by `gpgsm -u`</span>
<span class="c1">## If not set then defaults to the key associated with `user.email`</span>
<span class="c1"># key = &quot;4ED556E9729E000F&quot;</span>
<span class="c1"># key = &quot;signing@example.com&quot;</span>
</code></pre></div>
<p>By default the gpgsm backend will look for a <code>gpgsm</code> binary on your path. If you want
to change the program used or specify a path to <code>gpgsm</code> explicitly you can set:</p>
<div class="highlight"><pre><span></span><code><span class="k">[signing]</span>
<span class="n">backends</span><span class="p">.</span><span class="n">gpgsm</span><span class="p">.</span><span class="n">program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;gpgsm&quot;</span>
</code></pre></div>
<p>Also by default the gpgsm backend will consider key expiry when verifying commit signatures.
To consider expired keys as valid you can set:</p>
<div class="highlight"><pre><span></span><code><span class="k">[signing]</span>
<span class="n">backends</span><span class="p">.</span><span class="n">gpgsm</span><span class="p">.</span><span class="n">allow-expired-keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</code></pre></div>
<h3 id="config-ssh-signing">SSH Signing<a class="headerlink" href="#config-ssh-signing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">[signing]</span>
<span class="n">behavior</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;own&quot;</span>
<span class="n">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ssh&quot;</span>
<span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGj+J6N6SO+4P8dOZqfR1oiay2yxhhHnagH52avUqw5h&quot;</span>
<span class="c1">## You can also use a path instead of embedding the key</span>
<span class="c1"># key = &quot;~/.ssh/id_for_signing.pub&quot;</span>
</code></pre></div>
<p>By default the ssh backend will look for a <code>ssh-keygen</code> binary on your path. If you want
to change the program used or specify a path to <code>ssh-keygen</code> explicitly you can set:</p>
<div class="highlight"><pre><span></span><code><span class="k">[signing]</span>
<span class="n">backends</span><span class="p">.</span><span class="n">ssh</span><span class="p">.</span><span class="n">program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/path/to/ssh-keygen&quot;</span>
</code></pre></div>
<p>When verifying commit signatures the ssh backend needs to be provided with an allowed-signers
file containing the public keys of authors whose signatures you want to be able to verify.</p>
<p>You can find the format for this file in the
<a href="https://man.openbsd.org/ssh-keygen#ALLOWED_SIGNERS">ssh-keygen man page</a>. This can be provided
as follows:</p>
<div class="highlight"><pre><span></span><code><span class="k">[signing]</span>
<span class="n">backends</span><span class="p">.</span><span class="n">ssh</span><span class="p">.</span><span class="n">allowed-signers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/path/to/allowed-signers&quot;</span>
</code></pre></div>
<h3 id="config-manually-signing-commits">Manually signing commits<a class="headerlink" href="#config-manually-signing-commits" title="Permanent link">&para;</a></h3>
<p>You can use <a href="#cli-reference-jj-sign"><code>jj sign</code></a>/<a href="#cli-reference-jj-unsign"><code>jj unsign</code></a>
to sign/unsign commits manually.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code>jj sign</code> always signs commits, even if they are already signed by the
user. While this is cumbersome for users signing via hardware devices, we
cannot reliably check if a commit is already signed without creating a
signature (see <a href="https://github.com/jj-vcs/jj/issues/5786">this issue</a>).</p>
</div>
<h3 id="config-automatically-signing-commits">Automatically signing commits<a class="headerlink" href="#config-automatically-signing-commits" title="Permanent link">&para;</a></h3>
<p>The <code>signing.behavior</code> configuration option has four different options for what
to do with signing commits on modification of a change (e.g., rebasing or edits).</p>
<ul>
<li><code>drop</code>: do not automatically sign; if a change was signed before
  modification, drop that signing after modification.</li>
<li><code>keep</code>: if a change was signed before modification, and it was authored by
  you, attempt to sign it again after the modification.</li>
<li><code>own</code>: sign all commits that were authored by you when you modify them.</li>
<li><code>force</code>: sign all commits after modification, always, even if you are not the
  author.</li>
</ul>
<p>Instead of signing all commits during creation when <code>signing.behavior</code> is
set to <code>own</code>, the <code>git.sign-on-push</code> configuration can be used to sign
commits only upon running <code>jj git push</code>. All mutable unsigned commits
being pushed will be signed prior to pushing. This might be preferred if the
signing backend requires user interaction or is slow, so that signing is
performed in a single batch operation.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Configure signing backend as before, but lazily signing only on push.</span>
<span class="k">[signing]</span>
<span class="n">behavior</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;drop&quot;</span>
<span class="n">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ssh&quot;</span>
<span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGj+J6N6SO+4P8dOZqfR1oiay2yxhhHnagH52avUqw5h&quot;</span>

<span class="k">[git]</span>
<span class="n">sign-on-push</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</code></pre></div>
<h2 id="config-commit-signature-verification">Commit Signature Verification<a class="headerlink" href="#config-commit-signature-verification" title="Permanent link">&para;</a></h2>
<p>By default signature verification and display is <strong>disabled</strong> as it incurs a
performance cost when rendering medium to large change logs. You can enable it
by setting <code>ui.show-cryptographic-signatures</code> to true in your configuration.</p>
<p>If you want to display commit signatures in your templates, you can use
<code>commit.signature()</code> (see <a href="#templates-commit-type">Commit type</a>). The
returned <a href="#templates-cryptographicsignature-type">CryptographicSignature
Type</a> provides methods to retrieve
signature details.</p>
<h2 id="config-git-settings">Git settings<a class="headerlink" href="#config-git-settings" title="Permanent link">&para;</a></h2>
<h3 id="config-default-remotes-for-jj-git-fetch-and-jj-git-push">Default remotes for <code>jj git fetch</code> and <code>jj git push</code><a class="headerlink" href="#config-default-remotes-for-jj-git-fetch-and-jj-git-push" title="Permanent link">&para;</a></h3>
<p>By default, if a single remote exists it is used for <code>jj git fetch</code> and <code>jj git
push</code>; however if multiple remotes exist, the default remote is assumed to be
named <code>"origin"</code>, just like in Git. Sometimes this is undesirable, e.g. when you
want to fetch from a different remote than you push to, such as a GitHub fork.</p>
<p>To change this behavior, you can modify the <a href="#config-config-files-and-toml">repository
configuration</a> variable <code>git.fetch</code>, which can be a
single remote, or a list of remotes to fetch from multiple places:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--repo<span class="w"> </span>git.fetch<span class="w"> </span><span class="s2">&quot;upstream&quot;</span>
jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--repo<span class="w"> </span>git.fetch<span class="w"> </span><span class="s1">&#39;[&quot;origin&quot;, &quot;upstream&quot;]&#39;</span>
</code></pre></div>
<p>By default, the specified remote names matches exactly. You can also use a
<a href="#revsets-string-patterns">string pattern</a> to select remotes using patterns:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--repo<span class="w"> </span>git.fetch<span class="w"> </span><span class="s2">&quot;glob:*&quot;</span>
jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--repo<span class="w"> </span>git.fetch<span class="w"> </span><span class="s1">&#39;[&quot;glob:remote*&quot;, &quot;glob:upstream*&quot;]&#39;</span>
</code></pre></div>
<p>Similarly, you can also set the variable <code>git.push</code> to cause <code>jj git push</code> to
push to a different remote:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--repo<span class="w"> </span>git.push<span class="w"> </span><span class="s2">&quot;github&quot;</span>
</code></pre></div>
<p>Note that unlike <code>git.fetch</code>, <code>git.push</code> can currently only be a single remote.
This is not a hard limitation, and could be changed in the future if there is
demand.</p>
<h3 id="config-automatic-local-bookmark-creation">Automatic local bookmark creation<a class="headerlink" href="#config-automatic-local-bookmark-creation" title="Permanent link">&para;</a></h3>
<p>When <code>jj</code> imports a new remote-tracking bookmark from Git, it can also create a
local bookmark with the same name. This feature is disabled by default because it
may be undesirable in some repositories, e.g.:</p>
<ul>
<li>There is a remote with a lot of historical bookmarks that you don't
  want to be exported to the co-located Git repo.</li>
<li>There are multiple remotes with conflicting views of that bookmark,
  resulting in an unhelpful conflicted state.</li>
</ul>
<p>You can enable this behavior by setting <code>git.auto-local-bookmark</code> like so,</p>
<div class="highlight"><pre><span></span><code><span class="k">[git]</span>
<span class="n">auto-local-bookmark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</code></pre></div>
<p>This setting is applied only to new remote bookmarks. Existing remote bookmarks
can be tracked individually by using <code>jj bookmark track</code>/<code>untrack</code> commands.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># import feature1 bookmark and start tracking it</span>
jj<span class="w"> </span>bookmark<span class="w"> </span>track<span class="w"> </span>feature1@origin
<span class="c1"># delete local gh-pages bookmark and stop tracking it</span>
jj<span class="w"> </span>bookmark<span class="w"> </span>delete<span class="w"> </span>gh-pages
jj<span class="w"> </span>bookmark<span class="w"> </span>untrack<span class="w"> </span>gh-pages@upstream
</code></pre></div>
<h3 id="config-automatic-local-bookmark-creation-on-jj-git-clone">Automatic local bookmark creation on <code>jj git clone</code><a class="headerlink" href="#config-automatic-local-bookmark-creation-on-jj-git-clone" title="Permanent link">&para;</a></h3>
<p>When cloning a new Git repository, <code>jj</code> by default creates a local bookmark
tracking the default remote bookmark (such as <code>main</code> for <code>main@origin</code>.) If you
aren't going to update the <code>main</code> bookmark locally, the tracking bookmark isn't
necessary.</p>
<p>This behavior can be disabled by</p>
<div class="highlight"><pre><span></span><code><span class="k">[git]</span>
<span class="n">track-default-bookmark-on-clone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</code></pre></div>
<h3 id="config-abandon-commits-that-became-unreachable-in-git">Abandon commits that became unreachable in Git<a class="headerlink" href="#config-abandon-commits-that-became-unreachable-in-git" title="Permanent link">&para;</a></h3>
<p>By default, when <code>jj</code> imports refs from Git, it will look for commits that used
to be <a href="https://git-scm.com/docs/gitglossary/#Documentation/gitglossary.txt-aiddefreachableareachable">reachable</a> but no longer are reachable. Those commits will
then be abandoned, and any descendant commits will be rebased off of them (as
usual when commits are abandoned). You can disable this behavior and instead
leave the Git-unreachable commits in your repo by setting:</p>
<div class="highlight"><pre><span></span><code><span class="k">[git]</span>
<span class="n">abandon-unreachable-commits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</code></pre></div>
<h3 id="config-prefix-for-generated-bookmarks-on-push">Prefix for generated bookmarks on push<a class="headerlink" href="#config-prefix-for-generated-bookmarks-on-push" title="Permanent link">&para;</a></h3>
<p><code>jj git push --change</code> generates bookmark names with a prefix of "push-" by
default. You can pick a different prefix by setting <code>git.push-bookmark-prefix</code>. For
example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[git]</span>
<span class="n">push-bookmark-prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;martinvonz/push-&quot;</span>
</code></pre></div>
<h3 id="config-set-of-private-commits">Set of private commits<a class="headerlink" href="#config-set-of-private-commits" title="Permanent link">&para;</a></h3>
<p>You can configure the set of private commits by setting <code>git.private-commits</code> to
a revset. The value is a revset of commits that Jujutsu will refuse to push. If
unset, all commits are eligible to be pushed.</p>
<div class="highlight"><pre><span></span><code><span class="k">[git]</span>
<span class="c1"># Prevent pushing work in progress or anything explicitly labeled &quot;private&quot;</span>
<span class="n">private-commits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;description(glob:&#39;wip:*&#39;) | description(glob:&#39;private:*&#39;)&quot;</span>
</code></pre></div>
<p>If a commit is in <code>git.private-commits</code> but is already on the remote, then it is
not considered a private commit. Commits that are immutable are also excluded
from the private set.</p>
<p>Private commits prevent their descendants from being pushed, since doing so
would require pushing the private commit as well.</p>
<h3 id="config-git-subprocessing-behaviour">Git subprocessing behaviour<a class="headerlink" href="#config-git-subprocessing-behaviour" title="Permanent link">&para;</a></h3>
<p>Git remote interactions are handled by spawning a <code>git</code> subprocess.
If <code>git</code> is not on your OS path, or you want to specify a particular binary,
you can:</p>
<div class="highlight"><pre><span></span><code><span class="k">[git]</span>
<span class="n">executable-path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/path/to/git&quot;</span>
</code></pre></div>
<h2 id="config-filesystem-monitor">Filesystem monitor<a class="headerlink" href="#config-filesystem-monitor" title="Permanent link">&para;</a></h2>
<p>In large repositories, it may be beneficial to use a "filesystem monitor" to
track changes to the working copy. This allows <code>jj</code> to take working copy
snapshots without having to rescan the entire working copy.</p>
<p>This is governed by the <code>core.fsmonitor</code> option. Currently, the valid values are
<code>"none"</code> or <code>"watchman"</code>.</p>
<h3 id="config-watchman">Watchman<a class="headerlink" href="#config-watchman" title="Permanent link">&para;</a></h3>
<p>To configure the Watchman filesystem monitor, set
<code>core.fsmonitor = "watchman"</code>. Ensure that you have <a href="https://facebook.github.io/watchman/docs/install">installed the Watchman
executable on your system</a>.</p>
<p>You can configure <code>jj</code> to use watchman triggers to automatically create
snapshots on filesystem changes by setting
<code>core.watchman.register-snapshot-trigger = true</code>.</p>
<p>You can check whether Watchman is enabled and whether it is installed correctly
using <code>jj debug watchman status</code>.</p>
<h2 id="config-snapshot-settings">Snapshot settings<a class="headerlink" href="#config-snapshot-settings" title="Permanent link">&para;</a></h2>
<h3 id="config-paths-to-automatically-track">Paths to automatically track<a class="headerlink" href="#config-paths-to-automatically-track" title="Permanent link">&para;</a></h3>
<p>All new files in the working copy that don't match the ignore patterns are
tracked by default. You can set the <code>snapshot.auto-track</code> to set which paths
get automatically tracked when they're added to the working copy. See the
<a href="#filesets">fileset documentation</a> for the syntax. Files with paths matching
<a href="#working-copy-ignored-files">ignore files</a> are never tracked automatically.</p>
<p>You can use <code>jj file untrack</code> to untrack a file while keeping it in the working
copy. However, first <a href="#working-copy-ignored-files">ignore</a> them or remove them
from the <code>snapshot.auto-track</code> patterns; otherwise they will be immediately
tracked again.</p>
<h3 id="config-maximum-size-for-new-files">Maximum size for new files<a class="headerlink" href="#config-maximum-size-for-new-files" title="Permanent link">&para;</a></h3>
<p>By default, as an anti-footgun measure, <code>jj</code> will refuse to add new files to the
snapshot that are larger than a certain size; the default is 1MiB. This can be
changed by setting <code>snapshot.max-new-file-size</code> to a different value. For
example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[snapshot]</span>
<span class="n">max-new-file-size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;10MiB&quot;</span>
<span class="c1"># the following is equivalent</span>
<span class="n">max-new-file-size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10485760</span>
</code></pre></div>
<p>The value can be specified using a human readable string with typical suffixes;
<code>B</code>, <code>MiB</code>, <code>GB</code>, etc. By default, if no suffix is provided, or the value is a
raw integer literal, the value is interpreted as if it were specified in bytes.</p>
<p>Files that already exist in the working copy are not subject to this limit.</p>
<p>Setting this value to zero will disable the limit entirely.</p>
<h2 id="config-ways-to-specify-jj-config-details">Ways to specify <code>jj</code> config: details<a class="headerlink" href="#config-ways-to-specify-jj-config-details" title="Permanent link">&para;</a></h2>
<h3 id="config-user-config-files">User config files<a class="headerlink" href="#config-user-config-files" title="Permanent link">&para;</a></h3>
<p>An easy way to find the user config file/directory is:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>config<span class="w"> </span>path<span class="w"> </span>--user
</code></pre></div>
<p>On all platforms, the user's global <code>jj</code> configurations are by default loaded in
the following precedence order (with later configs overriding earlier ones):</p>
<ul>
<li><code>$HOME/.jjconfig.toml</code></li>
<li><code>&lt;PLATFORM_SPECIFIC&gt;/jj/config.toml</code> (preferred)</li>
<li><code>&lt;PLATFORM_SPECIFIC&gt;/jj/conf.d/*.toml</code></li>
</ul>
<p>where <code>$HOME</code> represents the user's home directory (<code>%USERPROFILE%</code> on Windows),
and <code>&lt;PLATFORM_SPECIFIC&gt;</code> represents the platform-specific configuration
directory shown in the table below. The platform-specific location is
recommended for better integration with platform services.</p>
<p>The files in the <code>conf.d</code> directory are loaded in lexicographic order. This allows
configs to be split across multiple files and combines well
with <a href="#config-conditional-variables">Conditional Variables</a>.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Platform</th>
<th style="text-align: left;">Location of <code>&lt;PLATFORM_SPECIFIC&gt;</code> dir</th>
<th style="text-align: left;">Example config file location</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Linux and macOS</td>
<td style="text-align: left;"><code>$XDG_CONFIG_HOME</code> or <code>$HOME/.config</code></td>
<td style="text-align: left;"><code>/home/alice/.config/jj/config.toml</code></td>
</tr>
<tr>
<td style="text-align: left;">Windows</td>
<td style="text-align: left;"><code>{FOLDERID_RoamingAppData}</code></td>
<td style="text-align: left;"><code>C:\Users\Alice\AppData\Roaming\jj\config.toml</code></td>
</tr>
</tbody>
</table>
<p>On macOS, jj used to put the user config in <code>~/Library/Application Support</code>,
and jj will still look there for backwards compatibility purposes; this is
considered a deprecated location, and you should use the new default
<code>XDG_CONFIG_HOME</code>.</p>
<p>The location of the <code>jj</code> user config files/directories can also be overridden with the
<code>JJ_CONFIG</code> environment variable. If it is not empty, it will be used instead
of any configuration files in the default locations. If it is a path to a TOML
file, then that file will be loaded instead. If it is a path to a directory,
then all the TOML files in that directory will be loaded in lexicographic order
and merged. Multiple paths can be specified by separating them with a
platform-specific path separator (<code>:</code> on Unix-like systems, <code>;</code> on Windows).</p>
<p>For example, the following could be used to run <code>jj</code> without loading any user configs:</p>
<div class="highlight"><pre><span></span><code><span class="nv">JJ_CONFIG</span><span class="o">=</span><span class="w"> </span>jj<span class="w"> </span>log<span class="w">       </span><span class="c1"># Ignores any settings specified in the config file.</span>
</code></pre></div>
<h3 id="config-json-schema-support">JSON Schema Support<a class="headerlink" href="#config-json-schema-support" title="Permanent link">&para;</a></h3>
<p>Many popular editors support TOML file syntax highlighting and validation. To
enable schema validation in your editor, add this line at the top of your TOML
config files:</p>
<div class="highlight"><pre><span></span><code><span class="s2">&quot;$schema&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://jj-vcs.github.io/jj/latest/config-schema.json&quot;</span>
</code></pre></div>
<p>This enables features like:</p>
<ul>
<li>Autocomplete for config keys</li>
<li>Type checking of values</li>
<li>Documentation on hover</li>
<li>Validation of settings</li>
</ul>
<p>Here are some popular editors with TOML schema validation support:</p>
<ul>
<li>VS Code</li>
<li>
<p>Install <a href="https://marketplace.visualstudio.com/items?itemName=tamasfe.even-better-toml">Even Better TOML</a></p>
</li>
<li>
<p>Neovim/Vim</p>
</li>
<li>
<p>Use with <a href="https://github.com/neovim/nvim-lspconfig">nvim-lspconfig</a> and <a href="https://github.com/tamasfe/taplo">taplo</a></p>
</li>
<li>
<p>Helix</p>
</li>
<li>
<p>Install <a href="https://github.com/tamasfe/taplo">taplo</a></p>
</li>
<li>
<p>JetBrains IDEs (IntelliJ, PyCharm, etc)</p>
</li>
<li>
<p>Install <a href="https://plugins.jetbrains.com/plugin/8195-toml">TOML</a> plugin</p>
</li>
<li>
<p>Emacs</p>
</li>
<li>Install <a href="https://github.com/emacs-lsp/lsp-mode">lsp-mode</a> and <a href="https://github.com/dryman/toml-mode.el">toml-mode</a></li>
<li>Configure <a href="https://github.com/tamasfe/taplo">taplo</a> as the LSP server</li>
</ul>
<h3 id="config-specifying-config-on-the-command-line">Specifying config on the command-line<a class="headerlink" href="#config-specifying-config-on-the-command-line" title="Permanent link">&para;</a></h3>
<p>You can use one or more <code>--config</code>/<code>--config-file</code> options on the command line
to specify additional configuration settings. This overrides settings defined in
config files or environment variables. For example,</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Must not have spaces around the `=`</span>
jj<span class="w"> </span>--config<span class="w"> </span>ui.color<span class="o">=</span>always<span class="w"> </span>--config<span class="w"> </span>ui.diff-editor<span class="o">=</span>meld<span class="w"> </span>split
</code></pre></div>
<p>Config value should be specified as a TOML expression. If string value isn't
enclosed by any TOML constructs (such as array notation), quotes can be omitted.
Here is an example with more advanced TOML constructs:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Single quotes and the &#39;\&#39; are interpreted by the shell and assume a Unix shell</span>
<span class="c1"># Double quotes are passed to jj and are parsed as TOML syntax</span>
jj<span class="w"> </span>log<span class="w"> </span>--config<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;template-aliases.&quot;format_timestamp(timestamp)&quot;=&quot;&quot;&quot;timestamp.format(&quot;%Y-%m-%d %H:%M %:::z&quot;)&quot;&quot;&quot;&#39;</span>
</code></pre></div>
<p>To load an entire TOML document, use <code>--config-file</code>:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>--config-file<span class="o">=</span>extra-config.toml<span class="w"> </span>log
</code></pre></div>
<h3 id="config-conditional-variables">Conditional variables<a class="headerlink" href="#config-conditional-variables" title="Permanent link">&para;</a></h3>
<p>You can conditionally enable config variables by using <code>--when</code>.</p>
<h4 id="config-using-scope-tables">Using <code>[[--scope]]</code> tables<a class="headerlink" href="#config-using-scope-tables" title="Permanent link">&para;</a></h4>
<p>Variables defined in <code>[[--scope]]</code> tables are expanded to the root table.
<code>--when</code> specifies the condition to enable the scope table.</p>
<p>If no conditions are specified, the table is always enabled. If multiple
conditions are specified, their intersection is used.</p>
<div class="highlight"><pre><span></span><code><span class="k">[user]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR NAME&quot;</span>
<span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR_DEFAULT_EMAIL@example.com&quot;</span>

<span class="c1"># override user.email if the repository is located under ~/oss</span>
<span class="k">[[--scope]]</span>
<span class="n">--when</span><span class="p">.</span><span class="n">repositories</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;~/oss&quot;</span><span class="p">]</span>
<span class="k">[--scope.user]</span>
<span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR_OSS_EMAIL@example.org&quot;</span>

<span class="c1"># disable pagination for `jj status`, use `delta` for `jj diff` and `jj show`</span>
<span class="k">[[--scope]]</span>
<span class="n">--when</span><span class="p">.</span><span class="n">commands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span>
<span class="k">[--scope.ui]</span>
<span class="n">paginate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;never&quot;</span>
<span class="k">[[--scope]]</span>
<span class="n">--when</span><span class="p">.</span><span class="n">commands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;show&quot;</span><span class="p">]</span>
<span class="k">[--scope.ui]</span>
<span class="n">pager</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;delta&quot;</span>
</code></pre></div>
<h4 id="config-using-multiple-files">Using multiple files<a class="headerlink" href="#config-using-multiple-files" title="Permanent link">&para;</a></h4>
<p><code>--when</code> can also be used on the top level of a TOML file, which is convenient
when splitting your config across multiple files.
The behavior of conditions are the same as when using <code>[[--scope]]</code> tables.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># In $XDG_CONFIG_HOME/jj/config.toml</span>
<span class="k">[user]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR NAME&quot;</span>
<span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR_DEFAULT_EMAIL@example.com&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># In $XDG_CONFIG_HOME/jj/conf.d/work.toml</span>
<span class="n">--when</span><span class="p">.</span><span class="n">repositories</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;~/the/work/repo&quot;</span><span class="p">]</span>

<span class="k">[user]</span>
<span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR_WORK_EMAIL@workplace.com&quot;</span>

<span class="k">[revset-aliases]</span>
<span class="n">work</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;heads(::@ ~ description(exact:&#39;&#39;))::&quot;</span>

<span class="k">[aliases]</span>
<span class="n">wip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-r&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;work&quot;</span><span class="p">]</span>
</code></pre></div>
<h4 id="config-available-condition-keys">Available condition keys<a class="headerlink" href="#config-available-condition-keys" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><code>--when.repositories</code>: List of paths to match the repository path prefix.</p>
<p>Paths should be absolute. Each path component (directory or file name, drive
letter, etc.) is compared case-sensitively on all platforms. A path starting
with <code>~</code> is expanded to the home directory. On Windows, directory separator may
be either <code>\</code> or <code>/</code>. (Beware that <code>\</code> needs escape in double-quoted strings.)</p>
<p>Use <code>jj root</code> to see the workspace root directory. Note that the repository path
is in the main workspace if you're using multiple workspaces with <code>jj
workspace</code>.</p>
</li>
<li>
<p><code>--when.commands</code>: List of subcommands to match.</p>
<p>Subcommands are space-separated and matched by prefix.</p>
<div class="highlight"><pre><span></span><code><span class="n">--when</span><span class="p">.</span><span class="n">commands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span><span class="w">        </span><span class="c1"># matches `jj file show`, `jj file list`, etc</span>
<span class="n">--when</span><span class="p">.</span><span class="n">commands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;file show&quot;</span><span class="p">]</span><span class="w">   </span><span class="c1"># matches `jj file show` but *NOT* `jj file list`</span>
<span class="n">--when</span><span class="p">.</span><span class="n">commands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;log&quot;</span><span class="p">]</span><span class="w"> </span><span class="c1"># matches `jj file` *OR* `jj log` (or subcommand of either)</span>
</code></pre></div>
</li>
</ul></section><section class="print-page" id="filesets" heading-number="8.2"><h1 id="filesets-filesets">Filesets<a class="headerlink" href="#filesets-filesets" title="Permanent link">&para;</a></h1>
<p>Jujutsu supports a functional language for selecting a set of files.
Expressions in this language are called "filesets" (the idea comes from
<a href="https://repo.mercurial-scm.org/hg/help/filesets">Mercurial</a>). The language
consists of file patterns, operators, and functions.</p>
<h2 id="filesets-quoting-file-names">Quoting file names<a class="headerlink" href="#filesets-quoting-file-names" title="Permanent link">&para;</a></h2>
<p>Many <code>jj</code> commands accept fileset expressions as positional arguments. File
names passed to these commands <a href="#templates-string-literals">must be quoted</a> if they contain
whitespace or meta characters. However, as a special case, quotes can be omitted
if the expression has no operators nor function calls. For example:</p>
<ul>
<li><code>jj diff 'Foo Bar'</code> (shell quotes are required, but inner quotes are optional)</li>
<li><code>jj diff '~"Foo Bar"'</code> (both shell and inner quotes are required)</li>
<li><code>jj diff '"Foo(1)"'</code> (both shell and inner quotes are required)</li>
</ul>
<p>Glob characters aren't considered meta characters, but shell quotes are still
required:</p>
<ul>
<li><code>jj diff '~glob:**/*.rs'</code></li>
</ul>
<h2 id="filesets-file-patterns">File patterns<a class="headerlink" href="#filesets-file-patterns" title="Permanent link">&para;</a></h2>
<p>The following patterns are supported. In all cases, we do not mention any shell
quoting that might be necessary, and the quotes around <code>"path"</code> are optional if
the path <a href="#filesets-quoting-file-names">has no special characters</a>.</p>
<ul>
<li><code>"path"</code> or <code>cwd:"path"</code>: Matches cwd-relative path prefix (file or files
  under directory recursively.)</li>
<li><code>file:"path"</code> or <code>cwd-file:"path"</code>: Matches cwd-relative file (or exact) path.</li>
<li><code>glob:"pattern"</code> or <code>cwd-glob:"pattern"</code>: Matches file paths with cwd-relative
  Unix-style shell <a href="https://docs.rs/glob/latest/glob/struct.Pattern.html">wildcard <code>pattern</code></a>. For example, <code>glob:"*.c"</code> will
  match all <code>.c</code> files in the current working directory non-recursively.</li>
<li><code>root:"path"</code>: Matches workspace-relative path prefix (file or files under
  directory recursively.)</li>
<li><code>root-file:"path"</code>: Matches workspace-relative file (or exact) path.</li>
<li><code>root-glob:"pattern"</code>: Matches file paths with workspace-relative Unix-style
  shell <a href="https://docs.rs/glob/latest/glob/struct.Pattern.html">wildcard <code>pattern</code></a>.</li>
</ul>
<h2 id="filesets-operators">Operators<a class="headerlink" href="#filesets-operators" title="Permanent link">&para;</a></h2>
<p>The following operators are supported. <code>x</code> and <code>y</code> below can be any fileset
expressions.</p>
<ul>
<li><code>~x</code>: Matches everything but <code>x</code>.</li>
<li><code>x &amp; y</code>: Matches both <code>x</code> and <code>y</code>.</li>
<li><code>x ~ y</code>: Matches <code>x</code> but not <code>y</code>.</li>
<li><code>x | y</code>: Matches either <code>x</code> or <code>y</code> (or both).</li>
</ul>
<p>(listed in order of binding strengths)</p>
<p>You can use parentheses to control evaluation order, such as <code>(x &amp; y) | z</code> or
<code>x &amp; (y | z)</code>.</p>
<h2 id="filesets-functions">Functions<a class="headerlink" href="#filesets-functions" title="Permanent link">&para;</a></h2>
<p>You can also specify patterns by using functions.</p>
<ul>
<li><code>all()</code>: Matches everything.</li>
<li><code>none()</code>: Matches nothing.</li>
</ul>
<h2 id="filesets-examples">Examples<a class="headerlink" href="#filesets-examples" title="Permanent link">&para;</a></h2>
<p>Show diff excluding <code>Cargo.lock</code>.</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>diff<span class="w"> </span><span class="s1">&#39;~Cargo.lock&#39;</span>
</code></pre></div>
<p>List files in <code>src</code> excluding Rust sources.</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>file<span class="w"> </span>list<span class="w"> </span><span class="s1">&#39;src ~ glob:&quot;**/*.rs&quot;&#39;</span>
</code></pre></div>
<p>Split a revision in two, putting <code>foo</code> into the second commit.</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>split<span class="w"> </span><span class="s1">&#39;~foo&#39;</span>
</code></pre></div></section><section class="print-page" id="revsets" heading-number="8.3"><h1 id="revsets-revsets">Revsets<a class="headerlink" href="#revsets-revsets" title="Permanent link">&para;</a></h1>
<p>Jujutsu supports a functional language for selecting a set of revisions.
Expressions in this language are called "revsets" (the idea comes from
<a href="https://www.mercurial-scm.org/repo/hg/help/revsets">Mercurial</a>). The language
consists of symbols, operators, and functions.</p>
<p>Most <code>jj</code> commands accept a revset (or multiple). Many commands, such as
<code>jj diff -r &lt;revset&gt;</code> expect the revset to resolve to a single commit; it is
an error to pass a revset that resolves to more than one commit (or zero
commits) to such commands.</p>
<p>The words "revisions" and "commits" are used interchangeably in this document.</p>
<p>Most revsets search only the <a href="#glossary-visible-commits">visible commits</a>.
Other commits are only included if you explicitly mention them (e.g. by commit
ID or a Git ref pointing to them).</p>
<h2 id="revsets-symbols">Symbols<a class="headerlink" href="#revsets-symbols" title="Permanent link">&para;</a></h2>
<p>The <code>@</code> expression refers to the working copy commit in the current workspace.
Use <code>&lt;workspace name&gt;@</code> to refer to the working-copy commit in another
workspace. Use <code>&lt;name&gt;@&lt;remote&gt;</code> to refer to a remote-tracking bookmark.</p>
<p>A full commit ID refers to a single commit. A unique prefix of the full commit
ID can also be used. It is an error to use a non-unique prefix.</p>
<p>A full change ID refers to all visible commits with that change ID (there is
typically only one visible commit with a given change ID). A unique prefix of
the full change ID can also be used. It is an error to use a non-unique prefix.</p>
<p>Use <a href="#templates-string-literals">single or double quotes</a> to prevent a symbol from being
interpreted as an expression. For example, <code>"x-"</code> is the symbol <code>x-</code>, not the
parents of symbol <code>x</code>. Taking shell quoting into account, you may need to use
something like <code>jj log -r '"x-"'</code>.</p>
<h3 id="revsets-priority">Priority<a class="headerlink" href="#revsets-priority" title="Permanent link">&para;</a></h3>
<p>Jujutsu attempts to resolve a symbol in the following order:</p>
<ol>
<li>Tag name</li>
<li>Bookmark name</li>
<li>Git ref</li>
<li>Commit ID or change ID</li>
</ol>
<h2 id="revsets-operators">Operators<a class="headerlink" href="#revsets-operators" title="Permanent link">&para;</a></h2>
<p>The following operators are supported. <code>x</code> and <code>y</code> below can be any revset, not
only symbols.</p>
<ul>
<li><code>x-</code>: Parents of <code>x</code>, can be empty.</li>
<li><code>x+</code>: Children of <code>x</code>, can be empty.</li>
<li><code>x::</code>: Descendants of <code>x</code>, including the commits in <code>x</code> itself. Shorthand for
  <code>x::visible_heads()</code>.</li>
<li><code>x..</code>: Revisions that are not ancestors of <code>x</code>. Shorthand for
  <code>x..visible_heads()</code>.</li>
<li><code>::x</code>: Ancestors of <code>x</code>, including the commits in <code>x</code> itself. Shorthand for
  <code>root()::x</code>.</li>
<li><code>..x</code>: Ancestors of <code>x</code>, including the commits in <code>x</code> itself, but excluding
  the root commit. Shorthand for <code>root()..x</code>. Equivalent to <code>::x ~ root()</code>.</li>
<li><code>x::y</code>: Descendants of <code>x</code> that are also ancestors of <code>y</code>. Equivalent
   to <code>x:: &amp; ::y</code>. This is what <code>git log</code> calls <code>--ancestry-path x..y</code>.</li>
<li><code>x..y</code>: Ancestors of <code>y</code> that are not also ancestors of <code>x</code>. Equivalent to
  <code>::y ~ ::x</code>. This is what <code>git log</code> calls <code>x..y</code> (i.e. the same as we call it).</li>
<li><code>::</code>: All visible commits in the repo. Shorthand for
  <code>root()::visible_heads()</code>. Equivalent to <code>all()</code>.</li>
<li><code>..</code>: All visible commits in the repo, but excluding the root commit.
  Shorthand for <code>root()..visible_heads()</code>. Equivalent to <code>~root()</code>.</li>
<li><code>~x</code>: Revisions that are not in <code>x</code>.</li>
<li><code>x &amp; y</code>: Revisions that are in both <code>x</code> and <code>y</code>.</li>
<li><code>x ~ y</code>: Revisions that are in <code>x</code> but not in <code>y</code>.</li>
<li><code>x | y</code>: Revisions that are in either <code>x</code> or <code>y</code> (or both).</li>
</ul>
<p>(listed in order of binding strengths)</p>
<p>You can use parentheses to control evaluation order, such as <code>(x &amp; y) | z</code> or
<code>x &amp; (y | z)</code>.</p>
<!-- The following format will be understood by the web site generator, and will
 generate a folded section that can be unfolded at will. -->

<details class="examples">
<summary>Examples</summary>
<p>Given this history:
<div class="highlight"><pre><span></span><code>o D
|\
| o C
| |
o | B
|/
o A
|
o root()
</code></pre></div></p>
<p><strong>Operator</strong> <code>x-</code></p>
<ul>
<li><code>D-</code> ⇒ <code>{C,B}</code></li>
<li><code>B-</code> ⇒ <code>{A}</code></li>
<li><code>A-</code> ⇒ <code>{root()}</code></li>
<li><code>root()-</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>none()-</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>(D|A)-</code> ⇒ <code>{C,B,root()}</code></li>
<li><code>(C|B)-</code> ⇒ <code>{A}</code></li>
</ul>
<p><strong>Operator</strong> <code>x+</code></p>
<ul>
<li><code>D+</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>B+</code> ⇒ <code>{D}</code></li>
<li><code>A+</code> ⇒ <code>{B,C}</code></li>
<li><code>root()+</code> ⇒ <code>{A}</code></li>
<li><code>none()+</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>(C|B)+</code> ⇒ <code>{D}</code></li>
<li><code>(B|root())+</code> ⇒ <code>{D,A}</code></li>
</ul>
<p><strong>Operator</strong> <code>x::</code></p>
<ul>
<li><code>D::</code> ⇒ <code>{D}</code></li>
<li><code>B::</code> ⇒ <code>{D,B}</code></li>
<li><code>A::</code> ⇒ <code>{D,C,B,A}</code></li>
<li><code>root()::</code> ⇒ <code>{D,C,B,A,root()}</code></li>
<li><code>none()::</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>(C|B)::</code> ⇒ <code>{D,C,B}</code></li>
</ul>
<p><strong>Operator</strong> <code>x..</code></p>
<ul>
<li><code>D..</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>B..</code> ⇒ <code>{D,C}</code> (note that, unlike <code>B::</code>, this includes <code>C</code>)</li>
<li><code>A..</code> ⇒ <code>{D,C,B}</code></li>
<li><code>root()..</code> ⇒ <code>{D,C,B,A}</code></li>
<li><code>none()..</code> ⇒ <code>{D,C,B,A,root()}</code></li>
<li><code>(C|B)..</code> ⇒ <code>{D}</code></li>
</ul>
<p><strong>Operator</strong> <code>::x</code></p>
<ul>
<li><code>::D</code> ⇒ <code>{D,C,B,A,root()}</code></li>
<li><code>::B</code> ⇒ <code>{B,A,root()}</code></li>
<li><code>::A</code> ⇒ <code>{A,root()}</code></li>
<li><code>::root()</code> ⇒ <code>{root()}</code></li>
<li><code>::none()</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>::(C|B)</code> ⇒ <code>{C,B,A,root()}</code></li>
</ul>
<p><strong>Operator</strong> <code>..x</code></p>
<ul>
<li><code>..D</code> ⇒ <code>{D,C,B,A}</code></li>
<li><code>..B</code> ⇒ <code>{B,A}</code></li>
<li><code>..A</code> ⇒ <code>{A}</code></li>
<li><code>..root()</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>..none()</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>..(C|B)</code> ⇒ <code>{C,B,A}</code></li>
</ul>
<p><strong>Operator</strong> <code>x::y</code></p>
<ul>
<li><code>D::D</code> ⇒ <code>{D}</code></li>
<li><code>B::D</code> ⇒ <code>{D,B}</code> (note that, unlike <code>B..D</code>, this includes <code>B</code> and excludes <code>C</code>)</li>
<li><code>A::D</code> ⇒ <code>{D,C,B,A}</code></li>
<li><code>root()::D</code> ⇒ <code>{D,C,B,A,root()}</code></li>
<li><code>none()::D</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>D::B</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>(C|B)::(C|B)</code> ⇒ <code>{C,B}</code></li>
</ul>
<p><strong>Operator</strong> <code>x..y</code></p>
<ul>
<li><code>D..D</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>B..D</code> ⇒ <code>{D,C}</code> (note that, unlike <code>B::D</code>, this includes <code>C</code> and excludes <code>B</code>)</li>
<li><code>A..D</code> ⇒ <code>{D,C,B}</code></li>
<li><code>root()..D</code> ⇒ <code>{D,C,B,A}</code></li>
<li><code>none()..D</code> ⇒ <code>{D,C,B,A,root()}</code></li>
<li><code>D..B</code> ⇒ <code>{}</code> (empty set)</li>
<li><code>(C|B)..(C|B)</code> ⇒ <code>{}</code> (empty set)</li>
</ul>
</details>
<h2 id="revsets-functions">Functions<a class="headerlink" href="#revsets-functions" title="Permanent link">&para;</a></h2>
<p>You can also specify revisions by using functions. Some functions take other
revsets (expressions) as arguments.</p>
<ul>
<li>
<p><code>parents(x)</code>: Same as <code>x-</code>.</p>
</li>
<li>
<p><code>children(x)</code>: Same as <code>x+</code>.</p>
</li>
<li>
<p><code>ancestors(x[, depth])</code>: <code>ancestors(x)</code> is the same as <code>::x</code>.
  <code>ancestors(x, depth)</code> returns the ancestors of <code>x</code> limited to the given
  <code>depth</code>.</p>
</li>
<li>
<p><code>descendants(x[, depth])</code>: <code>descendants(x)</code> is the same as <code>x::</code>.
  <code>descendants(x, depth)</code> returns the descendants of <code>x</code> limited to the given
  <code>depth</code>.</p>
</li>
<li>
<p><code>reachable(srcs, domain)</code>: All commits reachable from <code>srcs</code> within
  <code>domain</code>, traversing all parent and child edges.</p>
</li>
<li>
<p><code>connected(x)</code>: Same as <code>x::x</code>. Useful when <code>x</code> includes several commits.</p>
</li>
<li>
<p><code>all()</code>: All visible commits in the repo.</p>
</li>
<li>
<p><code>none()</code>: No commits. This function is rarely useful; it is provided for
  completeness.</p>
</li>
<li>
<p><code>bookmarks([pattern])</code>: All local bookmark targets. If <code>pattern</code> is specified,
  this selects the bookmarks whose name match the given <a href="#revsets-string-patterns">string
  pattern</a>. For example, <code>bookmarks(push)</code> would match the
  bookmarks <code>push-123</code> and <code>repushed</code> but not the bookmark <code>main</code>. If a bookmark is
  in a conflicted state, all its possible targets are included.</p>
</li>
<li>
<p><code>remote_bookmarks([bookmark_pattern[, [remote=]remote_pattern]])</code>: All remote
  bookmarks targets across all remotes. If just the <code>bookmark_pattern</code> is
  specified, the bookmarks whose names match the given <a href="#revsets-string-patterns">string
  pattern</a> across all remotes are selected. If both
  <code>bookmark_pattern</code> and <code>remote_pattern</code> are specified, the selection is
  further restricted to just the remotes whose names match <code>remote_pattern</code>.</p>
<p>For example, <code>remote_bookmarks(push, ri)</code> would match the bookmarks
<code>push-123@origin</code> and <code>repushed@private</code> but not <code>push-123@upstream</code> or
<code>main@origin</code> or <code>main@upstream</code>. If a bookmark is in a conflicted state, all
its possible targets are included.</p>
<p>While Git-tracking bookmarks can be selected by <code>&lt;name&gt;@git</code>, these bookmarks
aren't included in <code>remote_bookmarks()</code>.</p>
</li>
<li>
<p><code>tracked_remote_bookmarks([bookmark_pattern[, [remote=]remote_pattern]])</code>: All
  targets of tracked remote bookmarks. Supports the same optional arguments as
  <code>remote_bookmarks()</code>.</p>
</li>
<li>
<p><code>untracked_remote_bookmarks([bookmark_pattern[, [remote=]remote_pattern]])</code>:
  All targets of untracked remote bookmarks. Supports the same optional arguments
  as <code>remote_bookmarks()</code>.</p>
</li>
<li>
<p><code>tags([pattern])</code>: All tag targets. If <code>pattern</code> is specified,
  this selects the tags whose name match the given <a href="#revsets-string-patterns">string
  pattern</a>. For example, <code>tags(v1)</code> would match the
  tags <code>v123</code> and <code>rev1</code> but not the tag <code>v2</code>. If a tag is
  in a conflicted state, all its possible targets are included.</p>
</li>
<li>
<p><code>git_refs()</code>:  All Git ref targets as of the last import. If a Git ref
  is in a conflicted state, all its possible targets are included.</p>
</li>
<li>
<p><code>git_head()</code>: The Git <code>HEAD</code> target as of the last import.</p>
</li>
<li>
<p><code>visible_heads()</code>: All visible heads (same as <code>heads(all())</code>).</p>
</li>
<li>
<p><code>root()</code>: The virtual commit that is the oldest ancestor of all other commits.</p>
</li>
<li>
<p><code>heads(x)</code>: Commits in <code>x</code> that are not ancestors of other commits in <code>x</code>.
  Note that this is different from
  <a href="https://repo.mercurial-scm.org/hg/help/revsets">Mercurial's</a> <code>heads(x)</code>
  function, which is equivalent to <code>x ~ x-</code>.</p>
</li>
<li>
<p><code>roots(x)</code>: Commits in <code>x</code> that are not descendants of other commits in <code>x</code>.
  Note that this is different from
  <a href="https://repo.mercurial-scm.org/hg/help/revsets">Mercurial's</a> <code>roots(x)</code>
  function, which is equivalent to <code>x ~ x+</code>.</p>
</li>
<li>
<p><code>latest(x[, count])</code>: Latest <code>count</code> commits in <code>x</code>, based on committer
  timestamp. The default <code>count</code> is 1.</p>
</li>
<li>
<p><code>fork_point(x)</code>: The fork point of all commits in <code>x</code>. The fork point is the
  common ancestor(s) of all commits in <code>x</code> which do not have any descendants
  that are also common ancestors of all commits in <code>x</code>. It is equivalent to
  the revset <code>heads(::x_1 &amp; ::x_2 &amp; ... &amp; ::x_N)</code>, where <code>x_{1..N}</code> are commits
  in <code>x</code>. If <code>x</code> resolves to a single commit, <code>fork_point(x)</code> resolves to <code>x</code>.</p>
</li>
<li>
<p><code>merges()</code>: Merge commits.</p>
</li>
<li>
<p><code>description(pattern)</code>: Commits that have a description matching the given
  <a href="#revsets-string-patterns">string pattern</a>.</p>
<p>A non-empty description is usually terminated with newline character. For
example, <code>description(exact:"")</code> matches commits without description, and
<code>description(exact:"foo\n")</code> matches commits with description <code>"foo\n"</code>.</p>
</li>
<li>
<p><code>subject(pattern)</code>: Commits that have a subject matching the given <a href="#revsets-string-patterns">string
  pattern</a>. A subject is the first line of the description
  (without newline character.)</p>
</li>
<li>
<p><code>author(pattern)</code>: Commits with the author's name or email matching the given
  <a href="#revsets-string-patterns">string pattern</a>. Equivalent to <code>author_name(pattern) |
  author_email(pattern)</code>.</p>
</li>
<li>
<p><code>author_name(pattern)</code>: Commits with the author's name matching the given
  <a href="#revsets-string-patterns">string pattern</a>.</p>
</li>
<li>
<p><code>author_email(pattern)</code>: Commits with the author's email matching the given
  <a href="#revsets-string-patterns">string pattern</a>.</p>
</li>
<li>
<p><code>author_date(pattern)</code>: Commits with author dates matching the specified <a href="#revsets-date-patterns">date
  pattern</a>.</p>
</li>
<li>
<p><code>mine()</code>: Commits where the author's email matches the email of the current
  user. Equivalent to <code>author_email(exact-i:&lt;user-email&gt;)</code></p>
</li>
<li>
<p><code>committer(pattern)</code>: Commits with the committer's name or email matching the
  given <a href="#revsets-string-patterns">string pattern</a>. Equivalent to
  <code>committer_name(pattern) | committer_email(pattern)</code>.</p>
</li>
<li>
<p><code>committer_name(pattern)</code>: Commits with the committer's name matching the
  given <a href="#revsets-string-patterns">string pattern</a>.</p>
</li>
<li>
<p><code>committer_email(pattern)</code>: Commits with the committer's email matching the
  given <a href="#revsets-string-patterns">string pattern</a>.</p>
</li>
<li>
<p><code>committer_date(pattern)</code>: Commits with committer dates matching the specified
  <a href="#revsets-date-patterns">date pattern</a>.</p>
</li>
<li>
<p><code>signed()</code>: Commits that are cryptographically signed.</p>
</li>
<li>
<p><code>empty()</code>: Commits modifying no files. This also includes <code>merges()</code> without
  user modifications and <code>root()</code>.</p>
</li>
<li>
<p><code>files(expression)</code>: Commits modifying paths matching the given <a href="#filesets">fileset
  expression</a>.</p>
<p>Paths are relative to the directory <code>jj</code> was invoked from. A directory name
will match all files in that directory and its subdirectories.</p>
<p>For example, <code>files(foo)</code> will match files <code>foo</code>, <code>foo/bar</code>, <code>foo/bar/baz</code>.
It will <em>not</em> match <code>foobar</code> or <code>bar/foo</code>.</p>
<p>Some file patterns might need quoting because the <code>expression</code> must also be
parsable as a revset. For example, <code>.</code> has to be quoted in <code>files(".")</code>.</p>
</li>
<li>
<p><code>diff_contains(text[, files])</code>: Commits containing diffs matching the given
  <code>text</code> pattern line by line.</p>
<p>The search paths can be narrowed by the <code>files</code> expression. All modified files
are scanned by default, but it is likely to change in future version to
respect the command line path arguments.</p>
<p>For example, <code>diff_contains("TODO", "src")</code> will search revisions where "TODO"
is added to or removed from files under "src".</p>
</li>
<li>
<p><code>conflicts()</code>: Commits with conflicts.</p>
</li>
<li>
<p><code>present(x)</code>: Same as <code>x</code>, but evaluated to <code>none()</code> if any of the commits
  in <code>x</code> doesn't exist (e.g. is an unknown bookmark name.)</p>
</li>
<li>
<p><code>coalesce(revsets...)</code>: Commits in the first revset in the list of <code>revsets</code>
  which does not evaluate to <code>none()</code>. If all revsets evaluate to <code>none()</code>, then
  the result of <code>coalesce</code> will also be <code>none()</code>.</p>
</li>
<li>
<p><code>working_copies()</code>: The working copy commits across all the workspaces.</p>
</li>
<li>
<p><code>at_operation(op, x)</code>: Evaluates <code>x</code> at the specified <a href="#glossary-operation">operation</a>. For
  example, <code>at_operation(@-, visible_heads())</code> will return all heads which were
  visible at the previous operation.</p>
</li>
</ul>
<details class="examples">
<summary>Examples</summary>
<p>Given this history:
<div class="highlight"><pre><span></span><code>o E
|
| o D
|/|
| o C
| |
o | B
|/
o A
|
o root()
</code></pre></div></p>
<p><strong>function</strong> <code>reachable()</code></p>
<ul>
<li><code>reachable(E, A..)</code> ⇒ <code>{E,D,C,B}</code></li>
<li><code>reachable(D, A..)</code> ⇒ <code>{E,D,C,B}</code></li>
<li><code>reachable(C, A..)</code> ⇒ <code>{E,D,C,B}</code></li>
<li><code>reachable(B, A..)</code> ⇒ <code>{E,D,C,B}</code></li>
<li><code>reachable(A, A..)</code> ⇒ <code>{}</code> (empty set)</li>
</ul>
<p><strong>function</strong> <code>connected()</code></p>
<ul>
<li><code>connected(E|A)</code> ⇒ <code>{E,B,A}</code></li>
<li><code>connected(D|A)</code> ⇒ <code>{D,C,B,A}</code></li>
<li><code>connected(A)</code> ⇒ <code>{A}</code></li>
</ul>
<p><strong>function</strong> <code>heads()</code></p>
<ul>
<li><code>heads(E|D)</code> ⇒ <code>{E,D}</code></li>
<li><code>heads(E|C)</code> ⇒ <code>{E,C}</code></li>
<li><code>heads(E|B)</code> ⇒ <code>{E}</code></li>
<li><code>heads(E|A)</code> ⇒ <code>{E}</code></li>
<li><code>heads(A)</code> ⇒ <code>{A}</code></li>
</ul>
<p><strong>function</strong> <code>roots()</code></p>
<ul>
<li><code>roots(E|D)</code> ⇒ <code>{E,D}</code></li>
<li><code>roots(E|C)</code> ⇒ <code>{E,C}</code></li>
<li><code>roots(E|B)</code> ⇒ <code>{B}</code></li>
<li><code>roots(E|A)</code> ⇒ <code>{A}</code></li>
<li><code>roots(A)</code> ⇒ <code>{A}</code></li>
</ul>
<p><strong>function</strong> <code>fork_point()</code></p>
<ul>
<li><code>fork_point(E|D)</code> ⇒ <code>{B}</code></li>
<li><code>fork_point(E|C)</code> ⇒ <code>{A}</code></li>
<li><code>fork_point(E|B)</code> ⇒ <code>{B}</code></li>
<li><code>fork_point(E|A)</code> ⇒ <code>{A}</code></li>
<li><code>fork_point(D|C)</code> ⇒ <code>{C}</code></li>
<li><code>fork_point(D|B)</code> ⇒ <code>{A}</code></li>
<li><code>fork_point(B|C)</code> ⇒ <code>{A}</code></li>
<li><code>fork_point(A)</code> ⇒ <code>{A}</code></li>
<li><code>fork_point(none())</code> ⇒ <code>{}</code></li>
</ul>
</details>
<h2 id="revsets-string-patterns">String patterns<a class="headerlink" href="#revsets-string-patterns" title="Permanent link">&para;</a></h2>
<p>Functions that perform string matching support the following pattern syntax (the
quotes are optional):</p>
<ul>
<li><code>"string"</code> or <code>substring:"string"</code>: Matches strings that contain <code>string</code>.</li>
<li><code>exact:"string"</code>: Matches strings exactly equal to <code>string</code>.</li>
<li><code>glob:"pattern"</code>: Matches strings with Unix-style shell <a href="https://docs.rs/glob/latest/glob/struct.Pattern.html">wildcard
  <code>pattern</code></a>.</li>
<li><code>regex:"pattern"</code>: Matches substrings with <a href="https://docs.rs/regex/latest/regex/#syntax">regular
  expression <code>pattern</code></a>.</li>
</ul>
<p>You can append <code>-i</code> after the kind to match case‐insensitively (e.g.
<code>glob-i:"fix*jpeg*"</code>).</p>
<h2 id="revsets-date-patterns">Date patterns<a class="headerlink" href="#revsets-date-patterns" title="Permanent link">&para;</a></h2>
<p>Functions that perform date matching support the following pattern syntax:</p>
<ul>
<li><code>after:"string"</code>: Matches dates exactly at or after the given date.</li>
<li><code>before:"string"</code>: Matches dates before, but not including, the given date.</li>
</ul>
<p>Date strings can be specified in several forms, including:</p>
<ul>
<li>2024-02-01</li>
<li>2024-02-01T12:00:00</li>
<li>2024-02-01T12:00:00-08:00</li>
<li>2024-02-01 12:00:00</li>
<li>2 days ago</li>
<li>5 minutes ago</li>
<li>yesterday</li>
<li>yesterday 5pm</li>
<li>yesterday 10:30</li>
<li>yesterday 15:30</li>
</ul>
<h2 id="revsets-aliases">Aliases<a class="headerlink" href="#revsets-aliases" title="Permanent link">&para;</a></h2>
<p>New symbols and functions can be defined in the config file, by using any
combination of the predefined symbols/functions and other aliases.</p>
<p>Alias functions can be overloaded by the number of parameters. However, builtin
function will be shadowed by name, and can't co-exist with aliases.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[revset-aliases]</span>
<span class="s1">&#39;HEAD&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;@-&#39;</span>
<span class="s1">&#39;user()&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;user(&quot;me@example.org&quot;)&#39;</span>
<span class="s1">&#39;user(x)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;author(x) | committer(x)&#39;</span>
</code></pre></div>
<h3 id="revsets-built-in-aliases">Built-in Aliases<a class="headerlink" href="#revsets-built-in-aliases" title="Permanent link">&para;</a></h3>
<p>The following aliases are built-in and used for certain operations. These functions
are defined as aliases in order to allow you to overwrite them as needed.
See <a href="https://github.com/jj-vcs/jj/blob/main/cli/src/config/revsets.toml">revsets.toml</a>
for a comprehensive list.</p>
<ul>
<li>
<p><code>trunk()</code>: Resolves to the head commit for the trunk bookmark of the remote
  named <code>origin</code> or <code>upstream</code>. The bookmarks <code>main</code>, <code>master</code>, and <code>trunk</code> are
  tried. If more than one potential trunk commit exists, the newest one is
  chosen. If none of the bookmarks exist, the revset evaluates to <code>root()</code>.</p>
<p>When working with an existing Git repository (via <code>jj git clone</code> or
<code>jj git init</code>), <code>trunk()</code> will be overridden at the repository level
to the default bookmark of the remote <code>origin</code>.</p>
<p>You can <a href="#config">override</a> this as appropriate. If you do, make sure it
always resolves to exactly one commit. For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[revset-aliases]</span>
<span class="s1">&#39;trunk()&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;your-bookmark@your-remote&#39;</span>
</code></pre></div>
</li>
<li>
<p><code>builtin_immutable_heads()</code>: Resolves to
  <code>present(trunk()) | tags() | untracked_remote_bookmarks()</code>. It is used as the
   default definition for <code>immutable_heads()</code> below. It is not recommended to
   redefine this alias. Prefer to redefine <code>immutable_heads()</code> instead.</p>
</li>
<li>
<p><code>immutable_heads()</code>: Resolves to
  <code>present(trunk()) | tags() | untracked_remote_bookmarks()</code> by default. It is
  actually defined as <code>builtin_immutable_heads()</code>, and can be overridden as
  required. See <a href="#config-set-of-immutable-commits">here</a> for details.</p>
</li>
<li>
<p><code>immutable()</code>: The set of commits that <code>jj</code> treats as immutable. This is
  equivalent to <code>::(immutable_heads() | root())</code>. It is not recommended to redefine
  this alias. Note that modifying this will <em>not</em> change whether a commit is immutable.
  To do that, edit <code>immutable_heads()</code>.</p>
</li>
<li>
<p><code>mutable()</code>: The set of commits that <code>jj</code> treats as mutable. This is
  equivalent to <code>~immutable()</code>. It is not recommended to redefined this alias.
  Note that modifying this will <em>not</em> change whether a commit is immutable.
  To do that, edit <code>immutable_heads()</code>.</p>
</li>
</ul>
<h2 id="revsets-the-all-modifier">The <code>all:</code> modifier<a class="headerlink" href="#revsets-the-all-modifier" title="Permanent link">&para;</a></h2>
<p>Certain commands (such as <code>jj rebase</code>) can take multiple revset arguments, and
each of these may resolve to one-or-many revisions. By default, <code>jj</code> will not
allow revsets that resolve to more than one revision &mdash; a so-called "large
revset" &mdash; and will ask you to confirm that you want to proceed by
prefixing it with the <code>all:</code> modifier.</p>
<p>If you set the <code>ui.always-allow-large-revsets</code> option to <code>true</code>, <code>jj</code> will
behave as though the <code>all:</code> modifier was used every time it would matter.</p>
<p>An <code>all:</code> modifier before a revset expression does not otherwise change its
meaning. Strictly speaking, it is not part of the revset language. The notation
is similar to the modifiers like <code>glob:</code> allowed before <a href="#revsets-string-patterns">string
patterns</a>.</p>
<p>For example, <code>jj rebase -r w -d xyz+</code> will rebase <code>w</code> on top of the child of
<code>xyz</code> as long as <code>xyz</code> has exactly one child.</p>
<p>If <code>xyz</code> has more than one child, the <code>all:</code> modifier is <em>not</em> specified, and
<code>ui.always-allow-large-revsets</code> is <code>false</code> (the default), <code>jj rebase -r w -d
xyz+</code> will return an error.</p>
<p>If <code>ui.always-allow-large-revsets</code> was <code>true</code>, the above command would act as if
<code>all:</code> was set (see the next paragraph).</p>
<p>With the <code>all:</code> modifier, <code>jj rebase -r w -d all:xyz+</code> will make <code>w</code> into a merge
commit if <code>xyz</code> has more than one child. The <code>all:</code> modifier confirms that the
user expected <code>xyz</code> to have more than one child.</p>
<p>A more useful example: if <code>w</code> is a merge commit, <code>jj rebase -s w -d all:w- -d
xyz</code> will add <code>xyz</code> to the list of <code>w</code>'s parents.</p>
<h2 id="revsets-examples">Examples<a class="headerlink" href="#revsets-examples" title="Permanent link">&para;</a></h2>
<p>Show the parent(s) of the working-copy commit (like <code>git log -1 HEAD</code>):</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span>@-
</code></pre></div>
<p>Show all ancestors of the working copy (like plain <code>git log</code>)</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span>::@
</code></pre></div>
<p>Show commits not on any remote bookmark:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;remote_bookmarks()..&#39;</span>
</code></pre></div>
<p>Show commits not on <code>origin</code> (if you have other remotes like <code>fork</code>):</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;remote_bookmarks(remote=origin)..&#39;</span>
</code></pre></div>
<p>Show the initial commits in the repo (the ones Git calls "root commits"):</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;root()+&#39;</span>
</code></pre></div>
<p>Show some important commits (like <code>git --simplify-by-decoration</code>):</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;tags() | bookmarks()&#39;</span>
</code></pre></div>
<p>Show local commits leading up to the working copy, as well as descendants of
those commits:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;(remote_bookmarks()..@)::&#39;</span>
</code></pre></div>
<p>Show commits authored by "martinvonz" and containing the word "reset" in the
description:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;author(martinvonz) &amp; description(reset)&#39;</span>
</code></pre></div></section><section class="print-page" id="templates" heading-number="8.4"><h1 id="templates-templates">Templates<a class="headerlink" href="#templates-templates" title="Permanent link">&para;</a></h1>
<p>Jujutsu supports a functional language to customize output of commands.
The language consists of literals, keywords, operators, functions, and
methods.</p>
<p>A couple of <code>jj</code> commands accept a template via <code>-T</code>/<code>--template</code> option.</p>
<h2 id="templates-keywords">Keywords<a class="headerlink" href="#templates-keywords" title="Permanent link">&para;</a></h2>
<p>Keywords represent objects of different types; the types are described in
a follow-up section. In addition to context-specific keywords, the top-level
object can be referenced as <code>self</code>.</p>
<h3 id="templates-commit-keywords">Commit keywords<a class="headerlink" href="#templates-commit-keywords" title="Permanent link">&para;</a></h3>
<p>In <code>jj log</code>/<code>jj evolog</code> templates, all 0-argument methods of <a href="#templates-commit-type">the <code>Commit</code>
type</a> are available as keywords. For example, <code>commit_id</code> is
equivalent to <code>self.commit_id()</code>.</p>
<h3 id="templates-operation-keywords">Operation keywords<a class="headerlink" href="#templates-operation-keywords" title="Permanent link">&para;</a></h3>
<p>In <code>jj op log</code> templates, all 0-argument methods of <a href="#templates-operation-type">the <code>Operation</code>
type</a> are available as keywords. For example,
<code>current_operation</code> is equivalent to <code>self.current_operation()</code>.</p>
<h2 id="templates-operators">Operators<a class="headerlink" href="#templates-operators" title="Permanent link">&para;</a></h2>
<p>The following operators are supported.</p>
<ul>
<li><code>x.f()</code>: Method call.</li>
<li><code>-x</code>: Negate integer value.</li>
<li><code>!x</code>: Logical not.</li>
<li><code>x * y</code>, <code>x / y</code>, <code>x % y</code>: Multiplication/division/remainder. Operands must
  be <code>Integer</code>s.</li>
<li><code>x + y</code>, <code>x - y</code>: Addition/subtraction. Operands must be <code>Integer</code>s.</li>
<li><code>x &gt;= y</code>, <code>x &gt; y</code>, <code>x &lt;= y</code>, <code>x &lt; y</code>: Greater than or equal/greater than/
  lesser than or equal/lesser than. Operands must be <code>Integer</code>s.</li>
<li><code>x == y</code>, <code>x != y</code>: Equal/not equal. Operands must be either <code>Boolean</code>,
  <code>Integer</code>, or <code>String</code>.</li>
<li><code>x &amp;&amp; y</code>: Logical and, short-circuiting.</li>
<li><code>x || y</code>: Logical or, short-circuiting.</li>
<li><code>x ++ y</code>: Concatenate <code>x</code> and <code>y</code> templates.</li>
</ul>
<p>(listed in order of binding strengths)</p>
<h2 id="templates-global-functions">Global functions<a class="headerlink" href="#templates-global-functions" title="Permanent link">&para;</a></h2>
<p>The following functions are defined.</p>
<ul>
<li><code>fill(width: Integer, content: Template) -&gt; Template</code>: Fill lines at
  the given <code>width</code>.</li>
<li><code>indent(prefix: Template, content: Template) -&gt; Template</code>: Indent
  non-empty lines by the given <code>prefix</code>.</li>
<li><code>pad_start(width: Integer, content: Template[, fill_char: Template])</code>: Pad (or
  right-justify) content by adding leading fill characters. The <code>content</code>
  shouldn't have newline character.</li>
<li><code>pad_end(width: Integer, content: Template[, fill_char: Template])</code>: Pad (or
  left-justify) content by adding trailing fill characters. The <code>content</code>
  shouldn't have newline character.</li>
<li><code>pad_centered(width: Integer, content: Template[, fill_char: Template])</code>: Pad
  content by adding both leading and trailing fill characters. If an odd number
  of fill characters are needed, the trailing fill will be one longer than the
  leading fill. The <code>content</code> shouldn't have newline characters.</li>
<li><code>truncate_start(width: Integer, content: Template[, ellipsis: Template])</code>:
  Truncate <code>content</code> by removing leading characters. The <code>content</code> shouldn't
  have newline character. If <code>ellipsis</code> is provided and <code>content</code> was truncated,
  prepend the <code>ellipsis</code> to the result.</li>
<li><code>truncate_end(width: Integer, content: Template[, ellipsis: Template])</code>:
  Truncate <code>content</code> by removing trailing characters. The <code>content</code> shouldn't
  have newline character. If <code>ellipsis</code> is provided and <code>content</code> was truncated,
  append the <code>ellipsis</code> to the result.</li>
<li><code>label(label: Template, content: Template) -&gt; Template</code>: Apply label to
  the content. The <code>label</code> is evaluated as a space-separated string.</li>
<li><code>raw_escape_sequence(content: Template) -&gt; Template</code>: Preserves any escape
  sequences in <code>content</code> (i.e., bypasses sanitization) and strips labels.
  Note: This function is intended for escape sequences and as such, its output
  is expected to be invisible / of no display width. Outputting content with
  nonzero display width may break wrapping, indentation etc.</li>
<li><code>stringify(content: Template) -&gt; String</code>: Format <code>content</code> to string. This
  effectively removes color labels.</li>
<li><code>if(condition: Boolean, then: Template[, else: Template]) -&gt; Template</code>:
  Conditionally evaluate <code>then</code>/<code>else</code> template content.</li>
<li><code>coalesce(content: Template...) -&gt; Template</code>: Returns the first <strong>non-empty</strong>
  content.</li>
<li><code>concat(content: Template...) -&gt; Template</code>:
  Same as <code>content_1 ++ ... ++ content_n</code>.</li>
<li><code>separate(separator: Template, content: Template...) -&gt; Template</code>:
  Insert separator between <strong>non-empty</strong> contents.</li>
<li><code>surround(prefix: Template, suffix: Template, content: Template) -&gt; Template</code>:
  Surround <strong>non-empty</strong> content with texts such as parentheses.</li>
<li><code>config(name: String) -&gt; ConfigValue</code>: Look up configuration value by <code>name</code>.</li>
</ul>
<h2 id="templates-types">Types<a class="headerlink" href="#templates-types" title="Permanent link">&para;</a></h2>
<h3 id="templates-annotationline-type"><code>AnnotationLine</code> type<a class="headerlink" href="#templates-annotationline-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.commit() -&gt; Commit</code>: Commit responsible for changing the relevant line.</li>
<li><code>.content() -&gt; Template</code>: Line content including newline character.</li>
<li><code>.line_number() -&gt; Integer</code>: 1-based line number.</li>
<li><code>.first_line_in_hunk() -&gt; Boolean</code>: False when the directly preceding line
  references the same commit.</li>
</ul>
<h3 id="templates-boolean-type"><code>Boolean</code> type<a class="headerlink" href="#templates-boolean-type" title="Permanent link">&para;</a></h3>
<p>No methods are defined. Can be constructed with <code>false</code> or <code>true</code> literal.</p>
<h3 id="templates-commit-type"><code>Commit</code> type<a class="headerlink" href="#templates-commit-type" title="Permanent link">&para;</a></h3>
<p>This type cannot be printed. The following methods are defined.</p>
<ul>
<li><code>.description() -&gt; String</code></li>
<li><code>.trailers() -&gt; List&lt;Trailer&gt;</code></li>
<li><code>.change_id() -&gt; ChangeId</code></li>
<li><code>.commit_id() -&gt; CommitId</code></li>
<li><code>.parents() -&gt; List&lt;Commit&gt;</code></li>
<li><code>.author() -&gt; Signature</code></li>
<li><code>.committer() -&gt; Signature</code></li>
<li><code>.signature() -&gt; Option&lt;CryptographicSignature&gt;</code></li>
<li><code>.mine() -&gt; Boolean</code>: Commits where the author's email matches the email of
  the current user.</li>
<li><code>.working_copies() -&gt; String</code>: For multi-workspace repository, indicate
  working-copy commit as <code>&lt;workspace name&gt;@</code>.</li>
<li><code>.current_working_copy() -&gt; Boolean</code>: True for the working-copy commit of the
  current workspace.</li>
<li><code>.bookmarks() -&gt; List&lt;CommitRef&gt;</code>: Local and remote bookmarks pointing to the
  commit. A tracking remote bookmark will be included only if its target is
  different from the local one.</li>
<li><code>.local_bookmarks() -&gt; List&lt;CommitRef&gt;</code>: All local bookmarks pointing to the
  commit.</li>
<li><code>.remote_bookmarks() -&gt; List&lt;CommitRef&gt;</code>: All remote bookmarks pointing to the
  commit.</li>
<li><code>.tags() -&gt; List&lt;CommitRef&gt;</code></li>
<li><code>.git_refs() -&gt; List&lt;CommitRef&gt;</code></li>
<li><code>.git_head() -&gt; Boolean</code>: True for the Git <code>HEAD</code> commit.</li>
<li><code>.divergent() -&gt; Boolean</code>: True if the commit's change id corresponds to multiple
  visible commits.</li>
<li><code>.hidden() -&gt; Boolean</code>: True if the commit is not visible (a.k.a. abandoned).</li>
<li><code>.immutable() -&gt; Boolean</code>: True if the commit is included in <a href="#config-set-of-immutable-commits">the set of
  immutable commits</a>.</li>
<li><code>.contained_in(revset: String) -&gt; Boolean</code>: True if the commit is included in <a href="#revsets">the provided revset</a>.</li>
<li><code>.conflict() -&gt; Boolean</code>: True if the commit contains merge conflicts.</li>
<li><code>.empty() -&gt; Boolean</code>: True if the commit modifies no files.</li>
<li><code>.diff([files: String]) -&gt; TreeDiff</code>: Changes from the parents within <a href="#filesets">the
  <code>files</code> expression</a>. All files are compared by default, but it is
  likely to change in future version to respect the command line path arguments.</li>
<li><code>.root() -&gt; Boolean</code>: True if the commit is the root commit.</li>
</ul>
<h3 id="templates-changeid-type"><code>ChangeId</code> type<a class="headerlink" href="#templates-changeid-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.normal_hex() -&gt; String</code>: Normal hex representation (0-9a-f) instead of the
  canonical "reversed" (z-k) representation.</li>
<li><code>.short([len: Integer]) -&gt; String</code></li>
<li><code>.shortest([min_len: Integer]) -&gt; ShortestIdPrefix</code>: Shortest unique prefix.</li>
</ul>
<h3 id="templates-commitid-type"><code>CommitId</code> type<a class="headerlink" href="#templates-commitid-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.short([len: Integer]) -&gt; String</code></li>
<li><code>.shortest([min_len: Integer]) -&gt; ShortestIdPrefix</code>: Shortest unique prefix.</li>
</ul>
<h3 id="templates-commitref-type"><code>CommitRef</code> type<a class="headerlink" href="#templates-commitref-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.name() -&gt; RefSymbol</code>: Local bookmark or tag name.</li>
<li><code>.remote() -&gt; Option&lt;RefSymbol&gt;</code>: Remote name if this is a remote ref.</li>
<li><code>.present() -&gt; Boolean</code>: True if the ref points to any commit.</li>
<li><code>.conflict() -&gt; Boolean</code>: True if <a href="#bookmarks-conflicts">the bookmark or tag is
  conflicted</a>.</li>
<li><code>.normal_target() -&gt; Option&lt;Commit&gt;</code>: Target commit if the ref is not
  conflicted and points to a commit.</li>
<li><code>.removed_targets() -&gt; List&lt;Commit&gt;</code>: Old target commits if conflicted.</li>
<li><code>.added_targets() -&gt; List&lt;Commit&gt;</code>: New target commits. The list usually
  contains one "normal" target.</li>
<li><code>.tracked() -&gt; Boolean</code>: True if the ref is tracked by a local ref. The local
  ref might have been deleted (but not pushed yet.)</li>
<li><code>.tracking_present() -&gt; Boolean</code>: True if the ref is tracked by a local ref,
    and if the local ref points to any commit.</li>
<li><code>.tracking_ahead_count() -&gt; SizeHint</code>: Number of commits ahead of the tracking
  local ref.</li>
<li><code>.tracking_behind_count() -&gt; SizeHint</code>: Number of commits behind of the
  tracking local ref.</li>
</ul>
<h3 id="templates-configvalue-type"><code>ConfigValue</code> type<a class="headerlink" href="#templates-configvalue-type" title="Permanent link">&para;</a></h3>
<p>This type can be printed in TOML syntax. The following methods are defined.</p>
<ul>
<li><code>.as_boolean() -&gt; Boolean</code>: Extract boolean.</li>
<li><code>.as_integer() -&gt; Integer</code>: Extract integer.</li>
<li><code>.as_string() -&gt; String</code>: Extract string. This does not convert non-string
  value (e.g. integer) to string.</li>
<li><code>.as_string_list() -&gt; List&lt;String&gt;</code>: Extract list of strings.</li>
</ul>
<h3 id="templates-cryptographicsignature-type"><code>CryptographicSignature</code> type<a class="headerlink" href="#templates-cryptographicsignature-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.status() -&gt; String</code>: The signature's status (<code>"good"</code>, <code>"bad"</code>, <code>"unknown"</code>, <code>"invalid"</code>).</li>
<li><code>.key() -&gt; String</code>: The signature's key id representation (for GPG, this is the key fingerprint).</li>
<li><code>.display() -&gt; String</code>: The signature's display string (for GPG this is the formatted primary user ID).</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Calling any of <code>.status()</code>, <code>.key()</code>, or <code>.display()</code> is slow, as it incurs
the performance cost of verifying the signature (for example shelling out
to <code>gpg</code> or <code>ssh-keygen</code>). Though consecutive calls will be faster, because
the backend caches the verification result.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>As opposed to calling any of <code>.status()</code>, <code>.key()</code>, or <code>.display()</code>,
checking for signature presence through boolean coercion is fast:
<div class="highlight"><pre><span></span><code>if(commit.signature(), &quot;commit has a signature&quot;, &quot;commit is unsigned&quot;)
</code></pre></div></p>
</div>
<h3 id="templates-diffstats-type"><code>DiffStats</code> type<a class="headerlink" href="#templates-diffstats-type" title="Permanent link">&para;</a></h3>
<p>This type can be printed as a histogram of the changes. The following methods
are defined.</p>
<ul>
<li><code>.total_added() -&gt; Integer</code>: Total number of insertions.</li>
<li><code>.total_removed() -&gt; Integer</code>: Total number of deletions.</li>
</ul>
<h3 id="templates-email-type"><code>Email</code> type<a class="headerlink" href="#templates-email-type" title="Permanent link">&para;</a></h3>
<p>The email field of a signature may or may not look like an email address. It may
be empty, may not contain the symbol <code>@</code>, and could in principle contain
multiple <code>@</code>s.</p>
<p>The following methods are defined.</p>
<ul>
<li><code>.local() -&gt; String</code>: the part of the email before the first <code>@</code>, usually the
  username.</li>
<li><code>.domain() -&gt; String</code>: the part of the email after the first <code>@</code> or the empty
  string.</li>
</ul>
<h3 id="templates-integer-type"><code>Integer</code> type<a class="headerlink" href="#templates-integer-type" title="Permanent link">&para;</a></h3>
<p>No methods are defined.</p>
<h3 id="templates-list-type"><code>List</code> type<a class="headerlink" href="#templates-list-type" title="Permanent link">&para;</a></h3>
<p>A list can be implicitly converted to <code>Boolean</code>. The following methods are
defined.</p>
<ul>
<li><code>.len() -&gt; Integer</code>: Number of elements in the list.</li>
<li><code>.join(separator: Template) -&gt; Template</code>: Concatenate elements with
  the given <code>separator</code>.</li>
<li><code>.filter(|item| expression) -&gt; List</code>: Filter list elements by predicate
  <code>expression</code>. Example: <code>description.lines().filter(|s| s.contains("#"))</code></li>
<li><code>.map(|item| expression) -&gt; ListTemplate</code>: Apply template <code>expression</code>
  to each element. Example: <code>parents.map(|c| c.commit_id().short())</code></li>
</ul>
<h3 id="templates-listtrailer-type"><code>List&lt;Trailer&gt;</code> type<a class="headerlink" href="#templates-listtrailer-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined. See also the <code>List</code> type.</p>
<ul>
<li><code>.contains_key(key: Template) -&gt; Boolean</code>: True if the commit description
  contains at least one trailer with the key <code>key</code>.</li>
</ul>
<h3 id="templates-listtemplate-type"><code>ListTemplate</code> type<a class="headerlink" href="#templates-listtemplate-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined. See also the <code>List</code> type.</p>
<ul>
<li><code>.join(separator: Template) -&gt; Template</code></li>
</ul>
<h3 id="templates-operation-type"><code>Operation</code> type<a class="headerlink" href="#templates-operation-type" title="Permanent link">&para;</a></h3>
<p>This type cannot be printed. The following methods are defined.</p>
<ul>
<li><code>.current_operation() -&gt; Boolean</code></li>
<li><code>.description() -&gt; String</code></li>
<li><code>.id() -&gt; OperationId</code></li>
<li><code>.tags() -&gt; String</code></li>
<li><code>.time() -&gt; TimestampRange</code></li>
<li><code>.user() -&gt; String</code></li>
<li><code>.snapshot() -&gt; Boolean</code>: True if the operation is a snapshot operation.</li>
<li><code>.root() -&gt; Boolean</code>: True if the operation is the root operation.</li>
</ul>
<h3 id="templates-operationid-type"><code>OperationId</code> type<a class="headerlink" href="#templates-operationid-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.short([len: Integer]) -&gt; String</code></li>
</ul>
<h3 id="templates-option-type"><code>Option</code> type<a class="headerlink" href="#templates-option-type" title="Permanent link">&para;</a></h3>
<p>An option can be implicitly converted to <code>Boolean</code> denoting whether the
contained value is set. If set, all methods of the contained value can be
invoked. If not set, an error will be reported inline on method call.</p>
<p>On comparison between two optional values or optional and non-optional values,
unset value is not an error. Unset value is considered less than any set values.</p>
<h3 id="templates-refsymbol-type"><code>RefSymbol</code> type<a class="headerlink" href="#templates-refsymbol-type" title="Permanent link">&para;</a></h3>
<p><a href="#templates-string-type">A <code>String</code> type</a>, but is formatted as revset symbol by quoting
and escaping if necessary. Unlike strings, this cannot be implicitly converted
to <code>Boolean</code>.</p>
<h3 id="templates-repopath-type"><code>RepoPath</code> type<a class="headerlink" href="#templates-repopath-type" title="Permanent link">&para;</a></h3>
<p>A slash-separated path relative to the repository root. The following methods
are defined.</p>
<ul>
<li><code>.display() -&gt; String</code>: Format path for display. The formatted path uses
  platform-native separator, and is relative to the current working directory.</li>
<li><code>.parent() -&gt; Option&lt;RepoPath&gt;</code>: Parent directory path.</li>
</ul>
<h3 id="templates-shortestidprefix-type"><code>ShortestIdPrefix</code> type<a class="headerlink" href="#templates-shortestidprefix-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.prefix() -&gt; String</code></li>
<li><code>.rest() -&gt; String</code></li>
<li><code>.upper() -&gt; ShortestIdPrefix</code></li>
<li><code>.lower() -&gt; ShortestIdPrefix</code></li>
</ul>
<h3 id="templates-signature-type"><code>Signature</code> type<a class="headerlink" href="#templates-signature-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.name() -&gt; String</code></li>
<li><code>.email() -&gt; Email</code></li>
<li><code>.timestamp() -&gt; Timestamp</code></li>
</ul>
<h3 id="templates-sizehint-type"><code>SizeHint</code> type<a class="headerlink" href="#templates-sizehint-type" title="Permanent link">&para;</a></h3>
<p>This type cannot be printed. The following methods are defined.</p>
<ul>
<li><code>.lower() -&gt; Integer</code>: Lower bound.</li>
<li><code>.upper() -&gt; Option&lt;Integer&gt;</code>: Upper bound if known.</li>
<li><code>.exact() -&gt; Option&lt;Integer&gt;</code>: Exact value if upper bound is known and it
  equals to the lower bound.</li>
<li><code>.zero() -&gt; Boolean</code>: True if upper bound is known and is <code>0</code>. Equivalent to
  <code>.upper() == 0</code>.</li>
</ul>
<h3 id="templates-string-type"><code>String</code> type<a class="headerlink" href="#templates-string-type" title="Permanent link">&para;</a></h3>
<p>A string can be implicitly converted to <code>Boolean</code>. The following methods are
defined.</p>
<ul>
<li><code>.len() -&gt; Integer</code>: Length in UTF-8 bytes.</li>
<li><code>.contains(needle: Template) -&gt; Boolean</code></li>
<li><code>.first_line() -&gt; String</code></li>
<li><code>.lines() -&gt; List&lt;String&gt;</code>: Split into lines excluding newline characters.</li>
<li><code>.upper() -&gt; String</code></li>
<li><code>.lower() -&gt; String</code></li>
<li><code>.starts_with(needle: Template) -&gt; Boolean</code></li>
<li><code>.ends_with(needle: Template) -&gt; Boolean</code></li>
<li><code>.remove_prefix(needle: Template) -&gt; String</code>: Removes the passed prefix, if present</li>
<li><code>.remove_suffix(needle: Template) -&gt; String</code>: Removes the passed suffix, if present</li>
<li><code>.trim() -&gt; String</code>: Removes leading and trailing whitespace</li>
<li><code>.trim_start() -&gt; String</code>: Removes leading whitespace</li>
<li><code>.trim_end() -&gt; String</code>: Removes trailing whitespace</li>
<li><code>.substr(start: Integer, end: Integer) -&gt; String</code>: Extract substring. The
  <code>start</code>/<code>end</code> indices should be specified in UTF-8 bytes. Negative values
  count from the end of the string.</li>
<li><code>.escape_json() -&gt; String</code>: Serializes the string in JSON format. This
  function is useful for making machine-readable templates. For example, you
  can use it in a template like <code>'{ "foo": ' ++ foo.escape_json() ++ ' }'</code> to
  return a JSON/JSONL.</li>
</ul>
<h4 id="templates-string-literals">String literals<a class="headerlink" href="#templates-string-literals" title="Permanent link">&para;</a></h4>
<p>String literals must be surrounded by single or double quotes (<code>'</code> or <code>"</code>).
A double-quoted string literal supports the following escape sequences:</p>
<ul>
<li><code>\"</code>: double quote</li>
<li><code>\\</code>: backslash</li>
<li><code>\t</code>: horizontal tab</li>
<li><code>\r</code>: carriage return</li>
<li><code>\n</code>: new line</li>
<li><code>\0</code>: null</li>
<li><code>\e</code>: escape (i.e., <code>\x1b</code>)</li>
<li><code>\xHH</code>: byte with hex value <code>HH</code></li>
</ul>
<p>Other escape sequences are not supported. Any UTF-8 characters are allowed
inside a string literal, with two exceptions: unescaped <code>"</code>-s and uses of <code>\</code>
that don't form a valid escape sequence.</p>
<p>A single-quoted string literal has no escape syntax. <code>'</code> can't be expressed
inside a single-quoted string literal.</p>
<h3 id="templates-template-type"><code>Template</code> type<a class="headerlink" href="#templates-template-type" title="Permanent link">&para;</a></h3>
<p>Most types can be implicitly converted to <code>Template</code>. No methods are defined.</p>
<h3 id="templates-timestamp-type"><code>Timestamp</code> type<a class="headerlink" href="#templates-timestamp-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.ago() -&gt; String</code>: Format as relative timestamp.</li>
<li><code>.format(format: String) -&gt; String</code>: Format with <a href="https://docs.rs/chrono/latest/chrono/format/strftime/">the specified strftime-like
  format string</a>.</li>
<li><code>.utc() -&gt; Timestamp</code>: Convert timestamp into UTC timezone.</li>
<li><code>.local() -&gt; Timestamp</code>: Convert timestamp into local timezone.</li>
<li><code>.after(date: String) -&gt; Boolean</code>: True if the timestamp is exactly at or after the given date.</li>
<li><code>.before(date: String) -&gt; Boolean</code>: True if the timestamp is before, but not including, the given date.</li>
</ul>
<h3 id="templates-timestamprange-type"><code>TimestampRange</code> type<a class="headerlink" href="#templates-timestamprange-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.start() -&gt; Timestamp</code></li>
<li><code>.end() -&gt; Timestamp</code></li>
<li><code>.duration() -&gt; String</code></li>
</ul>
<h3 id="templates-trailer-type"><code>Trailer</code> type<a class="headerlink" href="#templates-trailer-type" title="Permanent link">&para;</a></h3>
<p>The following methods are defined.</p>
<ul>
<li><code>.key() -&gt; String</code></li>
<li><code>.value() -&gt; String</code></li>
</ul>
<h3 id="templates-treediff-type"><code>TreeDiff</code> type<a class="headerlink" href="#templates-treediff-type" title="Permanent link">&para;</a></h3>
<p>This type cannot be printed. The following methods are defined.</p>
<ul>
<li><code>.files() -&gt; List&lt;TreeDiffEntry&gt;</code>: Changed files.</li>
<li><code>.color_words([context: Integer]) -&gt; Template</code>: Format as a word-level diff
  with changes indicated only by color.</li>
<li><code>.git([context: Integer]) -&gt; Template</code>: Format as a Git diff.</li>
<li><code>.stat([width: Integer]) -&gt; DiffStats</code>: Calculate stats of changed lines.</li>
<li><code>.summary() -&gt; Template</code>: Format as a list of status code and path pairs.</li>
</ul>
<h3 id="templates-treediffentry-type"><code>TreeDiffEntry</code> type<a class="headerlink" href="#templates-treediffentry-type" title="Permanent link">&para;</a></h3>
<p>This type cannot be printed. The following methods are defined.</p>
<ul>
<li><code>.path() -&gt; RepoPath</code>: Path to the entry. If the entry is a copy/rename, this
  points to the target (or right) entry.</li>
<li><code>.status() -&gt; String</code>: One of <code>"modified"</code>, <code>"added"</code>, <code>"removed"</code>,
  <code>"copied"</code>, or <code>"renamed"</code>.</li>
<li><code>.source() -&gt; TreeEntry</code>: The source (or left) entry.</li>
<li><code>.target() -&gt; TreeEntry</code>: The target (or right) entry.</li>
</ul>
<h3 id="templates-treeentry-type"><code>TreeEntry</code> type<a class="headerlink" href="#templates-treeentry-type" title="Permanent link">&para;</a></h3>
<p>This type cannot be printed. The following methods are defined.</p>
<ul>
<li><code>.path() -&gt; RepoPath</code>: Path to the entry.</li>
<li><code>.conflict() -&gt; Boolean</code>: True if the entry is a merge conflict.</li>
<li><code>.file_type() -&gt; String</code>: One of <code>"file"</code>, <code>"symlink"</code>, <code>"tree"</code>,
  <code>"git-submodule"</code>, or <code>"conflict"</code>.</li>
<li><code>.executable() -&gt; Boolean</code>: True if the entry is an executable file.</li>
</ul>
<h2 id="templates-color-labels">Color labels<a class="headerlink" href="#templates-color-labels" title="Permanent link">&para;</a></h2>
<p>Template fragments are usually labeled with the command name, the context (or
the top-level object), and the method names. You can <a href="#config-custom-colors-and-styles">customize the output
colors</a> by using these labels.</p>
<p>For example, the following template is labeled as <code>op_log operation id short</code>:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>op<span class="w"> </span>log<span class="w"> </span>-T<span class="w"> </span><span class="s1">&#39;self.id().short()&#39;</span>
</code></pre></div>
<p>In addition to that, you can insert arbitrary labels by <code>label(label, content)</code>
function.</p>
<p>To inspect how output fragments are labeled, use <code>--color=debug</code> option.</p>
<h2 id="templates-configuration">Configuration<a class="headerlink" href="#templates-configuration" title="Permanent link">&para;</a></h2>
<p>The default templates and aliases() are defined in the <code>[templates]</code> and
<code>[template-aliases]</code> sections of the config respectively. The exact definitions
can be seen in the <a href="https://github.com/jj-vcs/jj/blob/main/cli/src/config/templates.toml"><code>cli/src/config/templates.toml</code></a> file in jj's source
tree.</p>
<!--- TODO: Find a way to embed the default config files in the docs -->

<p>New keywords and functions can be defined as aliases, by using any
combination of the predefined keywords/functions and other aliases.</p>
<p>Alias functions can be overloaded by the number of parameters. However, builtin
functions will be shadowed by name, and can't co-exist with aliases.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="k">[template-aliases]</span>
<span class="s1">&#39;commit_change_ids&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">concat(</span>
<span class="s1">  format_field(&quot;Commit ID&quot;, commit_id),</span>
<span class="s1">  format_field(&quot;Change ID&quot;, change_id),</span>
<span class="s1">)</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&#39;format_field(key, value)&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;key ++ &quot;: &quot; ++ value ++ &quot;\n&quot;&#39;</span>
</code></pre></div>
<h2 id="templates-examples">Examples<a class="headerlink" href="#templates-examples" title="Permanent link">&para;</a></h2>
<p>Get short commit IDs of the working-copy parents:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>--no-graph<span class="w"> </span>-r<span class="w"> </span>@<span class="w"> </span>-T<span class="w"> </span><span class="s1">&#39;parents.map(|c| c.commit_id().short()).join(&quot;,&quot;)&#39;</span>
</code></pre></div>
<p>Show machine-readable list of full commit and change IDs:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>--no-graph<span class="w"> </span>-T<span class="w"> </span><span class="s1">&#39;commit_id ++ &quot; &quot; ++ change_id ++ &quot;\n&quot;&#39;</span>
</code></pre></div></section></section>
                    <section class='print-page md-section' id='section-9' heading-number='9'>
                        <h1>Comparisons<a class='headerlink' href='#section-9' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="git-comparison" heading-number="9.1"><h1 id="git-comparison-comparison-with-git">Comparison with Git<a class="headerlink" href="#git-comparison-comparison-with-git" title="Permanent link">&para;</a></h1>
<h2 id="git-comparison-introduction">Introduction<a class="headerlink" href="#git-comparison-introduction" title="Permanent link">&para;</a></h2>
<p>This document attempts to describe how Jujutsu is different from Git. See
<a href="#git-compatibility">the Git-compatibility doc</a> for information about how
the <code>jj</code> command interoperates with Git repos. See
<a href="#git-command-table">the Git command table</a> for a table of similar commands.</p>
<h2 id="git-comparison-overview">Overview<a class="headerlink" href="#git-comparison-overview" title="Permanent link">&para;</a></h2>
<p>Here is a list of conceptual differences between Jujutsu and Git, along with
links to more details where applicable and available. There's a
<a href="#git-command-table">table</a> explaining how to achieve various use cases.</p>
<ul>
<li><strong>The working copy is automatically committed.</strong> That results in a simpler and
  more consistent CLI because the working copy is now treated like any other
  commit. <a href="#working-copy">Details</a>.</li>
<li><strong>There's no index (staging area).</strong> Because the working copy is automatically
  committed, an index-like concept doesn't make sense. The index is very similar
  to an intermediate commit between <code>HEAD</code> and the working copy, so workflows
  that depend on it can be modeled using proper commits instead. Jujutsu has
  excellent support for moving changes between commits. <a href="#git-comparison-the-index">Details</a>.</li>
<li><strong>No need for branch names (but they are supported as
  <a href="#glossary-bookmark">bookmarks</a>).</strong> Git lets you check out a commit without
  attaching a branch to it. It calls this state "detached HEAD". This is the
  normal state in Jujutsu (there's actually no way -- yet, at least -- to have
  an active branch/bookmark). However, Jujutsu keeps track of all visible heads
  (leaves) of the commit graph, so the commits won't get lost or
  garbage-collected.</li>
<li>
<p><strong>No current branch.</strong> Git lets you check out a branch, making it the 'current
  branch', and new commits will automatically update the branch. This is
  necessary in Git because Git might otherwise lose track of the new commits.</p>
<p>Jujutsu does not have a corresponding concept of a 'current bookmark';
instead, you update bookmarks manually. For example, if you start work on top
of a commit with a bookmark, new commits are created on top of the bookmark,
then you issue a later command to update the bookmark.</p>
</li>
<li>
<p><strong>Conflicts can be committed.</strong> No commands fail because of merge conflicts.
  The conflicts are instead recorded in commits and you can resolve them later.
  <a href="#conflicts">Details</a>.</p>
</li>
<li><strong>Descendant commits are automatically rebased.</strong> Whenever you rewrite a
  commit (e.g. by running <code>jj rebase</code>), all its descendants commits will
  automatically be rebased on top. Branches pointing to it will also get
  updated, and so will the working copy if it points to any of the rebased
  commits.</li>
<li><strong>Bookmarks/branches are identified by their names (across remotes).</strong> For
  example, if you pull from a remote that has a <code>main</code> branch, you'll get a
  bookmark by that name in your local repo. If you then move it and push back to
  the remote, the <code>main</code> branch on the remote will be updated.
  <a href="#bookmarks">Details</a>.</li>
<li><strong>The operation log replaces reflogs.</strong> The operation log is similar to
  reflogs, but is much more powerful. It keeps track of atomic updates to all
  refs at once (Jujutsu thus improves on Git's per-ref history much in the same
  way that Subversion improved on RCS's per-file history). The operation log
  powers e.g. the undo functionality. <a href="#operation-log">Details</a></li>
<li><strong>There's a single, virtual root commit.</strong> Like Mercurial, Jujutsu has a
  virtual commit (with a hash consisting of only zeros) called the "root commit"
  (called the "null revision" in Mercurial). This commit is a common ancestor of
  all commits. That removes the awkward state Git calls the "unborn branch"
  state (which is the state a newly initialized Git repo is in), and related
  command-line flags (e.g. <code>git rebase --root</code>, <code>git checkout --orphan</code>).</li>
</ul>
<h2 id="git-comparison-the-index">The index<a class="headerlink" href="#git-comparison-the-index" title="Permanent link">&para;</a></h2>
<p>Git's <a href="https://git-scm.com/book/en/v2/Git-Tools-Reset-Demystified">"index"</a> has
multiple roles. One role is as a cache of file system information. Jujutsu has
something similar. Unfortunately, Git exposes the index to the user, which makes
the CLI unnecessarily complicated (learning what the different flavors of
<code>git reset</code> do, especially when combined with commits and/or paths, usually
takes a while). Jujutsu, like Mercurial, doesn't make that mistake.</p>
<p>As a Git power-user, you may think that you need the power of the index to
commit only part of the working copy. However, Jujutsu provides commands for
more directly achieving most use cases you're used to using Git's index for. For
example, to create a commit from part of the changes in the working copy, you
might be used to using <code>git add -p; git commit</code>. With Jujutsu, you'd instead
use <code>jj split</code> to split the working-copy commit into two commits. To add more
changes into the parent commit, which you might normally use
<code>git add -p; git commit --amend</code> for, you can instead use <code>jj squash -i</code> to
choose which changes to move into the parent commit, or <code>jj squash &lt;file&gt;</code> to
move a specific file.</p></section><section class="print-page" id="git-command-table" heading-number="9.2"><h1 id="git-command-table-git-command-table">Git command table<a class="headerlink" href="#git-command-table-git-command-table" title="Permanent link">&para;</a></h1>
<p>Note that all <code>jj</code> commands can be run on any commit (not just the working-copy
commit), but that's left out of the table to keep it simple. For example,
<code>jj squash -r &lt;revision&gt;</code> will move the diff from that revision into its
parent.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Use case</th>
<th style="text-align: left;">Git command</th>
<th style="text-align: left;">Jujutsu command</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Create a new repo</td>
<td style="text-align: left;"><code>git init</code></td>
<td style="text-align: left;"><code>jj git init [--colocate]</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Clone an existing repo</td>
<td style="text-align: left;"><code>git clone &lt;source&gt; &lt;destination&gt; [--origin &lt;remote name&gt;]</code></td>
<td style="text-align: left;"><code>jj git clone &lt;source&gt; &lt;destination&gt; [--remote &lt;remote name&gt;]</code></td>
<td style="text-align: left;">There is no support for cloning non-Git repos yet.</td>
</tr>
<tr>
<td style="text-align: left;">Update the local repo with all bookmarks/branches from a remote</td>
<td style="text-align: left;"><code>git fetch [&lt;remote&gt;]</code></td>
<td style="text-align: left;"><code>jj git fetch [--remote &lt;remote&gt;]</code></td>
<td style="text-align: left;">There is no support for fetching into non-Git repos yet.</td>
</tr>
<tr>
<td style="text-align: left;">Update a remote repo with all bookmarks/branches from the local repo</td>
<td style="text-align: left;"><code>git push --all [&lt;remote&gt;]</code></td>
<td style="text-align: left;"><code>jj git push --all [--remote &lt;remote&gt;]</code></td>
<td style="text-align: left;">There is no support for pushing from non-Git repos yet.</td>
</tr>
<tr>
<td style="text-align: left;">Update a remote repo with a single bookmark from the local repo</td>
<td style="text-align: left;"><code>git push &lt;remote&gt; &lt;bookmark name&gt;</code></td>
<td style="text-align: left;"><code>jj git push --bookmark &lt;bookmark name&gt; [--remote &lt;remote&gt;]</code></td>
<td style="text-align: left;">There is no support for pushing from non-Git repos yet.</td>
</tr>
<tr>
<td style="text-align: left;">Add a remote target to the repo</td>
<td style="text-align: left;"><code>git remote add &lt;remote&gt; &lt;url&gt;</code></td>
<td style="text-align: left;"><code>jj git remote add &lt;remote&gt; &lt;url&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Show summary of current work and repo status</td>
<td style="text-align: left;"><code>git status</code></td>
<td style="text-align: left;"><code>jj st</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Show diff of the current change</td>
<td style="text-align: left;"><code>git diff HEAD</code></td>
<td style="text-align: left;"><code>jj diff</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Show diff of another change</td>
<td style="text-align: left;"><code>git diff &lt;revision&gt;^ &lt;revision&gt;</code></td>
<td style="text-align: left;"><code>jj diff -r &lt;revision&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Show diff from another change to the current change</td>
<td style="text-align: left;"><code>git diff &lt;revision&gt;</code></td>
<td style="text-align: left;"><code>jj diff --from &lt;revision&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Show diff from change A to change B</td>
<td style="text-align: left;"><code>git diff A B</code></td>
<td style="text-align: left;"><code>jj diff --from A --to B</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Show all the changes in A..B</td>
<td style="text-align: left;"><code>git diff A...B</code></td>
<td style="text-align: left;"><code>jj diff -r A..B</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Show description and diff of a change</td>
<td style="text-align: left;"><code>git show &lt;revision&gt;</code></td>
<td style="text-align: left;"><code>jj show &lt;revision&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Add a file to the current change</td>
<td style="text-align: left;"><code>touch filename; git add filename</code></td>
<td style="text-align: left;"><code>touch filename</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Remove a file from the current change</td>
<td style="text-align: left;"><code>git rm filename</code></td>
<td style="text-align: left;"><code>rm filename</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Modify a file in the current change</td>
<td style="text-align: left;"><code>echo stuff &gt;&gt; filename</code></td>
<td style="text-align: left;"><code>echo stuff &gt;&gt; filename</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Finish work on the current change and start a new change</td>
<td style="text-align: left;"><code>git commit -a</code></td>
<td style="text-align: left;"><code>jj commit</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">See log of ancestors of the current commit</td>
<td style="text-align: left;"><code>git log --oneline --graph --decorate</code></td>
<td style="text-align: left;"><code>jj log -r ::@</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">See log of all reachable commits</td>
<td style="text-align: left;"><code>git log --oneline --graph --decorate --branches</code></td>
<td style="text-align: left;"><code>jj log -r 'all()'</code> or <code>jj log -r ::</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Show log of commits not on the main branch</td>
<td style="text-align: left;">(TODO)</td>
<td style="text-align: left;"><code>jj log</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">List versioned files in the working copy</td>
<td style="text-align: left;"><code>git ls-files --cached</code></td>
<td style="text-align: left;"><code>jj file list</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Search among files versioned in the repository</td>
<td style="text-align: left;"><code>git grep foo</code></td>
<td style="text-align: left;"><code>grep foo $(jj file list)</code> or <code>rg --no-require-git foo</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Abandon the current change and start a new change</td>
<td style="text-align: left;"><code>git reset --hard</code> (cannot be undone)</td>
<td style="text-align: left;"><code>jj abandon</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Make the current change empty</td>
<td style="text-align: left;"><code>git reset --hard</code> (same as abandoning a change since Git has no concept of a "change")</td>
<td style="text-align: left;"><code>jj restore</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Abandon the parent of the working copy, but keep its diff in the working copy</td>
<td style="text-align: left;"><code>git reset --soft HEAD~</code></td>
<td style="text-align: left;"><code>jj squash --from @-</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Discard working copy changes in some files</td>
<td style="text-align: left;"><code>git restore &lt;paths&gt;...</code> or <code>git checkout HEAD -- &lt;paths&gt;...</code></td>
<td style="text-align: left;"><code>jj restore &lt;paths&gt;...</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Edit description (commit message) of the current change</td>
<td style="text-align: left;">Not supported</td>
<td style="text-align: left;"><code>jj describe</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Edit description (commit message) of the previous change</td>
<td style="text-align: left;"><code>git commit --amend --only</code></td>
<td style="text-align: left;"><code>jj describe @-</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Temporarily put away the current change</td>
<td style="text-align: left;"><code>git stash</code></td>
<td style="text-align: left;"><code>jj new @-</code></td>
<td style="text-align: left;">The old working-copy commit remains as a sibling commit. The old working-copy commit X can be restored with <code>jj edit X</code>.</td>
</tr>
<tr>
<td style="text-align: left;">Start working on a new change based on the <main> bookmark/branch</td>
<td style="text-align: left;"><code>git switch -c topic main</code> or <code>git checkout -b topic main</code> (may need to stash or commit first)</td>
<td style="text-align: left;"><code>jj new main</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Merge branch A into the current change</td>
<td style="text-align: left;"><code>git merge A</code></td>
<td style="text-align: left;"><code>jj new @ A</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Move bookmark/branch A onto bookmark/branch B</td>
<td style="text-align: left;"><code>git rebase B A</code> (may need to rebase other descendant branches separately)</td>
<td style="text-align: left;"><code>jj rebase -b A -d B</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Move change A and its descendants onto change B</td>
<td style="text-align: left;"><code>git rebase --onto B A^ &lt;some descendant bookmark&gt;</code> (may need to rebase other descendant bookmarks separately)</td>
<td style="text-align: left;"><code>jj rebase -s A -d B</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Reorder changes from A-B-C-D to A-C-B-D</td>
<td style="text-align: left;"><code>git rebase -i A</code></td>
<td style="text-align: left;"><code>jj rebase -r C --before B</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Move the diff in the current change into the parent change</td>
<td style="text-align: left;"><code>git commit --amend -a</code></td>
<td style="text-align: left;"><code>jj squash</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Interactively move part of the diff in the current change into the parent change</td>
<td style="text-align: left;"><code>git add -p; git commit --amend</code></td>
<td style="text-align: left;"><code>jj squash -i</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Move the diff in the working copy into an ancestor</td>
<td style="text-align: left;"><code>git commit --fixup=X; git rebase -i --autosquash X^</code></td>
<td style="text-align: left;"><code>jj squash --into X</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Interactively move part of the diff in an arbitrary change to another arbitrary change</td>
<td style="text-align: left;">Not supported</td>
<td style="text-align: left;"><code>jj squash -i --from X --into Y</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Interactively split the changes in the working copy in two</td>
<td style="text-align: left;"><code>git commit -p</code></td>
<td style="text-align: left;"><code>jj split</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Interactively split an arbitrary change in two</td>
<td style="text-align: left;">Not supported (can be emulated with the "edit" action in <code>git rebase -i</code>)</td>
<td style="text-align: left;"><code>jj split -r &lt;revision&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Interactively edit the diff in a given change</td>
<td style="text-align: left;">Not supported (can be emulated with the "edit" action in <code>git rebase -i</code>)</td>
<td style="text-align: left;"><code>jj diffedit -r &lt;revision&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Resolve conflicts and continue interrupted operation</td>
<td style="text-align: left;"><code>echo resolved &gt; filename; git add filename; git rebase/merge/cherry-pick --continue</code></td>
<td style="text-align: left;"><code>echo resolved &gt; filename; jj squash</code></td>
<td style="text-align: left;">Operations don't get interrupted, so no need to continue.</td>
</tr>
<tr>
<td style="text-align: left;">Create a copy of a commit on top of another commit</td>
<td style="text-align: left;"><code>git co &lt;destination&gt;; git cherry-pick &lt;source&gt;</code></td>
<td style="text-align: left;"><code>jj duplicate &lt;source&gt; -d &lt;destination&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Find the root of the working copy (or check if in a repo)</td>
<td style="text-align: left;"><code>git rev-parse --show-toplevel</code></td>
<td style="text-align: left;"><code>jj workspace root</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">List bookmarks/branches</td>
<td style="text-align: left;"><code>git branch</code></td>
<td style="text-align: left;"><code>jj bookmark list</code> or <code>jj b l</code> for short</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Create a bookmark/branch</td>
<td style="text-align: left;"><code>git branch &lt;name&gt; &lt;revision&gt;</code></td>
<td style="text-align: left;"><code>jj bookmark create &lt;name&gt; -r &lt;revision&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Move a bookmark/branch forward</td>
<td style="text-align: left;"><code>git branch -f &lt;name&gt; &lt;revision&gt;</code></td>
<td style="text-align: left;"><code>jj bookmark move &lt;name&gt; --to &lt;revision&gt;</code> or <code>jj b m &lt;name&gt; --to &lt;revision&gt;</code> for short</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Move a bookmark/branch backward or sideways</td>
<td style="text-align: left;"><code>git branch -f &lt;name&gt; &lt;revision&gt;</code></td>
<td style="text-align: left;"><code>jj bookmark move &lt;name&gt; --to &lt;revision&gt; --allow-backwards</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Delete a bookmark/branch</td>
<td style="text-align: left;"><code>git branch --delete &lt;name&gt;</code></td>
<td style="text-align: left;"><code>jj bookmark delete &lt;name&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">See log of operations performed on the repo</td>
<td style="text-align: left;">Not supported</td>
<td style="text-align: left;"><code>jj op log</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Undo an earlier operation</td>
<td style="text-align: left;">Not supported</td>
<td style="text-align: left;"><code>jj [op] undo &lt;operation ID&gt;</code></td>
<td style="text-align: left;"><code>jj undo</code> is an alias for <code>jj op undo</code>.</td>
</tr>
<tr>
<td style="text-align: left;">Create a commit that cancels out a previous commit</td>
<td style="text-align: left;"><code>git revert &lt;revision&gt;</code></td>
<td style="text-align: left;"><code>jj revert -r &lt;revision&gt; -B @</code></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">Show what revision and author last modified each line of a file</td>
<td style="text-align: left;"><code>git blame &lt;file&gt;</code></td>
<td style="text-align: left;"><code>jj file annotate &lt;path&gt;</code></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table></section><section class="print-page" id="git-compatibility" heading-number="9.3"><h1 id="git-compatibility-git-compatibility">Git compatibility<a class="headerlink" href="#git-compatibility-git-compatibility" title="Permanent link">&para;</a></h1>
<p>Jujutsu has two backends for storing commits. One of them uses a regular Git
repo, which means that you can collaborate with Git users without them even
knowing that you're not using the <code>git</code> CLI.</p>
<p>See <code>jj help git</code> for help about the <code>jj git</code> family of commands, and e.g.
<code>jj help git push</code> for help about a specific command (use <code>jj git push -h</code> for
briefer help).</p>
<h2 id="git-compatibility-supported-features">Supported features<a class="headerlink" href="#git-compatibility-supported-features" title="Permanent link">&para;</a></h2>
<p>The following list describes which Git features Jujutsu is compatible with. For
a comparison with Git, including how workflows are different, see the
<a href="#git-comparison">Git-comparison doc</a>.</p>
<ul>
<li><strong>Configuration: Partial.</strong> The only configuration from Git (e.g. in
  <code>~/.gitconfig</code>) that's respected is the following. Feel free to file a bug if
  you miss any particular configuration options.</li>
<li>The configuration of remotes (<code>[remote "&lt;name&gt;"]</code>). Only the names and URLs
    are respected (refspecs are not respected, and
    <a href="https://github.com/jj-vcs/jj/issues/4889">only the last pushurl</a> is
    respected).</li>
<li><code>core.excludesFile</code></li>
<li><strong>Authentication: Yes.</strong> <code>git</code> is used for remote operations under the hood.</li>
<li><strong>Branches: Yes.</strong> You can read more about
  <a href="#bookmarks">how branches work in Jujutsu</a>
  and <a href="#git-compatibility-branches">how they interoperate with Git</a>.</li>
<li><strong>Tags: Partial.</strong> You can check out tagged commits by name (pointed to be
  either annotated or lightweight tags), but you cannot create new tags.</li>
<li><strong>.gitignore: Yes.</strong> Patterns in <code>.gitignore</code> files are supported. So are
  ignores in <code>.git/info/exclude</code> or configured via Git's <code>core.excludesfile</code>
  config. Since working-copy files are snapshotted by every <code>jj</code> command, you
  might need to run <code>jj file untrack</code> to exclude newly ignored files from the
  working-copy commit. It's recommended to set up the ignore patterns earlier.
  The <code>.gitignore</code> support uses a native implementation, so please report a bug
  if you notice any difference compared to <code>git</code>.</li>
<li><strong>.gitattributes: No.</strong> There's <a href="https://github.com/jj-vcs/jj/issues/53">#53</a>
  about adding support for at least the <code>eol</code> attribute.</li>
<li><strong>Hooks: No.</strong> There's <a href="https://github.com/jj-vcs/jj/issues/405">#405</a>
  specifically for providing the checks from https://pre-commit.com.</li>
<li><strong>Merge commits: Yes.</strong> Octopus merges (i.e. with more than 2 parents) are
  also supported.</li>
<li><strong>Detached HEAD: Yes.</strong> Jujutsu supports anonymous branches, so this is a
  natural state.</li>
<li><strong>Orphan branch: Yes.</strong> Jujutsu has a virtual root commit that appears as
  parent of all commits Git would call "root commits".</li>
<li><strong>Staging area: Kind of.</strong> The staging area will be ignored. For example,
  <code>jj diff</code> will show a diff from the Git HEAD to the working copy. There are
  <a href="https://github.com/jj-vcs/jj/blob/main/docs/git-comparison.md#the-index">ways of fulfilling your use cases without a staging
  area</a>.</li>
<li><strong>Garbage collection: Yes.</strong> It should be safe to run <code>git gc</code> in the Git
  repo, but it's not tested, so it's probably a good idea to make a backup of
  the whole workspace first. There's <a href="https://github.com/jj-vcs/jj/issues/12">no garbage collection and repacking of
  Jujutsu's own data structures yet</a>,
  however.</li>
<li><strong>Bare repositories: Yes.</strong> You can use <code>jj git init --git-repo=&lt;path&gt;</code> to
  create a repo backed by a bare Git repo.</li>
<li><strong>Submodules: No.</strong> They will not show up in the working copy, but they will
  not be lost either.</li>
<li><strong>Partial clones: No.</strong> We use the <a href="https://libgit2.org/">libgit2</a> library,
  which <a href="https://github.com/libgit2/libgit2/issues/5564">doesn't have support for partial clones</a>.</li>
<li><strong>Shallow clones: Kind of.</strong> Shallow commits all have the virtual root commit as
  their parent. However, deepening or fully unshallowing a repository is currently not yet
  supported and will cause issues.</li>
<li><strong>git-worktree: No.</strong> However, there's native support for multiple working
  copies backed by a single repo. See the <code>jj workspace</code> family of commands.</li>
<li><strong>Sparse checkouts: No.</strong> However, there's native support for sparse
  checkouts. See the <code>jj sparse</code> command.</li>
<li><strong>Signed commits: Yes.</strong>
  You can sign commits automatically <a href="https://github.com/jj-vcs/jj/blob/main/docs/config.md#commit-signing">by configuration</a>,
  or use the <code>jj sign</code> command.</li>
<li><strong>Git LFS: No.</strong> (<a href="https://github.com/jj-vcs/jj/issues/80">#80</a>)</li>
</ul>
<h2 id="git-compatibility-creating-an-empty-repo">Creating an empty repo<a class="headerlink" href="#git-compatibility-creating-an-empty-repo" title="Permanent link">&para;</a></h2>
<p>To create an empty repo using the Git backend, use <code>jj init --git &lt;name&gt;</code>. Since
the command creates a Jujutsu repo, it will have a <code>.jj/</code> directory. The
underlying Git repo will be inside of that directory (currently in
<code>.jj/repo/store/git/</code>).</p>
<h2 id="git-compatibility-creating-a-repo-backed-by-an-existing-git-repo">Creating a repo backed by an existing Git repo<a class="headerlink" href="#git-compatibility-creating-a-repo-backed-by-an-existing-git-repo" title="Permanent link">&para;</a></h2>
<p>To create a Jujutsu repo backed by a Git repo you already have on disk, use
<code>jj git init --git-repo=&lt;path to Git repo&gt; &lt;name&gt;</code>. The repo will work similar
to a <a href="https://git-scm.com/docs/git-worktree">Git worktree</a>, meaning that the
working copies files and the record of the working-copy commit will be separate,
but the commits will be accessible in both repos. Use <code>jj git import</code> to update
the Jujutsu repo with changes made in the Git repo. Use <code>jj git export</code> to
update the Git repo with changes made in the Jujutsu repo.</p>
<h2 id="git-compatibility-creating-a-repo-by-cloning-a-git-repo">Creating a repo by cloning a Git repo<a class="headerlink" href="#git-compatibility-creating-a-repo-by-cloning-a-git-repo" title="Permanent link">&para;</a></h2>
<p>To create a Jujutsu repo from a remote Git URL, use <code>jj git clone &lt;URL&gt;
[&lt;destination&gt;]</code>. For example, <code>jj git clone
https://github.com/octocat/Hello-World</code> will clone GitHub's "Hello-World" repo
into a directory by the same name.</p>
<p>By default, the remote repository will be named <code>origin</code>. You can use
a name of your choice by adding <code>--remote &lt;remote name&gt;</code> to the <code>jj
git clone</code> command.</p>
<h2 id="git-compatibility-co-located-jujutsugit-repos">Co-located Jujutsu/Git repos<a class="headerlink" href="#git-compatibility-co-located-jujutsugit-repos" title="Permanent link">&para;</a></h2>
<p>A "co-located" Jujutsu repo is a hybrid Jujutsu/Git repo. These can be created
if you initialize the Jujutsu repo in an existing Git repo by running <code>jj git
init --colocate</code> or with <code>jj git clone --colocate</code>. The Git repo and the Jujutsu
repo then share the same working copy. Jujutsu will import and export from and
to the Git repo on every <code>jj</code> command automatically.</p>
<p>This mode is very convenient when tools (e.g. build tools) expect a Git repo to
be present.</p>
<p>It is allowed to mix <code>jj</code> and <code>git</code> commands in such a repo in any order.
However, it may be easier to keep track of what is going on if you mostly use
read-only <code>git</code> commands and use <code>jj</code> to make changes to the repo. One reason
for this (see below for more) is that <code>jj</code> commands will usually put the git
repo in a "detached HEAD" state, since in <code>jj</code> there is not concept of a
"currently tracked branch". Before doing mutating Git commands, you may need to
tell Git what the current branch should be with a <code>git switch</code> command.</p>
<p>You can undo the results of mutating <code>git</code> commands using <code>jj undo</code> and <code>jj op
restore</code>. Inside <code>jj op log</code>, changes by <code>git</code> will be represented as an "import
git refs" operation.</p>
<p>There are a few downsides to this mode of operation. Generally, using co-located
repos may require you to deal with more involved Jujutsu and Git concepts.</p>
<ul>
<li>
<p>Interleaving <code>jj</code> and <code>git</code> commands increases the chance of confusing branch
  conflicts or <a href="#glossary-divergent-change">conflicted (AKA divergent) change
  ids</a>. These never lose data, but can be
  annoying.</p>
<p>Such interleaving can happen unknowingly. For example, some IDEs can cause
it because they automatically run <code>git fetch</code> in the background from time to
time.</p>
</li>
<li>
<p>In co-located repos with a very large number of branches or other refs, <code>jj</code>
  commands can get noticeably slower because of the automatic <code>jj git import</code>
  executed on each command. This can be mitigated by occasionally running <code>jj util
  gc</code> to speed up the import (that command includes packing the Git refs).</p>
</li>
<li>
<p>Git tools will have trouble with revisions that contain conflicted files. While
  <code>jj</code> renders these files with conflict markers in the working copy, they are
  stored in a non-human-readable fashion inside the repo. Git tools will often
  see this non-human-readable representation.</p>
</li>
<li>
<p>When a <code>jj</code> branch is conflicted, the position of the branch in the Git repo
  will disagree with one or more of the conflicted positions. The state of that
  branch in git will be labeled as though it belongs to a remote named "git",
  e.g. <code>branch@git</code>.</p>
</li>
<li>
<p>Jujutsu will ignore Git's staging area. It will not understand merge conflicts
  as Git represents them, unfinished <code>git rebase</code> states, as well as other less
  common states a Git repository can be in.</p>
</li>
<li>
<p>Colocated repositories are less resilient to
  <a href="#technical-concurrency-syncing-with-rsync-nfs-dropbox-etc">concurrency</a>
  issues if you share the repo using an NFS filesystem or Dropbox. In general,
  such use of Jujutsu is not currently thoroughly tested.</p>
</li>
<li>
<p>There may still be bugs when interleaving mutating <code>jj</code> and <code>git</code> commands,
  usually having to do with a branch pointer ending up in the wrong place. We
  are working on the known ones, and are not aware of any major ones. Please
  report any new ones you find, or if any of the known bugs are less minor than
  they appear.</p>
</li>
</ul>
<h3 id="git-compatibility-converting-a-repo-into-a-co-located-repo">Converting a repo into a co-located repo<a class="headerlink" href="#git-compatibility-converting-a-repo-into-a-co-located-repo" title="Permanent link">&para;</a></h3>
<p>A Jujutsu repo backed by a Git repo has a full Git repo inside, so it is
technically possible (though not officially supported) to convert it into a
co-located repo like so:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Ignore the .jj directory in Git</span>
<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;/*&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>.jj/.gitignore
<span class="c1"># Move the Git repo</span>
mv<span class="w"> </span>.jj/repo/store/git<span class="w"> </span>.git
<span class="c1"># Tell jj where to find it</span>
<span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;../../../.git&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>.jj/repo/store/git_target
<span class="c1"># Make the Git repository non-bare and set HEAD</span>
git<span class="w"> </span>config<span class="w"> </span>--unset<span class="w"> </span>core.bare
<span class="c1"># Convince jj to update .git/HEAD to point to the working-copy commit&#39;s parent</span>
jj<span class="w"> </span>new<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>jj<span class="w"> </span>undo
</code></pre></div>
<p>We may officially support this in the future. If you try this, we would
appreciate feedback and bug reports.</p>
<h2 id="git-compatibility-branches">Branches<a class="headerlink" href="#git-compatibility-branches" title="Permanent link">&para;</a></h2>
<p>TODO: Describe how branches are mapped</p>
<h2 id="git-compatibility-format-mapping-details">Format mapping details<a class="headerlink" href="#git-compatibility-format-mapping-details" title="Permanent link">&para;</a></h2>
<p>Paths are assumed to be UTF-8. I have no current plans to support paths with
other encodings.</p>
<p>Commits created by <code>jj</code> have a ref starting with <code>refs/jj/</code> to prevent GC.</p>
<p>Commit metadata that cannot be represented in Git commits (such as the Change
ID and information about conflicts) is stored outside of the Git repo (currently
in <code>.jj/store/extra/</code>).</p>
<p>Commits with conflicts cannot be represented in Git. They appear in the Git
commit as as root directories called<code>.jjconflict-base-*/</code> and
<code>.jjconflict-side-*/</code>. Note that the purpose of this representation is only to
prevent GC of the relevant trees; the authoritative information is in the
Git-external storage mentioned in the paragraph above. As long as you use <code>jj</code>
commands to work with them, you won't notice those paths. If, on the other hand,
you use e.g. <code>git switch</code> to check one of them out, you will see those
directories in your working copy. If you then run e.g. <code>jj status</code>, the
resulting snapshot will contain those directories, making it look like they
replaced all the other paths in your repo. You will probably want to run
<code>jj abandon</code> to get back to the state with the unresolved conflicts.</p>
<p>Change IDs are stored in git commit headers as reverse hex encodings. These is
a non-standard header and is not preserved by all <code>git</code> tooling. For example,
the header is preserved by a <code>git commit --amend</code>, but is not preserved through
a rebase operation. GitHub and other major forges seem to preserve them for the
most part. This functionality is currently behind a <code>git.write-change-id-header</code>
flag.</p></section><section class="print-page" id="sapling-comparison" heading-number="9.4"><h1 id="sapling-comparison-comparison-with-sapling">Comparison with Sapling<a class="headerlink" href="#sapling-comparison-comparison-with-sapling" title="Permanent link">&para;</a></h1>
<h2 id="sapling-comparison-introduction">Introduction<a class="headerlink" href="#sapling-comparison-introduction" title="Permanent link">&para;</a></h2>
<p>This document attempts to describe how jj is different
from <a href="https://sapling-scm.com">Sapling</a>. Sapling is a VCS developed by Meta. It
was announced about 3 years after development started on jj. It is a heavily
modified fork of <a href="https://www.mercurial-scm.org/">Mercurial</a>. Because jj has
copied many ideas from Mercurial, there are many similarities between the two
tools, such as:</p>
<ul>
<li>A user-friendly CLI</li>
<li>A "<a href="#revsets">revset</a>" language for selecting revisions</li>
<li>Good support for working with stacked commits, including tracking "anonymous
  heads" (no "detached HEAD" state like in Git) and <code>split</code> commands, and
  automatically rebasing descendant commits when you amend a commit.</li>
<li>Flexible customization of output using <a href="#templates">templates</a></li>
</ul>
<h2 id="sapling-comparison-differences">Differences<a class="headerlink" href="#sapling-comparison-differences" title="Permanent link">&para;</a></h2>
<p>Here is a list of some differences between jj and Sapling.</p>
<ul>
<li>
<p><strong>Working copy:</strong> When using Sapling (like most VCSs), the
  user explicitly tells the tool when to create a commit and which files to
  include. When using jj, the working copy
  is <a href="#working-copy">automatically snapshotted by every command</a>. New files
  are automatically tracked and deleted files are automatically untracked. This
  has several advantages:</p>
<ul>
<li>The working copy is effectively backed up every time you run a command.</li>
<li>No commands fail because you have changes in the working copy ("abort: 1
  conflicting file changes: ..."). No need for <code>sl shelve</code>.</li>
<li>Simpler and more consistent CLI because the working copy is treated like any
  other commit.</li>
</ul>
</li>
<li>
<p><strong>Conflicts:</strong> Like most VCSs, Sapling requires the user to
  resolve conflicts before committing. jj lets
  you <a href="#conflicts">commit conflicts</a>. Note that it's a representation of the
  conflict that's committed, not conflict markers (<code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> etc.). This also
  has several advantages:</p>
<ul>
<li>Merge conflicts won't prevent you from checking out another commit.</li>
<li>You can resolve the conflicts when you feel like it.</li>
<li>Rebasing descendants always succeeds. Like jj, Sapling automatically
  rebases, but it will fail if there are conflicts.</li>
<li>Merge commits can be rebased correctly (Sapling sometimes fails).</li>
<li>You can rebase conflicts and conflict resolutions.</li>
</ul>
</li>
<li>
<p><strong>Undo:</strong> jj's undo is powered by <a href="#operation-log">the operation log</a>, which
  records how the repo has changed over time. Sapling has a similar feature
  with its <a href="https://sapling-scm.com/docs/internals/metalog">MetaLog</a>.
  They seem to provide similar functionality, but jj also exposes the log to the
  user via <code>jj op log</code>, so you can tell how far back you want to go back.
  Sapling has <code>sl debugmetalog</code>, but that seems to show the history of a single
  commit, not the whole repo's history. Thanks to jj snapshotting the working
  copy, it's possible to undo changes to the working copy. For example, if
  you <code>jj undo</code> a <code>jj commit</code>, <code>jj diff</code> will show the same changes as
  before <code>jj commit</code>, but if you <code>sl undo</code> a <code>sl commit</code>, the working copy will
  be clean.</p>
</li>
<li><strong>Git interop:</strong> Sapling supports cloning, pushing, and pulling from a remote
  Git repo. jj also does, and it also supports sharing a working copy with a Git
  repo, so you can use <code>jj</code> and <code>git</code> interchangeably in the same repo.</li>
<li><strong>Polish:</strong> Sapling is more polished and feature-complete. For example, jj
  has no <code>bisect</code> command. Sapling also has very nice built-in web UI called
  <a href="https://sapling-scm.com/docs/addons/isl">Interactive Smartlog</a>, which lets
  you drag and drop commits to rebase them, among other things.</li>
<li><strong>Forge workflow:</strong> Sapling has <code>sl pr submit --stack</code>, which lets you
  push a stack of commits as separate GitHub PRs, including setting the base
  branch. It only supports GitHub. jj doesn't have any direct integration with
  GitHub or any other forge. However, it has <code>jj git push --change</code> for
  automatically creating branches for specified commits. You have to specify
  each commit you want to create a branch for by using
  <code>jj git push --change X --change Y ...</code>, and you have to manually set up any
  base branches in GitHub's UI (or GitLab's or ...). On subsequent pushes, you
  can update all at once by specifying something like <code>jj git push -r main..@</code>
  (to push all branches on the current stack of commits from where it forked
  from <code>main</code>).</li>
</ul></section><section class="print-page" id="related-work" heading-number="9.5"><h1 id="related-work-related-work">Related work<a class="headerlink" href="#related-work-related-work" title="Permanent link">&para;</a></h1>
<p>Similar tools:</p>
<ul>
<li><a href="https://github.com/arxanas/git-branchless">git-branchless</a>: Helps you use a
  branchless workflow in your Git repo. Supports anonymous branching, undo,
  and faster rebase (<code>git move</code>). Under heavy development and quickly gaining
  new features.</li>
<li><a href="https://sapling-scm.com/">Sapling</a>: A heavily modified fork of
  <a href="https://www.mercurial-scm.org/">Mercurial</a> developed and used at Meta. It
  is compatible with Git, has undo functionality, and
  <a href="https://sapling-scm.com/docs/addons/isl">a graphical interface</a>.
  See <a href="#sapling-comparison">how it is different from Jujutsu</a>.</li>
<li><a href="https://gitup.co/">GitUp</a>: A Mac-only GUI for Git. Like Jujutsu, supports
  undo and restoring the repo to an earlier snapshot. Backed by its
  <a href="https://github.com/git-up/GitUp#gitupkit">GitUpKit library</a>.</li>
<li><a href="https://gitless.com/">Gitless</a>: Another attempt at providing a simpler
  interface for Git. Like Jujutsu, does not have an "index"/"staging area"
  concept. Also doesn't move the working-copy changes between branches (which
  we do simply as a consequence of making the working copy a commit).</li>
<li><a href="https://www.breezy-vcs.org/">Breezy</a>: Another VCS that's similar in that it
  has multiple storage backends, including its own format as well as .git
  support.</li>
<li><a href="https://getsturdy.com/">Sturdy</a>: A Git backed GUI that eliminates local and
  remote as well as the idea of an "index"/"staging area".</li>
</ul></section></section>
                    <section class='print-page md-section' id='section-10' heading-number='10'>
                        <h1>Technical details<a class='headerlink' href='#section-10' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="core_tenets" heading-number="10.1"><h1 id="core_tenets-core_tenets">Core tenets</h1><h2 id="jujutsus-core-tenets">Jujutsu's Core Tenets<a class="headerlink" href="#core_tenets-jujutsus-core-tenets" title="Permanent link">&para;</a></h2>
<p>Jujutsu's core tenets are:</p>
<ul>
<li>Separation of logic and UI: It should be as easy to create new UIs (CLIs,
   GUIs, TUIs, servers) without having to duplicate logic.</li>
<li>Easy-to-use APIs: It should be easy to create new commands. For example,
   each command should not have to worry about concurrency, working-copy state,
   and rebasing descendants of rewritten commits.</li>
<li>User-friendliness: Making the working copy a commit is simpler. This is
   how the project started.</li>
<li>The repository is the source of truth: Most commands should operate on the
   commit graph. The working copy is just one way of editing commits.</li>
<li>Pluggable storage: Must be easy to integrate with different commit storage,
   virtual file systems and more.</li>
<li>Git-interop: Git is everywhere. We need to have good interop to be adopted.</li>
<li>All operations must be able to scale to Google-scale repos (lots of commits,
   lots of files): Laziness is important, must avoid accessing data
   unnecessarily.</li>
<li>Having as few states as possible.</li>
<li>Make it incredibly hard to lose work in your repository.</li>
<li>Concurrent modifications to the repo should be safe.</li>
<li>Allow concurrent edits on any commit, pending or finished.</li>
<li>Make a "stacked diffs" workflow as easy as possible.</li>
</ul></section><section class="print-page" id="technical-architecture" heading-number="10.2"><h1 id="technical-architecture-architecture">Architecture<a class="headerlink" href="#technical-architecture-architecture" title="Permanent link">&para;</a></h1>
<h2 id="technical-architecture-data-model">Data model<a class="headerlink" href="#technical-architecture-data-model" title="Permanent link">&para;</a></h2>
<p>The commit data model is similar
to <a href="https://git-scm.com/book/en/v2/Git-Internals-Git-Objects">Git's object model</a>
, but with some differences.</p>
<h2 id="technical-architecture-separation-of-library-from-ui">Separation of library from UI<a class="headerlink" href="#technical-architecture-separation-of-library-from-ui" title="Permanent link">&para;</a></h2>
<p>The <code>jj</code> binary consists of two Rust crates: the library crate (<code>jj-lib</code>) and
the CLI crate (<code>jj-cli</code>). The library crate is currently only used by the CLI
crate, but it is meant to also be usable from a GUI or TUI, or in a server
serving requests from multiple users. As a result, the library should avoid
interacting directly with the user via the terminal or by other means; all
input/output is handled by the CLI crate <sup id="technical-architecture-fnref:1"><a class="footnote-ref" href="#technical-architecture-fn:1">1</a></sup>. Since the library crate is meant
to usable in a server, it also cannot read configuration from the user's home
directory, or from user-specific environment variables.</p>
<p>A lot of thought has gone into making the library crate's API easy to use, but
not much has gone into "details" such as which collection types are used, or
which symbols are exposed in the API.</p>
<h2 id="technical-architecture-storage-independent-apis">Storage-independent APIs<a class="headerlink" href="#technical-architecture-storage-independent-apis" title="Permanent link">&para;</a></h2>
<p>One overarching principle in the design is that it should be easy to change
where data is stored. The goal was to be able to put storage on local-disk by
default but also be able to move storage to the cloud at Google
(and for anyone). To that end, commits (and trees, files, etc.) are stored by
the commit backend, operations (and views) are stored by the operation backend,
the heads of the operation log are stored by the "op heads" backend, the commit
index is stored by the index backend, and the working copy is stored by the
working copy backend. The interfaces are defined in terms of plain Rust data
types, not tied to a specific format. The working copy doesn't have its own
trait defined yet, but its interface is small and easy to create traits for when
needed.</p>
<p>The commit backend to use when loading a repo is specified in
the <code>.jj/repo/store/type</code> file. There are similar files for the other backends
(<code>.jj/repo/index/type</code>, <code>.jj/repo/op_store/type</code>, <code>.jj/repo/op_heads/type</code>).</p>
<h2 id="technical-architecture-design-of-the-library-crate">Design of the library crate<a class="headerlink" href="#technical-architecture-design-of-the-library-crate" title="Permanent link">&para;</a></h2>
<h3 id="technical-architecture-overview">Overview<a class="headerlink" href="#technical-architecture-overview" title="Permanent link">&para;</a></h3>
<p>Here's a diagram showing some important types in the library crate, and how they
relate. For example, given a <code>Workspace</code>, you can use it to get a <code>WorkingCopy</code>
or a <code>RepoLoader</code>. A <code>Transaction</code> is required to acquire a <code>MutableRepo</code>, etc.
The following sections describe each component.</p>
<p><img alt="Type diagram" src="technical/types.svg" /></p>
<p><em>This diagram was created with <a href="https://excalidraw.com/">Excalidraw</a>. You can get a copy of it <a href="https://excalidraw.com/#json=X081PJVRW2h4iW12qZxc1,H2Yg3qnycVG0Vpq5Z90Miw">at this
location</a>, and Right Click &gt; "Copy to Clipboard as SVG".</em></p>
<h3 id="technical-architecture-backend">Backend<a class="headerlink" href="#technical-architecture-backend" title="Permanent link">&para;</a></h3>
<p>The <code>Backend</code> trait defines the interface each
commit backend needs to implement. The current in-tree commit backends
are <code>GitBackend</code>
and <code>SimpleBackend</code>.</p>
<p>Since there are non-commit backends, the <code>Backend</code> trait should probably be
renamed to <code>CommitBackend</code>.</p>
<h3 id="technical-architecture-gitbackend">GitBackend<a class="headerlink" href="#technical-architecture-gitbackend" title="Permanent link">&para;</a></h3>
<p>The <code>GitBackend</code> stores commits in a Git repository. It uses <code>libgit2</code> to read
and write commits and refs.</p>
<p>To prevent GC from deleting commits that are still reachable from the operation
log, the <code>GitBackend</code> stores a ref for each commit in the operation log in
the <code>refs/jj/keep/</code> namespace.</p>
<p>Commit data that is available in Jujutsu's model but not in Git's model is
stored in a <code>StackedTable</code> in <code>.jj/repo/store/extra/</code>. That is currently the
change ID and the list of predecessors. For commits that don't have any data in
that table, which is any commit created by <code>git</code>, we use an empty list as
predecessors, and the bit-reversed commit ID as change ID.</p>
<p>Because we use the Git Object ID as commit ID, two commits that differ only in
their change ID, for example, will get the same commit ID, so we error out when
trying to write the second one of them.</p>
<h3 id="technical-architecture-simplebackend">SimpleBackend<a class="headerlink" href="#technical-architecture-simplebackend" title="Permanent link">&para;</a></h3>
<p>The <code>SimpleBackend</code> is just a proof of concept. It stores objects addressed by
their hash, with one file per object.</p>
<h3 id="technical-architecture-store">Store<a class="headerlink" href="#technical-architecture-store" title="Permanent link">&para;</a></h3>
<p>The <code>Store</code> type wraps the <code>Backend</code> and returns wrapped types for commits and
trees to make them easier to use. The wrapped objects have a reference to
the <code>Store</code> itself, so you can do e.g. <code>commit.parents()</code> without having to
provide the <code>Store</code> as an argument.</p>
<p>The <code>Store</code> type also provides caching of commits and trees.</p>
<h3 id="technical-architecture-readonlyrepo">ReadonlyRepo<a class="headerlink" href="#technical-architecture-readonlyrepo" title="Permanent link">&para;</a></h3>
<p>A <code>ReadonlyRepo</code> represents the state of a repo at a specific operation. It
keeps the view object associated with that operation.</p>
<p>The repository doesn't know where on disk any working copies live. It knows, via
the view object, which commit is supposed to be the current working-copy commit
in each workspace.</p>
<h3 id="technical-architecture-mutablerepo">MutableRepo<a class="headerlink" href="#technical-architecture-mutablerepo" title="Permanent link">&para;</a></h3>
<p>A <code>MutableRepo</code> is a mutable version of <code>ReadonlyRepo</code>. It has a reference to
its base <code>ReadonlyRepo</code>, but it has its own copy of the view object and lets the
caller modify it.</p>
<h3 id="technical-architecture-transaction">Transaction<a class="headerlink" href="#technical-architecture-transaction" title="Permanent link">&para;</a></h3>
<p>The <code>Transaction</code> object has a <code>MutableRepo</code> and metadata that will go into the
operation log. When the transaction commits, the <code>MutableRepo</code> becomes a view
object in the operation log on disk, and the <code>Transaction</code> object becomes an
operation object. In memory, <code>Transaction::commit()</code> returns a
new <code>ReadonlyRepo</code>.</p>
<h3 id="technical-architecture-repoloader">RepoLoader<a class="headerlink" href="#technical-architecture-repoloader" title="Permanent link">&para;</a></h3>
<p>The <code>RepoLoader</code> represents a repository at an unspecified operation. You can
think of as a pointer to the <code>.jj/repo/</code> directory. It can create
a <code>ReadonlyRepo</code> given an operation ID.</p>
<h3 id="technical-architecture-treestate">TreeState<a class="headerlink" href="#technical-architecture-treestate" title="Permanent link">&para;</a></h3>
<p>The <code>TreeState</code> type represents the state of the files in a working copy. It
keep track of the mtime and size for each tracked file. It knows the <code>TreeId</code>
that the working copy represents. It has a <code>snapshot()</code> method that will use the
recorded mtimes and sizes and detect changes in the working copy. If anything
changed, it will return a new <code>TreeId</code>. It also has <code>checkout()</code> for updating
the files on disk to match a requested <code>TreeId</code>.</p>
<p>The <code>TreeState</code> type supports sparse checkouts. In fact, all working copies are
sparse; they simply track the full repo in most cases.</p>
<h3 id="technical-architecture-workingcopy">WorkingCopy<a class="headerlink" href="#technical-architecture-workingcopy" title="Permanent link">&para;</a></h3>
<p>The <code>WorkingCopy</code> type has a <code>TreeState</code> but also knows which <code>WorkspaceName</code> it
has and at which operation it was most recently updated.</p>
<h3 id="technical-architecture-workspace">Workspace<a class="headerlink" href="#technical-architecture-workspace" title="Permanent link">&para;</a></h3>
<p>The <code>Workspace</code> type represents the combination of a repo and a working copy (
like Git's 'worktree' concept).</p>
<p>The repo view at the current operation determines the desired working-copy
commit in each workspace. The <code>WorkingCopy</code> determines what is actually in the
working copy. The working copy can become stale if the working-copy commit was
changed from another workspace (or if the process updating the working copy
crashed, for example).</p>
<h3 id="technical-architecture-git">Git<a class="headerlink" href="#technical-architecture-git" title="Permanent link">&para;</a></h3>
<p>The <code>git</code> module contains functionality for interoperating with a Git repo, at a
higher level than the <code>GitBackend</code>. The <code>GitBackend</code> is restricted by
the <code>Backend</code> trait; the <code>git</code> module is specifically for Git-backed repos. It
has functionality for importing refs from the Git repo and for exporting to refs
in the Git repo. It also has functionality for pushing and pulling to/from Git
remotes.</p>
<h3 id="technical-architecture-revsets">Revsets<a class="headerlink" href="#technical-architecture-revsets" title="Permanent link">&para;</a></h3>
<p>A user-provided revset expression string goes through a few different stages to
be evaluated:</p>
<ol>
<li>Parse the expression into a <code>RevsetExpression</code>, which is close to an AST</li>
<li>Resolve symbols and functions like <code>tags()</code> into specific commits. After
   this stage, the expression is still a <code>RevsetExpression</code>, but it won't have
   any <code>CommitRef</code> variants in it.</li>
<li>Resolve visibility. This stage resolves <code>visible_heads()</code> and <code>all()</code> and
   produces a <code>ResolvedExpression</code>.</li>
<li>Evaluate the <code>ResolvedExpression</code> into a <code>Revset</code>.</li>
</ol>
<p>This evaluation step is performed by <code>Index::evaluate_revset()</code>, allowing
the <code>Revset</code> implementation to leverage the specifics of a custom index
implementation. The first three steps are independent of the index
implementation.</p>
<h3 id="technical-architecture-stackedtable">StackedTable<a class="headerlink" href="#technical-architecture-stackedtable" title="Permanent link">&para;</a></h3>
<p><code>StackedTable</code> (actually <code>ReadonlyTable</code> and <code>MutableTable</code>) is a simple disk
format for storing key-value pairs sorted by key. The keys have to have the same
size but the values can have different sizes. We use our own format because we
want <a href="#technical-concurrency">lock-free concurrency</a> and there doesn't seem to be an
existing key-value store we could use.</p>
<p>The file format contains a lookup table followed by concatenated values. The
lookup table is a sorted list of keys, where each key is followed by the
associated value's offset in the concatenated values.</p>
<p>A table can have a parent table. When looking up a key, if it's not found in the
current table, the parent table is searched. We never update a table in place.
If the number of new entries to write is less than half the number of entries in
the parent table, we create a new table with the new entries and a pointer to
the parent. Otherwise, we copy the entries from the parent table and the new
entries into a new table with the grandparent as the parent. We do that
recursively so parent tables are at least 2 times as large as child tables. This
results in O(log N) amortized insertion time and lookup time.</p>
<p>There's no garbage collection of unreachable tables yet.</p>
<p>The tables are named by their hash. We keep a separate directory of pointers to
the current leaf tables, in the same way as we
do <a href="#technical-concurrency-storage">for the operation log</a>.</p>
<h2 id="technical-architecture-design-of-the-cli-crate">Design of the CLI crate<a class="headerlink" href="#technical-architecture-design-of-the-cli-crate" title="Permanent link">&para;</a></h2>
<h3 id="technical-architecture-templates">Templates<a class="headerlink" href="#technical-architecture-templates" title="Permanent link">&para;</a></h3>
<p>The concept is copied from Mercurial, but the syntax is different. The main
difference is that the top-level expression is a template expression, not a
string like in Mercurial. There is also no string interpolation (e.g.
<code>"Commit ID: {node}"</code> in Mercurial).</p>
<h3 id="technical-architecture-diff-editing">Diff-editing<a class="headerlink" href="#technical-architecture-diff-editing" title="Permanent link">&para;</a></h3>
<p>Diff-editing works by creating two very sparse working copies, containing only
the files we want the user to edit. We then let the user edit the right-hand
side of the diff. Then we simply snapshot that working copy to create the new
tree.</p>
<div class="footnote">
<hr />
<ol>
<li id="technical-architecture-fn:1">
<p>There are a few exceptions, such as for messages printed during automatic
upgrades of the repo format&#160;<a class="footnote-backref" href="#technical-architecture-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="technical-concurrency" heading-number="10.3"><h1 id="technical-concurrency-concurrency">Concurrency<a class="headerlink" href="#technical-concurrency-concurrency" title="Permanent link">&para;</a></h1>
<h2 id="technical-concurrency-introduction">Introduction<a class="headerlink" href="#technical-concurrency-introduction" title="Permanent link">&para;</a></h2>
<p>Concurrent editing is a key feature of DVCSs -- that's why they're called
<em>Distributed</em> Version Control Systems. A DVCS that didn't let users edit files
and create commits on separate machines at the same time wouldn't be much
of a distributed VCS.</p>
<p>When conflicting changes are made in different clones, a DVCS will have to deal
with that when you push or pull. For example, when using Mercurial, if the
remote has updated a bookmark called <code>main</code> (Mercurial's bookmarks are similar
to a Git's branches) and you had updated the same bookmark locally but made it
point to a different target, Mercurial would add a bookmark called <code>main@origin</code>
to indicate the conflict. Git instead prevents the conflict by renaming pulled
branches to <code>origin/main</code> whether or not there was a conflict. However, most
DVCSs treat local concurrency quite differently, typically by using lock files
to prevent concurrent edits. Unlike those DVCSs, Jujutsu treats concurrent edits
the same whether they're made locally or remotely.</p>
<p>One problem with using lock files is that they don't work when the clone is in a
distributed file system. Most clones are of course not stored in distributed
file systems, but it is a <em>big</em> problem when they are (Mercurial repos
frequently get corrupted, for example).</p>
<p>Another problem with using lock files is related to complexity of
implementation. The simplest way of using lock files is to take coarse-grained
locks early: every command that may modify the repo takes a lock at the very
beginning. However, that means that operations that wouldn't actually conflict
would still have to wait for each other. The user experience can be improved by
using finer-grained locks and/or taking the locks later. The drawback of that is
complexity. For example, you need to verify that any assumptions you made before
locking are still valid after you take the lock.</p>
<p>To avoid depending on lock files, Jujutsu takes a different approach by
accepting that concurrent changes can always happen. It instead exposes any
conflicting changes to the user, much like other DVCSs do for conflicting
changes made remotely.</p>
<h3 id="technical-concurrency-syncing-with-rsync-nfs-dropbox-etc">Syncing with <code>rsync</code>, NFS, Dropbox, etc<a class="headerlink" href="#technical-concurrency-syncing-with-rsync-nfs-dropbox-etc" title="Permanent link">&para;</a></h3>
<p>Jujutsu's lock-free concurrency means that it's possible to update copies of the
clone on different machines and then let <code>rsync</code> (or Dropbox, or NFS, etc.)
merge them. The working copy may mismatch what's supposed to be checked out, but
no changes to the repo will be lost (added commits, moved bookmarks, etc.). If
conflicting changes were made, they will appear as conflicts. For example, if a
bookmark was moved to two different locations, they will appear in <code>jj log</code> in
both locations but with a "?" after the name, and <code>jj status</code> will also inform
the user about the conflict.</p>
<p>Note that, for now, there are known bugs in this area. Most notably, with the
Git backend, <a href="https://github.com/jj-vcs/jj/issues/2193">repository corruption is possible because the backend is not
entirely lock-free</a>. If you know
about the bug, it is relatively easy to recover from.</p>
<p>Moreover, such use of Jujutsu is not currently thoroughly tested,
especially in the context of <a href="#glossary-co-located-repos">co-located
repositories</a>. While the contents of commits
should be safe, concurrent modification of a repository from different computers
might conceivably lose some bookmark pointers. Note that, unlike in pure
Git, losing a bookmark pointer does not lead to losing commits.</p>
<h2 id="technical-concurrency-operation-log">Operation log<a class="headerlink" href="#technical-concurrency-operation-log" title="Permanent link">&para;</a></h2>
<p>The most important piece in the lock-free design is the "operation log". That is
what allows us to detect and merge divergent operations.</p>
<p>The operation log is similar to a commit DAG (such as in
<a href="https://git-scm.com/book/en/v2/Git-Internals-Git-Objects">Git's object model</a>),
but each commit object is instead an "operation" and each tree object is instead
a "view". The view object contains the set of visible head commits, bookmarks,
tags, and the working-copy commit in each workspace. The operation object
contains a pointer to the view object (like how commit objects point to tree
objects), pointers to parent operation(s) (like how commit objects point to
parent commit(s)), and metadata about the operation. These types are defined
in <code>op_store.proto</code> The operation log is normally linear.
It becomes non-linear if there are divergent operations.</p>
<p>When a command starts, it loads the repo at the latest operation. Because the
associated view object completely defines the repo state, the running command
will not see any changes made by other processes thereafter. When the operation
completes, it is written with the start operation as parent. The operation
cannot fail to commit (except for disk failures and such). It is left for the
next command to notice if there were divergent operations. It will have to be
able to do that anyway since the concurrent operation could have arrived via a
distributed file system. This model -- where each operation sees a consistent
view of the repo and is guaranteed to be able to commit their changes -- greatly
simplifies the implementation of commands.</p>
<p>It is possible to load the repo at a particular operation with
<code>jj --at-operation=&lt;operation ID&gt; &lt;command&gt;</code>. If the command is mutational, that
will result in a fork in the operation log. That works exactly the same as if
any later operations had not existed when the command started. In other words,
running commands on a repo loaded at an earlier operation works the same way as
if the operations had been concurrent. This can be useful for simulating
divergent operations.</p>
<h3 id="technical-concurrency-merging-divergent-operations">Merging divergent operations<a class="headerlink" href="#technical-concurrency-merging-divergent-operations" title="Permanent link">&para;</a></h3>
<p>If Jujutsu tries to load the repo and finds multiple heads in the operation log,
it will do a 3-way merge of the view objects based on their common ancestor
(possibly several 3-way merges if there were more than two heads). Conflicts
are recorded in the resulting view object. For example, if bookmark <code>main</code> was
moved from commit A to commit B in one operation and moved to commit C in a
concurrent operation, then <code>main</code> will be recorded as "moved from A to B or C".
See the <code>RefTarget</code> definition in <code>op_store.proto</code>.</p>
<p>Because we allow bookmarks (etc.) to be in a conflicted state rather than just
erroring out when there are multiple heads, the user can continue to use the
repo, including performing further operations on the repo. Of course, some
commands will fail when using a conflicted bookmark. For example,
<code>jj new main</code> when <code>main</code> is in a conflicted state will result in an error
telling you that <code>main</code> resolved to multiple revisions.</p>
<h3 id="technical-concurrency-storage">Storage<a class="headerlink" href="#technical-concurrency-storage" title="Permanent link">&para;</a></h3>
<p>The operation objects and view objects are stored in content-addressed storage
just like Git commits are. That makes them safe to write without locking.</p>
<p>We also need a way of finding the current head of the operation log. We do that
by keeping the ID of the current head(s) as a file in a directory. The ID is the
name of the file; it has no contents. When an operation completes, we add a file
pointing to the new operation and then remove the file pointing to the old
operation. Writing the new file is what makes the operation visible (if the old
file didn't get properly deleted, then future readers will take care of that).
This scheme ensures that transactions are atomic.</p></section><section class="print-page" id="technical-conflicts" heading-number="10.4"><h1 id="technical-conflicts-first-class-conflicts">First-class conflicts<a class="headerlink" href="#technical-conflicts-first-class-conflicts" title="Permanent link">&para;</a></h1>
<h2 id="technical-conflicts-introduction">Introduction<a class="headerlink" href="#technical-conflicts-introduction" title="Permanent link">&para;</a></h2>
<p>Conflicts can happen when two changes are applied to some state. This document
is about conflicts between changes to files (not about <a href="#technical-concurrency">conflicts between
changes to bookmark targets</a>, for example).</p>
<p>For example, if you merge two branches in a repo, there may be conflicting
changes between the two branches. Most DVCSs require you to resolve those
conflicts before you can finish the merge operation. Jujutsu instead records
the conflicts in the commit and lets you resolve the conflict when you feel like
it.</p>
<h2 id="technical-conflicts-data-model">Data model<a class="headerlink" href="#technical-conflicts-data-model" title="Permanent link">&para;</a></h2>
<p>When a merge conflict happens, it is recorded as an ordered list of tree objects
linked from the commit (instead of the usual single tree per commit). There will
always be an odd number of trees linked from the commit. You can think of the
first tree as a start tree, and the subsequent pairs of trees to apply the diff
between onto the start. Examples:</p>
<ul>
<li>If the commit has trees A, B, C, D, and E it means that the contents should be
  calculated as A+(C-B)+(E-D).</li>
<li>A three-way merge between A and C with B as base can be represented as a
commit with trees A, B, and C, also known as A+(C-B).</li>
</ul>
<p>The resulting tree contents is calculated on demand. Note that we often don't
need to merge the entire tree. For example, when checking out a commit in the
working copy, we only need to merge parts of the tree that differs from the
tree that was previously checked out in the working copy. As another example,
when listing paths with conflicts, we only need to traverse parts of the tree
that cannot be trivially resolved; if only one side modified <code>lib/</code>, then we
don't need to look for conflicts in that sub-tree.</p>
<p>When merging trees, if we can't resolve a sub-tree conflict trivially by looking
at just the tree id, we recurse into the sub-tree. Similarly, if we can't
resolve a file conflict trivially by looking at just the id, we recursive into
the hunks within the file.</p>
<p>See <a href="#git-compatibility-format-mapping-details">here</a> for how conflicts are
stored when using the Git commit backend.</p>
<h2 id="technical-conflicts-conflict-simplification">Conflict simplification<a class="headerlink" href="#technical-conflicts-conflict-simplification" title="Permanent link">&para;</a></h2>
<p>Remember that a 3-way merge can be written <code>A+C-B</code>. If one of those states is
itself a conflict, then we simply insert the conflict expression there. Then we
simplify by removing canceling terms. These two steps are implemented in
<code>Merge::flatten()</code> and <code>Merge::simplify()</code> in <a href="https://github.com/jj-vcs/jj/blob/main/lib/src/merge.rs"><code>merge.rs</code></a>.</p>
<p>For example, let's say commit B is based on A and is rebased to C, where it
results in conflicts (<code>C+(B-A)</code>), which the user leaves unresolved. If the
commit is then rebased to D, the result will be <code>D+((C+(B-A))-C)</code>. That expression
can be simplified to <code>D+(B-A)</code>, which is a regular 3-way merge between D and B
with A as base (no trace of C). This is what lets the user keep old commits
rebased to head without resolving conflicts and still not get messy recursive
conflicts.</p>
<p>As another example, let's go through what happens when you back out a conflicted
commit. Let's say we have the usual <code>E = C+(B-A)</code> conflict on top of
non-conflict state <code>C</code>. We then revert that change. Reverting a change means
applying its reverse diff <code>-(E-C)</code>, so the result is <code>E+(C-E) =
(C+(B-A))+(C-(C+(B-A)))</code>, which we can simplify to just <code>C</code> (i.e. no conflict).</p>
<h2 id="technical-conflicts-same-change-rule">Same-change rule<a class="headerlink" href="#technical-conflicts-same-change-rule" title="Permanent link">&para;</a></h2>
<p>When all sides of a conflict make the same change,
<a href="https://github.com/jj-vcs/jj/blob/53272510bf879086d83bb5eea1406f75ba31f138/lib/src/merge.rs#L85-L99">we automatically consider it resolved to that value</a>. We call this
"the same-change rule". This behavior matches what Git and Mercurial do.
Darcs, on the other hand, considers it a  conflict. The automatic conflict
resolution we do is lossy in terms of conflict algebra; it means that rebasing
a commit onto a commit that has the same changes (or a subset thereof) and then
rebasing it back will lose changes (for a real-life example see <a href="https://github.com/jj-vcs/jj/issues/6369">bug #6369</a>).
We do it because it is more user-friendly in the vast majority of cases. We
may at some point experiment with a config option to disable the same-change
rule.</p></section></section>
                    <section class='print-page md-section' id='section-11' heading-number='11'>
                        <h1>Contributing<a class='headerlink' href='#section-11' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="contributing" heading-number="11.1"><h1 id="contributing-how-to-contribute">How to Contribute<a class="headerlink" href="#contributing-how-to-contribute" title="Permanent link">&para;</a></h1>
<h2 id="contributing-policies">Policies<a class="headerlink" href="#contributing-policies" title="Permanent link">&para;</a></h2>
<p>We'd love to accept your patches and contributions to this project. There are
just a few small guidelines you need to follow.</p>
<h3 id="contributing-contributor-license-agreement">Contributor License Agreement<a class="headerlink" href="#contributing-contributor-license-agreement" title="Permanent link">&para;</a></h3>
<p>Contributions to this project must be accompanied by a Contributor License
Agreement. You (or your employer) retain the copyright to your contribution;
this simply gives us permission to use and redistribute your contributions as
part of the project. Head over to <a href="https://cla.developers.google.com/">https://cla.developers.google.com/</a> to see
your current agreements on file or to sign a new one.</p>
<p>You generally only need to submit a CLA once, so if you've already submitted one
(even if it was for a different project), you probably don't need to do it
again.</p>
<h3 id="contributing-commit-guidelines">Commit guidelines<a class="headerlink" href="#contributing-commit-guidelines" title="Permanent link">&para;</a></h3>
<p>Unlike many GitHub projects (but like many VCS projects), we care more about the
contents of commits than about the contents of PRs. We review each commit
separately, and we don't squash-merge the PR (so please manually squash any
fixup commits before sending for review).</p>
<p>Each commit should ideally do one thing. For example, if you need to refactor a
function in order to add a new feature cleanly, put the refactoring in one
commit and the new feature in a different commit. If the refactoring itself
consists of many parts, try to separate out those into separate commits. You can
use <code>jj split</code> to do it if you didn't realize ahead of time how it should be
split up. Include tests and documentation in the same commit as the code they
test and document.</p>
<p>The commit message should describe the changes in the commit;
the PR description can even be empty, but feel free to include a personal
message. We start the commit message with <code>&lt;topic&gt;:</code>  and don't use
<a href="https://www.conventionalcommits.org/en/v1.0.0/">conventional commits</a>. This means if
you modified a command in the CLI, use its name as the topic, e.g.
<code>next/prev: &lt;your-modification&gt;</code> or <code>conflicts: &lt;your-modification&gt;</code>. We don't
currently have a specific guidelines on what to write in the topic field, but
the reviewers will help you provide a topic if you have difficulties choosing
it. <a href="https://cbea.ms/git-commit/">How to Write a Git Commit Message</a> is a good
guide if you're new to writing good commit messages. We are not particularly
strict about the style, but please do explain the reason for the change unless
it's obvious.</p>
<h3 id="contributing-code-reviews">Code reviews<a class="headerlink" href="#contributing-code-reviews" title="Permanent link">&para;</a></h3>
<p>All submissions, including submissions by project members, require review. We
use GitHub pull requests for this purpose. Consult
<a href="https://help.github.com/articles/about-pull-requests/">GitHub Help</a> for more
information on using pull requests.</p>
<p>When you address comments on a PR, don't make the changes in a commit on top (as
is typical on GitHub). Instead, please make the changes in the appropriate
commit. You can do that by creating a new commit on top of the initial commit
 (<code>jj new &lt;commit&gt;</code>) and then squash in the changes when you're done (<code>jj squash</code>).
<code>jj git push</code>
will automatically force-push the bookmark.</p>
<p>When your first PR has been approved, we typically invite you to the
<code>jj-vcs/contributors</code> team to give you contributor access,
so you can address any remaining minor comments and then merge the PR yourself
when you're ready. If you realize that some comments require non-trivial
changes, please ask your reviewer to take another look.</p>
<p>If your employer pays anyone (not necessarily you) to contribute to Jujutsu,
please make sure your GitHub username is <a href="#paid_contributors">recorded</a>.
To avoid conflicts of interest, please don't merge a PR that has only been
approved by someone from the same organization. Similarly, as a reviewer, there
is no need to approve your coworkers' PRs, since the author should await an
approval from someone else anyway. It is of course still appreciated if you
review and comment on their PRs. Also, if the PR seems completely unrelated to
your company's interests, do feel free to approve it.</p>
<h3 id="contributing-community-guidelines">Community Guidelines<a class="headerlink" href="#contributing-community-guidelines" title="Permanent link">&para;</a></h3>
<p>This project follows <a href="https://opensource.google/conduct/">Google's Open Source Community
Guidelines</a>.</p>
<h2 id="contributing-contributing-large-patches">Contributing large patches<a class="headerlink" href="#contributing-contributing-large-patches" title="Permanent link">&para;</a></h2>
<p>Before sending a PR for a large change which designs/redesigns or reworks an
existing component, we require an architecture review from  multiple
stakeholders, which we do with <a href="#design_docs">Design Docs</a>, see the
<a href="#design_docs-process">process here</a>.</p>
<h2 id="contributing-contributing-to-the-documentation">Contributing to the documentation<a class="headerlink" href="#contributing-contributing-to-the-documentation" title="Permanent link">&para;</a></h2>
<p>We appreciate <a href="https://github.com/jj-vcs/jj/issues/new?template=bug_report.md">bug
reports</a>
about any problems, however small, lurking in <a href="https://jj-vcs.github.io/jj/prerelease">our documentation
website</a> or in the <code>jj help
&lt;command&gt;</code> docs. If a part of the bug report template does not apply, you can
just delete it.</p>
<p>Before reporting a problem with the documentation website, we'd appreciate it if
you could check that the problem still exists in the "prerelease" version of the
documentation (as opposed to the docs for one of the released versions of <code>jj</code>).
You can use the version switcher in the top-left of the website to do so.</p>
<p>If you are willing to make a PR fixing a documentation problem, even better!</p>
<p>The documentation website sources are Markdown files located in the <a href="https://github.com/jj-vcs/jj/tree/main/docs"><code>docs/</code>
directory</a>. You do not need to
know Rust to work with them. See below for <a href="#contributing-previewing-the-html-documentation">instructions on how to preview the
HTML docs</a> as you edit the Markdown files.
Doing so is optional, but recommended.</p>
<p>The <code>jj help</code> docs are sourced from the "docstring" comments inside the Rust
sources, currently from the <a href="https://github.com/jj-vcs/jj/tree/main/cli/src/commands"><code>cli/src/commands</code>
directory</a>. Working
on them requires setting up a Rust development environment, as described
below, and may occasionally require adjusting a test.</p>
<h2 id="contributing-learning-rust">Learning Rust<a class="headerlink" href="#contributing-learning-rust" title="Permanent link">&para;</a></h2>
<p>In addition to the <a href="https://doc.rust-lang.org/book/">Rust Book</a> and the other
excellent resources at <a href="https://www.rust-lang.org/learn">https://www.rust-lang.org/learn</a>, we recommend the
<a href="https://google.github.io/comprehensive-rust/">"Comprehensive Rust" mini-course</a>
for an overview, especially if you are familiar with C++.</p>
<h2 id="contributing-style-guide">Style guide<a class="headerlink" href="#contributing-style-guide" title="Permanent link">&para;</a></h2>
<p>See <a href="#style_guide">here</a>.</p>
<h2 id="contributing-setting-up-a-development-environment">Setting up a development environment<a class="headerlink" href="#contributing-setting-up-a-development-environment" title="Permanent link">&para;</a></h2>
<p>To develop <code>jj</code>, the mandatory steps are simply
to <a href="https://www.rust-lang.org/tools/install">install Rust</a> (the default
installer options are fine), clone the repository, and use <code>cargo build</code>
, <code>cargo fmt</code>,
<code>cargo clippy --workspace --all-targets</code>, and
<code>cargo test --workspace</code>. If you are preparing a PR, there are some additional
recommended steps.</p>
<h3 id="contributing-summary">Summary<a class="headerlink" href="#contributing-summary" title="Permanent link">&para;</a></h3>
<p>One-time setup:</p>
<div class="codehilite"><pre><span></span><code>rustup toolchain add nightly  # wanted for &#39;rustfmt&#39;
rustup toolchain add 1.84     # also specified in Cargo.toml
cargo install --locked bacon
cargo install --locked cargo-insta
cargo install --locked cargo-nextest
</code></pre></div>

<p>During development (adapt according to your preference):</p>
<div class="codehilite"><pre><span></span><code>bacon clippy-all
cargo +nightly fmt # Occasionally
cargo nextest run --workspace # Occasionally
cargo insta test --workspace --test-runner nextest # Occasionally
</code></pre></div>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Build artifacts from debug builds and especially from repeated
invocations of <code>cargo test</code> can quickly take up 10s of GB of disk space.
Cargo will happily use up your entire hard drive. If this happens, run
<code>cargo clean</code>.</p>
</div>
<h3 id="contributing-explanation">Explanation<a class="headerlink" href="#contributing-explanation" title="Permanent link">&para;</a></h3>
<p>These are listed roughly in order of decreasing importance.</p>
<ol>
<li>
<p>Nearly any change to <code>jj</code>'s CLI will require writing or updating snapshot
   tests that use the <a href="https://insta.rs/"><code>insta</code></a> crate. To make this
   convenient, install the <code>cargo-insta</code> binary.
   Use <code>cargo insta test --workspace</code> to run tests,
   and <code>cargo insta review --workspace</code> to update the snapshot tests.
   The <code>--workspace</code> flag is needed to run the tests on all crates; by default,
   only the crate in the current directory is tested.</p>
</li>
<li>
<p>GitHub CI checks require that the code is formatted with the <em>nightly</em>
   version of <code>rustfmt</code>. To do this on your computer, install the nightly
   toolchain and use <code>cargo +nightly fmt</code>.</p>
</li>
<li>
<p>Your code will be rejected if it cannot be compiled with the minimal
   supported version of Rust ("MSRV"). Currently, <code>jj</code> follows a rather
   casual MSRV policy: "The current <code>rustc</code> stable version, minus one."
   As of this writing, that version is <strong>1.84.0</strong>.</p>
</li>
<li>
<p>Your code needs to pass <code>cargo clippy</code>. You can also
   use <code>cargo +nightly clippy</code> if you wish to see more warnings.</p>
</li>
<li>
<p>You may also want to install and use <a href="https://dystroy.org/bacon/"><code>bacon</code></a>,
   to automatically build, check, and / or run tests.</p>
</li>
<li>
<p>To run tests more quickly, use <code>cargo nextest run --workspace</code>. To
   use <code>nextest</code> with <code>insta</code>, use <code>cargo insta test --workspace
   --test-runner nextest</code>.</p>
<p>On Linux, you may be able to speed up <code>nextest</code> even further by using
 the <code>mold</code> linker, as explained below.</p>
</li>
</ol>
<h3 id="contributing-configuring-jj-fix-to-run-rustfmt">Configuring <code>jj fix</code> to run <code>rustfmt</code><a class="headerlink" href="#contributing-configuring-jj-fix-to-run-rustfmt" title="Permanent link">&para;</a></h3>
<p>Run this in the jj repo:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--repo<span class="w"> </span>fix.tools.rustfmt<span class="w"> </span><span class="s1">&#39;{ command = [&quot;rustfmt&quot;, &quot;+nightly&quot;], patterns = [&quot;glob:**/*.rs&quot;] }&#39;</span>
</code></pre></div>
<h3 id="contributing-using-mold-for-faster-tests-on-linux">Using <code>mold</code> for faster tests on Linux<a class="headerlink" href="#contributing-using-mold-for-faster-tests-on-linux" title="Permanent link">&para;</a></h3>
<p>On a machine with a multi-core CPU, one way to speed up
<code>cargo nextest</code> on Linux is to use the multi-threaded <a href="https://github.com/rui314/mold"><code>mold</code>
linker</a>. This linker may help
if, currently, your CPU is underused while Rust is linking test
binaries. Before proceeding with <code>mold</code>, you can check whether this is
an issue worth solving using a system monitoring tool such as <code>htop</code>.</p>
<p><code>mold</code> is packaged for many distributions. On Debian, for example,
<code>sudo apt install mold</code> should just work.</p>
<p>A simple way to use <code>mold</code> is via the <code>-run</code> option, e.g.:</p>
<div class="highlight"><pre><span></span><code>mold<span class="w"> </span>-run<span class="w"> </span>cargo<span class="w"> </span>insta<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--workspace<span class="w"> </span>--test-runner<span class="w"> </span>nextest
</code></pre></div>
<p>There will be no indication that a different linker is used, except for
higher CPU usage while linking and, hopefully, faster completion. You
can verify that <code>mold</code> was indeed used by running
<code>readelf -p .comment target/debug/jj</code>.</p>
<p>There are also ways of having Rust use <code>mold</code> by default, see the <a href="https://github.com/rui314/mold#how-to-use">"How
to use" instructions</a>.</p>
<p>On recent versions of MacOS, the default linker Rust uses is already
multi-threaded. It should use all the CPU cores without any configuration.</p>
<h3 id="contributing-editor-setup">Editor setup<a class="headerlink" href="#contributing-editor-setup" title="Permanent link">&para;</a></h3>
<h4 id="contributing-visual-studio-code">Visual Studio Code<a class="headerlink" href="#contributing-visual-studio-code" title="Permanent link">&para;</a></h4>
<p>We recommend at least these settings:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;files.insertFinalNewline&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;files.trimTrailingWhitespace&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;[rust]&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="s2">&quot;files.trimTrailingWhitespace&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="contributing-zed">Zed<a class="headerlink" href="#contributing-zed" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// .zed/settings.json</span>
<span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;ensure_final_newline_on_save&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;remove_trailing_whitespace_on_save&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>

<span class="w">  </span><span class="s2">&quot;languages&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// We don&#39;t use a formatter for Markdown files, so format_on_save would just</span>
<span class="w">    </span><span class="c1">// mess with others&#39; docs</span>
<span class="w">    </span><span class="s2">&quot;Markdown&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;format_on_save&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;off&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="s2">&quot;Rust&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s2">&quot;format_on_save&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;on&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="c1">// Avoid removing trailing spaces within multi-line string literals</span>
<span class="w">      </span><span class="s2">&quot;remove_trailing_whitespace_on_save&quot;</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="s2">&quot;lsp&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;rust-analyzer&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s2">&quot;initialization_options&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// If you are working on docs and don&#39;t need `cargo check`, uncomment</span>
<span class="w">        </span><span class="c1">// this option:</span>
<span class="w">        </span><span class="c1">//</span>
<span class="w">        </span><span class="c1">//   &quot;checkOnSave&quot;: false,</span>

<span class="w">        </span><span class="c1">// Use nightly `rustfmt`, equivalent to `cargo +nightly fmt`</span>
<span class="w">        </span><span class="s2">&quot;rustfmt&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;extraArgs&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;+nightly&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="contributing-previewing-the-html-documentation">Previewing the HTML documentation<a class="headerlink" href="#contributing-previewing-the-html-documentation" title="Permanent link">&para;</a></h2>
<p>The documentation for <code>jj</code> is automatically published online at
<a href="https://jj-vcs.github.io/jj/">https://jj-vcs.github.io/jj/</a>.</p>
<p>When editing documentation, you should check your changes locally — especially
if you are adding a new page, or doing a major rewrite.</p>
<h3 id="contributing-install-uv">Install <code>uv</code><a class="headerlink" href="#contributing-install-uv" title="Permanent link">&para;</a></h3>
<p>The only thing you need is <a href="https://docs.astral.sh/uv/"><code>uv</code></a> (version 0.5.1 or newer).</p>
<p><code>uv</code> is a Python project manager written in Rust. It will fetch the right Python
version and the dependencies needed to build the docs. Install it like so:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:5"><input checked="checked" id="contributing-macoslinux" name="contributing-__tabbed_1" type="radio" /><input id="contributing-windows" name="contributing-__tabbed_1" type="radio" /><input id="contributing-homebrew" name="contributing-__tabbed_1" type="radio" /><input id="contributing-cargo" name="contributing-__tabbed_1" type="radio" /><input id="contributing-other-options" name="contributing-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="contributing-macoslinux">macOS/Linux</label><label for="contributing-windows">Windows</label><label for="contributing-homebrew">Homebrew</label><label for="contributing-cargo">Cargo</label><label for="contributing-other-options">Other options</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-LsSf<span class="w"> </span>https://astral.sh/uv/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don't have <code>~/.local/bin</code> in your <code>PATH</code>, the installer will
modify your shell profile. To avoid it:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-LsSf<span class="w"> </span>https://astral.sh/uv/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>env<span class="w"> </span><span class="nv">INSTALLER_NO_MODIFY_PATH</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>sh
</code></pre></div>
</div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>powershell<span class="w"> </span>-ExecutionPolicy<span class="w"> </span>ByPass<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;irm https://astral.sh/uv/install.ps1 | iex&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>brew<span class="w"> </span>install<span class="w"> </span>uv
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># This might take a while</span>
cargo<span class="w"> </span>install<span class="w"> </span>--git<span class="w"> </span>https://github.com/astral-sh/uv<span class="w"> </span>uv
</code></pre></div>
</div>
<div class="tabbed-block">
<ul>
<li>Directly download the binaries from GitHub: <a href="https://github.com/astral-sh/uv/releases">uv releases</a>.</li>
<li>Even more options: <a href="https://docs.astral.sh/uv/getting-started/installation/">Installing uv</a>.</li>
</ul>
</div>
</div>
</div>
<h3 id="contributing-build-the-docs">Build the docs<a class="headerlink" href="#contributing-build-the-docs" title="Permanent link">&para;</a></h3>
<p>To build the docs, run while inside the <code>jj</code> repository:</p>
<div class="highlight"><pre><span></span><code>uv<span class="w"> </span>run<span class="w"> </span>mkdocs<span class="w"> </span>serve
</code></pre></div>
<p>Open <a href="http://127.0.0.1:8000">http://127.0.0.1:8000</a> in your browser to see the docs.</p>
<p>As you edit the <code>.md</code> files in <code>docs/</code>, the website should be rebuilt and
reloaded in your browser automatically.</p>
<div class="admonition note">
<p class="admonition-title">If the docs are not updating</p>
<p>Check the terminal from which you ran <code>uv run mkdocs serve</code> for any build
errors or warnings. Warnings about <code>"GET /versions.json HTTP/1.1" code 404</code>
are expected and harmless.</p>
</div>
<h4 id="contributing-offline-distribution">Offline distribution<a class="headerlink" href="#contributing-offline-distribution" title="Permanent link">&para;</a></h4>
<p>To build the rendered docs for offline distribution or to view them from your file
system, run while inside the <code>jj</code> repository:</p>
<div class="highlight"><pre><span></span><code><span class="nv">MKDOCS_OFFLINE</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span>uv<span class="w"> </span>run<span class="w"> </span>mkdocs<span class="w"> </span>build
</code></pre></div>
<h2 id="contributing-building-the-entire-website">Building the entire website<a class="headerlink" href="#contributing-building-the-entire-website" title="Permanent link">&para;</a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Building the entire website is not usually necessary. If you are editing
documentation, the previous section is enough.</p>
<p>These instructions are relevant if you are working on the versioning of the
documentation that we currently do with <code>mike</code>.</p>
</div>
<p>The full <code>jj</code> website includes the documentation for several <code>jj</code> versions
(<code>prerelease</code>, latest release, and the older releases). The top-level
URL <a href="https://jj-vcs.github.io/jj">https://jj-vcs.github.io/jj</a> redirects to
<a href="https://jj-vcs.github.io/jj/latest">https://jj-vcs.github.io/jj/latest</a>, which in turn redirects to
the docs for the last stable version.</p>
<p>The different versions of documentation are managed and deployed with
<a href="https://github.com/jimporter/mike"><code>mike</code></a>, which can be run with
<code>uv run mike</code>.</p>
<p>On a POSIX system or WSL, one way to build the entire website is as follows (on
Windows, you'll need to understand and adapt the shell script):</p>
<ol>
<li>
<p>Check out <code>jj</code> as a co-located <code>jj + git</code> repository (<code>jj clone --colocate</code>),
cloned from your fork of <code>jj</code> (e.g. <code>github.com/jjfan/jj</code>). You can also use a
pure Git repo if you prefer.</p>
</li>
<li>
<p>Make sure <code>github.com/jjfan/jj</code> includes the <code>gh-pages</code> bookmark of the jj repo
and run <code>git fetch origin gh-pages</code>.</p>
</li>
<li>
<p>Go to the GitHub repository settings, enable GitHub Pages, and configure them
to use the <code>gh-pages</code> bookmark (this is usually the default).</p>
</li>
<li>
<p>Install <code>uv</code> as explained in <a href="#contributing-previewing-the-html-documentation">Previewing the HTML
documentation</a>, and run the same <code>sh</code> script
that is used in GitHub CI (details below):</p>
<div class="highlight"><pre><span></span><code>.github/scripts/docs-build-deploy<span class="w"> </span>prerelease<span class="w"> </span>main<span class="w"> </span>--push
</code></pre></div>
<p>This should build the version of the docs from the current commit,
  deploy it as a new commit to the <code>gh-pages</code> bookmark,
  and push the <code>gh-pages</code> bookmark to the origin.</p>
</li>
<li>
<p>Now, you should be able to see the full website, including your latest changes
to the <code>prerelease</code> version, at <code>https://jjfan.github.io/jj/prerelease/</code>.</p>
</li>
<li>
<p>(Optional) The previous steps actually only rebuild
<code>https://jjfan.github.io/jj/prerelease/</code> and its alias
<code>https://jjfan.github.io/jj/main/</code>. If you'd like to test out version switching
back and forth, you can also rebuild the docs for the latest release as follows.</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>new<span class="w"> </span>v1.33.1<span class="w">  </span><span class="c1"># Let&#39;s say `jj 1.33.1` is the currently the latest release</span>
.github/scripts/docs-build-deploy<span class="w"> </span>v1.33.1<span class="w"> </span>latest<span class="w"> </span>--push
</code></pre></div>
</li>
<li>
<p>(Optional) When you are done, you may want to reset the <code>gh-pages</code> bookmark to the
same spot as it is upstream. If you configured the "upstream" remote,
this can be done with:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># This will LOSE any changes you made to `gh-pages`</span>
jj<span class="w"> </span>git<span class="w"> </span>fetch<span class="w"> </span>--remote<span class="w"> </span>upstream
jj<span class="w"> </span>bookmark<span class="w"> </span><span class="nb">set</span><span class="w"> </span>gh-pages<span class="w"> </span>-r<span class="w"> </span>gh-pages@upstream
jj<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--remote<span class="w"> </span>origin<span class="w"> </span>--bookmark<span class="w"> </span>gh-pages
</code></pre></div>
<p>If you want to preserve some of the changes you made, you can do <code>jj bookmark
  set my-changes -r gh-pages</code> BEFORE running the above commands.</p>
</li>
</ol>
<h3 id="contributing-explanation-of-the-docs-build-deploy-script">Explanation of the <code>docs-build-deploy</code> script<a class="headerlink" href="#contributing-explanation-of-the-docs-build-deploy-script" title="Permanent link">&para;</a></h3>
<p>The script sets up a few environment variables and invokes <code>uv run mike deploy</code>
with some default arguments and whatever arguments were passed to
<code>docs-build-deploy</code>. Run <code>uv run mike help deploy</code> to find out what the
arguments do.</p>
<p>If you need to do something more complicated, you can use <code>uv run mike
...</code> commands. You can also edit the <code>gh-pages</code> bookmark directly, but take care
to avoid files that will be overwritten by future invocations of <code>mike</code>. Then,
you can submit a PR based on the <code>gh-pages</code> bookmark of
<a href="https://jj-vcs.github.com/jj">https://jj-vcs.github.com/jj</a> (instead of the usual <code>main</code> bookmark).</p>
<p>Previously, the version switcher would not work unless the value of the
<code>site_url</code> config in <code>mkdocs.yml</code> matched the actual URL the site is being
served from. This bug should now be fixed, but if you are not serving the site
from https://jj-vcs.github.com/jj and something does not work weirdly, you might
want to adjust the <code>site_url</code> to something like <code>https://jjfan.github.io/jj</code>.</p>
<h2 id="contributing-modifying-protobuffers-this-is-not-common">Modifying protobuffers (this is not common)<a class="headerlink" href="#contributing-modifying-protobuffers-this-is-not-common" title="Permanent link">&para;</a></h2>
<p>Occasionally, you may need to change the <code>.proto</code> files that define jj's data
 storage format. In this case, you will need to add a few steps to the above
 workflow.</p>
<ul>
<li>Install the <code>protoc</code> compiler. This usually means either <code>apt-get install
   protobuf-compiler</code> or downloading <a href="https://github.com/protocolbuffers/protobuf/releases">an official release</a>. The
   <code>prost</code> <a href="https://docs.rs/prost-build/latest/prost_build/#sourcing-protoc">library docs</a> have additional advice.</li>
<li>Run <code>cargo run -p gen-protos</code> regularly (or after every edit to a <code>.proto</code>
   file). This is the same as running <code>cargo run</code> from <code>lib/gen-protos</code>. The
   <code>gen-protos</code> binary will use the <code>prost-build</code> library to compile the
   <code>.proto</code> files into <code>.rs</code> files.</li>
<li>If you are adding a new <code>.proto</code> file, you will need to edit the list of
   these files in <code>lib/gen-protos/src/main.rs</code>.</li>
</ul>
<p>The <code>.rs</code> files generated from <code>.proto</code> files are included in the repository,
 and there is a GitHub CI check that will complain if they do not match.</p>
<h2 id="contributing-logging">Logging<a class="headerlink" href="#contributing-logging" title="Permanent link">&para;</a></h2>
<p>You can print internal jj logs using <code>JJ_LOG</code>. It acts like the <code>RUST_LOG</code>
environment variable, frequent in Rust codebases, and accepts one or more
<a href="https://docs.rs/tracing-subscriber/latest/tracing_subscriber/filter/struct.EnvFilter.html#directives">directives</a>. You can also run <code>JJ_LOG=debug jj</code> to get <code>debug</code> level logs
enabled for all targets. You can also use the <code>--debug</code> global option, which
turns on <code>debug</code> log level for <code>jj-lib</code> and <code>jj-cli</code> only.</p>
<h2 id="contributing-profiling">Profiling<a class="headerlink" href="#contributing-profiling" title="Permanent link">&para;</a></h2>
<p>One easy-to-use sampling profiler
is <a href="https://github.com/mstange/samply">samply</a>. For example:
<div class="highlight"><pre><span></span><code>cargo<span class="w"> </span>install<span class="w"> </span>samply
samply<span class="w"> </span>record<span class="w"> </span>jj<span class="w"> </span>diff
</code></pre></div>
Then just open the link it prints.</p>
<p>Another option is to use the instrumentation we've added manually (using
<code>tracing::instrument</code>) in various places. For example:
<div class="highlight"><pre><span></span><code><span class="nv">JJ_TRACE</span><span class="o">=</span>/tmp/trace.json<span class="w"> </span>jj<span class="w"> </span>diff
</code></pre></div>
Then go to <code>https://ui.perfetto.dev/</code> in Chrome and load <code>/tmp/trace.json</code> from
there.</p></section><section class="print-page" id="code-of-conduct" heading-number="11.2"><h1 id="code-of-conduct-contributor-covenant-code-of-conduct">Contributor Covenant Code of Conduct<a class="headerlink" href="#code-of-conduct-contributor-covenant-code-of-conduct" title="Permanent link">&para;</a></h1>
<h2 id="code-of-conduct-our-pledge">Our Pledge<a class="headerlink" href="#code-of-conduct-our-pledge" title="Permanent link">&para;</a></h2>
<p>We as members, contributors, and leaders pledge to make participation in our
community a harassment-free experience for everyone, regardless of age, body
size, visible or invisible disability, ethnicity, sex characteristics, gender
identity and expression, level of experience, education, socioeconomic status,
nationality, personal appearance, race, caste, color, religion, or sexual
identity and orientation.</p>
<p>We pledge to act and interact in ways that contribute to an open, welcoming,
diverse, inclusive, and healthy community.</p>
<h2 id="code-of-conduct-our-standards">Our Standards<a class="headerlink" href="#code-of-conduct-our-standards" title="Permanent link">&para;</a></h2>
<p>Examples of behavior that contributes to a positive environment for our
community include:</p>
<ul>
<li>Demonstrating empathy and kindness toward other people</li>
<li>Being respectful of differing opinions, viewpoints, and experiences</li>
<li>Giving and gracefully accepting constructive feedback</li>
<li>Accepting responsibility and apologizing to those affected by our mistakes,
  and learning from the experience</li>
<li>Focusing on what is best not just for us as individuals, but for the overall
  community</li>
</ul>
<p>Examples of unacceptable behavior include:</p>
<ul>
<li>The use of sexualized language or imagery, and sexual attention or advances of
  any kind</li>
<li>Trolling, insulting or derogatory comments, and personal or political attacks</li>
<li>Public or private harassment</li>
<li>Publishing others' private information, such as a physical or email address,
  without their explicit permission</li>
<li>Other conduct which could reasonably be considered inappropriate in a
  professional setting</li>
</ul>
<h2 id="code-of-conduct-enforcement-responsibilities">Enforcement Responsibilities<a class="headerlink" href="#code-of-conduct-enforcement-responsibilities" title="Permanent link">&para;</a></h2>
<p>Community leaders are responsible for clarifying and enforcing our standards of
acceptable behavior and will take appropriate and fair corrective action in
response to any behavior that they deem inappropriate, threatening, offensive,
or harmful.</p>
<p>Community leaders have the right and responsibility to remove, edit, or reject
comments, commits, code, wiki edits, issues, and other contributions that are
not aligned to this Code of Conduct, and will communicate reasons for moderation
decisions when appropriate.</p>
<h2 id="code-of-conduct-scope">Scope<a class="headerlink" href="#code-of-conduct-scope" title="Permanent link">&para;</a></h2>
<p>This Code of Conduct applies within all community spaces, and also applies when
an individual is officially representing the community in public spaces.
Examples of representing our community include using an official e-mail address,
posting via an official social media account, or acting as an appointed
representative at an online or offline event.</p>
<h2 id="code-of-conduct-enforcement">Enforcement<a class="headerlink" href="#code-of-conduct-enforcement" title="Permanent link">&para;</a></h2>
<p>Instances of abusive, harassing, or otherwise unacceptable behavior may be
reported to the community leaders responsible for enforcement at
two or more of jaraco@jaraco.com, avamsi07@gmail.com, me@waleedkhan.name, and opensource@google.com.
All complaints will be reviewed and investigated promptly and fairly.</p>
<p>All community leaders are obligated to respect the privacy and security of the
reporter of any incident.</p>
<h2 id="code-of-conduct-enforcement-guidelines">Enforcement Guidelines<a class="headerlink" href="#code-of-conduct-enforcement-guidelines" title="Permanent link">&para;</a></h2>
<p>Community leaders will follow these Community Impact Guidelines in determining
the consequences for any action they deem in violation of this Code of Conduct:</p>
<h3 id="code-of-conduct-1-correction">1. Correction<a class="headerlink" href="#code-of-conduct-1-correction" title="Permanent link">&para;</a></h3>
<p><strong>Community Impact</strong>: Use of inappropriate language or other behavior deemed
unprofessional or unwelcome in the community.</p>
<p><strong>Consequence</strong>: A private, written warning from community leaders, providing
clarity around the nature of the violation and an explanation of why the
behavior was inappropriate. A public apology may be requested.</p>
<h3 id="code-of-conduct-2-warning">2. Warning<a class="headerlink" href="#code-of-conduct-2-warning" title="Permanent link">&para;</a></h3>
<p><strong>Community Impact</strong>: A violation through a single incident or series of
actions.</p>
<p><strong>Consequence</strong>: A warning with consequences for continued behavior. No
interaction with the people involved, including unsolicited interaction with
those enforcing the Code of Conduct, for a specified period of time. This
includes avoiding interactions in community spaces as well as external channels
like social media. Violating these terms may lead to a temporary or permanent
ban.</p>
<h3 id="code-of-conduct-3-temporary-ban">3. Temporary Ban<a class="headerlink" href="#code-of-conduct-3-temporary-ban" title="Permanent link">&para;</a></h3>
<p><strong>Community Impact</strong>: A serious violation of community standards, including
sustained inappropriate behavior.</p>
<p><strong>Consequence</strong>: A temporary ban from any sort of interaction or public
communication with the community for a specified period of time. No public or
private interaction with the people involved, including unsolicited interaction
with those enforcing the Code of Conduct, is allowed during this period.
Violating these terms may lead to a permanent ban.</p>
<h3 id="code-of-conduct-4-permanent-ban">4. Permanent Ban<a class="headerlink" href="#code-of-conduct-4-permanent-ban" title="Permanent link">&para;</a></h3>
<p><strong>Community Impact</strong>: Demonstrating a pattern of violation of community
standards, including sustained inappropriate behavior, harassment of an
individual, or aggression toward or disparagement of classes of individuals.</p>
<p><strong>Consequence</strong>: A permanent ban from any sort of public interaction within the
community.</p>
<h2 id="code-of-conduct-attribution">Attribution<a class="headerlink" href="#code-of-conduct-attribution" title="Permanent link">&para;</a></h2>
<p>This Code of Conduct is adapted from the <a href="https://www.contributor-covenant.org">Contributor Covenant</a>,
version 2.1, available at
<a href="https://www.contributor-covenant.org/version/2/1/code_of_conduct.html">https://www.contributor-covenant.org/version/2/1/code_of_conduct.html</a>.</p>
<p>Community Impact Guidelines were inspired by
<a href="https://github.com/mozilla/diversity">Mozilla's code of conduct enforcement ladder</a>.</p>
<p>For answers to common questions about this code of conduct, see the FAQ at
<a href="https://www.contributor-covenant.org/faq">https://www.contributor-covenant.org/faq</a>. Translations are available at
<a href="https://www.contributor-covenant.org/translations">https://www.contributor-covenant.org/translations</a>.</p></section><section class="print-page" id="style_guide" heading-number="11.3"><h1 id="style_guide-style-guide">Style guide<a class="headerlink" href="#style_guide-style-guide" title="Permanent link">&para;</a></h1>
<h2 id="style_guide-panics">Panics<a class="headerlink" href="#style_guide-panics" title="Permanent link">&para;</a></h2>
<p>Panics are not allowed, especially in code that may run on a server. Calling
<code>.unwrap()</code> is okay if it's guaranteed to be safe by previous checks or
documented invariants. For example, if a function is documented as requiring
a non-empty slice as input, it's fine to call <code>slice[0]</code> and panic.</p>
<h2 id="style_guide-markdown">Markdown<a class="headerlink" href="#style_guide-markdown" title="Permanent link">&para;</a></h2>
<p>Try to wrap at 80 columns. We don't have a formatter yet.</p></section><section class="print-page" id="design_docs" heading-number="11.4"><h1 id="design_docs-jujutsu-design-docs">Jujutsu Design Docs<a class="headerlink" href="#design_docs-jujutsu-design-docs" title="Permanent link">&para;</a></h1>
<p>Jujutsu uses Design Docs to drive technical decisions on large projects and it
is the place to discuss your proposed design or new component. It is a very
thorough process, in which the design doc must be approved before PRs for the
feature will be accepted. It shares some similarities with <a href="https://github.com/rust-lang/rfcs">Rust RFCs</a> but
mostly addresses <em>technical</em> problems and gauges the technical and social
concerns of all stakeholders.</p>
<p>So if you want to start building a native backend or the server component for
Jujutsu, you'll need to go through this process.</p>
<h2 id="design_docs-process">Process<a class="headerlink" href="#design_docs-process" title="Permanent link">&para;</a></h2>
<ol>
<li>Add a new markdown document to <code>docs/design</code>, named after your improvement
   or project.</li>
<li>Describe the current state of the world and the things you want to improve.</li>
<li>Wait for the Maintainers and Stakeholders to show up.</li>
<li>Iterate until everyone accepts the change in normal codereview fashion.</li>
</ol>
<h2 id="design_docs-blueprint-template">Blueprint (Template)<a class="headerlink" href="#design_docs-blueprint-template" title="Permanent link">&para;</a></h2>
<p>You can find the base template of a new Design Doc
<a href="#design_doc_blueprint">here</a>.</p></section><section class="print-page" id="design_doc_blueprint" heading-number="11.5"><h1 id="design_doc_blueprint-title">Title<a class="headerlink" href="#design_doc_blueprint-title" title="Permanent link">&para;</a></h1>
<blockquote>
<p>A cool name for your Project</p>
</blockquote>
<p>Author: <a href="mailto:your-name@reachable.com">Your-Name</a></p>
<blockquote>
<p>If there are multiple authors, just list them all</p>
</blockquote>
<h2 id="design_doc_blueprint-summary">Summary<a class="headerlink" href="#design_doc_blueprint-summary" title="Permanent link">&para;</a></h2>
<p>A short summary of your project/re-design/component and what problems it
addresses in about 3-10 sentences.</p>
<h2 id="design_doc_blueprint-state-of-the-feature-as-of-version-optional">State of the Feature as of <code>$VERSION</code> (optional)<a class="headerlink" href="#design_doc_blueprint-state-of-the-feature-as-of-version-optional" title="Permanent link">&para;</a></h2>
<p>The state of the feature you want to improve and where it currently falls
short. If there's nothing to compare to, leave it out.</p>
<h2 id="design_doc_blueprint-prior-work-optional">Prior work (optional)<a class="headerlink" href="#design_doc_blueprint-prior-work-optional" title="Permanent link">&para;</a></h2>
<p>Does this feature exist somewhere else and which tradeoffs it made.</p>
<blockquote>
<p>If there's no prior work, then use the related work section below.</p>
</blockquote>
<h2 id="design_doc_blueprint-goals-and-non-goals">Goals and non-goals<a class="headerlink" href="#design_doc_blueprint-goals-and-non-goals" title="Permanent link">&para;</a></h2>
<p>Direct goals of the project and features deemed not worth pursuing.</p>
<h2 id="design_doc_blueprint-overview">Overview<a class="headerlink" href="#design_doc_blueprint-overview" title="Permanent link">&para;</a></h2>
<p>A detailed overview of the project and the improvements it brings.</p>
<h3 id="design_doc_blueprint-detailed-design">Detailed Design<a class="headerlink" href="#design_doc_blueprint-detailed-design" title="Permanent link">&para;</a></h3>
<p>The place to describe all new interfaces and interactions and how it plays into
the existing code and behavior. This is the place for all nitty-gritty details
which interact with the system.</p>
<h2 id="design_doc_blueprint-alternatives-considered-optional">Alternatives considered (optional)<a class="headerlink" href="#design_doc_blueprint-alternatives-considered-optional" title="Permanent link">&para;</a></h2>
<p>Other alternatives to your suggested approach, and why they fall short.</p>
<h2 id="design_doc_blueprint-issues-addressed-optional">Issues addressed (optional)<a class="headerlink" href="#design_doc_blueprint-issues-addressed-optional" title="Permanent link">&para;</a></h2>
<p>A list of issues which are addressed by this design.</p>
<h2 id="design_doc_blueprint-related-work-optional">Related Work (optional)<a class="headerlink" href="#design_doc_blueprint-related-work-optional" title="Permanent link">&para;</a></h2>
<p>If there's a feature in another VCS which shares some similarities to your
proposed work, it belongs here. An example would be Jujutsu sparse workspaces
and Perforce client workspaces.</p>
<h2 id="design_doc_blueprint-future-possibilities">Future Possibilities<a class="headerlink" href="#design_doc_blueprint-future-possibilities" title="Permanent link">&para;</a></h2>
<p>The section for things which could be added to it or deemed out of scope during
the discussion.</p></section><section class="print-page" id="releasing" heading-number="11.6"><h1 id="releasing-how-to-do-a-release">How to do a release<a class="headerlink" href="#releasing-how-to-do-a-release" title="Permanent link">&para;</a></h1>
<h2 id="releasing-update-changelog-and-cargo-versions">Update changelog and Cargo versions<a class="headerlink" href="#releasing-update-changelog-and-cargo-versions" title="Permanent link">&para;</a></h2>
<p>Send a PR similar to https://github.com/jj-vcs/jj/pull/5215. Feel free to
copy-edit the changelog in order to:</p>
<ul>
<li>Populate "Release highlights" if relevant</li>
<li>Put more important items first so the reader doesn't miss them</li>
<li>Make items consistent when it comes to language and formatting</li>
</ul>
<p>Producing the list of contributors is a bit annoying. The current suggestion is
to run something like this:</p>
<div class="highlight"><pre><span></span><code><span class="nv">root</span><span class="o">=</span><span class="k">$(</span>jj<span class="w"> </span>log<span class="w"> </span>--no-graph<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;heads(tags(glob:&quot;v*.*.*&quot;) &amp; ::trunk())&#39;</span><span class="w"> </span>-T<span class="w"> </span><span class="s1">&#39;commit_id&#39;</span><span class="k">)</span>
gh<span class="w"> </span>api<span class="w"> </span><span class="s2">&quot;/repos/jj-vcs/jj/compare/</span><span class="nv">$root</span><span class="s2">...main&quot;</span><span class="w"> </span>--paginate<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;.commits[] | select(.author.login | endswith(&quot;[bot]&quot;) | not) | &quot;* &quot; + .commit.author.name + &quot; (@&quot; + .author.login + &quot;)&quot;&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-fu
</code></pre></div>
<p>https://docs.github.com/en/rest/commits/commits?apiVersion=2022-11-28#compare-two-commits</p>
<p>Alternatively, the list can be produced locally:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>log<span class="w"> </span>--no-graph<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;heads(tags())..main&#39;</span><span class="w"> </span>-T<span class="w"> </span><span class="s1">&#39;&quot;* &quot; ++ author ++ &quot;\n&quot;&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-fu
</code></pre></div>
<p>Then try to find the right GitHub username for each person and copy their name
and username from the GitHub page for the person
(e.g. https://github.com/martinvonz).</p>
<p>Get the PR through review and get it merged as usual.</p>
<h2 id="releasing-create-a-tag-and-a-github-release">Create a tag and a GitHub release<a class="headerlink" href="#releasing-create-a-tag-and-a-github-release" title="Permanent link">&para;</a></h2>
<ol>
<li>Go to https://github.com/jj-vcs/jj/releases and click "Draft a new release"</li>
<li>Click "Choose a tag" and enter "v0.\&lt;number&gt;.0" (e.g. "v0.26.0") to create a
   new tag</li>
<li>Click "Target", then "Recent commits", and select the commit from your merged
   PR</li>
<li>Use the name (e.g. "v0.26.0") as "Release title". Paste the changelog entries
   into the message body</li>
<li>Check "Create a discussion for this release"</li>
<li>Click "Publish release"</li>
</ol>
<h2 id="releasing-publish-the-crates-to-cratesio">Publish the crates to crates.io<a class="headerlink" href="#releasing-publish-the-crates-to-cratesio" title="Permanent link">&para;</a></h2>
<p>Go to a terminal and create a new clone of the repo <sup id="fnref:1"><a class="footnote-ref" href="#releasing-fn:1">1</a></sup>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span><span class="k">$(</span>mktemp<span class="w"> </span>-d<span class="k">)</span>
jj<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/jj-vcs/jj
<span class="nb">cd</span><span class="w"> </span>jj
jj<span class="w"> </span>new<span class="w"> </span>v0.&lt;number&gt;.0
</code></pre></div>
<p>Publish each crate:</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span><span class="nb">cd</span><span class="w"> </span>lib/proc-macros<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cargo<span class="w"> </span>publish<span class="o">)</span>
<span class="o">(</span><span class="nb">cd</span><span class="w"> </span>lib<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cargo<span class="w"> </span>publish<span class="o">)</span>
<span class="o">(</span><span class="nb">cd</span><span class="w"> </span>cli<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cargo<span class="w"> </span>publish<span class="o">)</span>
</code></pre></div>
<div class="footnote">
<hr />
<ol>
<li id="releasing-fn:1">
<p>We recommend publishing from a new clone because <code>cargo publish</code> will
  archive ignored files if they match the patterns in <code>[include]</code>
  (<a href="https://github.com/jj-vcs/jj/blob/b95628c398c6c3d11f41bdf53d0aef11f92ee96d/lib/Cargo.toml#L15-L22">example</a>),
  so it's a security risk to run it an existing clone where you may have
  left sensitive content in an ignored file.&#160;<a class="footnote-backref" href="#releasing-fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></section><section class="print-page" id="governance-temporary-voting" heading-number="11.7"><h1 id="governance-temporary-voting-getting-community-buy-in-for-working-group-proposals">Getting Community Buy-in for Working Group Proposals<a class="headerlink" href="#governance-temporary-voting-getting-community-buy-in-for-working-group-proposals" title="Permanent link">&para;</a></h1>
<h2 id="governance-temporary-voting-introduction">Introduction<a class="headerlink" href="#governance-temporary-voting-introduction" title="Permanent link">&para;</a></h2>
<p>We're introducing a temporary process to describe how we'll gain approval to
adopt permanent governance policies - basically, how we make social and
technical decisions as a community. This temporary process describes how the
governance working group can propose these policies and how community members
can influence them and vote on them. Once permanent governance policies are in
place, the temporary process will stop being used, and the permanent governance
policies will be used instead.</p>
<h2 id="governance-temporary-voting-context">Context<a class="headerlink" href="#governance-temporary-voting-context" title="Permanent link">&para;</a></h2>
<p>The governance working group was appointed by recommendation from Martin (jj's
original author and current sole maintainer), without recommendation or approval
from the broader jj community. This isn't a problem in itself - but it does
mean that the governance working group (Austin Seipp/aseipp, Waleed
Khan/arxanas, Martin von Zweigbergk/martinvonz, and Emily Shaffer/nasamuffin)
needs to get some community approval before setting policy for the entire jj
project. If we skip this step, we risk being perceived as exercising excessive
control over the project.</p>
<h2 id="governance-temporary-voting-goals-and-non-goals">Goals and Non-Goals<a class="headerlink" href="#governance-temporary-voting-goals-and-non-goals" title="Permanent link">&para;</a></h2>
<ul>
<li>This process will be used to approve things like a <code>governance.md</code> (describing
  the formal structure of governance used for this project), technical design
  approval process, and code review process.</li>
<li>This is <strong>not</strong> a process that will be used forever. It is intended as a
  temporary process, only used to approve more permanent processes and policies
  for the project.</li>
<li>This process is used to gather feedback, approval, and acceptance from
  invested jj community members. Current members of the community should be able
  to participate in voting without hardship.</li>
<li>Current community members include code committers, code reviewers, those
    providing user support, those providing quality, actionable feedback, those
    providing documentation (first-party or third-party), developers of
    jj-compatible tools and add-ons (like GUIs or IDE extensions), and those
    providing design input and feedback.<ul>
<li>If you feel that you are a member of the community but do not fit into one
    of these buckets, please reach out to one of the members of the working
    group to have this list expanded.</li>
</ul>
</li>
<li>This process <strong>is</strong> the primary way for general community members to influence
  governance policies and processes. It should invite constructive feedback and
  help us form policies that are acceptable to the jj group as a whole.</li>
<li>It's intended to meet community members where they are - on GitHub and on
    Discord, where all development occurs and most support and technical
    discussion occurs.</li>
<li>This is <strong>not</strong> a process for gaining unanimous agreement - there are too
  many of us for that to be feasible. Instead, it is a process for gaining
  widespread community approval.</li>
</ul>
<h2 id="governance-temporary-voting-process">Process<a class="headerlink" href="#governance-temporary-voting-process" title="Permanent link">&para;</a></h2>
<h3 id="governance-temporary-voting-stage-1-advance-notice-of-effort">Stage 1: Advance Notice of Effort<a class="headerlink" href="#governance-temporary-voting-stage-1-advance-notice-of-effort" title="Permanent link">&para;</a></h3>
<p>The working group lets the community know about upcoming policy drafts they're
intending to share for approval. This must happen at least a week before
entering stage 3, and ideally should happen even earlier.</p>
<p>At this time, the working group should:</p>
<ul>
<li>Describe why the working group feels this policy is needed</li>
<li>Describe the basic goals the policy should achieve</li>
<li>Describe implementation details that are being considered, if any</li>
<li>Create discussion thread on GitHub (and link to it from Discord). The GitHub
  discussion thread is the canonical thread for discussion and will be reused
  through the lifetime of a proposal as it moves through this process.</li>
</ul>
<p>At this time, the community is invited to:</p>
<ul>
<li>Recommend additional goals, or discuss nuances of the stated goals the working
  group has already shared</li>
<li>Recommend implementation details</li>
</ul>
<p>The working group will consider these recommendations in good faith, but may
choose not to adopt them.</p>
<h3 id="governance-temporary-voting-stage-2-proposal-review-period">Stage 2: Proposal Review Period<a class="headerlink" href="#governance-temporary-voting-stage-2-proposal-review-period" title="Permanent link">&para;</a></h3>
<p>This stage lasts until the working group feels major concerns have been
addressed and the proposal is ready for a vote. However, <strong>at least 72 hours</strong>
must elapse between the proposal being published and the vote starting, to allow
community members around the globe to read and comment. Typically, this stage
should last at least one week.</p>
<p>At this time, the working group should:</p>
<ul>
<li>Share the full text of the proposal as a GitHub pull request (PR)</li>
<li>Link this GitHub PR to the existing Discord notification thread and GitHub
  discussion</li>
<li>Explain how the proposal meets the goals stated in Stage 1, either within the
  proposal itself or in commentary next to the proposal</li>
</ul>
<p>At this time, the community is invited to:</p>
<ul>
<li>Share constructive recommendations in GitHub to modify the text of the
  proposal, or discuss nuances of the proposal's wording</li>
<li>Share showstopper concerns in GitHub about the proposal, including details
  about how and why the concern is especially dire</li>
</ul>
<p>Think of this like a code review; the goal of this stage is to build a proposal
that is representative of the community's will. Keep recommendations actionable
and constructive: "This clause discourages X; if we phrase it like "foo bar baz"
it could be less exclusive" is much more productive than "It's obvious that the
governance working group doesn't want X!"</p>
<p>At the discretion of the working group, but based on the outcome of the
discussion, the proposal will go to a vote <strong>or</strong> the proposal will be dropped.</p>
<h3 id="governance-temporary-voting-stage-3-proposal-voting-period">Stage 3: Proposal Voting Period<a class="headerlink" href="#governance-temporary-voting-stage-3-proposal-voting-period" title="Permanent link">&para;</a></h3>
<p>When the working group feels that major concerns have been addressed and is
happy with the text of the proposal, the working group will open voting on the
proposal.</p>
<ul>
<li>Voting occurs on GitHub using the poll feature and is advertised heavily on
  Discord during the voting period.</li>
<li>If community members want to vote but aren't able to use GitHub, they can
    message nasamuffin@ (on Discord, or nasamuffin at google dot com) with their
    vote to have it manually included. Only one working group member is listed
    in order to avoid accidental double-counting.</li>
<li>When voting against, community members should comment on the post explaining
    why and describe what change would be required for them to abstain or vote
    in favor.</li>
<li>Generally, assume that the votes may be publicly visible or may be made
    publicly visible at a later time.</li>
<li>Voting is open for at least 1 week, but may be open as long as 2 weeks when
  appropriate. After that deadline, the GitHub poll will be locked.<ul>
<li>The deadline must be announced at the beginning of the voting period -
    once voting has begun, the deadline cannot change.</li>
<li>The working group may set the voting period longer to encompass two
    weekends (for more participation around day jobs), for less urgent or more
    complex proposals, or to account for holidays during the voting period.</li>
</ul>
</li>
<li>Participants can vote in favor or against.</li>
<li>"Participants" means the group of community members as enumerated at the
    beginning of this document.</li>
</ul>
<p><strong>Proposals with 2/3 or more votes in favor at the end of the voting period will
be approved.</strong></p>
<p>After voting has concluded, either:</p>
<ul>
<li>The proposal will be implemented (if accepted)</li>
<li>The proposal may be revised and begin again at stage 2 (if rejected)</li>
<li>The proposal may be abandoned (if rejected)</li>
</ul>
<p>Deciding whether to revise or abandon is up to the discretion of the governance
working group. The working group is expected to double-check their assumption
that the goals the proposal is attempting to meet are desirable after the
proposal fails to be accepted.</p>
<h3 id="governance-temporary-voting-stage-4-implementation">Stage 4: Implementation<a class="headerlink" href="#governance-temporary-voting-stage-4-implementation" title="Permanent link">&para;</a></h3>
<p>Typically, implementation will look like merging the document with the policy
into the jj codebase and remembering to use that policy in conversations moving
forward.</p>
<p>In some cases, implementation may also involve nomination of individuals to a
group or committee. When this is necessary, expect the policy being proposed to
describe how these individuals will be nominated, both initially and moving into
the future.</p>
<p>It's possible (but unlikely) that during implementation, some obstacle will
arise that means the policy doesn't actually work. If this does happen, expect
the working group to be transparent with the community about the situation. We
may reuse some of all of this process to figure out how to move forward.</p></section><section class="print-page" id="governance-governance" heading-number="11.8"><h1 id="governance-governance-jujutsu-governance">Jujutsu Governance<a class="headerlink" href="#governance-governance-jujutsu-governance" title="Permanent link">&para;</a></h1>
<h2 id="governance-governance-overview">Overview<a class="headerlink" href="#governance-governance-overview" title="Permanent link">&para;</a></h2>
<p>Jujutsu is an open source project, led, maintained and designed for a worldwide
community. Anyone who is interested can join, contribute, and participate in the
decision-making process. This document is intended to help you understand how
you can do that.</p>
<h2 id="governance-governance-project-roles">Project roles<a class="headerlink" href="#governance-governance-project-roles" title="Permanent link">&para;</a></h2>
<p>We greatly appreciate everyone's contributions, and Jujutsu has benefited
greatly from people who shared a single idea, change, or a suggestion, without
ever becoming a regular contributor. We also want everybody to feel welcome to
share their suggestions for the project (as long as you follow the Community
Guidelines).</p>
<p>There are two special roles for participants in the Jujutsu projects:
Maintainers and Contributors.</p>
<p>The role of the Maintainer is formally defined. These are the people empowered
to collectively make final decisions about most aspects of the project. They are
expected to take community's input seriously and to aim for the benefit of the
entire community.</p>
<p>The role of a Contributor is less formal. In situations where opinions become
numerous or contentious, it is acceptable for the maintainers to assign more
weight to the voices of the more established Contributors.</p>
<h3 id="governance-governance-maintainers">Maintainers<a class="headerlink" href="#governance-governance-maintainers" title="Permanent link">&para;</a></h3>
<p><strong>Maintainers</strong> are the people who contribute, review, guide, and collectively
make decisions about the direction and scope of the project (see:
<a href="#governance-governance-decision-making">Decision Making</a>). Maintainers are elected by a
<a href="#governance-governance-adding-and-removing-maintainers">voting process</a>.</p>
<p>A typical Maintainer is not only someone who has made "large" contributions, but
someone who has shown they are continuously committed to the project and its
community. Some expected responsibilities of maintainers include (but are not
exclusively limited to):</p>
<ul>
<li>Displaying a high level of commitment to the project and its community, and
  being a role model for others.</li>
<li>Writing patches &mdash; a lot of patches, especially "glue code" or "grunt
  work" or general "housekeeping"; fixing bugs, ensuring documentation is always
  high quality, consistent UX design, improving processes, making judgments on
  dependencies, handling security vulnerabilities, and so on and so forth.</li>
<li>Reviewing code submitted by others &mdash; with an eye to maintainability,
  performance, code quality, and "style" (fitting in with the project).</li>
<li>Participating in design discussions, especially with regards to architecture
  or long-term vision.</li>
<li>Ensuring the community remains a warm and welcoming place, to new and veteran
  members alike.</li>
</ul>
<p>This is not an exhaustive list, nor is it intended that every Maintainer does
each and every one of these individual tasks to equal amounts. Rather this is
only a guideline for what Maintainers are expected to conceptually do.</p>
<p>In short, Maintainers are the outwardly visible stewards of the project.</p>
<h4 id="governance-governance-current-list-of-maintainers">Current list of Maintainers<a class="headerlink" href="#governance-governance-current-list-of-maintainers" title="Permanent link">&para;</a></h4>
<p>The current list of Maintainers:</p>
<ul>
<li>Austin Seipp (@thoughtpolice)</li>
<li>Ilya Grigoriev (@ilyagr)</li>
<li>Martin von Zweigbergk (@martinvonz)</li>
<li>Waleed Khan (@arxanas)</li>
<li>Yuya Nishihara (@yuja)</li>
</ul>
<h3 id="governance-governance-contributors">Contributors<a class="headerlink" href="#governance-governance-contributors" title="Permanent link">&para;</a></h3>
<p>We consider contributors to be active participants in the project and community
who are <em>not</em> maintainers. These are people who might:</p>
<ul>
<li>Help users by answering questions</li>
<li>Participating in lively and respectful discussions across various channels</li>
<li>Submit high-quality bug reports, reproduce reported bugs, and verifying fixes</li>
<li>Submit patches or pull requests</li>
<li>Provide reviews and input on others' pull requests</li>
<li>Help with testing and quality assurance</li>
<li>Submit feedback about planned features, use cases, or bugs</li>
</ul>
<p>We essentially define them as <strong>people who actively participate in the
project</strong>. Examples of things that would <em>not</em> make you a contributor are:</p>
<ul>
<li>Submitting a single bug report and never returning</li>
<li>Writing blog posts or other evangelism</li>
<li>Using the software in production</li>
<li>Forking the project and maintaining your own version</li>
<li>Writing a third-party tool or add-on</li>
</ul>
<p>While these are all generally quite valuable, we don't consider these ongoing
contributions to the codebase or project itself, and on their own do not
constitute "active participation".</p>
<h2 id="governance-governance-processes">Processes<a class="headerlink" href="#governance-governance-processes" title="Permanent link">&para;</a></h2>
<p>For the purposes of making decisions across the project, the following processes
are defined.</p>
<h3 id="governance-governance-decision-making">Decision-Making<a class="headerlink" href="#governance-governance-decision-making" title="Permanent link">&para;</a></h3>
<p>The person proposing a decision to be made (i.e. technical, project direction,
etc.) can offer a proposal, along with a 2-to-4 week deadline for discussion.
During this time, Maintainers may participate with a vote of:</p>
<p>A) Support B) Reject C) Abstain</p>
<p>Each Maintainer gets one vote. The total number of "participating votes" is the
number of Maintainer votes which are not Abstain. The proposal is accepted when
more than half of the participating votes are Support.</p>
<p>In the event that a decision is reached before the proposed timeline, said
proposal can move on and be accepted immediately. In the event no consensus is
reached, a proposal may be re-submitted later on.</p>
<p>This document itself is subject to the Decision-Making process by the existing
set of Maintainers.</p>
<h3 id="governance-governance-adding-and-removing-maintainers">Adding and Removing Maintainers<a class="headerlink" href="#governance-governance-adding-and-removing-maintainers" title="Permanent link">&para;</a></h3>
<p>An active Contributor may, at any given time, nominate themselves or another
Contributor to become a Maintainer. This process is purely optional and no
Contributor is expected to do so; however, self-nomination is encouraged for
active participants. A vote and discussion by the existing Maintainers will be
used to decide the outcome.</p>
<p>Note that Contributors should demonstrate a high standard of continuous
participation to become a Maintainer; the upper limit on the number of
Maintainers is practically bounded, and so rejection should be considered as a
real possibility. As the scope of the project changes, this limit may increase,
but it is fundamentally fluid. (If you are unsure, you are free to privately ask
existing Maintainers before self-nominating if there is room.)</p>
<p>A Maintainer may, at any time, cede their responsibility and step down without a
vote.</p>
<p>A Maintainer can be removed by other Maintainers, subject to a vote of at-least
a 2/3rds majority from the existing Maintainer group (excluding the vote of the
Maintainer in question). This can be due to lack of participation or conduct
violations, among other things. Note that Maintainers are subject to a higher
set of behavioral and communicative standards than average contributor or
participant.</p></section></section>
                    <section class='print-page md-section' id='section-12' heading-number='12'>
                        <h1>Design docs<a class='headerlink' href='#section-12' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="design-git-submodules" heading-number="12.1"><h1 id="design-git-submodules-git-submodules">Git submodules<a class="headerlink" href="#design-git-submodules-git-submodules" title="Permanent link">&para;</a></h1>
<p>This is an aspirational document that describes how jj <em>will</em> support Git
submodules. Readers are assumed to have some familiarity with Git and Git
submodules.</p>
<p>This document is a work in progress; submodules are a big feature, and relevant
details will be filled in incrementally.</p>
<h2 id="design-git-submodules-objective">Objective<a class="headerlink" href="#design-git-submodules-objective" title="Permanent link">&para;</a></h2>
<p>This proposal aims to replicate the workflows users are used to with Git
submodules, e.g.:</p>
<ul>
<li>Cloning submodules</li>
<li>Making new submodule commits and updating the superproject</li>
<li>Fetching and pushing updates to the submodule's remote</li>
<li>Viewing submodule history</li>
</ul>
<p>When it is convenient, this proposal will also aim to make submodules easier to
use than Git's implementation.</p>
<h3 id="design-git-submodules-non-goals">Non-goals<a class="headerlink" href="#design-git-submodules-non-goals" title="Permanent link">&para;</a></h3>
<ul>
<li>Non-Git 'submodules' (e.g. native jj submodules, other VCSes)</li>
<li>Non-Git backends (e.g. Google internal backend)</li>
<li>Changing how Git submodules are implemented in Git</li>
</ul>
<h2 id="design-git-submodules-background">Background<a class="headerlink" href="#design-git-submodules-background" title="Permanent link">&para;</a></h2>
<p>We mainly want to support Git submodules for feature parity, since Git
submodules are a standard feature in Git and are popular enough that we have
received user requests for them. Secondarily (and distantly so), Git submodules
are notoriously difficult to use, so there is an opportunity to improve the UX
over Git's implementation.</p>
<h3 id="design-git-submodules-intro-to-git-submodules">Intro to Git Submodules<a class="headerlink" href="#design-git-submodules-intro-to-git-submodules" title="Permanent link">&para;</a></h3>
<p><a href="https://git-scm.com/docs/gitsubmodules">Git submodules</a> are a feature of Git
that allow a repository (submodule) to be embedded inside another repository
(the superproject). Notably, a submodule is a full repository, complete with its
own index, object store and ref store. It can be interacted with like any other
repository, regardless of the superproject.</p>
<p>In a superproject commit, submodule information is captured in two places:</p>
<ul>
<li>
<p>A <code>gitlink</code> entry in the commit's tree, where the value of the <code>gitlink</code> entry
  is the submodule commit id. This tells Git what to populate in the working
  tree.</p>
</li>
<li>
<p>A top level <code>.gitmodules</code> file. This file is in Git's config syntax and
  entries take the form <code>submodule.&lt;submodule-name&gt;.*</code>. These include many
  settings about the submodules, but most importantly:</p>
<ul>
<li>
<p><code>submodule&lt;submodule-name&gt;.path</code> contains the path from the root of the tree
  to the <code>gitlink</code> being described.</p>
</li>
<li>
<p><code>submodule&lt;submodule-name&gt;.url</code> contains the url to clone the submodule
  from.</p>
</li>
</ul>
</li>
</ul>
<p>In the working tree, Git notices the presence of a submodule by the <code>.git</code> entry
(signifying the root of a Git repository working tree). This is either the
submodule's actual Git directory (an "old-form" submodule), or a <code>.git</code> file
pointing to <code>&lt;superproject-git-directory&gt;/modules/&lt;submodule-name&gt;</code>. The latter
is sometimes called the "absorbed form", and is Git's preferred mode of
operation.</p>
<h2 id="design-git-submodules-roadmap">Roadmap<a class="headerlink" href="#design-git-submodules-roadmap" title="Permanent link">&para;</a></h2>
<p>Git submodules should be implemented in an order that supports an increasing set
of workflows, with the goal of getting feedback early and often. When support is
incomplete, jj should not crash, but instead provide fallback behavior and warn
the user where needed.</p>
<p>The goal is to land good support for pure Jujutsu repositories, while colocated
repositories will be supported when convenient.</p>
<p>This section should be treated as a set of guidelines, not a strict order of
work.</p>
<h3 id="design-git-submodules-phase-1-readonly-submodules">Phase 1: Readonly submodules<a class="headerlink" href="#design-git-submodules-phase-1-readonly-submodules" title="Permanent link">&para;</a></h3>
<p>This includes work that inspects submodule contents but does not create new
objects in the submodule. This requires a way to store submodules in a jj
repository that supports readonly operations.</p>
<h4 id="design-git-submodules-outcomes">Outcomes<a class="headerlink" href="#design-git-submodules-outcomes" title="Permanent link">&para;</a></h4>
<ul>
<li>Submodules can be cloned anew</li>
<li>New submodule commits can be fetched</li>
<li>Submodule history and branches can be viewed</li>
<li>Submodule contents are populated in the working copy</li>
<li>Superproject gitlink can be updated to an existing submodule commit</li>
<li>Conflicts in the superproject gitlink can be resolved to an existing submodule
  commit</li>
</ul>
<h3 id="design-git-submodules-phase-2-snapshotting-new-changes">Phase 2: Snapshotting new changes<a class="headerlink" href="#design-git-submodules-phase-2-snapshotting-new-changes" title="Permanent link">&para;</a></h3>
<p>This allows a user to write new contents to a submodule and its remote.</p>
<h4 id="design-git-submodules-outcomes_1">Outcomes<a class="headerlink" href="#design-git-submodules-outcomes_1" title="Permanent link">&para;</a></h4>
<ul>
<li>Changes in the working copy can be recorded in a submodule commit</li>
<li>Submodule branches can be modified</li>
<li>Submodules and their branches can be pushed to their remote</li>
</ul>
<h3 id="design-git-submodules-phase-3-mergingrebasingconflicts">Phase 3: Merging/rebasing/conflicts<a class="headerlink" href="#design-git-submodules-phase-3-mergingrebasingconflicts" title="Permanent link">&para;</a></h3>
<p>This allows merging and rebasing of superproject commits in a content-aware way
(in contrast to Git, where only the gitlink commit ids are compared), as well as
workflows that make resolving conflicts easy and sensible.</p>
<p>This can be done in tandem with Phase 2, but will likely require a significant
amount of design work on its own.</p>
<h4 id="design-git-submodules-outcomes_2">Outcomes<a class="headerlink" href="#design-git-submodules-outcomes_2" title="Permanent link">&para;</a></h4>
<ul>
<li>Merged/rebased submodules result in merged/rebased working copy content</li>
<li>Merged/rebased working copy content can be committed, possibly by creating
  sensible merged/rebased submodule commits</li>
<li>Merge/rebase between submodule and non-submodule gives a sensible result</li>
<li>Merge/rebase between submodule A and submodule B gives a sensible result</li>
</ul>
<h3 id="design-git-submodules-phase-an-ideal-world">Phase ?: An ideal world<a class="headerlink" href="#design-git-submodules-phase-an-ideal-world" title="Permanent link">&para;</a></h3>
<p>I.e. outcomes we would like to see if there were no constraints whatsoever.</p>
<ul>
<li>Rewriting submodule commits rewrites descendants correctly and updates
  superproject gitlinks.</li>
<li>Submodule conflicts automatically resolve to the 'correct' submodule commits,
  e.g. a merge between superproject commits creating a merge of the submodule
  commits.</li>
<li>Nested submodules are as easy to work with as non-nested submodules.</li>
<li>The operation log captures changes in the submodule.</li>
</ul>
<h2 id="design-git-submodules-design">Design<a class="headerlink" href="#design-git-submodules-design" title="Permanent link">&para;</a></h2>
<h3 id="design-git-submodules-guiding-principles">Guiding principles<a class="headerlink" href="#design-git-submodules-guiding-principles" title="Permanent link">&para;</a></h3>
<p>TODO</p>
<h3 id="design-git-submodules-storing-submodules">Storing submodules<a class="headerlink" href="#design-git-submodules-storing-submodules" title="Permanent link">&para;</a></h3>
<p>Possible approaches under discussion. See
<a href="#design-git-submodule-storage">./git-submodule-storage.md</a>.</p>
<h3 id="design-git-submodules-snapshotting-new-submodule-changes">Snapshotting new submodule changes<a class="headerlink" href="#design-git-submodules-snapshotting-new-submodule-changes" title="Permanent link">&para;</a></h3>
<p>TODO</p>
<h3 id="design-git-submodules-mergingrebasing-with-submodules">Merging/rebasing with submodules<a class="headerlink" href="#design-git-submodules-mergingrebasing-with-submodules" title="Permanent link">&para;</a></h3>
<p>TODO</p></section><section class="print-page" id="design-git-submodule-storage" heading-number="12.2"><h1 id="design-git-submodule-storage-git-submodule-storage">Git submodule storage<a class="headerlink" href="#design-git-submodule-storage-git-submodule-storage" title="Permanent link">&para;</a></h1>
<h2 id="design-git-submodule-storage-objective">Objective<a class="headerlink" href="#design-git-submodule-storage-objective" title="Permanent link">&para;</a></h2>
<p>Decide what approach(es) to Git submodule storage we should pursue.
The decision will be recorded in <a href="#design-git-submodules">./git-submodules.md</a>.</p>
<h2 id="design-git-submodule-storage-use-cases-to-consider">Use cases to consider<a class="headerlink" href="#design-git-submodule-storage-use-cases-to-consider" title="Permanent link">&para;</a></h2>
<p>The submodule storage format should support the workflows specified in the
<a href="#design-git-submodules">submodules roadmap</a>. It should be obvious how "Phase 1"
requirements will be supported, and we should have an idea of how "Phases 2,3,X"
might be supported.</p>
<p>Notable use cases and workflows are noted below.</p>
<h3 id="design-git-submodule-storage-fetching-submodule-commits">Fetching submodule commits<a class="headerlink" href="#design-git-submodule-storage-fetching-submodule-commits" title="Permanent link">&para;</a></h3>
<p>Git's protocol is designed for communicating between copies of the same
repository. Notably, a Git fetch calculates the list of required objects by
performing reachability checks between the refs on the local and the remote
side. We should expect that this will only work well if the submodule repository
is stored as a local Git repository.</p>
<p>Rolling our own Git fetch is too complex to be worth the effort.</p>
<h3 id="design-git-submodule-storage-jj-op-restore-and-operation-log-format">"jj op restore" and operation log format<a class="headerlink" href="#design-git-submodule-storage-jj-op-restore-and-operation-log-format" title="Permanent link">&para;</a></h3>
<p>We want <code>jj op restore</code> to restore to an "expected" state in the submodule.
There is a potential distinction between running <code>jj op restore</code> in the
superproject vs in the submodule, and the expected behavior may be different in
each case, e.g. in the superproject, it might be enough to restore the submodule
working copy, but in the submodule, refs also need to be restored.</p>
<p>Currently, the operation log only references objects and refs in the
superproject, so it is likely that proposed approaches will need to extend this
format. It is also worth considering that submodules may be added, updated or
removed in superproject commits, thus the list of submodules is likely to change
over the repository's lifetime.</p>
<h3 id="design-git-submodule-storage-nested-submodules">Nested submodules<a class="headerlink" href="#design-git-submodule-storage-nested-submodules" title="Permanent link">&para;</a></h3>
<p>Git submodules may contain submodules themselves, so our chosen storage schemes
should support that.</p>
<p>We should consider limiting the recursion depth to avoid nasty edge cases (e.g.
cyclical submodules.) that might surprise users.</p>
<h3 id="design-git-submodule-storage-supporting-future-extensions">Supporting future extensions<a class="headerlink" href="#design-git-submodule-storage-supporting-future-extensions" title="Permanent link">&para;</a></h3>
<p>There are certain extensions we may want to make in the future, but we don't
have a timeline for them today. Proposed approaches should take these
extensions into account (e.g. the approach should be theoretically extensible),
but a full proposal for implementing them is not necessary.</p>
<p>These extensions are:</p>
<ul>
<li>Non-git subrepos</li>
<li>Colocated Git repos</li>
<li>The superproject using a non-git backend</li>
</ul>
<h2 id="design-git-submodule-storage-proposed-design">Proposed design<a class="headerlink" href="#design-git-submodule-storage-proposed-design" title="Permanent link">&para;</a></h2>
<p>Git submodules will be stored as full jj repos. In the code, jj commands will
only interact with the submodule's repo as an entire unit, e.g. it cannot query
the submodule's commit backend directly. A well-abstracted submodule will extend
well to non-git backends and non-git subrepos.</p>
<p>The main challenge with this approach is that the submodule repo can be in a
state that is internally valid (when considering only the submodule's repo), but
invalid when considering the superproject-submodule system. This will be managed
by requiring all submodule interactions go through the superproject so that
superproject-submodule coordination can occur. For example, jj will not allow
the user to work on the submodule's repo without going through the superproject
(unlike Git).</p>
<p>The notable workflows could be addressed like so:</p>
<h3 id="design-git-submodule-storage-fetching-submodule-commits_1">Fetching submodule commits<a class="headerlink" href="#design-git-submodule-storage-fetching-submodule-commits_1" title="Permanent link">&para;</a></h3>
<p>The submodule would fetch using the equivalent of <code>jj git fetch</code>. It remains to
be decided how a "recursive" fetch should work, especially if a newly fetched
superproject commit references an unfetched submodule commit. A reasonable
approximation would be to fetch all branches in the submodule, and then, if the
submodule commit is still missing, gracefully handle it.</p>
<h3 id="design-git-submodule-storage-jj-op-restore-and-operation-log-format_1">"jj op restore" and operation log format<a class="headerlink" href="#design-git-submodule-storage-jj-op-restore-and-operation-log-format_1" title="Permanent link">&para;</a></h3>
<p>As full repos, each submodule will have its own operation log. We will continue
to use the existing operation log format, where each operation log tracks their
own repo's commits. As commands are run in the superproject, corresponding
commands will be run in the submodule as necessary, e.g. checking out a
superproject commit will cause a submodule commit to also be checked out.</p>
<p>Since there is no association between a superproject operation and a submodule
operation, <code>jj op restore</code> in the superproject will not restore the submodule to
a previous operation. Instead, the appropriate submodule operation(s) will be
created. This is sufficient to preserve the superproject-submodule relationship;
it precludes "recursive" restore (e.g. restoring branches in the superproject
and submodules) but it seems unlikely that we will need such a thing.</p>
<h3 id="design-git-submodule-storage-nested-submodules_1">Nested submodules<a class="headerlink" href="#design-git-submodule-storage-nested-submodules_1" title="Permanent link">&para;</a></h3>
<p>Since submodules are full repos, they can contain submodules themselves. Nesting
is unlikely to complicate any of the core features, since the top-level
superproject/submodule relationship is almost identical to the submodule/nested
submodule relationship.</p>
<h3 id="design-git-submodule-storage-extending-to-colocated-git-repos">Extending to colocated Git repos<a class="headerlink" href="#design-git-submodule-storage-extending-to-colocated-git-repos" title="Permanent link">&para;</a></h3>
<p>Git expects submodules to be in <code>.git/modules</code>, so it will not understand this
storage format. To support colocated Git repos, we will have to change Git to
allow a submodule's gitdir to be in an alternate location (e.g. we could add a
new <code>submodule.&lt;name&gt;.gitdir</code> config option). This is a simple change, so it
should be feasible.</p>
<h2 id="design-git-submodule-storage-alternatives-considered">Alternatives considered<a class="headerlink" href="#design-git-submodule-storage-alternatives-considered" title="Permanent link">&para;</a></h2>
<h3 id="design-git-submodule-storage-git-repos-in-the-main-git-backend">Git repos in the main Git backend<a class="headerlink" href="#design-git-submodule-storage-git-repos-in-the-main-git-backend" title="Permanent link">&para;</a></h3>
<p>Since the Git backend contains a Git repository, an 'obvious' default would be
to store them in the Git superproject the same way Git does, i.e. in
<code>.git/modules</code>. Since Git submodules are full repositories that can have
submodules, this storage scheme naturally extends to nested submodules.</p>
<p>Most of the work in storing submodules and querying them would be well-isolated
to the Git backend, which gives us a lot of flexibility to make changes without
affecting the rest of jj. However, the operation log will need a significant
rework since it isn't designed to reference submodules, and handling edge cases
(e.g. a submodule being added/removed, nested submodules) will be tricky.</p>
<p>This is rejected because handling that operation log complexity isn't worth it
when very little of the work extends to non-Git backends.</p>
<h3 id="design-git-submodule-storage-store-git-submodules-as-alternate-git-backends">Store Git submodules as alternate Git backends<a class="headerlink" href="#design-git-submodule-storage-store-git-submodules-as-alternate-git-backends" title="Permanent link">&para;</a></h3>
<p>Teach jj to use multiple commit backends and store Git submodules as Git
backends. Since submodules are separate from the 'main' backend, a repository
can use whatever backend it wants as its 'main' one, while still having Git
submodules in the 'alternate' Git backends.</p>
<p>This approach extends fairly well to non-Git submodules (which would be stored
in non-Git commit backends). However, this requires significantly reworking the
operation log to account for multiple commit backends. It is also not clear how
nested submodules will be supported since there isn't an obvious way to
represent a nested submodule's relationship to its superproject.</p></section><section class="print-page" id="design-run" heading-number="12.3"><h1 id="design-run-introducing-jj-run">Introducing JJ run<a class="headerlink" href="#design-run-introducing-jj-run" title="Permanent link">&para;</a></h1>
<p>Authors: <a href="mailto:philipmetzger@bluewin.ch">Philip Metzger</a>, <a href="mailto:martinvonz@google.com">Martin von Zweigberk</a>, <a href="mailto:hooper@google.com">Danny Hooper</a>, <a href="mailto:me@waleedkhan.name">Waleed Khan</a></p>
<p>Initial Version, 10.12.2022 (view full history <a href="https://docs.google.com/document/d/14BiAoEEy_e-BRPHYpXRFjvHMfgYVKh-pKWzzTDi-v-g/edit">here</a>)</p>
<p><strong>Summary:</strong> This Document documents the design of a new <code>run</code> command for
Jujutsu which will be used to seamlessly integrate with build systems, linters
and formatters. This is achieved by running a user-provided command or script
across multiple revisions. For more details, read the
<a href="#design-run-use-cases-of-jj-run">Use-Cases of jj run</a>.</p>
<h2 id="design-run-preface">Preface<a class="headerlink" href="#design-run-preface" title="Permanent link">&para;</a></h2>
<p>The goal of this Design Document is to specify the correct behavior of <code>jj run</code>.
The points we decide on here I (Philip Metzger) will try to implement. There
exists some prior work in other DVCS:</p>
<ul>
<li><code>git test</code>: part of <a href="https://github.com/arxanas/git-branchless">git-branchless</a>. Similar to this proposal for <code>jj run</code>.</li>
<li><code>hg run</code>: Google's internal Mercurial extension. Similar to this proposal for
<code>jj run</code>.
Details not available.</li>
<li><code>hg fix</code>: Google's open source Mercurial extension: <a href="https://repo.mercurial-scm.org/hg/file/tip/hgext/fix.py">source code</a>. A
more specialized approach to rewriting file content without full context of the
working directory.</li>
<li><code>git rebase -x</code>: runs commands opportunistically as part of rebase.</li>
<li><code>git bisect run</code>: run a command to determine which commit introduced a bug.</li>
</ul>
<h2 id="design-run-context-and-scope">Context and Scope<a class="headerlink" href="#design-run-context-and-scope" title="Permanent link">&para;</a></h2>
<p>The initial need for some kind of command runner integrated in the VCS, surfaced
in a <a href="https://github.com/jj-vcs/jj/issues/405">github discussion</a>. In a <a href="https://discord.com/channels/968932220549103686/969829516539228222/1047958933161119795">discussion on discord</a> about
the git-hook model, there was consensus about not repeating their mistakes.</p>
<p>For <code>jj run</code> there is prior art in Mercurial, git branchless and Google's
internal Mercurial. Currently git-branchless <code>git test</code> and <code>hg fix</code> implement
some kind of command runner. The Google internal <code>hg run</code> works in conjunction
with CitC (Clients in the Cloud) which allows it to lazily apply the current
command to any affected file. Currently no open-source Jujutsu backend (Git,
Simple) has a fancy virtual filesystem supporting it, so we can't apply this
optimization. We could do the same once we have an implementation of the working
copy based on a virtual file system. Until then, we have to run the commands in
regular local-disk working copies.</p>
<h2 id="design-run-goals-and-non-goals">Goals and Non-Goals<a class="headerlink" href="#design-run-goals-and-non-goals" title="Permanent link">&para;</a></h2>
<h3 id="design-run-goals">Goals<a class="headerlink" href="#design-run-goals" title="Permanent link">&para;</a></h3>
<ul>
<li>We should be able to apply the command to any revision, published or unpublished.</li>
<li>We should be able to parallelize running the actual command, while preserving a
good console output.</li>
<li>The run command should be able to work in any commit, the working-copy commit
itself or any other commit.</li>
<li>There should exist some way to signal hard failure.</li>
<li>The command should build enough infrastructure for <code>jj test</code>, <code>jj fix</code> and
<code>jj format</code>.</li>
<li>The main goal is to be good enough, as we can always expand the functionality
in the future.</li>
</ul>
<h3 id="design-run-non-goals">Non-Goals<a class="headerlink" href="#design-run-non-goals" title="Permanent link">&para;</a></h3>
<ul>
<li>While we should build a base for <code>jj test</code>, <code>jj format</code> and <code>jj fix</code>, we
shouldn't mash their use-cases into <code>jj run</code>.</li>
<li>The command shouldn't be too smart, as too many assumptions about workflows
makes the command confusing for users.</li>
<li>The smart caching of outputs, as user input commands can be unpredictable.
makes the command confusing for users.</li>
<li>Avoid the smart caching of outputs, as user input commands can be
unpredictable.</li>
<li>Fine grained user facing configuration, as it's unwarranted complexity.</li>
<li>A <code>fix</code> subcommand as it cuts too much design space.</li>
</ul>
<h2 id="design-run-use-cases-of-jj-run">Use-Cases of jj run<a class="headerlink" href="#design-run-use-cases-of-jj-run" title="Permanent link">&para;</a></h2>
<p><strong>Linting and Formatting:</strong></p>
<ul>
<li><code>jj run 'pre-commit run' -r $revset</code></li>
<li><code>jj run 'cargo clippy' -r $revset</code></li>
<li><code>jj run 'cargo +nightly fmt'</code></li>
</ul>
<p><strong>Large scale changes across repositories, local and remote:</strong></p>
<ul>
<li><code>jj run 'sed /some/test/' -r 'mine() &amp; ~remote_bookmarks(exact:"origin")'</code></li>
<li><code>jj run '$rewrite-tool' -r '$revset'</code></li>
</ul>
<p><strong>Build systems:</strong></p>
<ul>
<li><code>jj run 'bazel build //some/target:somewhere'</code></li>
<li><code>jj run 'ninja check-lld'</code></li>
</ul>
<p>Some of these use-cases should get a specialized command, as this allows
further optimization. A command could be <code>jj format</code>, which runs a list of
formatters over a subset of a file in a revision. Another command could be
<code>jj fix</code>, which runs a command like <code>rustfmt --fix</code> or <code>cargo clippy --fix</code> over
a subset of a file in a revision.</p>
<h2 id="design-run-design">Design<a class="headerlink" href="#design-run-design" title="Permanent link">&para;</a></h2>
<h3 id="design-run-base-design">Base Design<a class="headerlink" href="#design-run-base-design" title="Permanent link">&para;</a></h3>
<p>All the work will be done in the <code>.jj/</code> directory. This allows us to hide all
complexity from the users, while preserving the user's current workspace.</p>
<p>We will copy the approach from git-branchless's <code>git test</code> of creating a
temporary working copy for each parallel command. The working copies will be
reused between <code>jj run</code> invocations. They will also be reused within <code>jj run</code>
invocation if there are more commits to run on than there are parallel jobs.</p>
<p>We will leave ignored files in the temporary directory between runs. That
enables incremental builds (e.g. by letting cargo reuse its <code>target/</code>
directory). However, it also means that runs potentially become less
reproducible. We will provide a flag for removing ignored files from the
temporary working copies to address that.</p>
<p>Another problem with leaving ignored files in the temporary directories is that
they take up space. That is especially problematic in the case of cargo (the
<code>target/</code> directory often takes up tens of GBs). The same flag for cleaning up
ignored files can be used to address that. We may want to also have a flag for
cleaning up temporary working copies <em>after</em> running the command.</p>
<p>An early version of the command will directly use <a href="https://github.com/jj-vcs/jj/blob/af85f552b676d66ed0e9ae0d401cd0c4ffbbeb21/lib/src/working_copy.rs#L117">Treestate</a> to
to manage the temporary working copies. That means that running <code>jj</code> inside the
temporary working copies will not work . We can later extend that to use a full
<a href="https://github.com/jj-vcs/jj/blob/af85f552b676d66ed0e9ae0d401cd0c4ffbbeb21/lib/src/workspace.rs#L54">Workspace</a>. To prevent operations in the working copies from
impacting the repo, we can use a separate <a href="https://github.com/jj-vcs/jj/blob/main/lib/src/op_heads_store.rs">OpHeadsStore</a> for it.</p>
<h3 id="design-run-modifying-the-working-copy">Modifying the Working Copy<a class="headerlink" href="#design-run-modifying-the-working-copy" title="Permanent link">&para;</a></h3>
<p>Since the subprocesses will run in temporary working copies, they
won't interfere with the user's working copy. The user can therefore continue
to work in it while <code>jj run</code> is running.</p>
<p>We want subprocesses to be able to make changes to the repo by updating their
assigned working copy. Let's say the user runs <code>jj run</code> on just commits A and
B, where B's parent is A. Any changes made on top of A would be squashed into
A, forming A'. Similarly B' would be formed by squasing it into B. We can then
either do a normal rebase of B' onto A', or we can simply update its parent to
A'. The former is useful, e.g. when the subprocess only makes a partial update
of the tree based on the parent commit. In addition to these two modes, we may
want to have an option to ignore any changes made in the subprocess's working
copy.</p>
<h3 id="design-run-modifying-the-repo">Modifying the Repo<a class="headerlink" href="#design-run-modifying-the-repo" title="Permanent link">&para;</a></h3>
<p>Once we give the subprocess access to a fork of the repo via separate
<a href="https://github.com/jj-vcs/jj/blob/main/lib/src/op_heads_store.rs">OpHeadsStore</a>, it will be able to create new operations in its fork.
If the user runs <code>jj run -r foo</code> and the subprocess checks out another commit,
it's not clear what that should do. We should probably just verify that the
working-copy commit's parents are unchanged after the subprocess returns. Any
operations created by the subprocess will be ignored.</p>
<h3 id="design-run-rewriting-the-revisions">Rewriting the revisions<a class="headerlink" href="#design-run-rewriting-the-revisions" title="Permanent link">&para;</a></h3>
<p>Like all commands, <code>jj run</code> will refuse to rewrite public/immutable commits.
For private/unpublished revisions, we either amend or reparent the changes,
which are available as command options.</p>
<h2 id="design-run-execution-orderparallelism">Execution order/parallelism<a class="headerlink" href="#design-run-execution-orderparallelism" title="Permanent link">&para;</a></h2>
<p>It may be useful to execute commands in topological order. For example,
commands with costs proportional to incremental changes, like build systems.
There may also be other relevant heuristics, but topological order is an easy
and effective way to start.</p>
<p>Parallel execution of commands on different commits may choose to schedule
commits to still reduce incremental changes in the working copy used by each
execution slot/"thread". However, running the command on all commits
concurrently should be possible if desired.</p>
<p>Executing commands in topological order allows for more meaningful use of any
potential features that stop execution "at the first failure". For example,
when running tests on a chain of commits, it might be useful to proceed in
topological/chronological order, and stop on the first failure, because it
might imply that the remaining executions will be undesirable because they will
also fail.</p>
<h2 id="design-run-dealing-with-failure">Dealing with failure<a class="headerlink" href="#design-run-dealing-with-failure" title="Permanent link">&para;</a></h2>
<p>It will be useful to have multiple strategies to deal with failures on a single
or multiple revisions. The reason for these strategies is to allow customized
conflict handling. These strategies then can be exposed in the ui with a
matching option.</p>
<p><strong>Continue:</strong> If any subprocess fails, we will continue the work on child
revisions. Notify the user on exit about the failed revisions.</p>
<p><strong>Stop:</strong> Signal a fatal failure and cancel any scheduled work that has not
yet started running, but let any already started subprocess finish. Notify the
user about the failed command and display the generated error from the
subprocess.</p>
<p><strong>Fatal:</strong> Signal a fatal failure and immediately stop processing and kill any
running processes. Notify the user that we failed to apply the command to the
specific revision.</p>
<p>We will leave any affected commit in its current state, if any subprocess fails.
This allows us to provide a better user experience, as leaving revisions in an
undesirable state, e.g partially formatted, may confuse users.</p>
<h2 id="design-run-resource-constraints">Resource constraints<a class="headerlink" href="#design-run-resource-constraints" title="Permanent link">&para;</a></h2>
<p>It will be useful to constrain the execution to prevent resource exhaustion.
Relevant resources could include:</p>
<ul>
<li>CPU and memory available on the machine running the commands. <code>jj run</code> can
provide some simple mitigations like limiting parallelism to "number of CPUs"
by default, and limiting parallelism by dividing "available memory" by some
estimate or measurement of per-invocation memory use of the commands.</li>
<li>External resources that are not immediately known to jj. For example,
commands run in parallel may wish to limit the total number of connections
to a server. We might choose to defer any handling of this to the
implementation of the command being invoked, instead of trying to
communicate that information to jj.</li>
</ul>
<h2 id="design-run-command-options">Command Options<a class="headerlink" href="#design-run-command-options" title="Permanent link">&para;</a></h2>
<p>The base command of any jj command should be usable. By default <code>jj run</code> works
on the <code>@</code> the current working copy.</p>
<ul>
<li>--command, explicit name of the first argument</li>
<li>-x, for git compatibility (may alias another command)</li>
<li>-j, --jobs, the amount of parallelism to use</li>
<li>-k, --keep-going, continue on failure (may alias another command)</li>
<li>--show, display the diff for an affected revision</li>
<li>--dry-run, do the command execution without doing any work, logging all
intended files and arguments</li>
<li>--rebase, rebase all parents on the consulitng diff (may alias another
command)</li>
<li>--reparent, change the parent of an effected revision to the new change
(may alias another command)</li>
<li>--clean, remove existing workspaces and remove the ignored files</li>
<li>--readonly, ignore changes across multiple run invocations</li>
<li>--error-strategy=<code>continue|stop|fatal</code>, see <a href="#design-run-dealing-with-failure">Dealing with failure</a></li>
</ul>
<h3 id="design-run-integrating-with-other-commands">Integrating with other commands<a class="headerlink" href="#design-run-integrating-with-other-commands" title="Permanent link">&para;</a></h3>
<p><code>jj log</code>: No special handling needed
<code>jj diff</code>: No special handling needed
<code>jj st</code>: For now reprint the final output of <code>jj run</code>
<code>jj op log</code>: No special handling needed, but awaits further discussion in
<a href="https://github.com/jj-vcs/jj/issues/963">#963</a>
<code>jj undo/jj op undo</code>: No special handling needed</p>
<h2 id="design-run-open-points">Open Points<a class="headerlink" href="#design-run-open-points" title="Permanent link">&para;</a></h2>
<p>Should the command be working copy backend specific?
How do we manage the Processes which the command will spawn?
Configuration options, User and Repository Wide?</p>
<h2 id="design-run-future-possibilities">Future possibilities<a class="headerlink" href="#design-run-future-possibilities" title="Permanent link">&para;</a></h2>
<ul>
<li>We could rewrite the file in memory, which is a neat optimization</li>
<li>Exposing some internal state, to allow preciser resource constraints</li>
<li>Integration options for virtual filesystems, which allow them to cache the
needed working copies.</li>
<li>A Jujutsu wide concept for a cached working copy, as they could be expensive
to materialize.</li>
<li>Customized failure messages, this maybe useful for bots, it could be similar
to Bazel's <code>select(..., message = "arch not supported for $project")</code>.</li>
<li>Make <code>jj run</code> asynchronous by spawning a <code>main</code> process, directly return to the
user and incrementally updating the output of <code>jj st</code>.</li>
</ul></section><section class="print-page" id="design-sparse-v2" heading-number="12.4"><h1 id="design-sparse-v2-sparse-patterns-v2-redesign">Sparse Patterns v2 redesign<a class="headerlink" href="#design-sparse-v2-sparse-patterns-v2-redesign" title="Permanent link">&para;</a></h1>
<p>Authors: <a href="mailto:dploch@google.com">Daniel Ploch</a></p>
<p><strong>Summary:</strong> This Document documents a redesign of the sparse command and
it's internal storage format in jj, in order to facilitate several desirable
improvements for large repos. It covers both the migration path and the planned
end state.</p>
<h2 id="design-sparse-v2-objective">Objective<a class="headerlink" href="#design-sparse-v2-objective" title="Permanent link">&para;</a></h2>
<p>Redesign Sparse Patterns to accommodate more advanced features for native
and custom implementations. This includes three main goals:</p>
<ol>
<li>Sparse Patterns should be versioned with the working copy</li>
<li>Sparse Patterns should support more <a href="https://github.com/jj-vcs/jj/issues/1896">flexible matching rules</a></li>
<li>Sparse Patterns should support <a href="https://github.com/jj-vcs/jj/issues/2288">client path remapping</a></li>
</ol>
<h2 id="design-sparse-v2-current-state-as-of-jj-0130">Current State (as of jj 0.13.0)<a class="headerlink" href="#design-sparse-v2-current-state-as-of-jj-0130" title="Permanent link">&para;</a></h2>
<p>Sparse patterns are an effectively unordered list of prefix strings:</p>
<div class="highlight"><pre><span></span><code>path/one
path/to/dir/two
</code></pre></div>
<p>The <em>set</em> of files identified by the Sparse Patterns is all paths which match
any provided prefix. This governs what gets materialized in the working copy on
checkout, and what is updated on snapshot. The set is stored in working copy
state files which are not versioned in the Op Store.</p>
<p>Because all paths are bare strings with no escaping or higher-level formatting,
the current design makes it difficult to add new features like exclusions or
path remappings.</p>
<h2 id="design-sparse-v2-proposed-state-sparse-patterns-v2">Proposed State (Sparse Patterns v2)<a class="headerlink" href="#design-sparse-v2-proposed-state-sparse-patterns-v2" title="Permanent link">&para;</a></h2>
<p>Sparse Patterns v2 will be stored as objects in the Op Store, referenced
by a <code>WorkingCopyPatternsId</code> from the active <code>View</code>. They will have a new,
ordered structure which can fully represent previous patterns.</p>
<div class="highlight"><pre><span></span><code><span class="sd">/// Analogues of RepoPath, specifically describing paths in the working copy.</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">WorkingCopyPathBuf</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">String</span>
<span class="p">}</span>
<span class="k">struct</span><span class="w"> </span><span class="nc">WorkingCopyPath</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">str</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="nc">SparsePatternsPathType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Dir</span><span class="p">,</span><span class="w">    </span><span class="c1">// Everything under &lt;path&gt;/...</span>
<span class="w">    </span><span class="n">Files</span><span class="p">,</span><span class="w">  </span><span class="c1">// Files under &lt;path&gt;/*</span>
<span class="w">    </span><span class="n">Exact</span><span class="p">,</span><span class="w">  </span><span class="c1">// &lt;path&gt; exactly</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">SparsePatternsPath</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">path_type</span><span class="p">:</span><span class="w"> </span><span class="nc">SparsePatternsPathType</span><span class="p">,</span>
<span class="w">    </span><span class="n">include</span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="p">,</span><span class="w">  </span><span class="c1">// True if included, false if excluded.</span>
<span class="w">    </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="nc">RepoPathBuf</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">WorkingCopyMapping</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">src_path</span><span class="p">:</span><span class="w"> </span><span class="nc">RepoPathBuf</span><span class="p">,</span>
<span class="w">    </span><span class="n">dst_path</span><span class="p">:</span><span class="w"> </span><span class="nc">WorkingCopyPathBuf</span><span class="p">,</span>
<span class="w">    </span><span class="n">recursive</span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="p">,</span><span class="w">  </span><span class="c1">// If false, only immediate children of src_path (files) are renamed.</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">WorkingCopyPatterns</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sparse_paths</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">SparsePatternsPath</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="n">mappings</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">WorkingCopyMapping</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">OpStore</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">..</span><span class="p">.</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">read_working_copy_patterns</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">WorkingCopyPatternsId</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">OpStoreResult</span><span class="o">&lt;</span><span class="n">WorkingCopyPatterns</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">write_working_copy_patterns</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">sparse_patterns</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">WorkingCopyPatterns</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">OpStoreResult</span><span class="o">&lt;</span><span class="n">WorkingCopyPatternsId</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>To support these more complex behaviors, a new <code>WorkingCopyPatterns</code> trait will
be introduced, initially only as a thin wrapper around the existing prefix
format, but soon to be expanded with richer types and functionality.</p>
<div class="highlight"><pre><span></span><code><span class="k">impl</span><span class="w"> </span><span class="n">WorkingCopyPatterns</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">to_matcher</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span><span class="n">Matcher</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">..</span><span class="p">.</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="o">..</span><span class="p">.</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="design-sparse-v2-command-syntax">Command Syntax<a class="headerlink" href="#design-sparse-v2-command-syntax" title="Permanent link">&para;</a></h3>
<p><code>SparsePatternsPath</code> rules can be specified on the CLI and in an editor via a
compact syntax:</p>
<div class="highlight"><pre><span></span><code>(include|exclude):(dir|files|exact):&lt;path&gt;
</code></pre></div>
<p>If both prefix terms are omitted, then <code>include:dir:</code> is assumed. If any prefix
is specified, both must be specified. The editor and CLI will both accept path
rules in either format going forward.</p>
<ul>
<li><code>jj sparse set --add foo/bar</code> is equal to <code>jj sparse set --add include:dir:foo/bar</code></li>
<li><code>jj sparse set --add exclude:dir:foo/bar</code> adds a new <code>Dir</code> type rule with <code>include = false</code></li>
<li><code>jj sparse set --exclude foo/bar</code> as a possible shorthand for the above</li>
<li><code>jj sparse list</code> will print the explicit rules</li>
</ul>
<p>Paths will be stored in an ordered, canonical form which unambiguously describes
the set of files to be included. Every <code>--add</code> command will append to the end of
this list before the patterns are canonicalized. Whether a file is included is
determined by the first matching rule in reverse order.</p>
<p>For example:</p>
<div class="highlight"><pre><span></span><code>include:dir:foo
exclude:dir:foo/bar
include:dir:foo/bar/baz
exclude:dir:foo/bar/baz/qux
</code></pre></div>
<p>Produces rule set which includes "foo/file.txt", excludes "foo/bar/file.txt",
includes "foo/bar/baz/file.txt", and excludes "foo/bar/baz/qux/file.txt".</p>
<p>If the rules are subtly re-ordered, they become canonicalized to a smaller, but
functionally equivalent form:</p>
<div class="highlight"><pre><span></span><code># Before
include:dir:foo
exclude:dir:foo/bar/baz/qux
include:dir:foo/bar/baz
exclude:dir:foo/bar

# Canonicalized
include:dir:foo
exclude:dir:foo/bar
</code></pre></div>
<h4 id="design-sparse-v2-canonicalization">Canonicalization<a class="headerlink" href="#design-sparse-v2-canonicalization" title="Permanent link">&para;</a></h4>
<p>There are many ways to represent functionally equivalent <code>WorkingCopyPatterns</code>.
For instance, the following 4 rule sets are all functionally equivalent:</p>
<div class="highlight"><pre><span></span><code># Set 1
include:dir:bar
include:dir:foo

# Set 2
include:dir:foo
include:dir:bar

# Set 3
include:dir:bar
include:dir:bar/baz/qux
include:dir:foo

# Set 4
include:dir:foo
exclude:dir:foo/baz
include:dir:bar
include:dir:foo/baz
</code></pre></div>
<p>Because these patterns are stored in the Op Store now, it is useful for all of
these representations to be rewritten into a minimal, canonical form before
serialization. In this case, <code>Set 1</code> will be the canonical set. The canonical
form of a <code>WorkingCopyPatterns</code> is defined as the form such that:</p>
<ul>
<li>Every rule affects the functionality (there are no redundant rules)</li>
<li>Rules are sorted lexicographically, but with '/' sorted before all else</li>
<li>This special sorting order is useful for constructing path tries</li>
</ul>
<h3 id="design-sparse-v2-working-copy-map">Working Copy Map<a class="headerlink" href="#design-sparse-v2-working-copy-map" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This section is intentionally lacking, more research is needed.</p>
</div>
<p>All <code>WorkingCopyPatterns</code> will come equipped with a default no-op mapping.
These mappings are inspired by and similar to <a href="https://www.perforce.com/manuals/cmdref/Content/CmdRef/views.html">Perforce client views</a>.</p>
<div class="highlight"><pre><span></span><code><span class="fm">vec!</span><span class="p">[</span><span class="n">WorkingCopyMapping</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">src_path</span><span class="p">:</span><span class="w"> </span><span class="nc">RepoPathBuf</span><span class="p">::</span><span class="n">root</span><span class="p">(),</span>
<span class="w">    </span><span class="n">dst_path</span><span class="p">:</span><span class="w"> </span><span class="nc">WorkingCopyPathBuf</span><span class="p">::</span><span class="n">root</span><span class="p">(),</span>
<span class="w">    </span><span class="n">recursive</span><span class="p">:</span><span class="w"> </span><span class="nc">true</span><span class="p">,</span>
<span class="p">}]</span>
</code></pre></div>
<p><code>WorkingCopyPatterns</code> will provide an interface to map working copy paths into
repo paths and vice versa. The `WorkingCopy`` trait will apply this mapping to
all snapshot and checkout operations, and jj commands which accept relative
paths will need to be updated to perform working copy path -&gt; repo path
translations as needed. It's not clear at this time <em>which</em> commands will need
changing, as some are more likely to refer to repo paths rather than working
copy paths.</p>
<p>TODO: Expand this section.</p>
<p>In particular, the path rules for sparse patterns will <em>always</em> be repo paths,
not working copy paths. Thus, if the working copy wants to track "foo" and
rename it to "subdir/bar", they must <code>jj sparse set --add foo</code> and
<code>jj map set --from foo --to bar</code>. In other words, the mapping operation can
be thought of as always <em>after</em> the sparse operation.</p>
<h4 id="design-sparse-v2-command-syntax_1">Command Syntax<a class="headerlink" href="#design-sparse-v2-command-syntax_1" title="Permanent link">&para;</a></h4>
<p>New commands will enable editing of the <code>WorkingCopyMapping</code>s:</p>
<p>TODO: Maybe this should be <code>jj workspace map ...</code>?</p>
<ul>
<li><code>jj map list</code> will print all mapping pairs.</li>
<li><code>jj map add --from foo --to bar</code> will add a new mapping to the end of the list.</li>
<li><code>jj map remove --from foo</code> will remove a specific mapping rule.</li>
<li><code>jj map edit</code> will pull up a text editor for manual editing.</li>
</ul>
<p>Like sparse paths, mappings will have a compact text syntax for editing in file
form, or for adding a rule textually on the CLI:</p>
<div class="highlight"><pre><span></span><code>&quot;&lt;from&gt;&quot; -&gt; &quot;&lt;to&gt;&quot; [nonrecursive]
</code></pre></div>
<p>Like sparse paths, mapping rules are defined to apply in <em>order</em> and on any
save operation will be modified to a minimal canonical form. Thus,
<code>jj map set --from "" --to ""</code> will always completely wipe the map.
The first matching rule in reverse list order determines how a particular
repo path should be mapped into the working copy, and likewise how a particular
working copy path should be mapped into the repo. For simplicity, the
'last rule wins' applies both for repo-&gt;WC conversions, as well as WC-&gt;repo
conversions, using the same ordering.</p>
<p>If a working copy mapping places the same repo file at two distinct working
copy paths, snapshotting will fail unless these files are identical. Some
specialized filesystems may even treat these as the 'same' file, allowing this
to work in some cases.</p>
<p>If a working copy mapping places two distinct repo files at the same working
copy path, checkout will fail with an error regardless of equivalence.</p>
<h3 id="design-sparse-v2-versioning-and-storage">Versioning and Storage<a class="headerlink" href="#design-sparse-v2-versioning-and-storage" title="Permanent link">&para;</a></h3>
<p>Updating the active <code>WorkingCopyPatterns</code> for a particular working copy will now
take place in two separate steps: one transaction which updates the op store,
and a separate <code>LockedWorkingCopy</code> operation which actually updates the working
copy. The working copy proto will no longer store <code>WorkingCopyPatterns</code>
directly, instead storing only a <code>WorkingCopyPatternsId</code>. On mismatch with the
current op head, the user will be prompted to run <code>jj workspace update-stale</code>.</p>
<p>This gives the user the ability to update the active <code>WorkingCopyPatterns</code>
whilst not interacting with the local working copy, which is useful for custom
integrations which may not be <em>able</em> to check out particular working copy
patterns due to problems with the backend (encoding, permission errors, etc.). A
bad <code>jj sparse set --add oops</code> command can thus be undone, even via <code>jj op undo</code>
if desired.</p>
<h4 id="design-sparse-v2-view-updates">View Updates<a class="headerlink" href="#design-sparse-v2-view-updates" title="Permanent link">&para;</a></h4>
<p>The View object will be migrated to store working copy patterns via id. The
indirection will save on storage since working copy patterns are not expected to
change very frequently.</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Before:</span>
<span class="k">pub</span><span class="w"> </span><span class="n">wc_commit_ids</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="o">&lt;</span><span class="n">WorkspaceNameBuf</span><span class="p">,</span><span class="w"> </span><span class="n">CommitId</span><span class="o">&gt;</span><span class="p">,</span>

<span class="c1">// After:</span>
<span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">WorkingCopyInfo</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">commit_id</span><span class="p">:</span><span class="w"> </span><span class="nc">CommitId</span><span class="p">,</span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">wc_patterns_id</span><span class="p">:</span><span class="w"> </span><span class="nc">WorkingCopyPatternsId</span><span class="p">,</span>
<span class="p">}</span>
<span class="o">..</span><span class="p">.</span>
<span class="k">pub</span><span class="w"> </span><span class="n">wc_info</span><span class="p">:</span><span class="w"> </span><span class="nc">HashMap</span><span class="o">&lt;</span><span class="n">WorkspaceNameBuf</span><span class="p">,</span><span class="w"> </span><span class="n">WorkingCopyInfo</span><span class="o">&gt;</span><span class="p">,</span>
</code></pre></div>
<p>A View object with no stored working copy patterns will be modified at read
time to include the current working copy patterns, thus all <code>read_view</code>
operations will need to pass in the current working copy patterns for a
migration period of at least 6 months. After that, we may choose to auto-fill
missing working copy infos with a default <code>WorkingCopyPatterns</code> as needed.</p>
<h3 id="design-sparse-v2-appendix">Appendix<a class="headerlink" href="#design-sparse-v2-appendix" title="Permanent link">&para;</a></h3>
<h4 id="design-sparse-v2-related-work">Related Work<a class="headerlink" href="#design-sparse-v2-related-work" title="Permanent link">&para;</a></h4>
<p><a href="https://www.perforce.com/manuals/cmdref/Content/CmdRef/views.html">Perforce client maps</a>
 are very similar in concept to the entirety of <code>WorkingCopyPatterns</code>, and this
 design aims to achieve similar functionality.</p>
<p>The <a href="https://github.com/josh-project/josh">Josh Project</a> implements partial git
clones in a way similar to how sparse patterns try to work.</p>
<h4 id="design-sparse-v2-patterns-via-configuration">Patterns via configuration<a class="headerlink" href="#design-sparse-v2-patterns-via-configuration" title="Permanent link">&para;</a></h4>
<p>There may be some scenarios where it is valuable to configure working copy
patterns via a configuration file, rather than through explicit commands.
Generally this only makes sense for automated repos, with the configuration
coming from outside the repo - there are too many caveats and edge cases if the
configuration comes from inside the repo and/or is fought with by a human.</p>
<p>No configuration syntax is planned at this time but if we add any, we should
probably reuse the compact line syntaxes as much as possible for consistency.</p></section><section class="print-page" id="design-tracking-branches" heading-number="12.5"><h1 id="design-tracking-branches-remotegit-tracking-branches">Remote/<code>@git</code> tracking branches<a class="headerlink" href="#design-tracking-branches-remotegit-tracking-branches" title="Permanent link">&para;</a></h1>
<p>This is a plan to implement more Git-like remote tracking branch UX.</p>
<h2 id="design-tracking-branches-objective">Objective<a class="headerlink" href="#design-tracking-branches-objective" title="Permanent link">&para;</a></h2>
<p><code>jj</code> imports all remote branches to local branches by default. As described in
<a href="https://github.com/jj-vcs/jj/issues/1136">#1136</a>, this doesn't interact nicely with Git if we have multiple Git remotes
with a number of branches. The <code>git.auto-local-bookmark</code> config can mitigate this
problem, but we'll get locally-deleted branches instead.</p>
<p>The goal of this plan is to implement</p>
<ul>
<li>proper support for tracking/non-tracking remote branches</li>
<li>logically consistent data model for importing/exporting Git refs</li>
</ul>
<h2 id="design-tracking-branches-current-data-model-as-of-jj-080">Current data model (as of jj 0.8.0)<a class="headerlink" href="#design-tracking-branches-current-data-model-as-of-jj-080" title="Permanent link">&para;</a></h2>
<p>Under the current model, all remote branches are "tracking" branches, and
remote changes are merged into the local counterparts.</p>
<div class="highlight"><pre><span></span><code>branches
  [name]:
    local_target?
    remote_targets[remote]: target
tags
  [name]: target
git_refs
  [&quot;refs/heads/{name}&quot;]: target             # last-known local branches
  [&quot;refs/remotes/{remote}/{name}&quot;]: target  # last-known remote branches
                                            # (copied to remote_targets)
  [&quot;refs/tags/{name}&quot;]: target              # last-known tags
git_head: target?
</code></pre></div>
<ul>
<li>Remote branches are stored in both <code>branches[name].remote_targets</code> and
  <code>git_refs["refs/remotes"]</code>. These two are mostly kept in sync, but there
  are two scenarios where remote-tracking branches and git refs can diverge:
  1. <code>jj branch forget</code>
  2. <code>jj op undo</code>/<code>restore</code> in colocated repo</li>
<li>Pseudo <code>@git</code> tracking branches are stored in <code>git_refs["refs/heads"]</code>. We
  need special case to resolve <code>@git</code> branches, and their behavior is slightly
  different from the other remote-tracking branches.</li>
</ul>
<h2 id="design-tracking-branches-proposed-data-model">Proposed data model<a class="headerlink" href="#design-tracking-branches-proposed-data-model" title="Permanent link">&para;</a></h2>
<p>We'll add a per-remote-branch <code>state</code> to distinguish non-tracking branches
from tracking ones.</p>
<div class="highlight"><pre><span></span><code>state = new        # not merged in the local branch or tag
      | tracking   # merged in the local branch or tag
# `ignored` state could be added if we want to manage it by view, not by
# config file. target of ignored remote branch would be absent.
</code></pre></div>
<p>We'll add a per-remote view-like object to record the last known remote
branches. It will replace <code>branches[name].remote_targets</code> in the current model.
<code>@git</code> branches will be stored in <code>remotes["git"]</code>.</p>
<div class="highlight"><pre><span></span><code>branches
  [name]: target
tags
  [name]: target
remotes
  [&quot;git&quot;]:
    branches
      [name]: target, state                 # refs/heads/{name}
    tags
      [name]: target, state = tracking      # refs/tags/{name}
    head: target?, state = TBD              # refs/HEAD
  [remote]:
    branches
      [name]: target, state                 # refs/remotes/{remote}/{name}
    tags: (empty)
    head: (empty)
git_refs                                    # last imported/exported refs
  [&quot;refs/heads/{name}&quot;]: target
  [&quot;refs/remotes/{remote}/{name}&quot;]: target
  [&quot;refs/tags/{name}&quot;]: target
</code></pre></div>
<p>With the proposed data model, we can</p>
<ul>
<li>naturally support remote branches which have no local counterparts</li>
<li>deduplicate <code>branches[name].remote_targets</code> and <code>git_refs["refs/remotes"]</code></li>
</ul>
<h3 id="design-tracking-branches-importexport-data-flow">Import/export data flow<a class="headerlink" href="#design-tracking-branches-importexport-data-flow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>       export flow                              import flow
       -----------                              -----------
                        +----------------+                   --.
   +-------------------&gt;|backing Git repo|---+                 :
   |                    +----------------+   |                 : unchanged
   |[update]                                 |[copy]           : on &quot;op restore&quot;
   |                      +----------+       |                 :
   |      +--------------&gt;| git_refs |&lt;------+                 :
   |      |               +----------+       |               --&#39;
   +--[compare]                            [diff]--+
          |   .--       +---------------+    |     |         --.
          |   :    +---&gt;|remotes[&quot;git&quot;] |    |     |           :
          +---:    |    |               |&lt;---+     |           :
              :    |    |remotes[remote]|          |           : restored
              &#39;--  |    +---------------+          |[merge]    : on &quot;op restore&quot;
                   |                               |           : by default
             [copy]|    +---------------+          |           :
                   +----| (local)       |&lt;---------+           :
                        | branches/tags |                      :
                        +---------------+                    --&#39;
</code></pre></div>
<ul>
<li><code>jj git import</code> applies diff between <code>git_refs</code> and <code>remotes[]</code>. <code>git_refs</code> is
  always copied from the backing Git repo.</li>
<li><code>jj git export</code> copies jj's <code>remotes</code> view back to the Git repo. If a ref in
  the Git repo has been updated since the last import, the ref isn't exported.</li>
<li><code>jj op restore</code> never rolls back <code>git_refs</code>.</li>
</ul>
<h3 id="design-tracking-branches-tracking-state">Tracking state<a class="headerlink" href="#design-tracking-branches-tracking-state" title="Permanent link">&para;</a></h3>
<p>The <code>git.auto-local-bookmark</code> config knob is applied when importing new remote
branch. <code>jj branch</code> sub commands will be added to change the tracking state.</p>
<div class="highlight"><pre><span></span><code><span class="k">fn</span><span class="w"> </span><span class="nf">default_state_for_newly_imported_branch</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">remote</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;git&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">State</span><span class="p">::</span><span class="n">Tracked</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">config</span><span class="p">[</span><span class="s">&quot;git.auto-local-bookmark&quot;</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">State</span><span class="p">::</span><span class="n">Tracked</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">State</span><span class="p">::</span><span class="n">New</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A branch target to be merged is calculated based on the <code>state</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">fn</span><span class="w"> </span><span class="nf">target_in_merge_context</span><span class="p">(</span><span class="n">known_target</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">State</span><span class="p">::</span><span class="n">New</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">RefTarget</span><span class="p">::</span><span class="n">absent</span><span class="p">(),</span>
<span class="w">        </span><span class="n">State</span><span class="p">::</span><span class="n">Tracked</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">known_target</span><span class="p">,</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="design-tracking-branches-mapping-to-the-current-data-model">Mapping to the current data model<a class="headerlink" href="#design-tracking-branches-mapping-to-the-current-data-model" title="Permanent link">&para;</a></h3>
<ul>
<li>New <code>remotes["git"].branches</code> corresponds to <code>git_refs["refs/heads"]</code>, but
  forgotten branches are removed from <code>remotes["git"].branches</code>.</li>
<li>New <code>remotes["git"].tags</code> corresponds to <code>git_refs["refs/tags"]</code>.</li>
<li>New <code>remotes["git"].head</code> corresponds to <code>git_head</code>.</li>
<li>New <code>remotes[remote].branches</code> corresponds to
  <code>branches[].remote_targets[remote]</code>.</li>
<li><code>state = new|tracking</code> doesn't exist in the current model. It's determined
  by <code>git.auto-local-bookmark</code> config.</li>
</ul>
<h2 id="design-tracking-branches-common-command-behaviors">Common command behaviors<a class="headerlink" href="#design-tracking-branches-common-command-behaviors" title="Permanent link">&para;</a></h2>
<p>In the following sections, a merge is expressed as <code>adds - removes</code>.
In particular, a merge of local and remote targets is
<code>[local, remote] - [known_remote]</code>.</p>
<h3 id="design-tracking-branches-fetchimport">fetch/import<a class="headerlink" href="#design-tracking-branches-fetchimport" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>jj git fetch</code>
  1. Fetches remote changes to the backing Git repo.
  2. Import changes only for <code>remotes[remote].branches[glob]</code> (see below)</p>
<ul>
<li>TODO: how about fetched <code>.tags</code>?</li>
</ul>
</li>
<li>
<p><code>jj git import</code>
  1. Copies <code>git_refs</code> from the backing Git repo.
  2. Calculates diff from the known <code>remotes</code> to the new <code>git_refs</code>.</p>
<ul>
<li><code>git_refs["refs/heads"] - remotes["git"].branches</code></li>
<li><code>git_refs["refs/tags"] - remotes["git"].tags</code></li>
<li>TBD: <code>"HEAD" - remotes["git"].head</code> (unused)</li>
<li><code>git_refs["refs/remotes/{remote}"] - remotes[remote]</code>
3. Merges diff in local <code>branches</code> and <code>tags</code> if <code>state</code> is <code>tracking</code>.</li>
<li>If the known <code>target</code> is <code>absent</code>, the default <code>state</code> should be
     calculated. This also applies to previously-forgotten branches.
4. Updates <code>remotes</code> reflecting the import.
5. Abandons commits that are no longer referenced.</li>
</ul>
</li>
</ul>
<h3 id="design-tracking-branches-pushexport">push/export<a class="headerlink" href="#design-tracking-branches-pushexport" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>jj git push</code>
  1. Calculates diff from the known <code>remotes[remote]</code> to the local changes.</p>
<ul>
<li><code>branches - remotes[remote].branches</code><ul>
<li>If <code>state</code> is <code>new</code> (i.e. untracked), the known remote branch <code>target</code>
     is considered <code>absent</code>.</li>
<li>If <code>state</code> is <code>new</code>, and if the local branch <code>target</code> is <code>absent</code>, the
     diff <code>[absent, remote] - absent</code> is noop. So it's not allowed to push
     deleted branch to untracked remote.</li>
<li>TODO: Copy Git's <code>--force-with-lease</code> behavior?</li>
</ul>
</li>
<li>~<code>tags</code>~ (not implemented, but should be the same as <code>branches</code>)
2. Pushes diff to the remote Git repo (as well as remote tracking branches
   in the backing Git repo.)
3. Updates <code>remotes[remote]</code> and <code>git_refs</code> reflecting the push.</li>
</ul>
</li>
<li>
<p><code>jj git export</code>
  1. Copies local <code>branches</code>/<code>tags</code> back to <code>remotes["git"]</code>.</p>
<ul>
<li>Conceptually, <code>remotes["git"].branches[name].state</code> can be set to
     untracked. Untracked local branches won't be exported to Git.</li>
<li>If <code>remotes["git"].branches[name]</code> is <code>absent</code>, the default
     <code>state = tracking</code> applies. This also applies to forgotten branches.</li>
<li>~<code>tags</code>~ (not implemented, but should be the same as <code>branches</code>)
2. Calculates diff from the known <code>git_refs</code> to the new <code>remotes[remote]</code>.
3. Applies diff to the backing Git repo.
4. Updates <code>git_refs</code> reflecting the export.</li>
</ul>
<p>If a ref failed to export at the step 3, the preceding steps should also be
rolled back for that ref.</p>
</li>
</ul>
<h3 id="design-tracking-branches-initclone">init/clone<a class="headerlink" href="#design-tracking-branches-initclone" title="Permanent link">&para;</a></h3>
<ul>
<li><code>jj init</code></li>
<li>Import, track, and merge per <code>git.auto_local_branch</code> config.</li>
<li>
<p>If <code>!git.auto_local_branch</code>, no <code>tracking</code> state will be set.</p>
</li>
<li>
<p><code>jj git clone</code></p>
</li>
<li>Import, track, and merge per <code>git.auto_local_branch</code> config.</li>
<li>The default branch will be tracked regardless of <code>git.auto_local_branch</code>
    config. This isn't technically needed, but will help users coming from Git.</li>
</ul>
<h3 id="design-tracking-branches-branch">branch<a class="headerlink" href="#design-tracking-branches-branch" title="Permanent link">&para;</a></h3>
<ul>
<li><code>jj branch set {name}</code>
  1. Sets local <code>branches[name]</code> entry.</li>
<li><code>jj branch delete {name}</code>
  1. Removes local <code>branches[name]</code> entry.</li>
<li><code>jj branch forget {name}</code>
  1. Removes local <code>branches[name]</code> entry if exists.
  2. Removes <code>remotes[remote].branches[name]</code> entries if exist.
     TODO: maybe better to not remove non-tracking remote branches?</li>
<li><code>jj branch track {name}@{remote}</code> (new command)
  1. Merges <code>[local, remote] - [absent]</code> in local branch.<ul>
<li>Same as "fetching/importing existing branch from untracked remote".
2. Sets <code>remotes[remote].branches[name].state = tracking</code>.</li>
</ul>
</li>
<li><code>jj branch untrack {name}@{remote}</code> (new command)
  1. Sets <code>remotes[remote].branches[name].state = new</code>.</li>
<li><code>jj branch list</code></li>
<li>TODO: hide non-tracking branches by default? ...</li>
</ul>
<p>Note: desired behavior of <code>jj branch forget</code> is to</p>
<ul>
<li>discard both local and remote branches (without actually removing branches
  at remotes)</li>
<li>not abandon commits which belongs to those branches (even if the branch is
  removed at a remote)</li>
</ul>
<h2 id="design-tracking-branches-command-behavior-examples">Command behavior examples<a class="headerlink" href="#design-tracking-branches-command-behavior-examples" title="Permanent link">&para;</a></h2>
<h3 id="design-tracking-branches-fetchimport_1">fetch/import<a class="headerlink" href="#design-tracking-branches-fetchimport_1" title="Permanent link">&para;</a></h3>
<ul>
<li>Fetching/importing new branch
  1. Decides new <code>state = new|tracking</code> based on <code>git.auto_local_branch</code>
  2. If new <code>state</code> is <code>tracking</code>, merges <code>[absent, new_remote] - [absent]</code>
     (i.e. creates local branch with <code>new_remote</code> target)
  3. Sets <code>remotes[remote].branches[name].state</code></li>
<li>Fetching/importing existing branch from tracking remote
  1. Merges <code>[local, new_remote] - [known_remote]</code></li>
<li>Fetching/importing existing branch from untracked remote
  1. Decides new <code>state = new|tracking</code> based on <code>git.auto_local_branch</code>
  2. If new <code>state</code> is <code>tracking</code>, merges <code>[local, new_remote] - [absent]</code>
  3. Sets <code>remotes[remote].branches[name].state</code></li>
<li>Fetching/importing remotely-deleted branch from tracking remote
  1. Merges <code>[local, absent] - [known_remote]</code>
  2. Removes <code>remotes[remote].branches[name]</code> (<code>target</code> becomes <code>absent</code>)
     (i.e. the remote branch is no longer tracked)
  3. Abandons commits in the deleted branch</li>
<li>Fetching/importing remotely-deleted branch from untracked remote
  1. Decides new <code>state = new|tracking</code> based on <code>git.auto_local_branch</code>
  2. Noop anyway since <code>[local, absent] - [absent]</code> -&gt; <code>local</code></li>
<li>Fetching previously-forgotten branch from remote
  1. Decides new <code>state = new|tracking</code> based on <code>git.auto_local_branch</code>
  2. If new <code>state</code> is <code>tracking</code>, merges
    <code>[absent, new_remote] - [absent]</code> -&gt; <code>new_remote</code>
  3. Sets <code>remotes[remote].branches[name].state</code></li>
<li>Fetching forgotten and remotely-deleted branch</li>
<li>Same as "remotely-deleted branch from untracked remote" since forgotten
    remote branch should be <code>state = new</code></li>
<li>Therefore, no local commits should be abandoned</li>
</ul>
<h3 id="design-tracking-branches-push">push<a class="headerlink" href="#design-tracking-branches-push" title="Permanent link">&para;</a></h3>
<ul>
<li>Pushing new branch, remote doesn't exist
  1. Pushes <code>[local, absent] - [absent]</code> -&gt; <code>local</code>
  2. Sets <code>remotes[remote].branches[name].target = local</code>, <code>.state = tracking</code></li>
<li>Pushing new branch, untracked remote exists
  1. Pushes <code>[local, remote] - [absent]</code><ul>
<li>Fails if <code>local</code> moved backwards or sideways
2. Sets <code>remotes[remote].branches[name].target = local</code>, <code>.state = tracking</code></li>
</ul>
</li>
<li>Pushing existing branch to tracking remote
  1. Pushes <code>[local, remote] - [remote]</code> -&gt; <code>local</code><ul>
<li>Fails if <code>local</code> moved backwards or sideways, and if <code>remote</code> is out of
     sync
2. Sets <code>remotes[remote].branches[name].target = local</code></li>
</ul>
</li>
<li>Pushing existing branch to untracked remote</li>
<li>Same as "new branch"</li>
<li>Pushing deleted branch to tracking remote
  1. Pushes <code>[absent, remote] - [remote]</code> -&gt; <code>absent</code><ul>
<li>TODO: Fails if <code>remote</code> is out of sync?
2. Removes <code>remotes[remote].branches[name]</code> (<code>target</code> becomes <code>absent</code>)</li>
</ul>
</li>
<li>Pushing deleted branch to untracked remote</li>
<li>Noop since <code>[absent, remote] - [absent]</code> -&gt; <code>remote</code></li>
<li>Perhaps, UI will report error</li>
<li>Pushing forgotten branch to untracked remote</li>
<li>Same as "deleted branch to untracked remote"</li>
<li>Pushing previously-forgotten branch to remote</li>
<li>Same as "new branch, untracked remote exists"</li>
<li>The <code>target</code> of forgotten remote branch is <code>absent</code></li>
</ul>
<h3 id="design-tracking-branches-export">export<a class="headerlink" href="#design-tracking-branches-export" title="Permanent link">&para;</a></h3>
<ul>
<li>Exporting new local branch, git branch doesn't exist
  1. Sets <code>remotes["git"].branches[name].target = local</code>, <code>.state = tracking</code>
  2. Exports <code>[local, absent] - [absent]</code> -&gt; <code>local</code></li>
<li>Exporting new local branch, git branch is out of sync
  1. Exports <code>[local, git] - [absent]</code> -&gt; fail</li>
<li>Exporting existing local branch, git branch is synced
  1. Sets <code>remotes["git"].branches[name].target = local</code>
  2. Exports <code>[local, git] - [git]</code> -&gt; <code>local</code></li>
<li>Exporting deleted local branch, git branch is synced
  1. Removes <code>remotes["git"].branches[name]</code>
  2. Exports <code>[absent, git] - [git]</code> -&gt; <code>absent</code></li>
<li>Exporting forgotten branches, git branches are synced
  1. Exports <code>[absent, git] - [git]</code> -&gt; <code>absent</code> for forgotten local/remote
     branches</li>
</ul>
<h3 id="design-tracking-branches-undo-fetch">undo fetch<a class="headerlink" href="#design-tracking-branches-undo-fetch" title="Permanent link">&para;</a></h3>
<ul>
<li>Exporting undone fetch, git branches are synced
  1. Exports <code>[old, git] - [git]</code> -&gt; <code>old</code> for undone local/remote branches</li>
<li>Redoing undone fetch without exporting</li>
<li>Same as plain fetch since the known <code>git_refs</code> isn't diffed against the
    refs in the backing Git repo.</li>
</ul>
<h3 id="design-tracking-branches-git-remote"><code>@git</code> remote<a class="headerlink" href="#design-tracking-branches-git-remote" title="Permanent link">&para;</a></h3>
<ul>
<li><code>jj branch untrack {name}@git</code></li>
<li>Maybe rejected (to avoid confusion)?</li>
<li>Allowing this would mean different local branches of the same name coexist
    in jj and git.</li>
<li><code>jj git fetch --remote git</code></li>
<li>Rejected. The implementation is different.</li>
<li>Conceptually, it's <code>git::import_refs()</code> only for local branches.</li>
<li><code>jj git push --remote git</code></li>
<li>Rejected. The implementation is different.</li>
<li>Conceptually, it's <code>jj branch track</code> and <code>git::export_refs()</code> only for
    local branches.</li>
</ul>
<h2 id="design-tracking-branches-remaining-issues">Remaining issues<a class="headerlink" href="#design-tracking-branches-remaining-issues" title="Permanent link">&para;</a></h2>
<ul>
<li>https://github.com/jj-vcs/jj/issues/1278 pushing to tracked remote</li>
<li>Option could be added to push to all <code>tracking</code> remotes?</li>
<li>Track remote branch locally with different name</li>
<li>Local branch name could be stored per remote branch</li>
<li>Consider UI complexity</li>
<li>"private" state (suggested by @ilyagr)</li>
<li>"private" branches can be pushed to their own remote, but not to the
    upstream repo</li>
<li>This might be a state attached to a local branch (similar to Mercurial's
    "secret" phase)</li>
</ul>
<h2 id="design-tracking-branches-references">References<a class="headerlink" href="#design-tracking-branches-references" title="Permanent link">&para;</a></h2>
<ul>
<li>https://github.com/jj-vcs/jj/issues/1136</li>
<li>https://github.com/jj-vcs/jj/issues/1666</li>
<li>https://github.com/jj-vcs/jj/issues/1690</li>
<li>https://github.com/jj-vcs/jj/issues/1734</li>
<li>https://github.com/jj-vcs/jj/pull/1739</li>
</ul></section><section class="print-page" id="design-copy-tracking" heading-number="12.6"><h1 id="design-copy-tracking-copy-tracking-and-tracing-design">Copy Tracking and Tracing Design<a class="headerlink" href="#design-copy-tracking-copy-tracking-and-tracing-design" title="Permanent link">&para;</a></h1>
<p>Authors: <a href="mailto:dploch@google.com">Daniel Ploch</a></p>
<p><strong>Summary:</strong> This Document documents an approach to tracking and detecting copy
information in jj repos, in a way that is compatible with both Git's detection
model and with custom backends that have more complicated tracking of copy
information. This design affects the output of diff commands as well as the
results of rebasing across remote copies.</p>
<h2 id="design-copy-tracking-objective">Objective<a class="headerlink" href="#design-copy-tracking-objective" title="Permanent link">&para;</a></h2>
<p>Implement extensible APIs for recording and retrieving copy info for the
purposes of diffing and rebasing across renames and copies more accurately.
This should be performant both for Git, which synthesizes copy info on the fly
between arbitrary trees, and for custom extensions which may explicitly record
and re-serve copy info over arbitrarily large commit ranges.</p>
<p>The APIs should be defined in a way that makes it easy for custom backends to
ignore copy info entirely until they are ready to implement it.</p>
<h2 id="design-copy-tracking-interface-design">Interface Design<a class="headerlink" href="#design-copy-tracking-interface-design" title="Permanent link">&para;</a></h2>
<h3 id="design-copy-tracking-read-api">Read API<a class="headerlink" href="#design-copy-tracking-read-api" title="Permanent link">&para;</a></h3>
<p>Copy information will be served both by a new Backend trait method described
below, as well as a new field on Commit objects for backends that support copy
tracking:</p>
<div class="highlight"><pre><span></span><code><span class="sd">/// An individual copy source.</span>
<span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">CopySource</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="sd">/// The source path a target was copied from.</span>
<span class="w">    </span><span class="sd">///</span>
<span class="w">    </span><span class="sd">/// It is not required that the source path is different than the target</span>
<span class="w">    </span><span class="sd">/// path. A custom backend may choose to represent &#39;rollbacks&#39; as copies</span>
<span class="w">    </span><span class="sd">/// from a file unto itself, from a specific prior commit.</span>
<span class="w">    </span><span class="n">path</span><span class="p">:</span><span class="w"> </span><span class="nc">RepoPathBuf</span><span class="p">,</span>
<span class="w">    </span><span class="n">file</span><span class="p">:</span><span class="w"> </span><span class="nc">FileId</span><span class="p">,</span>
<span class="w">    </span><span class="sd">/// The source commit the target was copied from. If not specified, then the</span>
<span class="w">    </span><span class="sd">/// parent of the target commit is the source commit. Backends may use this</span>
<span class="w">    </span><span class="sd">/// field to implement &#39;integration&#39; logic, where a source may be</span>
<span class="w">    </span><span class="sd">/// periodically merged into a target, similar to a branch, but the</span>
<span class="w">    </span><span class="sd">/// branching occurs at the file level rather than the repository level. It</span>
<span class="w">    </span><span class="sd">/// also follows naturally that any copy source targeted to a specific</span>
<span class="w">    </span><span class="sd">/// commit should avoid copy propagation on rebasing, which is desirable</span>
<span class="w">    </span><span class="sd">/// for &#39;fork&#39; style copies.</span>
<span class="w">    </span><span class="sd">///</span>
<span class="w">    </span><span class="sd">/// If specified, it is required that the commit id is an ancestor of the</span>
<span class="w">    </span><span class="sd">/// commit with which this copy source is associated.</span>
<span class="w">    </span><span class="n">commit</span><span class="p">:</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">CommitId</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="nc">CopySources</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Resolved</span><span class="p">(</span><span class="n">CopySource</span><span class="p">),</span>
<span class="w">    </span><span class="n">Conflict</span><span class="p">(</span><span class="n">HashSet</span><span class="o">&lt;</span><span class="n">CopySource</span><span class="o">&gt;</span><span class="p">),</span>
<span class="p">}</span>

<span class="sd">/// An individual copy event, from file A -&gt; B.</span>
<span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">CopyRecord</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="sd">/// The destination of the copy, B.</span>
<span class="w">    </span><span class="n">target</span><span class="p">:</span><span class="w"> </span><span class="nc">RepoPathBuf</span><span class="p">,</span>
<span class="w">    </span><span class="sd">/// The CommitId where the copy took place.</span>
<span class="w">    </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nc">CommitId</span><span class="p">,</span>
<span class="w">    </span><span class="sd">/// The source of the copy, A.</span>
<span class="w">    </span><span class="n">sources</span><span class="p">:</span><span class="w"> </span><span class="nc">CopySources</span><span class="p">,</span>
<span class="p">}</span>

<span class="sd">/// Backend options for fetching copy records.</span>
<span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">CopyRecordOpts</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// TODO: Probably something for git similarity detection</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nc">CopyRecordStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BoxStream</span><span class="o">&lt;</span><span class="n">BackendResult</span><span class="o">&lt;</span><span class="n">CopyRecord</span><span class="o">&gt;&gt;</span><span class="p">;</span>

<span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">Backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="sd">/// Get all copy records for `paths` in the dag range `roots..heads`.</span>
<span class="w">    </span><span class="sd">///</span>
<span class="w">    </span><span class="sd">/// The exact order these are returned is unspecified, but it is guaranteed</span>
<span class="w">    </span><span class="sd">/// to be reverse-topological. That is, for any two copy records with</span>
<span class="w">    </span><span class="sd">/// different commit ids A and B, if A is an ancestor of B, A is streamed</span>
<span class="w">    </span><span class="sd">/// after B.</span>
<span class="w">    </span><span class="sd">///</span>
<span class="w">    </span><span class="sd">/// Streaming by design to better support large backends which may have very</span>
<span class="w">    </span><span class="sd">/// large single-file histories. This also allows more iterative algorithms</span>
<span class="w">    </span><span class="sd">/// like blame/annotate to short-circuit after a point without wasting</span>
<span class="w">    </span><span class="sd">/// unnecessary resources.</span>
<span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">get_copy_records</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">paths</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="p">[</span><span class="n">RepoPathBuf</span><span class="p">],</span><span class="w"> </span><span class="n">roots</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="p">[</span><span class="n">CommitId</span><span class="p">],</span><span class="w"> </span><span class="n">heads</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="p">[</span><span class="n">CommitId</span><span class="p">])</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">CopyRecordStream</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Obtaining copy records for a single commit requires first computing the files
list for that commit, then calling get_copy_records with <code>heads = [id]</code> and
<code>roots = parents()</code>. This enables commands like <code>jj diff</code> to produce better
diffs that take copy sources into account.</p>
<h3 id="design-copy-tracking-write-api">Write API<a class="headerlink" href="#design-copy-tracking-write-api" title="Permanent link">&para;</a></h3>
<p>Backends that support tracking copy records at the commit level will do so
through a new field on <code>backend::Commit</code> objects:</p>
<div class="highlight"><pre><span></span><code><span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">Commit</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="o">..</span><span class="p">.</span>
<span class="w">    </span><span class="n">copies</span><span class="p">:</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">HashMap</span><span class="o">&lt;</span><span class="n">RepoPathBuf</span><span class="p">,</span><span class="w"> </span><span class="n">CopySources</span><span class="o">&gt;&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">Backend</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="sd">/// Whether this backend supports storing explicit copy records on write.</span>
<span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">supports_copy_tracking</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>This field will be ignored by backends that do not support copy tracking, and
always set to <code>None</code> when read from such backends. Backends that do support copy
tracking are required to preserve the field value always.</p>
<p>This API will enable the creation of new <code>jj</code> commands for recording copies:</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>cp<span class="w"> </span><span class="nv">$SRC</span><span class="w"> </span><span class="nv">$DEST</span><span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span>
jj<span class="w"> </span>mv<span class="w"> </span><span class="nv">$SRC</span><span class="w"> </span><span class="nv">$DEST</span><span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span>
</code></pre></div>
<p>These commands will rewrite the target commit to reflect the given move/copy
instructions in its tree, as well as recording the rewrites on the Commit
object itself for backends that support it (for backends that do not,
these copy records will be silently discarded).</p>
<p>Flags for the first two commands will include:</p>
<div class="highlight"><pre><span></span><code>-r/--revision
    perform the copy or move at the specified revision
    defaults to the working copy commit if unspecified
-f
    force overwrite the destination path
--after
    record the copy retroactively, without modifying the targeted commit tree
--resolve
    overwrite all previous copy intents for this $DEST
--allow-ignore-copy
    don&#39;t error if the backend doesn&#39;t support copy tracking
--from REV
    specify a commit id for the copy source that isn&#39;t the parent commit
</code></pre></div>
<p>For backends which do not support copy tracking, it will be an error to use
<code>--after</code>, since this has no effect on anything and the user should know that.
The <code>supports_copy_tracking()</code> trait method is used to determine this.</p>
<p>An additional command is provided to deliberately discard copy info for a
destination path, possibly as a means of resolving a conflict.</p>
<div class="highlight"><pre><span></span><code>jj<span class="w"> </span>forget-cp<span class="w"> </span><span class="nv">$DEST</span><span class="w"> </span><span class="o">[</span>-r<span class="w"> </span>REV<span class="o">]</span>
</code></pre></div>
<h2 id="design-copy-tracking-behavioral-changes">Behavioral Changes<a class="headerlink" href="#design-copy-tracking-behavioral-changes" title="Permanent link">&para;</a></h2>
<h3 id="design-copy-tracking-rebase-changes">Rebase Changes<a class="headerlink" href="#design-copy-tracking-rebase-changes" title="Permanent link">&para;</a></h3>
<p>In general, we want to support the following use cases:</p>
<ul>
<li>A rebase of an edited file A across a rename of A-&gt;B should transparently move the edits to B.</li>
<li>A rebase of an edited file A across a copy from A-&gt;B should <em>optionally</em> copy the edits to B. A configuration option should be defined to enable/disable this behavior.</li>
<li>TODO: Others?</li>
</ul>
<p>Using the aforementioned copy tracing API, both of these should be feasible. A
detailed approach to a specific edge case is detailed in the next section.</p>
<h4 id="design-copy-tracking-rename-of-an-added-file">Rename of an added file<a class="headerlink" href="#design-copy-tracking-rename-of-an-added-file" title="Permanent link">&para;</a></h4>
<p>A well known and thorny problem in Mercurial occurs in the following scenario:</p>
<ol>
<li>Create a new file A</li>
<li>Create new commits on top that make changes to file A</li>
<li>Whoops, I should rename file A to B. Do so, amend the first commit.</li>
<li>Because the first commit created file A, there is no rename to record; it's changing to a commit that instead creates file B.</li>
<li>All child commits get sad on evolve</li>
</ol>
<p>In jj, we have an opportunity to fix this because all rebasing occurs atomically
and transactionally within memory. The exact implementation of this is yet to be
determined, but conceptually the following should produce desirable results:</p>
<ol>
<li>Rebase commit A from parents [B] to parents [C]</li>
<li>Get copy records from [D]-&gt;[B] and [D]-&gt;[C], where [D] are the common ancestors of [B] and [C]</li>
<li>DescendantRebaser maintains an in-memory map of commits to extra copy info, which it may inject into (2). When squashing a rename of a newly created file into the commit that creates that file, DescendentRebase will return this rename for all rebases of descendants of the newly modified commit. The rename lives ephemerally in memory and has no persistence after the rebase completes.</li>
<li>A to-be-determined algorithm diffs the copy records between [D]-&gt;[B] and [D]-&gt;[C] in order to make changes to the rebased commit. This results in edits to renamed files being propagated to those renamed files, and avoiding conflicts on the deletion of their sources. A copy/move may also be undone in this way; abandoning a commit which renames A-&gt;B should move all descendant edits of B back into A.</li>
</ol>
<h3 id="design-copy-tracking-conflicts">Conflicts<a class="headerlink" href="#design-copy-tracking-conflicts" title="Permanent link">&para;</a></h3>
<p>With copy-tracking, a whole new class of conflicts become possible. These need
to be well-defined and have well documented resolution paths. Because copy info
in a commit is keyed by <em>destination</em>, conflicts can only occur at the
<em>destination</em> of a copy, not at a source (that's called forking).</p>
<h4 id="design-copy-tracking-split-conflicts">Split conflicts<a class="headerlink" href="#design-copy-tracking-split-conflicts" title="Permanent link">&para;</a></h4>
<p>Suppose we create commit A by renaming file F1 -&gt; F2, then we split A. What
happens to the copy info? I argue that this is straightforward:</p>
<ul>
<li>If F2 is preserved at all in the parent commit, the copy info stays on the parent commit.</li>
<li>Otherwise, the copy info goes onto the child commit.</li>
</ul>
<p>Things get a little messier if A <em>also</em> modifies F1, and this modification is
separated from the copy, but I think this is messy only in an academic sense and
the user gets a sane result either way. If they want to separate the
modification from the copy while still putting it in an earlier commit, they can
express this intent after with <code>jj cp --after --from</code>.</p>
<h4 id="design-copy-tracking-merge-commit-conflicts">Merge commit conflicts<a class="headerlink" href="#design-copy-tracking-merge-commit-conflicts" title="Permanent link">&para;</a></h4>
<p>Suppose we create commit A by renaming file F1 -&gt; F, then we create a sibling
commit B by renaming file F2 -&gt; F. What happens when we create a merge commit
with parents A and B?</p>
<p>In terms of <em>copy info</em> there is no conflict here, because C does not have copy
info and needs none, but resolving the contents of F becomes more complicated.
We need to (1) identify the greatest common ancestor of A and B (D)
(which we do anyway), and (2) invoke <code>get_copy_records()</code> on F for each of
<code>D::A</code> and <code>D::B</code> to identify the 'real' source file id for each parent. If
these are the same, then we can use that as the base for a better 3-way merge.
Otherwise, we must treat it as an add+add conflict where the base is the empty
file id.</p>
<p>It is possible that F1 and F2 both came from a common source file G, but that
these copies precede D. In such case, we will not produce as good of a merge
resolution as we theoretically could, but (1) this seems extremely niche and
unlikely, and (2) we cannot reasonably achieve this without implementing some
analogue of Mercurial's linknodes concept, and it would be nice to avoid that
additional complexity.</p>
<h4 id="design-copy-tracking-squash-conflicts">Squash conflicts<a class="headerlink" href="#design-copy-tracking-squash-conflicts" title="Permanent link">&para;</a></h4>
<p>Suppose we create commit A by renaming file F1 -&gt; F, then we create child
commit B in which we replace F by renaming F2 -&gt; F. This touches on two issues.</p>
<p>Firstly, if these two commits are squashed together, then we have a destination
F with two copy sources, F1 and F2. In this case, we can store a
<code>CopySources::Conflict([F1, F2])</code> as the copy source for F, and treat this
commit as 'conflicted' in <code>jj log</code>. <code>jj status</code> will need modification to show
this conflicted state, and <code>jj resolve</code> will need some way of handling the
conflicted copy sources (possibly printing them in some structured text form,
and using the user's merge tool to resolve them). Alternatively, the user can
'resolve directly' by running <code>jj cp --after --resolve</code> with the desired copy
info.</p>
<p>Secondly, who is to say that commit B is 'replacing' F at all? In some version
control systems, it is possible to 'integrate' a file X into an existing file Y,
by e.g. propagating changes in X since its previous 'integrate' into Y, without
erasing Y's prior history in that moment for the purpose of archaeology. With
the commit metadata currently defined, it is not possible to distinguish
between a 'replacement' operation and an 'integrate' operation.</p>
<h5 id="design-copy-tracking-track-replacements-explicitly">Track replacements explicitly<a class="headerlink" href="#design-copy-tracking-track-replacements-explicitly" title="Permanent link">&para;</a></h5>
<p>One solution is to add a <code>destructive: bool</code> field or similar to the
<code>CopySource</code> struct, to explicitly distinguish between these two types of copy
records. It then becomes possible to record a non-destructive copy using
<code>--after</code> to recognize that a file F was 'merged into' its destination, which
can be useful in handling parallel edits of F that later sync this information.</p>
<h5 id="design-copy-tracking-always-assume-replacement">Always assume replacement<a class="headerlink" href="#design-copy-tracking-always-assume-replacement" title="Permanent link">&para;</a></h5>
<p>Alternatively, we can keep copy-tracking simple in jj by taking a stronger
stance here and treating all copies-onto-existing-files as 'replacement'
operations. This makes integrations with more complex VCSs that do support
'integrate'-style operations trickier, but it is possible that a more generic
commit extension system is better suited to such backends.</p>
<h3 id="design-copy-tracking-future-changes">Future Changes<a class="headerlink" href="#design-copy-tracking-future-changes" title="Permanent link">&para;</a></h3>
<p>An implementation of <code>jj blame</code> or <code>jj annotate</code> does not currently exist, but
when it does we'll definitely want it to be copy-tracing aware to provide
better annotations for users doing archaeology. The Read APIs provided are
expected to be sufficient for these use cases.</p>
<h2 id="design-copy-tracking-non-goals">Non-goals<a class="headerlink" href="#design-copy-tracking-non-goals" title="Permanent link">&para;</a></h2>
<h3 id="design-copy-tracking-tracking-copies-in-git">Tracking copies in Git<a class="headerlink" href="#design-copy-tracking-tracking-copies-in-git" title="Permanent link">&para;</a></h3>
<p>Git uses rename detection rather than copy tracking, generating copy info on
the fly between two arbitrary trees. It does not have any place for explicit
copy info that <em>exchanges</em> with other users of the same git repo, so any
enhancements jj adds here would be local only and could potentially introduce
confusion when collaborating with other users.</p>
<h3 id="design-copy-tracking-directory-copiesmoves">Directory copies/moves<a class="headerlink" href="#design-copy-tracking-directory-copiesmoves" title="Permanent link">&para;</a></h3>
<p>All copy/move information will be read and written at the file level. While
<code>jj cp|mv</code> may accept directory paths as a convenience and perform the
appropriate tree modification operations, the renames will be recorded at the
file level, one for each copied/moved file.</p></section></section><section class="print-page" id="roadmap" heading-number="13"><h1 id="roadmap-roadmap">Roadmap<a class="headerlink" href="#roadmap-roadmap" title="Permanent link">&para;</a></h1>
<p>This documents some of the goals we have. Many of them are quite independent.</p>
<blockquote>
<p><strong>Note:</strong> Most people contributing to Jujutsu do so in their spare time, which
 means that we cannot attach any target dates to any of the goals below.</p>
</blockquote>
<h2 id="roadmap-support-for-copies-and-renames">Support for copies and renames<a class="headerlink" href="#roadmap-support-for-copies-and-renames" title="Permanent link">&para;</a></h2>
<p>We want to support copy tracing in a way that leaves it up to the commit backend
to either record or detect copies. That should let us work with existing Git
repos (Git does not record copies, it detects them on the fly) as well as with
very large repos where detection would be too slow. See
<a href="#design-copy-tracking">design doc</a>.</p>
<h2 id="roadmap-forge-integrations">Forge integrations<a class="headerlink" href="#roadmap-forge-integrations" title="Permanent link">&para;</a></h2>
<p>We would like to make it easier to work with various popular forges by providing
something like <code>jj github submit</code>, <code>jj gitlab submit</code>, and <code>jj gerrit send</code>. For
popular forges, we might include that support by default in the standard <code>jj</code>
binary.</p>
<h2 id="roadmap-submodule-support">Submodule support<a class="headerlink" href="#roadmap-submodule-support" title="Permanent link">&para;</a></h2>
<p>Git submodules are used frequently enough in large Git repos that we will
probably need to <a href="https://github.com/jj-vcs/jj/issues/494">support them</a>. There are still big open
questions around UX.</p>
<h2 id="roadmap-better-rust-api-for-uis">Better Rust API for UIs<a class="headerlink" href="#roadmap-better-rust-api-for-uis" title="Permanent link">&para;</a></h2>
<p>UIs like <a href="https://github.com/gulbanana/gg">gg</a> currently have to duplicate quite a bit of logic from <code>jj-cli</code>. We
need to make this code not specific to the CLI (e.g. return status objects
instead of printing messages) and move it into <code>jj-lib</code>.</p>
<h2 id="roadmap-rpc-api">RPC API<a class="headerlink" href="#roadmap-rpc-api" title="Permanent link">&para;</a></h2>
<p>One problem with writing tools using the Rust API is that they will only work
with the backends they were compiled with. For example, a regular <a href="https://github.com/gulbanana/gg">gg</a> build
will not work on Google repos because it doesn't have the backends necessary to
load them. We want to provide an RPC API for tools that want to work with an
unknown build of <code>jj</code> by having the tool run something like <code>jj api</code> to give it
an address to talk to.</p>
<p>In addition to helping with the problem of unknown backends, having an RPC API
should make it easier for tools like VS Code that are not written in Rust. The
RPC API will probably be at a higher abstraction level than the Rust API.</p>
<p>See <a href="https://docs.google.com/document/d/1rOKvutee5TVYpFhh_UDNZDxfUKyrJ8rjCNpFaNHOHwU/edit?usp=sharing&amp;resourcekey=0-922ApyoAjuXN_uTKqmCqjg">design doc</a>.</p>
<h2 id="roadmap-open-source-cloud-based-repos-server-and-daemon-process">Open-source cloud-based repos (server and daemon process)<a class="headerlink" href="#roadmap-open-source-cloud-based-repos-server-and-daemon-process" title="Permanent link">&para;</a></h2>
<p>Google has an internal Jujutsu server backed by a database. This server allows
commits and repos (operation logs) to be stored in the cloud (i.e. the database).
Working copies can still be stored locally.</p>
<p>In order to reduce latency, there is a local daemon process that caches reads
and writes. It also prefetches of objects it thinks the client might ask for
next. In also helps with write latency by optimistically answering write
requests (it therefore needs to know the server's hashing scheme so it can
return the right IDs).</p>
<p>We (the project, not necessarily Google) want to provide a similar experience
for all users. We would therefore like to create a similar server and daemon.
The daemon might be the same process as for the RPC API mentioned above.</p>
<h2 id="roadmap-virtual-file-system-vfs">Virtual file system (VFS)<a class="headerlink" href="#roadmap-virtual-file-system-vfs" title="Permanent link">&para;</a></h2>
<p>For very large projects and/or large files, it can be expensive to update the
working copy. We want to provide a VFS to help with that. Updating the working
copy to another commit can then be done simply by telling the VFS to use the
other commit as base, without needing to download any large files in the target
commit until the user asks for them via the file system. A VFS can also make it
cheap to snapshot the working copy by keeping track of all changes compared to
the base commit.</p>
<p>Having a VFS can also be very benefial for <a href="https://github.com/jj-vcs/jj/issues/1869"><code>jj run</code></a>, since we can then
cheaply create temporary working copies for the commands to run in.</p>
<h2 id="roadmap-better-support-for-large-files">Better support for large files<a class="headerlink" href="#roadmap-better-support-for-large-files" title="Permanent link">&para;</a></h2>
<p>We have talked about somehow using content-defined chunking (CDC) to reduce
storage and transfer costs for large files. Maybe we will store files in our
future cloud-based server using the same model as <a href="https://web.archive.org/web/20240914200921/https://xethub.com/assets/docs/concepts/xet-storage">XetHub</a>.</p></section></div><style>.print-site-enumerate-headings #index > h1:before { content: '1 ' }

                .print-site-enumerate-headings #index h2:before { content: '1.' counter(counter-index-2) ' ' }
                .print-site-enumerate-headings #index h2 {  counter-reset: counter-index-3 ;  counter-increment: counter-index-2 }
            
                .print-site-enumerate-headings #index h3:before { content: '1.' counter(counter-index-2) '.' counter(counter-index-3) ' ' }
                .print-site-enumerate-headings #index h3 {  counter-increment: counter-index-3 }
            
.print-site-enumerate-headings #section-2 > h1:before { content: '2 ' }
.print-site-enumerate-headings #install-and-setup > h1:before { content: '2.1 ' }

                .print-site-enumerate-headings #install-and-setup h2:before { content: '2.1.' counter(counter-install-and-setup-2) ' ' }
                .print-site-enumerate-headings #install-and-setup h2 {  counter-increment: counter-install-and-setup-2 }
            
.print-site-enumerate-headings #tutorial > h1:before { content: '2.2 ' }

                .print-site-enumerate-headings #tutorial h2:before { content: '2.2.' counter(counter-tutorial-2) ' ' }
                .print-site-enumerate-headings #tutorial h2 {  counter-increment: counter-tutorial-2 }
            
.print-site-enumerate-headings #github > h1:before { content: '2.3 ' }

                .print-site-enumerate-headings #github h2:before { content: '2.3.' counter(counter-github-2) ' ' }
                .print-site-enumerate-headings #github h2 {  counter-increment: counter-github-2 }
            
.print-site-enumerate-headings #windows > h1:before { content: '2.4 ' }

                .print-site-enumerate-headings #windows h2:before { content: '2.4.' counter(counter-windows-2) ' ' }
                .print-site-enumerate-headings #windows h2 {  counter-increment: counter-windows-2 }
            
.print-site-enumerate-headings #faq > h1:before { content: '3 ' }

                .print-site-enumerate-headings #faq h2:before { content: '3.' counter(counter-faq-2) ' ' }
                .print-site-enumerate-headings #faq h2 {  counter-reset: counter-faq-3 ;  counter-increment: counter-faq-2 }
            
                .print-site-enumerate-headings #faq h3:before { content: '3.' counter(counter-faq-2) '.' counter(counter-faq-3) ' ' }
                .print-site-enumerate-headings #faq h3 {  counter-increment: counter-faq-3 }
            
.print-site-enumerate-headings #cli-reference > h1:before { content: '4 ' }

                .print-site-enumerate-headings #cli-reference h2:before { content: '4.' counter(counter-cli-reference-2) ' ' }
                .print-site-enumerate-headings #cli-reference h2 {  counter-reset: counter-cli-reference-3 ;  counter-increment: counter-cli-reference-2 }
            
                .print-site-enumerate-headings #cli-reference h3:before { content: '4.' counter(counter-cli-reference-2) '.' counter(counter-cli-reference-3) ' ' }
                .print-site-enumerate-headings #cli-reference h3 {  counter-increment: counter-cli-reference-3 }
            
.print-site-enumerate-headings #testimonials > h1:before { content: '5 ' }

                .print-site-enumerate-headings #testimonials h2:before { content: '5.' counter(counter-testimonials-2) ' ' }
                .print-site-enumerate-headings #testimonials h2 {  counter-reset: counter-testimonials-3 ;  counter-increment: counter-testimonials-2 }
            
                .print-site-enumerate-headings #testimonials h3:before { content: '5.' counter(counter-testimonials-2) '.' counter(counter-testimonials-3) ' ' }
                .print-site-enumerate-headings #testimonials h3 {  counter-increment: counter-testimonials-3 }
            
.print-site-enumerate-headings #community_tools > h1:before { content: '6 ' }

                .print-site-enumerate-headings #community_tools h2:before { content: '6.' counter(counter-community_tools-2) ' ' }
                .print-site-enumerate-headings #community_tools h2 {  counter-reset: counter-community_tools-3 ;  counter-increment: counter-community_tools-2 }
            
                .print-site-enumerate-headings #community_tools h3:before { content: '6.' counter(counter-community_tools-2) '.' counter(counter-community_tools-3) ' ' }
                .print-site-enumerate-headings #community_tools h3 {  counter-increment: counter-community_tools-3 }
            
.print-site-enumerate-headings #section-7 > h1:before { content: '7 ' }
.print-site-enumerate-headings #working-copy > h1:before { content: '7.1 ' }

                .print-site-enumerate-headings #working-copy h2:before { content: '7.1.' counter(counter-working-copy-2) ' ' }
                .print-site-enumerate-headings #working-copy h2 {  counter-increment: counter-working-copy-2 }
            
.print-site-enumerate-headings #bookmarks > h1:before { content: '7.2 ' }

                .print-site-enumerate-headings #bookmarks h2:before { content: '7.2.' counter(counter-bookmarks-2) ' ' }
                .print-site-enumerate-headings #bookmarks h2 {  counter-increment: counter-bookmarks-2 }
            
.print-site-enumerate-headings #conflicts > h1:before { content: '7.3 ' }

                .print-site-enumerate-headings #conflicts h2:before { content: '7.3.' counter(counter-conflicts-2) ' ' }
                .print-site-enumerate-headings #conflicts h2 {  counter-increment: counter-conflicts-2 }
            
.print-site-enumerate-headings #operation-log > h1:before { content: '7.4 ' }

                .print-site-enumerate-headings #operation-log h2:before { content: '7.4.' counter(counter-operation-log-2) ' ' }
                .print-site-enumerate-headings #operation-log h2 {  counter-increment: counter-operation-log-2 }
            
.print-site-enumerate-headings #glossary > h1:before { content: '7.5 ' }

                .print-site-enumerate-headings #glossary h2:before { content: '7.5.' counter(counter-glossary-2) ' ' }
                .print-site-enumerate-headings #glossary h2 {  counter-increment: counter-glossary-2 }
            
.print-site-enumerate-headings #section-8 > h1:before { content: '8 ' }
.print-site-enumerate-headings #config > h1:before { content: '8.1 ' }

                .print-site-enumerate-headings #config h2:before { content: '8.1.' counter(counter-config-2) ' ' }
                .print-site-enumerate-headings #config h2 {  counter-increment: counter-config-2 }
            
.print-site-enumerate-headings #filesets > h1:before { content: '8.2 ' }

                .print-site-enumerate-headings #filesets h2:before { content: '8.2.' counter(counter-filesets-2) ' ' }
                .print-site-enumerate-headings #filesets h2 {  counter-increment: counter-filesets-2 }
            
.print-site-enumerate-headings #revsets > h1:before { content: '8.3 ' }

                .print-site-enumerate-headings #revsets h2:before { content: '8.3.' counter(counter-revsets-2) ' ' }
                .print-site-enumerate-headings #revsets h2 {  counter-increment: counter-revsets-2 }
            
.print-site-enumerate-headings #templates > h1:before { content: '8.4 ' }

                .print-site-enumerate-headings #templates h2:before { content: '8.4.' counter(counter-templates-2) ' ' }
                .print-site-enumerate-headings #templates h2 {  counter-increment: counter-templates-2 }
            
.print-site-enumerate-headings #section-9 > h1:before { content: '9 ' }
.print-site-enumerate-headings #git-comparison > h1:before { content: '9.1 ' }

                .print-site-enumerate-headings #git-comparison h2:before { content: '9.1.' counter(counter-git-comparison-2) ' ' }
                .print-site-enumerate-headings #git-comparison h2 {  counter-increment: counter-git-comparison-2 }
            
.print-site-enumerate-headings #git-command-table > h1:before { content: '9.2 ' }

                .print-site-enumerate-headings #git-command-table h2:before { content: '9.2.' counter(counter-git-command-table-2) ' ' }
                .print-site-enumerate-headings #git-command-table h2 {  counter-increment: counter-git-command-table-2 }
            
.print-site-enumerate-headings #git-compatibility > h1:before { content: '9.3 ' }

                .print-site-enumerate-headings #git-compatibility h2:before { content: '9.3.' counter(counter-git-compatibility-2) ' ' }
                .print-site-enumerate-headings #git-compatibility h2 {  counter-increment: counter-git-compatibility-2 }
            
.print-site-enumerate-headings #sapling-comparison > h1:before { content: '9.4 ' }

                .print-site-enumerate-headings #sapling-comparison h2:before { content: '9.4.' counter(counter-sapling-comparison-2) ' ' }
                .print-site-enumerate-headings #sapling-comparison h2 {  counter-increment: counter-sapling-comparison-2 }
            
.print-site-enumerate-headings #related-work > h1:before { content: '9.5 ' }

                .print-site-enumerate-headings #related-work h2:before { content: '9.5.' counter(counter-related-work-2) ' ' }
                .print-site-enumerate-headings #related-work h2 {  counter-increment: counter-related-work-2 }
            
.print-site-enumerate-headings #section-10 > h1:before { content: '10 ' }
.print-site-enumerate-headings #core_tenets > h1:before { content: '10.1 ' }

                .print-site-enumerate-headings #core_tenets h2:before { content: '10.1.' counter(counter-core_tenets-2) ' ' }
                .print-site-enumerate-headings #core_tenets h2 {  counter-increment: counter-core_tenets-2 }
            
.print-site-enumerate-headings #technical-architecture > h1:before { content: '10.2 ' }

                .print-site-enumerate-headings #technical-architecture h2:before { content: '10.2.' counter(counter-technical-architecture-2) ' ' }
                .print-site-enumerate-headings #technical-architecture h2 {  counter-increment: counter-technical-architecture-2 }
            
.print-site-enumerate-headings #technical-concurrency > h1:before { content: '10.3 ' }

                .print-site-enumerate-headings #technical-concurrency h2:before { content: '10.3.' counter(counter-technical-concurrency-2) ' ' }
                .print-site-enumerate-headings #technical-concurrency h2 {  counter-increment: counter-technical-concurrency-2 }
            
.print-site-enumerate-headings #technical-conflicts > h1:before { content: '10.4 ' }

                .print-site-enumerate-headings #technical-conflicts h2:before { content: '10.4.' counter(counter-technical-conflicts-2) ' ' }
                .print-site-enumerate-headings #technical-conflicts h2 {  counter-increment: counter-technical-conflicts-2 }
            
.print-site-enumerate-headings #section-11 > h1:before { content: '11 ' }
.print-site-enumerate-headings #contributing > h1:before { content: '11.1 ' }

                .print-site-enumerate-headings #contributing h2:before { content: '11.1.' counter(counter-contributing-2) ' ' }
                .print-site-enumerate-headings #contributing h2 {  counter-increment: counter-contributing-2 }
            
.print-site-enumerate-headings #code-of-conduct > h1:before { content: '11.2 ' }

                .print-site-enumerate-headings #code-of-conduct h2:before { content: '11.2.' counter(counter-code-of-conduct-2) ' ' }
                .print-site-enumerate-headings #code-of-conduct h2 {  counter-increment: counter-code-of-conduct-2 }
            
.print-site-enumerate-headings #style_guide > h1:before { content: '11.3 ' }

                .print-site-enumerate-headings #style_guide h2:before { content: '11.3.' counter(counter-style_guide-2) ' ' }
                .print-site-enumerate-headings #style_guide h2 {  counter-increment: counter-style_guide-2 }
            
.print-site-enumerate-headings #design_docs > h1:before { content: '11.4 ' }

                .print-site-enumerate-headings #design_docs h2:before { content: '11.4.' counter(counter-design_docs-2) ' ' }
                .print-site-enumerate-headings #design_docs h2 {  counter-increment: counter-design_docs-2 }
            
.print-site-enumerate-headings #design_doc_blueprint > h1:before { content: '11.5 ' }

                .print-site-enumerate-headings #design_doc_blueprint h2:before { content: '11.5.' counter(counter-design_doc_blueprint-2) ' ' }
                .print-site-enumerate-headings #design_doc_blueprint h2 {  counter-increment: counter-design_doc_blueprint-2 }
            
.print-site-enumerate-headings #releasing > h1:before { content: '11.6 ' }

                .print-site-enumerate-headings #releasing h2:before { content: '11.6.' counter(counter-releasing-2) ' ' }
                .print-site-enumerate-headings #releasing h2 {  counter-increment: counter-releasing-2 }
            
.print-site-enumerate-headings #governance-temporary-voting > h1:before { content: '11.7 ' }

                .print-site-enumerate-headings #governance-temporary-voting h2:before { content: '11.7.' counter(counter-governance-temporary-voting-2) ' ' }
                .print-site-enumerate-headings #governance-temporary-voting h2 {  counter-increment: counter-governance-temporary-voting-2 }
            
.print-site-enumerate-headings #governance-governance > h1:before { content: '11.8 ' }

                .print-site-enumerate-headings #governance-governance h2:before { content: '11.8.' counter(counter-governance-governance-2) ' ' }
                .print-site-enumerate-headings #governance-governance h2 {  counter-increment: counter-governance-governance-2 }
            
.print-site-enumerate-headings #section-12 > h1:before { content: '12 ' }
.print-site-enumerate-headings #design-git-submodules > h1:before { content: '12.1 ' }

                .print-site-enumerate-headings #design-git-submodules h2:before { content: '12.1.' counter(counter-design-git-submodules-2) ' ' }
                .print-site-enumerate-headings #design-git-submodules h2 {  counter-increment: counter-design-git-submodules-2 }
            
.print-site-enumerate-headings #design-git-submodule-storage > h1:before { content: '12.2 ' }

                .print-site-enumerate-headings #design-git-submodule-storage h2:before { content: '12.2.' counter(counter-design-git-submodule-storage-2) ' ' }
                .print-site-enumerate-headings #design-git-submodule-storage h2 {  counter-increment: counter-design-git-submodule-storage-2 }
            
.print-site-enumerate-headings #design-run > h1:before { content: '12.3 ' }

                .print-site-enumerate-headings #design-run h2:before { content: '12.3.' counter(counter-design-run-2) ' ' }
                .print-site-enumerate-headings #design-run h2 {  counter-increment: counter-design-run-2 }
            
.print-site-enumerate-headings #design-sparse-v2 > h1:before { content: '12.4 ' }

                .print-site-enumerate-headings #design-sparse-v2 h2:before { content: '12.4.' counter(counter-design-sparse-v2-2) ' ' }
                .print-site-enumerate-headings #design-sparse-v2 h2 {  counter-increment: counter-design-sparse-v2-2 }
            
.print-site-enumerate-headings #design-tracking-branches > h1:before { content: '12.5 ' }

                .print-site-enumerate-headings #design-tracking-branches h2:before { content: '12.5.' counter(counter-design-tracking-branches-2) ' ' }
                .print-site-enumerate-headings #design-tracking-branches h2 {  counter-increment: counter-design-tracking-branches-2 }
            
.print-site-enumerate-headings #design-copy-tracking > h1:before { content: '12.6 ' }

                .print-site-enumerate-headings #design-copy-tracking h2:before { content: '12.6.' counter(counter-design-copy-tracking-2) ' ' }
                .print-site-enumerate-headings #design-copy-tracking h2 {  counter-increment: counter-design-copy-tracking-2 }
            
.print-site-enumerate-headings #roadmap > h1:before { content: '13 ' }

                .print-site-enumerate-headings #roadmap h2:before { content: '13.' counter(counter-roadmap-2) ' ' }
                .print-site-enumerate-headings #roadmap h2 {  counter-reset: counter-roadmap-3 ;  counter-increment: counter-roadmap-2 }
            
                .print-site-enumerate-headings #roadmap h3:before { content: '13.' counter(counter-roadmap-2) '.' counter(counter-roadmap-3) ' ' }
                .print-site-enumerate-headings #roadmap h3 {  counter-increment: counter-roadmap-3 }
            </style>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "/jj/", "features": ["content.action.edit", "content.code.copy", "navigation.instant"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>